2021-09-29 16:05:43.281464 (MainThread): Running with dbt=0.20.2
2021-09-29 16:05:43.783301 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, parse_only=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, full_refresh=False, defer=None, cls=<class 'dbt.task.compile.CompileTask'>, which='compile', rpc_method='compile')
2021-09-29 16:05:43.796630 (MainThread): Tracking: tracking
2021-09-29 16:05:43.797626 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4E784BDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4E8D7A280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4E8D7A400>]}
2021-09-29 16:05:43.812865 (MainThread): Partial parsing not enabled
2021-09-29 16:05:43.988303 (MainThread): Parsing macros\adapters.sql
2021-09-29 16:05:44.013447 (MainThread): Parsing macros\catalog.sql
2021-09-29 16:05:44.014449 (MainThread): Parsing macros\materializations\incremental.sql
2021-09-29 16:05:44.020429 (MainThread): Parsing macros\materializations\merge.sql
2021-09-29 16:05:44.021412 (MainThread): Parsing macros\materializations\table.sql
2021-09-29 16:05:44.023407 (MainThread): Parsing macros\materializations\view.sql
2021-09-29 16:05:44.024415 (MainThread): Parsing macros\core.sql
2021-09-29 16:05:44.026436 (MainThread): Parsing macros\adapters\common.sql
2021-09-29 16:05:44.053231 (MainThread): Parsing macros\etc\datetime.sql
2021-09-29 16:05:44.058214 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-09-29 16:05:44.059211 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-09-29 16:05:44.060208 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-09-29 16:05:44.062202 (MainThread): Parsing macros\etc\is_incremental.sql
2021-09-29 16:05:44.063198 (MainThread): Parsing macros\etc\query.sql
2021-09-29 16:05:44.063198 (MainThread): Parsing macros\materializations\helpers.sql
2021-09-29 16:05:44.069178 (MainThread): Parsing macros\materializations\test.sql
2021-09-29 16:05:44.073164 (MainThread): Parsing macros\materializations\common\merge.sql
2021-09-29 16:05:44.081138 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-09-29 16:05:44.082135 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-09-29 16:05:44.087119 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-09-29 16:05:44.100074 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-09-29 16:05:44.117832 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-09-29 16:05:44.118829 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-09-29 16:05:44.128874 (MainThread): Parsing macros\materializations\table\table.sql
2021-09-29 16:05:44.132871 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-09-29 16:05:44.135861 (MainThread): Parsing macros\materializations\view\view.sql
2021-09-29 16:05:44.139847 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-09-29 16:05:44.140845 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-09-29 16:05:44.141841 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-09-29 16:05:44.142838 (MainThread): Parsing macros\schema_tests\unique.sql
2021-09-29 16:05:44.245270 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-09-29 16:05:44.251250 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-09-29 16:05:44.269383 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-09-29 16:05:44.270407 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-09-29 16:05:44.271404 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-09-29 16:05:44.272400 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-09-29 16:05:44.297176 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea4469e7-3413-44cc-b51f-4522202726fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4E8ECB9A0>]}
2021-09-29 16:05:44.336563 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-09-29 16:05:44.337688 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea4469e7-3413-44cc-b51f-4522202726fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4E62EB0D0>]}
2021-09-29 16:05:44.337688 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-09-29 16:05:44.339003 (MainThread): 
2021-09-29 16:05:44.339654 (MainThread): Acquiring new snowflake connection "master".
2021-09-29 16:05:44.340727 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-09-29 16:05:44.356191 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics_dbt".
2021-09-29 16:05:44.356191 (ThreadPoolExecutor-0_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-09-29 16:05:44.357109 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-09-29 16:05:45.428661 (ThreadPoolExecutor-0_0): Got an error when attempting to open a snowflake connection: '250001 (08001): Failed to connect to DB: fua63997.us-east-1.snowflakecomputing.com:443. Specified password has expired.  Password must be changed using the Snowflake web console.'
2021-09-29 16:05:45.428661 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-09-29 16:05:45.428661 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-09-29 16:05:45.429657 (ThreadPoolExecutor-0_0): Error running SQL: macro list_relations_without_caching
2021-09-29 16:05:45.429657 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-09-29 16:05:45.429657 (ThreadPoolExecutor-0_0): On list_analytics_dbt: No close available on handle
2021-09-29 16:05:45.430582 (MainThread): Connection 'master' was properly closed.
2021-09-29 16:05:45.430582 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-09-29 16:05:45.430582 (MainThread): ERROR: Database Error
  250001 (08001): Failed to connect to DB: fua63997.us-east-1.snowflakecomputing.com:443. Specified password has expired.  Password must be changed using the Snowflake web console.
2021-09-29 16:05:45.430582 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4E8CE4E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4E8D73370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4E8ECB2E0>]}
2021-09-29 16:05:45.431579 (MainThread): Flushing usage events
2021-10-01 07:31:21.004963 (MainThread): Running with dbt=0.20.2
2021-10-01 07:31:21.609629 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-01 07:31:21.611621 (MainThread): Tracking: tracking
2021-10-01 07:31:21.611621 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002193DF6DDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002193F49C610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002193F49C670>]}
2021-10-01 07:31:21.624719 (MainThread): Partial parsing not enabled
2021-10-01 07:31:21.805331 (MainThread): Parsing macros\adapters.sql
2021-10-01 07:31:21.831261 (MainThread): Parsing macros\catalog.sql
2021-10-01 07:31:21.833921 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-01 07:31:21.844030 (MainThread): Parsing macros\materializations\merge.sql
2021-10-01 07:31:21.845525 (MainThread): Parsing macros\materializations\table.sql
2021-10-01 07:31:21.850507 (MainThread): Parsing macros\materializations\view.sql
2021-10-01 07:31:21.851504 (MainThread): Parsing macros\core.sql
2021-10-01 07:31:21.855489 (MainThread): Parsing macros\adapters\common.sql
2021-10-01 07:31:21.894027 (MainThread): Parsing macros\etc\datetime.sql
2021-10-01 07:31:21.903990 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-01 07:31:21.904987 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-01 07:31:21.905983 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-01 07:31:21.906979 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-01 07:31:21.907976 (MainThread): Parsing macros\etc\query.sql
2021-10-01 07:31:21.907976 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-01 07:31:21.915500 (MainThread): Parsing macros\materializations\test.sql
2021-10-01 07:31:21.922478 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-01 07:31:21.934821 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-01 07:31:21.935817 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-01 07:31:21.940799 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-01 07:31:21.954748 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-01 07:31:21.974676 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-01 07:31:21.975672 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-01 07:31:21.989787 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-01 07:31:21.995765 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-01 07:31:21.998754 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-01 07:31:22.003093 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-01 07:31:22.004091 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-01 07:31:22.005088 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-01 07:31:22.006084 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-01 07:31:22.116524 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:31:22.125498 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 07:31:22.143425 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:31:22.144421 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:31:22.146414 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:31:22.147410 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:31:22.163458 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bd6fcc2-cd83-43ba-ae28-a62f64b0bab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002193F51B790>]}
2021-10-01 07:31:22.209842 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-01 07:31:22.210991 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bd6fcc2-cd83-43ba-ae28-a62f64b0bab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002193F408FD0>]}
2021-10-01 07:31:22.211610 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-01 07:31:22.212704 (MainThread): 
2021-10-01 07:31:22.212704 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 07:31:22.214203 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-01 07:31:22.223165 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-01 07:31:22.223165 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-01 07:31:22.223165 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 07:31:23.559240 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 1.34 seconds
2021-10-01 07:31:23.563871 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-01 07:31:24.032461 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2021-10-01 07:31:24.032461 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2021-10-01 07:31:24.032461 (ThreadPoolExecutor-0_0): Creating schema "analytics.dbt"
2021-10-01 07:31:24.035491 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt".
2021-10-01 07:31:24.035491 (ThreadPoolExecutor-0_0): On create_analytics_dbt: BEGIN
2021-10-01 07:31:24.035491 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-01 07:31:26.042369 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 2.01 seconds
2021-10-01 07:31:26.042369 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt".
2021-10-01 07:31:26.042369 (ThreadPoolExecutor-0_0): On create_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "create_analytics_dbt"} */
create schema if not exists analytics.dbt
2021-10-01 07:31:26.630461 (ThreadPoolExecutor-0_0): Snowflake query id: 019f4fe3-0601-30a3-0000-00664703602d
2021-10-01 07:31:26.630461 (ThreadPoolExecutor-0_0): Snowflake error: 003041 (42710): SQL compilation error:
Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-10-01 07:31:26.630461 (ThreadPoolExecutor-0_0): Error running SQL: macro create_schema
2021-10-01 07:31:26.630461 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-10-01 07:31:26.630461 (ThreadPoolExecutor-0_0): On create_analytics_dbt: ROLLBACK
2021-10-01 07:31:27.135392 (ThreadPoolExecutor-0_0): On create_analytics_dbt: Close
2021-10-01 07:31:27.710077 (MainThread): Connection 'master' was properly closed.
2021-10-01 07:31:27.710077 (MainThread): Connection 'create_analytics_dbt' was properly closed.
2021-10-01 07:31:27.710077 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002193F564460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002193F487A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002193F487190>]}
2021-10-01 07:31:27.710077 (MainThread): Flushing usage events
2021-10-01 07:31:28.890462 (MainThread): Encountered an error:
2021-10-01 07:31:28.890462 (MainThread): Database Error
  003041 (42710): SQL compilation error:
  Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-10-01 07:31:28.909940 (MainThread): Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003041 (42710): SQL compilation error:
Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 425, in run
    result = self.execute_with_hooks(selected_uids)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 410, in before_run
    self.create_schemas(adapter, selected_uids)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 536, in create_schemas
    create_future.result()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\concurrent\futures\_base.py", line 438, in result
    return self.__get_result()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\concurrent\futures\_base.py", line 390, in __get_result
    raise self._exception
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\concurrent\futures\thread.py", line 52, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\utils.py", line 474, in connected
    return func(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 499, in create_schema
    adapter.create_schema(relation)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\impl.py", line 182, in create_schema
    self.execute_macro(CREATE_SCHEMA_MACRO_NAME, kwargs=kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 1000, in execute_macro
    result = macro_function(**kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 19, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  003041 (42710): SQL compilation error:
  Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

2021-10-01 07:45:03.066764 (MainThread): Running with dbt=0.20.2
2021-10-01 07:45:03.998757 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-01 07:45:03.999684 (MainThread): Tracking: tracking
2021-10-01 07:45:03.999684 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFD22BCE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFD3806FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFD3806EB0>]}
2021-10-01 07:45:04.011251 (MainThread): Partial parsing not enabled
2021-10-01 07:45:04.186576 (MainThread): Parsing macros\adapters.sql
2021-10-01 07:45:04.203860 (MainThread): Parsing macros\catalog.sql
2021-10-01 07:45:04.205854 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-01 07:45:04.210838 (MainThread): Parsing macros\materializations\merge.sql
2021-10-01 07:45:04.211834 (MainThread): Parsing macros\materializations\table.sql
2021-10-01 07:45:04.213827 (MainThread): Parsing macros\materializations\view.sql
2021-10-01 07:45:04.214824 (MainThread): Parsing macros\core.sql
2021-10-01 07:45:04.216817 (MainThread): Parsing macros\adapters\common.sql
2021-10-01 07:45:04.243726 (MainThread): Parsing macros\etc\datetime.sql
2021-10-01 07:45:04.248779 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-01 07:45:04.249781 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-01 07:45:04.249781 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-01 07:45:04.251777 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-01 07:45:04.251777 (MainThread): Parsing macros\etc\query.sql
2021-10-01 07:45:04.252771 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-01 07:45:04.257769 (MainThread): Parsing macros\materializations\test.sql
2021-10-01 07:45:04.261734 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-01 07:45:04.269707 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-01 07:45:04.270727 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-01 07:45:04.275697 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-01 07:45:04.288642 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-01 07:45:04.306514 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-01 07:45:04.307586 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-01 07:45:04.319246 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-01 07:45:04.323229 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-01 07:45:04.326223 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-01 07:45:04.330206 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-01 07:45:04.331202 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-01 07:45:04.332199 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-01 07:45:04.333275 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-01 07:45:04.430372 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:45:04.436352 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 07:45:04.452802 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:45:04.453799 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:45:04.454796 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:45:04.455793 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:45:04.501013 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55d92460-aff0-4410-b702-c7c0971ee50c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFD3917CA0>]}
2021-10-01 07:45:04.522388 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-01 07:45:04.522388 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55d92460-aff0-4410-b702-c7c0971ee50c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFD3917820>]}
2021-10-01 07:45:04.522388 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-01 07:45:04.523386 (MainThread): 
2021-10-01 07:45:04.524382 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 07:45:04.525378 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-01 07:45:04.533493 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-01 07:45:04.533493 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-01 07:45:04.533493 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 07:45:05.783498 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.25 seconds
2021-10-01 07:45:05.789476 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-01 07:45:06.104695 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-01 07:45:06.111805 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-01 07:45:06.111805 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-01 07:45:06.111805 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-01 07:45:06.996872 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.89 seconds
2021-10-01 07:45:06.996872 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-01 07:45:07.326670 (MainThread): Using snowflake connection "master".
2021-10-01 07:45:07.326670 (MainThread): On master: BEGIN
2021-10-01 07:45:07.326670 (MainThread): Opening a new connection, currently in state init
2021-10-01 07:45:08.350931 (MainThread): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-01 07:45:08.351915 (MainThread): On master: COMMIT
2021-10-01 07:45:08.351915 (MainThread): Using snowflake connection "master".
2021-10-01 07:45:08.351915 (MainThread): On master: COMMIT
2021-10-01 07:45:08.621785 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-01 07:45:08.621785 (MainThread): On master: Close
2021-10-01 07:45:08.941484 (MainThread): 09:45:08 | Concurrency: 1 threads (target='dev')
2021-10-01 07:45:08.942534 (MainThread): 09:45:08 | 
2021-10-01 07:45:08.946170 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:45:08.946170 (Thread-1): 09:45:08 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-10-01 07:45:08.947163 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:45:08.947163 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:45:08.951334 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 07:45:08.965216 (Thread-1): finished collecting timing info
2021-10-01 07:45:08.984226 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 07:45:08.985153 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:45:08.985153 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-01 07:45:08.985153 (Thread-1): Opening a new connection, currently in state init
2021-10-01 07:45:09.900461 (Thread-1): SQL status: SUCCESS 1 in 0.91 seconds
2021-10-01 07:45:09.900461 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:45:09.900461 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-01 07:45:10.186282 (Thread-1): Snowflake query id: 019f4ff1-0601-304f-0000-006647035255
2021-10-01 07:45:10.186282 (Thread-1): Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'DBT'
2021-10-01 07:45:10.186282 (Thread-1): finished collecting timing info
2021-10-01 07:45:10.186282 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: ROLLBACK
2021-10-01 07:45:10.444107 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-01 07:45:10.738110 (Thread-1): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'DBT'
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'DBT'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'DBT'
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-01 07:45:10.744202 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55d92460-aff0-4410-b702-c7c0971ee50c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFD3A7BBB0>]}
2021-10-01 07:45:10.744202 (Thread-1): 09:45:10 | 1 of 2 ERROR creating table model dbt.my_first_dbt_model............. [ERROR in 1.80s]
2021-10-01 07:45:10.745219 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:45:10.746210 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 07:45:10.746210 (Thread-1): 09:45:10 | 2 of 2 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-10-01 07:45:10.747274 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 07:45:10.747838 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 07:45:10.747838 (MainThread): Using snowflake connection "master".
2021-10-01 07:45:10.747838 (MainThread): On master: BEGIN
2021-10-01 07:45:10.747838 (MainThread): Opening a new connection, currently in state closed
2021-10-01 07:45:11.609337 (MainThread): SQL status: SUCCESS 1 in 0.86 seconds
2021-10-01 07:45:11.609337 (MainThread): On master: COMMIT
2021-10-01 07:45:11.609337 (MainThread): Using snowflake connection "master".
2021-10-01 07:45:11.609337 (MainThread): On master: COMMIT
2021-10-01 07:45:11.875742 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-01 07:45:11.875742 (MainThread): On master: Close
2021-10-01 07:45:12.201589 (MainThread): 09:45:12 | 
2021-10-01 07:45:12.202192 (MainThread): 09:45:12 | Finished running 1 table model, 1 view model in 7.68s.
2021-10-01 07:45:12.202192 (MainThread): Connection 'master' was properly closed.
2021-10-01 07:45:12.202192 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-01 07:45:12.203194 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-01 07:45:12.203194 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_first_dbt_model' was properly closed.
2021-10-01 07:45:12.217254 (MainThread): 
2021-10-01 07:45:12.217254 (MainThread): Completed with 1 error and 0 warnings:
2021-10-01 07:45:12.218143 (MainThread): 
2021-10-01 07:45:12.218143 (MainThread): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-01 07:45:12.218143 (MainThread):   003001 (42501): SQL access control error:
2021-10-01 07:45:12.219139 (MainThread):   Insufficient privileges to operate on schema 'DBT'
2021-10-01 07:45:12.219139 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-01 07:45:12.220137 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-10-01 07:45:12.220137 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFD3852CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFD3BE1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFD3BE1BB0>]}
2021-10-01 07:45:12.220137 (MainThread): Flushing usage events
2021-10-01 07:46:58.150759 (MainThread): Running with dbt=0.20.2
2021-10-01 07:46:58.621478 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-01 07:46:58.621478 (MainThread): Tracking: tracking
2021-10-01 07:46:58.621478 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4C51DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4DA4AC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4DA4A670>]}
2021-10-01 07:46:58.627825 (MainThread): Partial parsing not enabled
2021-10-01 07:46:58.637792 (MainThread): Parsing macros\adapters.sql
2021-10-01 07:46:58.655798 (MainThread): Parsing macros\catalog.sql
2021-10-01 07:46:58.656796 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-01 07:46:58.661779 (MainThread): Parsing macros\materializations\merge.sql
2021-10-01 07:46:58.662777 (MainThread): Parsing macros\materializations\table.sql
2021-10-01 07:46:58.664770 (MainThread): Parsing macros\materializations\view.sql
2021-10-01 07:46:58.665767 (MainThread): Parsing macros\core.sql
2021-10-01 07:46:58.667761 (MainThread): Parsing macros\adapters\common.sql
2021-10-01 07:46:58.694585 (MainThread): Parsing macros\etc\datetime.sql
2021-10-01 07:46:58.699569 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-01 07:46:58.699569 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-01 07:46:58.700566 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-01 07:46:58.701562 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-01 07:46:58.702559 (MainThread): Parsing macros\etc\query.sql
2021-10-01 07:46:58.703673 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-01 07:46:58.708692 (MainThread): Parsing macros\materializations\test.sql
2021-10-01 07:46:58.713184 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-01 07:46:58.720666 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-01 07:46:58.721663 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-01 07:46:58.726646 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-01 07:46:58.738901 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-01 07:46:58.756393 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-01 07:46:58.757391 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-01 07:46:58.767428 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-01 07:46:58.771425 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-01 07:46:58.774414 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-01 07:46:58.777392 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-01 07:46:58.778397 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-01 07:46:58.779389 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-01 07:46:58.780381 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-01 07:46:58.877925 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:46:58.883906 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 07:46:58.899966 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:46:58.900964 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:46:58.901961 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:46:58.902957 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:46:58.917179 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa4e31f0-b699-47b4-841b-93175228e600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4DB9B970>]}
2021-10-01 07:46:58.958485 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-01 07:46:58.959482 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa4e31f0-b699-47b4-841b-93175228e600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF46B4CB50>]}
2021-10-01 07:46:58.959482 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-01 07:46:58.960483 (MainThread): 
2021-10-01 07:46:58.961482 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 07:46:58.962519 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-01 07:46:58.970444 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-01 07:46:58.970444 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-01 07:46:58.970444 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 07:47:00.182173 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.21 seconds
2021-10-01 07:47:00.185159 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-01 07:47:00.506611 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2021-10-01 07:47:00.507695 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2021-10-01 07:47:00.507695 (ThreadPoolExecutor-0_0): Creating schema "analytics.dbt"
2021-10-01 07:47:00.513668 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt".
2021-10-01 07:47:00.513668 (ThreadPoolExecutor-0_0): On create_analytics_dbt: BEGIN
2021-10-01 07:47:00.513668 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-01 07:47:01.707477 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 1.19 seconds
2021-10-01 07:47:01.707477 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt".
2021-10-01 07:47:01.708552 (ThreadPoolExecutor-0_0): On create_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "create_analytics_dbt"} */
create schema if not exists analytics.dbt
2021-10-01 07:47:01.958901 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-01 07:47:01.960825 (ThreadPoolExecutor-0_0): On create_analytics_dbt: COMMIT
2021-10-01 07:47:01.960825 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt".
2021-10-01 07:47:01.961822 (ThreadPoolExecutor-0_0): On create_analytics_dbt: COMMIT
2021-10-01 07:47:02.229884 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-01 07:47:02.229884 (ThreadPoolExecutor-0_0): On create_analytics_dbt: Close
2021-10-01 07:47:02.550582 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-01 07:47:02.557563 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-01 07:47:02.557563 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-01 07:47:02.557563 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-01 07:47:03.405811 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.85 seconds
2021-10-01 07:47:03.405811 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-01 07:47:03.707302 (MainThread): Using snowflake connection "master".
2021-10-01 07:47:03.707302 (MainThread): On master: BEGIN
2021-10-01 07:47:03.707302 (MainThread): Opening a new connection, currently in state init
2021-10-01 07:47:04.589008 (MainThread): SQL status: SUCCESS 1 in 0.88 seconds
2021-10-01 07:47:04.590075 (MainThread): On master: COMMIT
2021-10-01 07:47:04.590075 (MainThread): Using snowflake connection "master".
2021-10-01 07:47:04.590075 (MainThread): On master: COMMIT
2021-10-01 07:47:04.860284 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-01 07:47:04.860284 (MainThread): On master: Close
2021-10-01 07:47:05.165013 (MainThread): 09:47:05 | Concurrency: 1 threads (target='dev')
2021-10-01 07:47:05.166125 (MainThread): 09:47:05 | 
2021-10-01 07:47:05.171898 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:47:05.171898 (Thread-1): 09:47:05 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-10-01 07:47:05.173074 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:47:05.173074 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:47:05.176148 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 07:47:05.183894 (Thread-1): finished collecting timing info
2021-10-01 07:47:05.202686 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 07:47:05.212693 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:47:05.212693 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-01 07:47:05.212693 (Thread-1): Opening a new connection, currently in state init
2021-10-01 07:47:06.069493 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-10-01 07:47:06.069493 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:47:06.069493 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-01 07:47:06.331581 (Thread-1): Snowflake query id: 019f4ff3-0601-30a3-0000-0066470362cd
2021-10-01 07:47:06.331581 (Thread-1): Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

2021-10-01 07:47:06.331581 (Thread-1): finished collecting timing info
2021-10-01 07:47:06.332574 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: ROLLBACK
2021-10-01 07:47:06.599397 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-01 07:47:06.905558 (Thread-1): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-01 07:47:06.906634 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa4e31f0-b699-47b4-841b-93175228e600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4DE69A00>]}
2021-10-01 07:47:06.907627 (Thread-1): 09:47:06 | 1 of 2 ERROR creating table model dbt.my_first_dbt_model............. [ERROR in 1.73s]
2021-10-01 07:47:06.908547 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:47:06.908547 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 07:47:06.909544 (Thread-1): 09:47:06 | 2 of 2 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-10-01 07:47:06.909544 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 07:47:06.910552 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 07:47:06.910552 (MainThread): Using snowflake connection "master".
2021-10-01 07:47:06.910552 (MainThread): On master: BEGIN
2021-10-01 07:47:06.910552 (MainThread): Opening a new connection, currently in state closed
2021-10-01 07:47:07.799283 (MainThread): SQL status: SUCCESS 1 in 0.89 seconds
2021-10-01 07:47:07.799283 (MainThread): On master: COMMIT
2021-10-01 07:47:07.800276 (MainThread): Using snowflake connection "master".
2021-10-01 07:47:07.800276 (MainThread): On master: COMMIT
2021-10-01 07:47:08.073390 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-01 07:47:08.073390 (MainThread): On master: Close
2021-10-01 07:47:08.382225 (MainThread): 09:47:08 | 
2021-10-01 07:47:08.383225 (MainThread): 09:47:08 | Finished running 1 table model, 1 view model in 9.42s.
2021-10-01 07:47:08.385139 (MainThread): Connection 'master' was properly closed.
2021-10-01 07:47:08.385139 (MainThread): Connection 'create_analytics_dbt' was properly closed.
2021-10-01 07:47:08.385139 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-01 07:47:08.385139 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_first_dbt_model' was properly closed.
2021-10-01 07:47:08.399841 (MainThread): 
2021-10-01 07:47:08.399841 (MainThread): Completed with 1 error and 0 warnings:
2021-10-01 07:47:08.400849 (MainThread): 
2021-10-01 07:47:08.402534 (MainThread): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-01 07:47:08.403541 (MainThread):   000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
2021-10-01 07:47:08.404025 (MainThread):   
2021-10-01 07:47:08.404364 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-01 07:47:08.404869 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-10-01 07:47:08.404869 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4DD5D520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4DE34F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4DE34E50>]}
2021-10-01 07:47:08.404869 (MainThread): Flushing usage events
2021-10-01 07:49:06.696025 (MainThread): Running with dbt=0.20.2
2021-10-01 07:49:07.194451 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-01 07:49:07.195447 (MainThread): Tracking: tracking
2021-10-01 07:49:07.195447 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A5DCCE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A72FB8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A72FB760>]}
2021-10-01 07:49:07.200750 (MainThread): Partial parsing not enabled
2021-10-01 07:49:07.211870 (MainThread): Parsing macros\adapters.sql
2021-10-01 07:49:07.228815 (MainThread): Parsing macros\catalog.sql
2021-10-01 07:49:07.229806 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-01 07:49:07.235716 (MainThread): Parsing macros\materializations\merge.sql
2021-10-01 07:49:07.236713 (MainThread): Parsing macros\materializations\table.sql
2021-10-01 07:49:07.238706 (MainThread): Parsing macros\materializations\view.sql
2021-10-01 07:49:07.239703 (MainThread): Parsing macros\core.sql
2021-10-01 07:49:07.241696 (MainThread): Parsing macros\adapters\common.sql
2021-10-01 07:49:07.268737 (MainThread): Parsing macros\etc\datetime.sql
2021-10-01 07:49:07.273721 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-01 07:49:07.274718 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-01 07:49:07.274718 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-01 07:49:07.275714 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-01 07:49:07.276711 (MainThread): Parsing macros\etc\query.sql
2021-10-01 07:49:07.277708 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-01 07:49:07.282691 (MainThread): Parsing macros\materializations\test.sql
2021-10-01 07:49:07.286677 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-01 07:49:07.295646 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-01 07:49:07.296643 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-01 07:49:07.300629 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-01 07:49:07.313587 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-01 07:49:07.331526 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-01 07:49:07.332523 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-01 07:49:07.343343 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-01 07:49:07.346751 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-01 07:49:07.349414 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-01 07:49:07.352954 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-01 07:49:07.354957 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-01 07:49:07.354957 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-01 07:49:07.355954 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-01 07:49:07.454833 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:49:07.459820 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 07:49:07.475690 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:49:07.476688 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:49:07.477685 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:49:07.478681 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:49:07.492407 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c67c856-7a97-46cb-81cf-856f74c7ba85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A744B940>]}
2021-10-01 07:49:07.537161 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-01 07:49:07.538159 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c67c856-7a97-46cb-81cf-856f74c7ba85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A03ECB50>]}
2021-10-01 07:49:07.538159 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-01 07:49:07.539155 (MainThread): 
2021-10-01 07:49:07.540151 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 07:49:07.543754 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-01 07:49:07.552763 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-01 07:49:07.552763 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-01 07:49:07.552763 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 07:49:08.680051 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.13 seconds
2021-10-01 07:49:08.684037 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-01 07:49:08.988447 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-01 07:49:08.997951 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-01 07:49:08.997951 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-01 07:49:08.997951 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-01 07:49:09.919461 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.92 seconds
2021-10-01 07:49:09.920455 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-01 07:49:10.228196 (MainThread): Using snowflake connection "master".
2021-10-01 07:49:10.228196 (MainThread): On master: BEGIN
2021-10-01 07:49:10.228196 (MainThread): Opening a new connection, currently in state init
2021-10-01 07:49:11.354610 (MainThread): SQL status: SUCCESS 1 in 1.13 seconds
2021-10-01 07:49:11.354610 (MainThread): On master: COMMIT
2021-10-01 07:49:11.354610 (MainThread): Using snowflake connection "master".
2021-10-01 07:49:11.354610 (MainThread): On master: COMMIT
2021-10-01 07:49:11.594775 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-01 07:49:11.595772 (MainThread): On master: Close
2021-10-01 07:49:11.905380 (MainThread): 09:49:11 | Concurrency: 1 threads (target='dev')
2021-10-01 07:49:11.905380 (MainThread): 09:49:11 | 
2021-10-01 07:49:11.912700 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:49:11.912700 (Thread-1): 09:49:11 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-10-01 07:49:11.913665 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:49:11.913665 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:49:11.916663 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 07:49:11.919221 (Thread-1): finished collecting timing info
2021-10-01 07:49:11.936961 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 07:49:11.939053 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:49:11.939053 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-01 07:49:11.939053 (Thread-1): Opening a new connection, currently in state init
2021-10-01 07:49:12.823208 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-10-01 07:49:12.824204 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:49:12.824204 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-01 07:49:13.145601 (Thread-1): Snowflake query id: 019f4ff5-0601-304f-0000-0066470352d9
2021-10-01 07:49:13.145601 (Thread-1): Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

2021-10-01 07:49:13.145601 (Thread-1): finished collecting timing info
2021-10-01 07:49:13.145601 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: ROLLBACK
2021-10-01 07:49:13.425091 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-01 07:49:13.739455 (Thread-1): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-01 07:49:13.741448 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c67c856-7a97-46cb-81cf-856f74c7ba85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A76E8C10>]}
2021-10-01 07:49:13.741448 (Thread-1): 09:49:13 | 1 of 2 ERROR creating table model dbt.my_first_dbt_model............. [ERROR in 1.83s]
2021-10-01 07:49:13.742444 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:49:13.743491 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 07:49:13.743491 (Thread-1): 09:49:13 | 2 of 2 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-10-01 07:49:13.744585 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 07:49:13.744585 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 07:49:13.744585 (MainThread): Using snowflake connection "master".
2021-10-01 07:49:13.745669 (MainThread): On master: BEGIN
2021-10-01 07:49:13.745669 (MainThread): Opening a new connection, currently in state closed
2021-10-01 07:49:14.666913 (MainThread): SQL status: SUCCESS 1 in 0.92 seconds
2021-10-01 07:49:14.666913 (MainThread): On master: COMMIT
2021-10-01 07:49:14.666913 (MainThread): Using snowflake connection "master".
2021-10-01 07:49:14.666913 (MainThread): On master: COMMIT
2021-10-01 07:49:14.917172 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-01 07:49:14.917172 (MainThread): On master: Close
2021-10-01 07:49:15.243627 (MainThread): 09:49:15 | 
2021-10-01 07:49:15.244593 (MainThread): 09:49:15 | Finished running 1 table model, 1 view model in 7.70s.
2021-10-01 07:49:15.246546 (MainThread): Connection 'master' was properly closed.
2021-10-01 07:49:15.246546 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-01 07:49:15.246546 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-01 07:49:15.246546 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_first_dbt_model' was properly closed.
2021-10-01 07:49:15.258761 (MainThread): 
2021-10-01 07:49:15.259725 (MainThread): Completed with 1 error and 0 warnings:
2021-10-01 07:49:15.259725 (MainThread): 
2021-10-01 07:49:15.262485 (MainThread): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-01 07:49:15.263396 (MainThread):   000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
2021-10-01 07:49:15.263396 (MainThread):   
2021-10-01 07:49:15.264105 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-01 07:49:15.264105 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-10-01 07:49:15.264863 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A75879D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A7587040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A7587760>]}
2021-10-01 07:49:15.264863 (MainThread): Flushing usage events
2021-10-01 07:53:39.904599 (MainThread): Running with dbt=0.20.2
2021-10-01 07:53:40.394910 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-01 07:53:40.395915 (MainThread): Tracking: tracking
2021-10-01 07:53:40.395915 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051D7BCDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051ECEAD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051ECEA400>]}
2021-10-01 07:53:40.401885 (MainThread): Partial parsing not enabled
2021-10-01 07:53:40.411851 (MainThread): Parsing macros\adapters.sql
2021-10-01 07:53:40.430067 (MainThread): Parsing macros\catalog.sql
2021-10-01 07:53:40.431059 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-01 07:53:40.436043 (MainThread): Parsing macros\materializations\merge.sql
2021-10-01 07:53:40.437044 (MainThread): Parsing macros\materializations\table.sql
2021-10-01 07:53:40.440024 (MainThread): Parsing macros\materializations\view.sql
2021-10-01 07:53:40.440024 (MainThread): Parsing macros\core.sql
2021-10-01 07:53:40.443300 (MainThread): Parsing macros\adapters\common.sql
2021-10-01 07:53:40.469782 (MainThread): Parsing macros\etc\datetime.sql
2021-10-01 07:53:40.475008 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-01 07:53:40.476005 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-01 07:53:40.477001 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-01 07:53:40.477998 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-01 07:53:40.477998 (MainThread): Parsing macros\etc\query.sql
2021-10-01 07:53:40.478995 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-01 07:53:40.483978 (MainThread): Parsing macros\materializations\test.sql
2021-10-01 07:53:40.487964 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-01 07:53:40.495977 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-01 07:53:40.496974 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-01 07:53:40.501957 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-01 07:53:40.514205 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-01 07:53:40.531230 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-01 07:53:40.532227 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-01 07:53:40.546976 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-01 07:53:40.551033 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-01 07:53:40.553228 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-01 07:53:40.557231 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-01 07:53:40.558219 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-01 07:53:40.559140 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-01 07:53:40.560205 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-01 07:53:40.665532 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:53:40.671513 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'bd1e8d59-6f91-4bd7-9f55-09a434beeacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051EDE56A0>]}
2021-10-01 07:53:40.671513 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 07:53:40.687766 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:53:40.688763 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:53:40.689833 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:53:40.690855 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:53:40.706529 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd1e8d59-6f91-4bd7-9f55-09a434beeacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051EE3A760>]}
2021-10-01 07:53:40.752204 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-01 07:53:40.752204 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd1e8d59-6f91-4bd7-9f55-09a434beeacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020517E2CB50>]}
2021-10-01 07:53:40.753272 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-01 07:53:40.754199 (MainThread): 
2021-10-01 07:53:40.755196 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 07:53:40.758149 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-01 07:53:40.766124 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-01 07:53:40.766124 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-01 07:53:40.766124 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 07:53:42.080803 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.31 seconds
2021-10-01 07:53:42.085892 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-01 07:53:42.535419 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-01 07:53:42.544694 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-01 07:53:42.544694 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-01 07:53:42.544694 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-01 07:53:43.559169 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.01 seconds
2021-10-01 07:53:43.560166 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-01 07:53:43.865899 (MainThread): Using snowflake connection "master".
2021-10-01 07:53:43.866970 (MainThread): On master: BEGIN
2021-10-01 07:53:43.866970 (MainThread): Opening a new connection, currently in state init
2021-10-01 07:53:44.715549 (MainThread): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-01 07:53:44.716612 (MainThread): On master: COMMIT
2021-10-01 07:53:44.716612 (MainThread): Using snowflake connection "master".
2021-10-01 07:53:44.716612 (MainThread): On master: COMMIT
2021-10-01 07:53:44.953614 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-01 07:53:44.954608 (MainThread): On master: Close
2021-10-01 07:53:45.251519 (MainThread): 09:53:45 | Concurrency: 1 threads (target='dev')
2021-10-01 07:53:45.251519 (MainThread): 09:53:45 | 
2021-10-01 07:53:45.258546 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:53:45.259547 (Thread-1): 09:53:45 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-10-01 07:53:45.260545 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:53:45.260545 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:53:45.263610 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 07:53:45.271573 (Thread-1): finished collecting timing info
2021-10-01 07:53:45.288500 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 07:53:45.290223 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:53:45.290223 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-01 07:53:45.290223 (Thread-1): Opening a new connection, currently in state init
2021-10-01 07:53:46.137771 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-01 07:53:46.137771 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:53:46.137771 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-01 07:53:46.368285 (Thread-1): Snowflake query id: 019f4ff9-0601-30a3-0000-006647036339
2021-10-01 07:53:46.368285 (Thread-1): Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

2021-10-01 07:53:46.368285 (Thread-1): finished collecting timing info
2021-10-01 07:53:46.369282 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: ROLLBACK
2021-10-01 07:53:46.599605 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-01 07:53:46.910479 (Thread-1): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-01 07:53:46.912474 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd1e8d59-6f91-4bd7-9f55-09a434beeacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051EFD7A60>]}
2021-10-01 07:53:46.912474 (Thread-1): 09:53:46 | 1 of 2 ERROR creating table model dbt.my_first_dbt_model............. [ERROR in 1.65s]
2021-10-01 07:53:46.914228 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:53:46.914228 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 07:53:46.915220 (Thread-1): 09:53:46 | 2 of 2 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-10-01 07:53:46.915891 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 07:53:46.916890 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 07:53:46.916890 (MainThread): Using snowflake connection "master".
2021-10-01 07:53:46.916890 (MainThread): On master: BEGIN
2021-10-01 07:53:46.916890 (MainThread): Opening a new connection, currently in state closed
2021-10-01 07:53:47.785237 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-01 07:53:47.786276 (MainThread): On master: COMMIT
2021-10-01 07:53:47.786276 (MainThread): Using snowflake connection "master".
2021-10-01 07:53:47.786276 (MainThread): On master: COMMIT
2021-10-01 07:53:48.041529 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-01 07:53:48.042519 (MainThread): On master: Close
2021-10-01 07:53:48.333230 (MainThread): 09:53:48 | 
2021-10-01 07:53:48.334153 (MainThread): 09:53:48 | Finished running 1 table model, 1 view model in 7.58s.
2021-10-01 07:53:48.336143 (MainThread): Connection 'master' was properly closed.
2021-10-01 07:53:48.336143 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-01 07:53:48.336143 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-01 07:53:48.336143 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_first_dbt_model' was properly closed.
2021-10-01 07:53:48.351146 (MainThread): 
2021-10-01 07:53:48.351146 (MainThread): Completed with 1 error and 0 warnings:
2021-10-01 07:53:48.352090 (MainThread): 
2021-10-01 07:53:48.352090 (MainThread): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-01 07:53:48.353086 (MainThread):   000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
2021-10-01 07:53:48.353086 (MainThread):   
2021-10-01 07:53:48.354084 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-01 07:53:48.354084 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-10-01 07:53:48.355086 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051F0AB3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051F0AB460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051EF80A90>]}
2021-10-01 07:53:48.355086 (MainThread): Flushing usage events
2021-10-01 07:54:05.779338 (MainThread): Running with dbt=0.20.2
2021-10-01 07:54:06.281817 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-01 07:54:06.282814 (MainThread): Tracking: tracking
2021-10-01 07:54:06.282814 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B776BCE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B78BEB340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B78BEB4F0>]}
2021-10-01 07:54:06.289041 (MainThread): Partial parsing not enabled
2021-10-01 07:54:06.299008 (MainThread): Parsing macros\adapters.sql
2021-10-01 07:54:06.319370 (MainThread): Parsing macros\catalog.sql
2021-10-01 07:54:06.320371 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-01 07:54:06.325343 (MainThread): Parsing macros\materializations\merge.sql
2021-10-01 07:54:06.326349 (MainThread): Parsing macros\materializations\table.sql
2021-10-01 07:54:06.328333 (MainThread): Parsing macros\materializations\view.sql
2021-10-01 07:54:06.329333 (MainThread): Parsing macros\core.sql
2021-10-01 07:54:06.331295 (MainThread): Parsing macros\adapters\common.sql
2021-10-01 07:54:06.358443 (MainThread): Parsing macros\etc\datetime.sql
2021-10-01 07:54:06.363426 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-01 07:54:06.364423 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-01 07:54:06.365532 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-01 07:54:06.366557 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-01 07:54:06.367554 (MainThread): Parsing macros\etc\query.sql
2021-10-01 07:54:06.367554 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-01 07:54:06.373534 (MainThread): Parsing macros\materializations\test.sql
2021-10-01 07:54:06.378517 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-01 07:54:06.387887 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-01 07:54:06.388885 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-01 07:54:06.393867 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-01 07:54:06.406965 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-01 07:54:06.425069 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-01 07:54:06.426067 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-01 07:54:06.437096 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-01 07:54:06.441086 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-01 07:54:06.444073 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-01 07:54:06.448286 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-01 07:54:06.449283 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-01 07:54:06.450279 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-01 07:54:06.451276 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-01 07:54:06.555342 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:54:06.562393 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 07:54:06.577439 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:54:06.578429 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:54:06.579419 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:54:06.581420 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:54:06.596295 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '142ccfcb-4f4f-401f-a633-1c19474fc318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B78D3C940>]}
2021-10-01 07:54:06.639436 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-01 07:54:06.639436 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '142ccfcb-4f4f-401f-a633-1c19474fc318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B71D1CB50>]}
2021-10-01 07:54:06.640467 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-01 07:54:06.641430 (MainThread): 
2021-10-01 07:54:06.644418 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 07:54:06.645535 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-01 07:54:06.653965 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-01 07:54:06.653965 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-01 07:54:06.653965 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 07:54:07.714856 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.06 seconds
2021-10-01 07:54:07.720843 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-01 07:54:08.020481 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-01 07:54:08.024468 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-01 07:54:08.025464 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-01 07:54:08.025464 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-01 07:54:08.871665 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.85 seconds
2021-10-01 07:54:08.871665 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-01 07:54:09.173719 (MainThread): Using snowflake connection "master".
2021-10-01 07:54:09.173719 (MainThread): On master: BEGIN
2021-10-01 07:54:09.173719 (MainThread): Opening a new connection, currently in state init
2021-10-01 07:54:10.065888 (MainThread): SQL status: SUCCESS 1 in 0.89 seconds
2021-10-01 07:54:10.065888 (MainThread): On master: COMMIT
2021-10-01 07:54:10.065888 (MainThread): Using snowflake connection "master".
2021-10-01 07:54:10.065888 (MainThread): On master: COMMIT
2021-10-01 07:54:10.313625 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-01 07:54:10.313625 (MainThread): On master: Close
2021-10-01 07:54:10.617809 (MainThread): 09:54:10 | Concurrency: 1 threads (target='dev')
2021-10-01 07:54:10.618264 (MainThread): 09:54:10 | 
2021-10-01 07:54:10.629068 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:54:10.629068 (Thread-1): 09:54:10 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-10-01 07:54:10.629902 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:54:10.629902 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:54:10.632979 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 07:54:10.634941 (Thread-1): finished collecting timing info
2021-10-01 07:54:10.653459 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 07:54:10.655201 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:54:10.655201 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-01 07:54:10.655201 (Thread-1): Opening a new connection, currently in state init
2021-10-01 07:54:11.529985 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-01 07:54:11.529985 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:54:11.529985 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-01 07:54:11.766434 (Thread-1): Snowflake query id: 019f4ffa-0601-30a3-0000-00664703634d
2021-10-01 07:54:11.766434 (Thread-1): Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

2021-10-01 07:54:11.766434 (Thread-1): finished collecting timing info
2021-10-01 07:54:11.767431 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: ROLLBACK
2021-10-01 07:54:11.988772 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-01 07:54:12.288942 (Thread-1): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-01 07:54:12.290447 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '142ccfcb-4f4f-401f-a633-1c19474fc318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B78FD7C10>]}
2021-10-01 07:54:12.291442 (Thread-1): 09:54:12 | 1 of 2 ERROR creating table model dbt.my_first_dbt_model............. [ERROR in 1.66s]
2021-10-01 07:54:12.291442 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:54:12.292471 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 07:54:12.292471 (Thread-1): 09:54:12 | 2 of 2 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-10-01 07:54:12.293535 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 07:54:12.294524 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 07:54:12.294524 (MainThread): Using snowflake connection "master".
2021-10-01 07:54:12.294524 (MainThread): On master: BEGIN
2021-10-01 07:54:12.294524 (MainThread): Opening a new connection, currently in state closed
2021-10-01 07:54:13.190587 (MainThread): SQL status: SUCCESS 1 in 0.90 seconds
2021-10-01 07:54:13.191582 (MainThread): On master: COMMIT
2021-10-01 07:54:13.191582 (MainThread): Using snowflake connection "master".
2021-10-01 07:54:13.191582 (MainThread): On master: COMMIT
2021-10-01 07:54:13.453537 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-01 07:54:13.453537 (MainThread): On master: Close
2021-10-01 07:54:13.762475 (MainThread): 09:54:13 | 
2021-10-01 07:54:13.762475 (MainThread): 09:54:13 | Finished running 1 table model, 1 view model in 7.12s.
2021-10-01 07:54:13.763407 (MainThread): Connection 'master' was properly closed.
2021-10-01 07:54:13.763407 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-01 07:54:13.763407 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-01 07:54:13.763407 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_first_dbt_model' was properly closed.
2021-10-01 07:54:13.780470 (MainThread): 
2021-10-01 07:54:13.780470 (MainThread): Completed with 1 error and 0 warnings:
2021-10-01 07:54:13.781479 (MainThread): 
2021-10-01 07:54:13.781479 (MainThread): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-01 07:54:13.782504 (MainThread):   000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
2021-10-01 07:54:13.782504 (MainThread):   
2021-10-01 07:54:13.782504 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-01 07:54:13.782504 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-10-01 07:54:13.782504 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B79017220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B79017E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B79017490>]}
2021-10-01 07:54:13.783482 (MainThread): Flushing usage events
2021-10-01 07:54:53.832807 (MainThread): Running with dbt=0.20.2
2021-10-01 07:54:54.305487 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-01 07:54:54.305487 (MainThread): Tracking: tracking
2021-10-01 07:54:54.305487 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A51CDE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A670BA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A670BC40>]}
2021-10-01 07:54:54.311568 (MainThread): Partial parsing not enabled
2021-10-01 07:54:54.321535 (MainThread): Parsing macros\adapters.sql
2021-10-01 07:54:54.338538 (MainThread): Parsing macros\catalog.sql
2021-10-01 07:54:54.339536 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-01 07:54:54.344778 (MainThread): Parsing macros\materializations\merge.sql
2021-10-01 07:54:54.345777 (MainThread): Parsing macros\materializations\table.sql
2021-10-01 07:54:54.347765 (MainThread): Parsing macros\materializations\view.sql
2021-10-01 07:54:54.348762 (MainThread): Parsing macros\core.sql
2021-10-01 07:54:54.350750 (MainThread): Parsing macros\adapters\common.sql
2021-10-01 07:54:54.377591 (MainThread): Parsing macros\etc\datetime.sql
2021-10-01 07:54:54.382653 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-01 07:54:54.383643 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-01 07:54:54.384636 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-01 07:54:54.385632 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-01 07:54:54.386629 (MainThread): Parsing macros\etc\query.sql
2021-10-01 07:54:54.386629 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-01 07:54:54.392615 (MainThread): Parsing macros\materializations\test.sql
2021-10-01 07:54:54.396528 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-01 07:54:54.404501 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-01 07:54:54.405498 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-01 07:54:54.409484 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-01 07:54:54.421505 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-01 07:54:54.439499 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-01 07:54:54.440496 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-01 07:54:54.450462 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-01 07:54:54.455076 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-01 07:54:54.458066 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-01 07:54:54.461056 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-01 07:54:54.463049 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-01 07:54:54.463049 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-01 07:54:54.464046 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-01 07:54:54.567547 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:54:54.573525 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 07:54:54.589532 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:54:54.590529 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:54:54.591526 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:54:54.592595 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:54:54.609583 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcc0be27-41c5-46d4-be40-85229bf00b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A685A550>]}
2021-10-01 07:54:54.653821 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-01 07:54:54.653821 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcc0be27-41c5-46d4-be40-85229bf00b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309F81CB50>]}
2021-10-01 07:54:54.653821 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-01 07:54:54.654828 (MainThread): 
2021-10-01 07:54:54.655889 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 07:54:54.656889 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-01 07:54:54.664938 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-01 07:54:54.664938 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-01 07:54:54.664938 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 07:54:55.819803 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.15 seconds
2021-10-01 07:54:55.825837 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-01 07:54:56.117023 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-01 07:54:56.124177 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-01 07:54:56.124177 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-01 07:54:56.124177 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-01 07:54:57.159956 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.04 seconds
2021-10-01 07:54:57.159956 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-01 07:54:57.586504 (MainThread): Using snowflake connection "master".
2021-10-01 07:54:57.586504 (MainThread): On master: BEGIN
2021-10-01 07:54:57.586504 (MainThread): Opening a new connection, currently in state init
2021-10-01 07:54:58.459842 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-01 07:54:58.460837 (MainThread): On master: COMMIT
2021-10-01 07:54:58.460837 (MainThread): Using snowflake connection "master".
2021-10-01 07:54:58.460837 (MainThread): On master: COMMIT
2021-10-01 07:54:58.729419 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-01 07:54:58.729419 (MainThread): On master: Close
2021-10-01 07:54:59.034042 (MainThread): 09:54:59 | Concurrency: 1 threads (target='dev')
2021-10-01 07:54:59.034750 (MainThread): 09:54:59 | 
2021-10-01 07:54:59.038248 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:54:59.038248 (Thread-1): 09:54:59 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-10-01 07:54:59.039117 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:54:59.039117 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:54:59.043109 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 07:54:59.045228 (Thread-1): finished collecting timing info
2021-10-01 07:54:59.064566 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 07:54:59.065937 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:54:59.065937 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-01 07:54:59.065937 (Thread-1): Opening a new connection, currently in state init
2021-10-01 07:54:59.974147 (Thread-1): SQL status: SUCCESS 1 in 0.91 seconds
2021-10-01 07:54:59.974147 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:54:59.975143 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-01 07:55:00.239802 (Thread-1): Snowflake query id: 019f4ffb-0601-304f-0000-006647035341
2021-10-01 07:55:00.239802 (Thread-1): Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

2021-10-01 07:55:00.239802 (Thread-1): finished collecting timing info
2021-10-01 07:55:00.239802 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: ROLLBACK
2021-10-01 07:55:00.480522 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-01 07:55:00.773817 (Thread-1): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-01 07:55:00.774840 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc0be27-41c5-46d4-be40-85229bf00b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A6AF9040>]}
2021-10-01 07:55:00.774840 (Thread-1): 09:55:00 | 1 of 2 ERROR creating table model dbt.my_first_dbt_model............. [ERROR in 1.74s]
2021-10-01 07:55:00.776132 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:55:00.777169 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 07:55:00.777169 (Thread-1): 09:55:00 | 2 of 2 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-10-01 07:55:00.778177 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 07:55:00.779173 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 07:55:00.779173 (MainThread): Using snowflake connection "master".
2021-10-01 07:55:00.779173 (MainThread): On master: BEGIN
2021-10-01 07:55:00.779173 (MainThread): Opening a new connection, currently in state closed
2021-10-01 07:55:01.605490 (MainThread): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-01 07:55:01.605490 (MainThread): On master: COMMIT
2021-10-01 07:55:01.605490 (MainThread): Using snowflake connection "master".
2021-10-01 07:55:01.605490 (MainThread): On master: COMMIT
2021-10-01 07:55:01.846169 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-01 07:55:01.846169 (MainThread): On master: Close
2021-10-01 07:55:02.137539 (MainThread): 09:55:02 | 
2021-10-01 07:55:02.137539 (MainThread): 09:55:02 | Finished running 1 table model, 1 view model in 7.48s.
2021-10-01 07:55:02.137539 (MainThread): Connection 'master' was properly closed.
2021-10-01 07:55:02.138535 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-01 07:55:02.138535 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-01 07:55:02.138535 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_first_dbt_model' was properly closed.
2021-10-01 07:55:02.149504 (MainThread): 
2021-10-01 07:55:02.149504 (MainThread): Completed with 1 error and 0 warnings:
2021-10-01 07:55:02.150874 (MainThread): 
2021-10-01 07:55:02.150874 (MainThread): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-01 07:55:02.150874 (MainThread):   000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
2021-10-01 07:55:02.151892 (MainThread):   
2021-10-01 07:55:02.151892 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-01 07:55:02.151892 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-10-01 07:55:02.155867 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A6B37100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A6B37B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A6B37340>]}
2021-10-01 07:55:02.155867 (MainThread): Flushing usage events
2021-10-01 07:57:06.998025 (MainThread): Running with dbt=0.20.2
2021-10-01 07:57:07.485734 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-01 07:57:07.485734 (MainThread): Tracking: tracking
2021-10-01 07:57:07.485734 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194C332BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194C485A190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194C485A880>]}
2021-10-01 07:57:07.491714 (MainThread): Partial parsing not enabled
2021-10-01 07:57:07.502788 (MainThread): Parsing macros\adapters.sql
2021-10-01 07:57:07.521723 (MainThread): Parsing macros\catalog.sql
2021-10-01 07:57:07.522720 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-01 07:57:07.527703 (MainThread): Parsing macros\materializations\merge.sql
2021-10-01 07:57:07.528813 (MainThread): Parsing macros\materializations\table.sql
2021-10-01 07:57:07.531051 (MainThread): Parsing macros\materializations\view.sql
2021-10-01 07:57:07.532048 (MainThread): Parsing macros\core.sql
2021-10-01 07:57:07.534041 (MainThread): Parsing macros\adapters\common.sql
2021-10-01 07:57:07.566138 (MainThread): Parsing macros\etc\datetime.sql
2021-10-01 07:57:07.571122 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-01 07:57:07.572119 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-01 07:57:07.573115 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-01 07:57:07.574112 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-01 07:57:07.575109 (MainThread): Parsing macros\etc\query.sql
2021-10-01 07:57:07.575109 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-01 07:57:07.581451 (MainThread): Parsing macros\materializations\test.sql
2021-10-01 07:57:07.586444 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-01 07:57:07.595404 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-01 07:57:07.597322 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-01 07:57:07.601383 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-01 07:57:07.614371 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-01 07:57:07.631343 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-01 07:57:07.632340 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-01 07:57:07.642849 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-01 07:57:07.646835 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-01 07:57:07.649825 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-01 07:57:07.653811 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-01 07:57:07.654900 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-01 07:57:07.655898 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-01 07:57:07.656895 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-01 07:57:07.758069 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:57:07.765046 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 07:57:07.781622 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:57:07.783683 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:57:07.784692 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:57:07.785679 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 07:57:07.798565 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef21f109-5e24-4d85-b1ff-94f72dcb3303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194C49AB970>]}
2021-10-01 07:57:07.841997 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-01 07:57:07.841997 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef21f109-5e24-4d85-b1ff-94f72dcb3303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194C47C8130>]}
2021-10-01 07:57:07.841997 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-01 07:57:07.842994 (MainThread): 
2021-10-01 07:57:07.842994 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 07:57:07.844987 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-01 07:57:07.852959 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-01 07:57:07.852959 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-01 07:57:07.852959 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 07:57:08.997560 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.14 seconds
2021-10-01 07:57:09.003622 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-01 07:57:09.316706 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-01 07:57:09.326677 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-01 07:57:09.326677 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-01 07:57:09.326677 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-01 07:57:10.160440 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.83 seconds
2021-10-01 07:57:10.161430 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-01 07:57:10.458779 (MainThread): Using snowflake connection "master".
2021-10-01 07:57:10.458779 (MainThread): On master: BEGIN
2021-10-01 07:57:10.458779 (MainThread): Opening a new connection, currently in state init
2021-10-01 07:57:11.307753 (MainThread): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-01 07:57:11.308747 (MainThread): On master: COMMIT
2021-10-01 07:57:11.308747 (MainThread): Using snowflake connection "master".
2021-10-01 07:57:11.308747 (MainThread): On master: COMMIT
2021-10-01 07:57:11.549803 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-01 07:57:11.550799 (MainThread): On master: Close
2021-10-01 07:57:11.841899 (MainThread): 09:57:11 | Concurrency: 1 threads (target='dev')
2021-10-01 07:57:11.841899 (MainThread): 09:57:11 | 
2021-10-01 07:57:11.845149 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:57:11.845149 (Thread-1): 09:57:11 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-10-01 07:57:11.846218 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:57:11.847159 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:57:11.848139 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 07:57:11.850304 (Thread-1): finished collecting timing info
2021-10-01 07:57:11.865843 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 07:57:11.867904 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:57:11.867904 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-01 07:57:11.867904 (Thread-1): Opening a new connection, currently in state init
2021-10-01 07:57:12.924992 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-10-01 07:57:12.925987 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:57:12.925987 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-01 07:57:17.424878 (Thread-1): SQL status: SUCCESS 1 in 4.50 seconds
2021-10-01 07:57:17.426868 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-01 07:57:17.427864 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 07:57:17.427864 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-01 07:57:17.602663 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-01 07:57:17.609636 (Thread-1): finished collecting timing info
2021-10-01 07:57:17.609636 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-01 07:57:17.910594 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef21f109-5e24-4d85-b1ff-94f72dcb3303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194C4B5CDF0>]}
2021-10-01 07:57:17.910594 (Thread-1): 09:57:17 | 1 of 2 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 6.06s]
2021-10-01 07:57:17.911590 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 07:57:17.912586 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 07:57:17.912586 (Thread-1): 09:57:17 | 2 of 2 START view model dbt.my_second_dbt_model...................... [RUN]
2021-10-01 07:57:17.912586 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 07:57:17.912586 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 07:57:17.913585 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-01 07:57:17.914581 (Thread-1): finished collecting timing info
2021-10-01 07:57:17.925544 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-01 07:57:17.926539 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 07:57:17.926539 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-01 07:57:17.926539 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 07:57:18.795786 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-01 07:57:18.795786 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 07:57:18.795786 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-10-01 07:57:19.161531 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-10-01 07:57:19.163523 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-01 07:57:19.164522 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 07:57:19.164522 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-01 07:57:19.326801 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-01 07:57:19.327394 (Thread-1): finished collecting timing info
2021-10-01 07:57:19.328553 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-01 07:57:19.659316 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef21f109-5e24-4d85-b1ff-94f72dcb3303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194C4C6BAC0>]}
2021-10-01 07:57:19.660314 (Thread-1): 09:57:19 | 2 of 2 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 1.75s]
2021-10-01 07:57:19.661894 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 07:57:19.663363 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 07:57:19.663363 (MainThread): Using snowflake connection "master".
2021-10-01 07:57:19.664430 (MainThread): On master: BEGIN
2021-10-01 07:57:19.664430 (MainThread): Opening a new connection, currently in state closed
2021-10-01 07:57:20.685067 (MainThread): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-01 07:57:20.685067 (MainThread): On master: COMMIT
2021-10-01 07:57:20.685067 (MainThread): Using snowflake connection "master".
2021-10-01 07:57:20.685067 (MainThread): On master: COMMIT
2021-10-01 07:57:20.920841 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-01 07:57:20.920841 (MainThread): On master: Close
2021-10-01 07:57:21.208830 (MainThread): 09:57:21 | 
2021-10-01 07:57:21.209456 (MainThread): 09:57:21 | Finished running 1 table model, 1 view model in 13.37s.
2021-10-01 07:57:21.209456 (MainThread): Connection 'master' was properly closed.
2021-10-01 07:57:21.209456 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-01 07:57:21.209456 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-01 07:57:21.209456 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-01 07:57:21.222115 (MainThread): 
2021-10-01 07:57:21.222115 (MainThread): Completed successfully
2021-10-01 07:57:21.223129 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-10-01 07:57:21.223129 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194C47C8E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194C4C117C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194C4B79EB0>]}
2021-10-01 07:57:21.223129 (MainThread): Flushing usage events
2021-10-01 08:27:24.063933 (MainThread): Running with dbt=0.20.2
2021-10-01 08:27:24.804203 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-01 08:27:24.806017 (MainThread): Tracking: tracking
2021-10-01 08:27:24.807211 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B260D1CEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B26224BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B26224B4C0>]}
2021-10-01 08:27:24.813176 (MainThread): Partial parsing not enabled
2021-10-01 08:27:24.816619 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B26224BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2622615E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2622617C0>]}
2021-10-01 08:27:24.816619 (MainThread): Flushing usage events
2021-10-01 08:27:25.432448 (MainThread): Encountered an error:
2021-10-01 08:27:25.433445 (MainThread): Compilation Error
  Error reading lukeclarke_learn_dbt: example\schema.yml - Runtime Error
    Syntax error near line 23
    ------------------------------
    20 |                 - not_null
    21 | 
    22 |     - name: snowflake_customer_purchases
    23 |       description: ""This is the total purchases for each customer in the sample snowflake database""
    24 |       columns:
    25 |         - name: c_custkey
    26 |           description: "This is the primary key for this table"
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 22, column 7
    did not find expected key
      in "<unicode string>", line 23, column 22
2021-10-01 08:27:25.480640 (MainThread): Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\yaml\__init__.py", line 114, in load
    return loader.get_single_data()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml\_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml\_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 22, column 7
did not find expected key
  in "<unicode string>", line 23, column 22

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 106, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 23
  ------------------------------
  20 |                 - not_null
  21 | 
  22 |     - name: snowflake_customer_purchases
  23 |       description: ""This is the total purchases for each customer in the sample snowflake database""
  24 |       columns:
  25 |         - name: c_custkey
  26 |           description: "This is the primary key for this table"
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 22, column 7
  did not find expected key
    in "<unicode string>", line 23, column 22

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 207, in load
    read_files(project, self.manifest.files, project_parser_files)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 137, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 92, in read_files_for_parser
    source_files = get_source_files(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 83, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 23, in load_source_file
    dfy = yaml_from_file(source_file)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 109, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading lukeclarke_learn_dbt: example\schema.yml - Runtime Error
    Syntax error near line 23
    ------------------------------
    20 |                 - not_null
    21 | 
    22 |     - name: snowflake_customer_purchases
    23 |       description: ""This is the total purchases for each customer in the sample snowflake database""
    24 |       columns:
    25 |         - name: c_custkey
    26 |           description: "This is the primary key for this table"
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 22, column 7
    did not find expected key
      in "<unicode string>", line 23, column 22

2021-10-01 08:28:29.658728 (MainThread): Running with dbt=0.20.2
2021-10-01 08:28:30.151399 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-01 08:28:30.152398 (MainThread): Tracking: tracking
2021-10-01 08:28:30.152398 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE373ADDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE388F6820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE388F6640>]}
2021-10-01 08:28:30.158581 (MainThread): Partial parsing not enabled
2021-10-01 08:28:30.186750 (MainThread): Parsing macros\adapters.sql
2021-10-01 08:28:30.206216 (MainThread): Parsing macros\catalog.sql
2021-10-01 08:28:30.207213 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-01 08:28:30.212196 (MainThread): Parsing macros\materializations\merge.sql
2021-10-01 08:28:30.213193 (MainThread): Parsing macros\materializations\table.sql
2021-10-01 08:28:30.215186 (MainThread): Parsing macros\materializations\view.sql
2021-10-01 08:28:30.216183 (MainThread): Parsing macros\core.sql
2021-10-01 08:28:30.218176 (MainThread): Parsing macros\adapters\common.sql
2021-10-01 08:28:30.244341 (MainThread): Parsing macros\etc\datetime.sql
2021-10-01 08:28:30.249324 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-01 08:28:30.250371 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-01 08:28:30.251406 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-01 08:28:30.252402 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-01 08:28:30.252402 (MainThread): Parsing macros\etc\query.sql
2021-10-01 08:28:30.253399 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-01 08:28:30.259379 (MainThread): Parsing macros\materializations\test.sql
2021-10-01 08:28:30.262441 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-01 08:28:30.271407 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-01 08:28:30.272404 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-01 08:28:30.276359 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-01 08:28:30.289318 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-01 08:28:30.307291 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-01 08:28:30.308292 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-01 08:28:30.319179 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-01 08:28:30.323166 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-01 08:28:30.325159 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-01 08:28:30.329146 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-01 08:28:30.330143 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-01 08:28:30.331140 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-01 08:28:30.332136 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-01 08:28:30.428111 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 08:28:30.434091 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 08:28:30.436085 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 08:28:30.452264 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 08:28:30.453261 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 08:28:30.454257 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 08:28:30.455254 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 08:28:30.456881 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 08:28:30.459876 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 08:28:30.519049 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '724e0f35-c4b9-4730-a746-9c6734400a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE38A41100>]}
2021-10-01 08:28:30.563185 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-01 08:28:30.563185 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '724e0f35-c4b9-4730-a746-9c6734400a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE38955BE0>]}
2021-10-01 08:28:30.564180 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-01 08:28:30.565178 (MainThread): 
2021-10-01 08:28:30.566175 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 08:28:30.568925 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-01 08:28:30.578506 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-01 08:28:30.578506 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-01 08:28:30.579615 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 08:28:31.891843 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.31 seconds
2021-10-01 08:28:31.895830 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-01 08:28:32.200374 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-01 08:28:32.207540 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-01 08:28:32.207540 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-01 08:28:32.207540 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-01 08:28:33.075737 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.87 seconds
2021-10-01 08:28:33.076819 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-01 08:28:33.372534 (MainThread): Using snowflake connection "master".
2021-10-01 08:28:33.372534 (MainThread): On master: BEGIN
2021-10-01 08:28:33.372534 (MainThread): Opening a new connection, currently in state init
2021-10-01 08:28:34.205130 (MainThread): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-01 08:28:34.205130 (MainThread): On master: COMMIT
2021-10-01 08:28:34.206153 (MainThread): Using snowflake connection "master".
2021-10-01 08:28:34.206153 (MainThread): On master: COMMIT
2021-10-01 08:28:34.445545 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-01 08:28:34.446541 (MainThread): On master: Close
2021-10-01 08:28:34.751203 (MainThread): 10:28:34 | Concurrency: 1 threads (target='dev')
2021-10-01 08:28:34.752201 (MainThread): 10:28:34 | 
2021-10-01 08:28:34.758181 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 08:28:34.758181 (Thread-1): 10:28:34 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-10-01 08:28:34.759180 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 08:28:34.759180 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 08:28:34.761336 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 08:28:34.773310 (Thread-1): finished collecting timing info
2021-10-01 08:28:34.793003 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 08:28:34.809542 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 08:28:34.809542 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-01 08:28:34.809542 (Thread-1): Opening a new connection, currently in state init
2021-10-01 08:28:35.658500 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-01 08:28:35.659595 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 08:28:35.659595 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-01 08:28:44.150681 (Thread-1): SQL status: SUCCESS 1 in 8.49 seconds
2021-10-01 08:28:44.151677 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-01 08:28:44.151677 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 08:28:44.152668 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-01 08:28:44.346138 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-01 08:28:44.353113 (Thread-1): finished collecting timing info
2021-10-01 08:28:44.353113 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-01 08:28:44.656708 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '724e0f35-c4b9-4730-a746-9c6734400a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE38BD0C40>]}
2021-10-01 08:28:44.657712 (Thread-1): 10:28:44 | 1 of 2 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 9.90s]
2021-10-01 08:28:44.660903 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 08:28:44.661099 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 08:28:44.661099 (Thread-1): 10:28:44 | 2 of 2 START view model dbt.my_second_dbt_model...................... [RUN]
2021-10-01 08:28:44.661099 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 08:28:44.661099 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 08:28:44.663174 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-01 08:28:44.668319 (Thread-1): finished collecting timing info
2021-10-01 08:28:44.678620 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-01 08:28:44.683741 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 08:28:44.683741 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-01 08:28:44.683741 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 08:28:45.786008 (Thread-1): SQL status: SUCCESS 1 in 1.10 seconds
2021-10-01 08:28:45.786008 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 08:28:45.786008 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-10-01 08:28:46.199556 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-10-01 08:28:46.201547 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-01 08:28:46.202615 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 08:28:46.202615 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-01 08:28:46.394571 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-01 08:28:46.395565 (Thread-1): finished collecting timing info
2021-10-01 08:28:46.395565 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-01 08:28:46.699195 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '724e0f35-c4b9-4730-a746-9c6734400a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE38CC0A90>]}
2021-10-01 08:28:46.699195 (Thread-1): 10:28:46 | 2 of 2 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 2.04s]
2021-10-01 08:28:46.701724 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 08:28:46.703206 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 08:28:46.703206 (MainThread): Using snowflake connection "master".
2021-10-01 08:28:46.703206 (MainThread): On master: BEGIN
2021-10-01 08:28:46.704272 (MainThread): Opening a new connection, currently in state closed
2021-10-01 08:28:47.545871 (MainThread): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-01 08:28:47.546899 (MainThread): On master: COMMIT
2021-10-01 08:28:47.546899 (MainThread): Using snowflake connection "master".
2021-10-01 08:28:47.546899 (MainThread): On master: COMMIT
2021-10-01 08:28:47.798363 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-01 08:28:47.799428 (MainThread): On master: Close
2021-10-01 08:28:48.106254 (MainThread): 10:28:48 | 
2021-10-01 08:28:48.106254 (MainThread): 10:28:48 | Finished running 1 table model, 1 view model in 17.54s.
2021-10-01 08:28:48.107252 (MainThread): Connection 'master' was properly closed.
2021-10-01 08:28:48.107252 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-01 08:28:48.107252 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-01 08:28:48.108204 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-01 08:28:48.121709 (MainThread): 
2021-10-01 08:28:48.121709 (MainThread): Completed successfully
2021-10-01 08:28:48.122595 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-10-01 08:28:48.124854 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE38B7BA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE38CCE880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE38CCECA0>]}
2021-10-01 08:28:48.124854 (MainThread): Flushing usage events
2021-10-01 08:29:33.052263 (MainThread): Running with dbt=0.20.2
2021-10-01 08:29:33.569198 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-01 08:29:33.569198 (MainThread): Tracking: tracking
2021-10-01 08:29:33.569198 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFECABBCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFEDFEACA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFEDFEA670>]}
2021-10-01 08:29:33.575177 (MainThread): Partial parsing not enabled
2021-10-01 08:29:33.585145 (MainThread): Parsing macros\adapters.sql
2021-10-01 08:29:33.602087 (MainThread): Parsing macros\catalog.sql
2021-10-01 08:29:33.603084 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-01 08:29:33.608067 (MainThread): Parsing macros\materializations\merge.sql
2021-10-01 08:29:33.610060 (MainThread): Parsing macros\materializations\table.sql
2021-10-01 08:29:33.612054 (MainThread): Parsing macros\materializations\view.sql
2021-10-01 08:29:33.613050 (MainThread): Parsing macros\core.sql
2021-10-01 08:29:33.615044 (MainThread): Parsing macros\adapters\common.sql
2021-10-01 08:29:33.642166 (MainThread): Parsing macros\etc\datetime.sql
2021-10-01 08:29:33.647149 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-01 08:29:33.647149 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-01 08:29:33.648146 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-01 08:29:33.649143 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-01 08:29:33.650139 (MainThread): Parsing macros\etc\query.sql
2021-10-01 08:29:33.651136 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-01 08:29:33.656119 (MainThread): Parsing macros\materializations\test.sql
2021-10-01 08:29:33.660106 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-01 08:29:33.668080 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-01 08:29:33.669077 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-01 08:29:33.673354 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-01 08:29:33.685314 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-01 08:29:33.704397 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-01 08:29:33.705412 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-01 08:29:33.715368 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-01 08:29:33.719337 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-01 08:29:33.722355 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-01 08:29:33.729330 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-01 08:29:33.731315 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-01 08:29:33.732314 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-01 08:29:33.734389 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-01 08:29:33.837804 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 08:29:33.843782 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 08:29:33.845699 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 08:29:33.861647 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 08:29:33.862644 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 08:29:33.863641 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 08:29:33.864638 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 08:29:33.866631 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 08:29:33.868624 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 08:29:33.913138 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59a0a5f5-d1d3-4979-a99a-5420334e1112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFEE0FEE80>]}
2021-10-01 08:29:33.951302 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-01 08:29:33.951302 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59a0a5f5-d1d3-4979-a99a-5420334e1112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFEE0FEA00>]}
2021-10-01 08:29:33.952298 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-01 08:29:33.953295 (MainThread): 
2021-10-01 08:29:33.954409 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 08:29:33.955301 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-01 08:29:33.966885 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-01 08:29:33.966885 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-01 08:29:33.966885 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 08:29:35.130850 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.16 seconds
2021-10-01 08:29:35.132840 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-01 08:29:35.505748 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-01 08:29:35.509757 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-01 08:29:35.509757 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-01 08:29:35.509757 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-01 08:29:36.627111 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.12 seconds
2021-10-01 08:29:36.629100 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-01 08:29:36.945512 (MainThread): Using snowflake connection "master".
2021-10-01 08:29:36.945512 (MainThread): On master: BEGIN
2021-10-01 08:29:36.945512 (MainThread): Opening a new connection, currently in state init
2021-10-01 08:29:37.879115 (MainThread): SQL status: SUCCESS 1 in 0.93 seconds
2021-10-01 08:29:37.879115 (MainThread): On master: COMMIT
2021-10-01 08:29:37.879115 (MainThread): Using snowflake connection "master".
2021-10-01 08:29:37.879115 (MainThread): On master: COMMIT
2021-10-01 08:29:38.122607 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-01 08:29:38.123601 (MainThread): On master: Close
2021-10-01 08:29:38.420115 (MainThread): 10:29:38 | Concurrency: 1 threads (target='dev')
2021-10-01 08:29:38.420115 (MainThread): 10:29:38 | 
2021-10-01 08:29:38.429068 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 08:29:38.430140 (Thread-1): 10:29:38 | 1 of 3 START table model dbt.my_first_dbt_model...................... [RUN]
2021-10-01 08:29:38.431066 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 08:29:38.431066 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 08:29:38.434125 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 08:29:38.436123 (Thread-1): finished collecting timing info
2021-10-01 08:29:38.453080 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 08:29:38.455662 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 08:29:38.456122 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-01 08:29:38.456122 (Thread-1): Opening a new connection, currently in state init
2021-10-01 08:29:39.374863 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2021-10-01 08:29:39.374863 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 08:29:39.374863 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-01 08:29:40.739563 (Thread-1): SQL status: SUCCESS 1 in 1.36 seconds
2021-10-01 08:29:40.741595 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-01 08:29:40.741595 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 08:29:40.741595 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-01 08:29:40.921013 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-01 08:29:40.930984 (Thread-1): finished collecting timing info
2021-10-01 08:29:40.930984 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-01 08:29:41.269232 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59a0a5f5-d1d3-4979-a99a-5420334e1112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFEE0704C0>]}
2021-10-01 08:29:41.269232 (Thread-1): 10:29:41 | 1 of 3 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.84s]
2021-10-01 08:29:41.271226 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 08:29:41.271226 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-01 08:29:41.271226 (Thread-1): 10:29:41 | 2 of 3 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-01 08:29:41.272075 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 08:29:41.272075 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-01 08:29:41.274085 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-01 08:29:41.285048 (Thread-1): finished collecting timing info
2021-10-01 08:29:41.287125 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-01 08:29:41.288038 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 08:29:41.288038 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-01 08:29:41.288038 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 08:29:42.304530 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-01 08:29:42.304530 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 08:29:42.304530 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey

;
2021-10-01 08:29:42.521340 (Thread-1): Snowflake query id: 019f501d-0601-304f-0000-006647035945
2021-10-01 08:29:42.521340 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 0 unexpected ';'.
2021-10-01 08:29:42.521340 (Thread-1): finished collecting timing info
2021-10-01 08:29:42.521340 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: ROLLBACK
2021-10-01 08:29:42.769818 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-01 08:29:43.074532 (Thread-1): Database Error in model snowflake_customer_purchases (models\example\snowflake_customer_purchases.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 0 unexpected ';'.
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\snowflake_customer_purchases.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 17 at position 0 unexpected ';'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_customer_purchases (models\example\snowflake_customer_purchases.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 0 unexpected ';'.
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\snowflake_customer_purchases.sql
2021-10-01 08:29:43.077854 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59a0a5f5-d1d3-4979-a99a-5420334e1112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFEE40E4F0>]}
2021-10-01 08:29:43.077854 (Thread-1): 10:29:43 | 2 of 3 ERROR creating table model dbt.snowflake_customer_purchases... [ERROR in 1.81s]
2021-10-01 08:29:43.080014 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-01 08:29:43.080014 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 08:29:43.080014 (Thread-1): 10:29:43 | 3 of 3 START view model dbt.my_second_dbt_model...................... [RUN]
2021-10-01 08:29:43.081014 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 08:29:43.081014 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 08:29:43.083007 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-01 08:29:43.084343 (Thread-1): finished collecting timing info
2021-10-01 08:29:43.094317 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-01 08:29:43.096386 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 08:29:43.096386 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-01 08:29:43.096386 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 08:29:43.955552 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-10-01 08:29:43.955552 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 08:29:43.956546 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-10-01 08:29:44.368274 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-10-01 08:29:44.369341 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-01 08:29:44.369341 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 08:29:44.369341 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-01 08:29:44.539005 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-01 08:29:44.541041 (Thread-1): finished collecting timing info
2021-10-01 08:29:44.541041 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-01 08:29:44.843761 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59a0a5f5-d1d3-4979-a99a-5420334e1112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFEE3D55B0>]}
2021-10-01 08:29:44.844757 (Thread-1): 10:29:44 | 3 of 3 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 1.76s]
2021-10-01 08:29:44.846678 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 08:29:44.847782 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 08:29:44.847782 (MainThread): Using snowflake connection "master".
2021-10-01 08:29:44.847782 (MainThread): On master: BEGIN
2021-10-01 08:29:44.847782 (MainThread): Opening a new connection, currently in state closed
2021-10-01 08:29:45.683749 (MainThread): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-01 08:29:45.683749 (MainThread): On master: COMMIT
2021-10-01 08:29:45.683749 (MainThread): Using snowflake connection "master".
2021-10-01 08:29:45.683749 (MainThread): On master: COMMIT
2021-10-01 08:29:45.933911 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-01 08:29:45.934948 (MainThread): On master: Close
2021-10-01 08:29:46.237819 (MainThread): 10:29:46 | 
2021-10-01 08:29:46.237819 (MainThread): 10:29:46 | Finished running 2 table models, 1 view model in 12.28s.
2021-10-01 08:29:46.241043 (MainThread): Connection 'master' was properly closed.
2021-10-01 08:29:46.242088 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-01 08:29:46.242088 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-01 08:29:46.242088 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-01 08:29:46.259017 (MainThread): 
2021-10-01 08:29:46.259017 (MainThread): Completed with 1 error and 0 warnings:
2021-10-01 08:29:46.260249 (MainThread): 
2021-10-01 08:29:46.262245 (MainThread): Database Error in model snowflake_customer_purchases (models\example\snowflake_customer_purchases.sql)
2021-10-01 08:29:46.263206 (MainThread):   001003 (42000): SQL compilation error:
2021-10-01 08:29:46.263206 (MainThread):   syntax error line 17 at position 0 unexpected ';'.
2021-10-01 08:29:46.263206 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\snowflake_customer_purchases.sql
2021-10-01 08:29:46.264273 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-10-01 08:29:46.264273 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFEE3D23D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFEE3D2EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFEE3D2B20>]}
2021-10-01 08:29:46.264273 (MainThread): Flushing usage events
2021-10-01 08:30:06.990678 (MainThread): Running with dbt=0.20.2
2021-10-01 08:30:07.492707 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-01 08:30:07.492707 (MainThread): Tracking: tracking
2021-10-01 08:30:07.492707 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024026B1DE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024028066160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024028066340>]}
2021-10-01 08:30:07.498687 (MainThread): Partial parsing not enabled
2021-10-01 08:30:07.508655 (MainThread): Parsing macros\adapters.sql
2021-10-01 08:30:07.525813 (MainThread): Parsing macros\catalog.sql
2021-10-01 08:30:07.526810 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-01 08:30:07.531793 (MainThread): Parsing macros\materializations\merge.sql
2021-10-01 08:30:07.532790 (MainThread): Parsing macros\materializations\table.sql
2021-10-01 08:30:07.535780 (MainThread): Parsing macros\materializations\view.sql
2021-10-01 08:30:07.535780 (MainThread): Parsing macros\core.sql
2021-10-01 08:30:07.538770 (MainThread): Parsing macros\adapters\common.sql
2021-10-01 08:30:07.564684 (MainThread): Parsing macros\etc\datetime.sql
2021-10-01 08:30:07.570571 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-01 08:30:07.570571 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-01 08:30:07.571568 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-01 08:30:07.572564 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-01 08:30:07.573561 (MainThread): Parsing macros\etc\query.sql
2021-10-01 08:30:07.574558 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-01 08:30:07.580538 (MainThread): Parsing macros\materializations\test.sql
2021-10-01 08:30:07.585529 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-01 08:30:07.593562 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-01 08:30:07.594565 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-01 08:30:07.599518 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-01 08:30:07.618413 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-01 08:30:07.635430 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-01 08:30:07.636433 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-01 08:30:07.646386 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-01 08:30:07.650589 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-01 08:30:07.653579 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-01 08:30:07.656569 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-01 08:30:07.657566 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-01 08:30:07.658563 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-01 08:30:07.659559 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-01 08:30:07.755449 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 08:30:07.761429 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 08:30:07.763423 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 08:30:07.779367 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 08:30:07.780364 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 08:30:07.782358 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 08:30:07.783354 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 08:30:07.784540 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 08:30:07.787486 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 08:30:07.830790 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ac7f6f7-0ed0-4372-967f-aeaddf4143e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240281B3BB0>]}
2021-10-01 08:30:07.855063 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-01 08:30:07.855063 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ac7f6f7-0ed0-4372-967f-aeaddf4143e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240280AF520>]}
2021-10-01 08:30:07.855063 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-01 08:30:07.856281 (MainThread): 
2021-10-01 08:30:07.857281 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 08:30:07.860272 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-01 08:30:07.870795 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-01 08:30:07.871282 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-01 08:30:07.871282 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 08:30:08.938171 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.07 seconds
2021-10-01 08:30:08.943151 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-01 08:30:09.236525 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-01 08:30:09.243505 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-01 08:30:09.243505 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-01 08:30:09.243505 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-01 08:30:10.122053 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.88 seconds
2021-10-01 08:30:10.123054 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-01 08:30:10.420411 (MainThread): Using snowflake connection "master".
2021-10-01 08:30:10.420411 (MainThread): On master: BEGIN
2021-10-01 08:30:10.421452 (MainThread): Opening a new connection, currently in state init
2021-10-01 08:30:11.470698 (MainThread): SQL status: SUCCESS 1 in 1.05 seconds
2021-10-01 08:30:11.470698 (MainThread): On master: COMMIT
2021-10-01 08:30:11.471778 (MainThread): Using snowflake connection "master".
2021-10-01 08:30:11.471778 (MainThread): On master: COMMIT
2021-10-01 08:30:11.717925 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-01 08:30:11.717925 (MainThread): On master: Close
2021-10-01 08:30:12.031621 (MainThread): 10:30:12 | Concurrency: 1 threads (target='dev')
2021-10-01 08:30:12.032617 (MainThread): 10:30:12 | 
2021-10-01 08:30:12.037507 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 08:30:12.037507 (Thread-1): 10:30:12 | 1 of 3 START table model dbt.my_first_dbt_model...................... [RUN]
2021-10-01 08:30:12.037507 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 08:30:12.037507 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 08:30:12.039510 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 08:30:12.040993 (Thread-1): finished collecting timing info
2021-10-01 08:30:12.058732 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 08:30:12.060732 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 08:30:12.060732 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-01 08:30:12.061211 (Thread-1): Opening a new connection, currently in state init
2021-10-01 08:30:12.931937 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-01 08:30:12.932432 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 08:30:12.932432 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-01 08:30:13.862084 (Thread-1): SQL status: SUCCESS 1 in 0.93 seconds
2021-10-01 08:30:13.864159 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-01 08:30:13.864159 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 08:30:13.864159 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-01 08:30:14.033968 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-01 08:30:14.044930 (Thread-1): finished collecting timing info
2021-10-01 08:30:14.045922 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-01 08:30:14.341750 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac7f6f7-0ed0-4372-967f-aeaddf4143e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024028442580>]}
2021-10-01 08:30:14.342393 (Thread-1): 10:30:14 | 1 of 3 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.30s]
2021-10-01 08:30:14.343393 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 08:30:14.343393 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-01 08:30:14.344392 (Thread-1): 10:30:14 | 2 of 3 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-01 08:30:14.344392 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 08:30:14.344392 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-01 08:30:14.346459 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-01 08:30:14.350371 (Thread-1): finished collecting timing info
2021-10-01 08:30:14.351366 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-01 08:30:14.356350 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 08:30:14.356350 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-01 08:30:14.356350 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 08:30:15.245482 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-10-01 08:30:15.246480 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 08:30:15.246480 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-01 08:30:17.001851 (Thread-1): SQL status: SUCCESS 1 in 1.76 seconds
2021-10-01 08:30:17.003806 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-01 08:30:17.004834 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 08:30:17.004834 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-01 08:30:17.173283 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-01 08:30:17.174280 (Thread-1): finished collecting timing info
2021-10-01 08:30:17.174280 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-01 08:30:17.482028 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac7f6f7-0ed0-4372-967f-aeaddf4143e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002402846D4C0>]}
2021-10-01 08:30:17.482028 (Thread-1): 10:30:17 | 2 of 3 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.14s]
2021-10-01 08:30:17.484544 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-01 08:30:17.484544 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 08:30:17.484544 (Thread-1): 10:30:17 | 3 of 3 START view model dbt.my_second_dbt_model...................... [RUN]
2021-10-01 08:30:17.485550 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 08:30:17.486544 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 08:30:17.488610 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-01 08:30:17.490417 (Thread-1): finished collecting timing info
2021-10-01 08:30:17.501389 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-01 08:30:17.502796 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 08:30:17.502796 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-01 08:30:17.502796 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 08:30:18.362873 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-10-01 08:30:18.363867 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 08:30:18.363867 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-10-01 08:30:18.737669 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-10-01 08:30:18.739661 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-01 08:30:18.739661 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 08:30:18.739661 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-01 08:30:18.897900 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-01 08:30:18.899878 (Thread-1): finished collecting timing info
2021-10-01 08:30:18.899878 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-01 08:30:19.199871 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac7f6f7-0ed0-4372-967f-aeaddf4143e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002402844B4C0>]}
2021-10-01 08:30:19.200854 (Thread-1): 10:30:19 | 3 of 3 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 1.71s]
2021-10-01 08:30:19.201781 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 08:30:19.202777 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 08:30:19.202777 (MainThread): Using snowflake connection "master".
2021-10-01 08:30:19.202777 (MainThread): On master: BEGIN
2021-10-01 08:30:19.202777 (MainThread): Opening a new connection, currently in state closed
2021-10-01 08:30:20.230720 (MainThread): SQL status: SUCCESS 1 in 1.03 seconds
2021-10-01 08:30:20.231722 (MainThread): On master: COMMIT
2021-10-01 08:30:20.231722 (MainThread): Using snowflake connection "master".
2021-10-01 08:30:20.231722 (MainThread): On master: COMMIT
2021-10-01 08:30:20.556958 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-01 08:30:20.557954 (MainThread): On master: Close
2021-10-01 08:30:20.856838 (MainThread): 10:30:20 | 
2021-10-01 08:30:20.857837 (MainThread): 10:30:20 | Finished running 2 table models, 1 view model in 13.00s.
2021-10-01 08:30:20.858843 (MainThread): Connection 'master' was properly closed.
2021-10-01 08:30:20.858843 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-01 08:30:20.858843 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-01 08:30:20.858843 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-01 08:30:20.872712 (MainThread): 
2021-10-01 08:30:20.873707 (MainThread): Completed successfully
2021-10-01 08:30:20.874740 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-10-01 08:30:20.877113 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024028442580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002402805C3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024028342400>]}
2021-10-01 08:30:20.877113 (MainThread): Flushing usage events
2021-10-01 09:04:55.420171 (MainThread): Running with dbt=0.20.2
2021-10-01 09:04:55.916355 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-01 09:04:55.917352 (MainThread): Tracking: tracking
2021-10-01 09:04:55.917352 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF832DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF9876C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF9876760>]}
2021-10-01 09:04:55.923332 (MainThread): Partial parsing not enabled
2021-10-01 09:04:55.934884 (MainThread): Parsing macros\adapters.sql
2021-10-01 09:04:55.956621 (MainThread): Parsing macros\catalog.sql
2021-10-01 09:04:55.957617 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-01 09:04:55.965747 (MainThread): Parsing macros\materializations\merge.sql
2021-10-01 09:04:55.966742 (MainThread): Parsing macros\materializations\table.sql
2021-10-01 09:04:55.968736 (MainThread): Parsing macros\materializations\view.sql
2021-10-01 09:04:55.970350 (MainThread): Parsing macros\core.sql
2021-10-01 09:04:55.973216 (MainThread): Parsing macros\adapters\common.sql
2021-10-01 09:04:56.000204 (MainThread): Parsing macros\etc\datetime.sql
2021-10-01 09:04:56.005180 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-01 09:04:56.005180 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-01 09:04:56.006179 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-01 09:04:56.007177 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-01 09:04:56.008169 (MainThread): Parsing macros\etc\query.sql
2021-10-01 09:04:56.008169 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-01 09:04:56.014298 (MainThread): Parsing macros\materializations\test.sql
2021-10-01 09:04:56.018358 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-01 09:04:56.025336 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-01 09:04:56.026332 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-01 09:04:56.031317 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-01 09:04:56.043277 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-01 09:04:56.061218 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-01 09:04:56.061218 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-01 09:04:56.071179 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-01 09:04:56.075163 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-01 09:04:56.078165 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-01 09:04:56.081149 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-01 09:04:56.083139 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-01 09:04:56.083139 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-01 09:04:56.084133 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-01 09:04:56.189976 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-01 09:04:56.195957 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 09:04:56.197950 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 09:04:56.199943 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 09:04:56.217891 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 09:04:56.218949 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 09:04:56.219952 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 09:04:56.220944 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 09:04:56.221875 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 09:04:56.224939 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 09:04:56.227923 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 09:04:56.229151 (MainThread): [WARNING]: Test 'test.lukeclarke_learn_dbt.not_snowflake_culmulative_order_price_cul_daily_amount.82d1de0791' (models\example\schema.yml) depends on a node named 'snowflake_culmulative_order_price' which was not found
2021-10-01 09:04:56.274532 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ed26a24-aebe-4856-8468-52df6ac70789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF99D1850>]}
2021-10-01 09:04:56.293176 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-01 09:04:56.293176 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ed26a24-aebe-4856-8468-52df6ac70789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF99D1D30>]}
2021-10-01 09:04:56.293176 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-01 09:04:56.295453 (MainThread): 
2021-10-01 09:04:56.295453 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 09:04:56.297446 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-01 09:04:56.308325 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-01 09:04:56.308716 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-01 09:04:56.308716 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 09:04:57.551666 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.24 seconds
2021-10-01 09:04:57.557654 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-01 09:04:57.870030 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-01 09:04:57.877011 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-01 09:04:57.878007 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-01 09:04:57.878007 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-01 09:04:58.967209 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.09 seconds
2021-10-01 09:04:58.968204 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-01 09:04:59.334289 (MainThread): Using snowflake connection "master".
2021-10-01 09:04:59.335288 (MainThread): On master: BEGIN
2021-10-01 09:04:59.335288 (MainThread): Opening a new connection, currently in state init
2021-10-01 09:05:00.219888 (MainThread): SQL status: SUCCESS 1 in 0.88 seconds
2021-10-01 09:05:00.219888 (MainThread): On master: COMMIT
2021-10-01 09:05:00.219888 (MainThread): Using snowflake connection "master".
2021-10-01 09:05:00.220885 (MainThread): On master: COMMIT
2021-10-01 09:05:00.482780 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-01 09:05:00.483778 (MainThread): On master: Close
2021-10-01 09:05:00.791550 (MainThread): 11:05:00 | Concurrency: 1 threads (target='dev')
2021-10-01 09:05:00.791550 (MainThread): 11:05:00 | 
2021-10-01 09:05:00.794050 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 09:05:00.794050 (Thread-1): 11:05:00 | 1 of 4 START table model dbt.my_first_dbt_model...................... [RUN]
2021-10-01 09:05:00.794512 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 09:05:00.794512 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 09:05:00.795511 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 09:05:00.797297 (Thread-1): finished collecting timing info
2021-10-01 09:05:00.815512 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 09:05:00.818568 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 09:05:00.818568 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-01 09:05:00.818568 (Thread-1): Opening a new connection, currently in state init
2021-10-01 09:05:01.720464 (Thread-1): SQL status: SUCCESS 1 in 0.90 seconds
2021-10-01 09:05:01.720464 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 09:05:01.721464 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-01 09:05:03.160014 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-10-01 09:05:03.162014 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-01 09:05:03.162014 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 09:05:03.162014 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-01 09:05:03.337063 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-01 09:05:03.349021 (Thread-1): finished collecting timing info
2021-10-01 09:05:03.349021 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-01 09:05:03.656492 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ed26a24-aebe-4856-8468-52df6ac70789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF9C2D9D0>]}
2021-10-01 09:05:03.656492 (Thread-1): 11:05:03 | 1 of 4 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.86s]
2021-10-01 09:05:03.658978 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 09:05:03.658978 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-01 09:05:03.659979 (Thread-1): 11:05:03 | 2 of 4 START table model dbt.cul_order_price......................... [RUN]
2021-10-01 09:05:03.660976 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-01 09:05:03.660976 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-01 09:05:03.664034 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-01 09:05:03.665048 (Thread-1): finished collecting timing info
2021-10-01 09:05:03.665959 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-01 09:05:03.666956 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-01 09:05:03.666956 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-01 09:05:03.666956 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:05:04.524286 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-10-01 09:05:04.524286 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-01 09:05:04.524286 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (

SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-01 09:05:07.051414 (Thread-1): SQL status: SUCCESS 1 in 2.53 seconds
2021-10-01 09:05:07.053403 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-01 09:05:07.053403 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-01 09:05:07.053403 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-01 09:05:07.238387 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-01 09:05:07.240370 (Thread-1): finished collecting timing info
2021-10-01 09:05:07.240370 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-01 09:05:07.555426 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ed26a24-aebe-4856-8468-52df6ac70789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF9B615B0>]}
2021-10-01 09:05:07.556419 (Thread-1): 11:05:07 | 2 of 4 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.90s]
2021-10-01 09:05:07.557346 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-01 09:05:07.558343 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-01 09:05:07.558343 (Thread-1): 11:05:07 | 3 of 4 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-01 09:05:07.559409 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 09:05:07.559409 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-01 09:05:07.562403 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-01 09:05:07.568223 (Thread-1): finished collecting timing info
2021-10-01 09:05:07.570343 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-01 09:05:07.576817 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 09:05:07.576817 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-01 09:05:07.576817 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:05:08.627163 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-10-01 09:05:08.628129 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 09:05:08.628129 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-01 09:05:10.360063 (Thread-1): SQL status: SUCCESS 1 in 1.73 seconds
2021-10-01 09:05:10.362055 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-01 09:05:10.363051 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 09:05:10.363051 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-01 09:05:10.534391 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-01 09:05:10.535387 (Thread-1): finished collecting timing info
2021-10-01 09:05:10.535387 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-01 09:05:10.836215 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ed26a24-aebe-4856-8468-52df6ac70789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF995E310>]}
2021-10-01 09:05:10.836215 (Thread-1): 11:05:10 | 3 of 4 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.28s]
2021-10-01 09:05:10.837484 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-01 09:05:10.837484 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 09:05:10.837484 (Thread-1): 11:05:10 | 4 of 4 START view model dbt.my_second_dbt_model...................... [RUN]
2021-10-01 09:05:10.837484 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 09:05:10.837484 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 09:05:10.839478 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-01 09:05:10.841467 (Thread-1): finished collecting timing info
2021-10-01 09:05:10.851433 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-01 09:05:10.852660 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 09:05:10.852660 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-01 09:05:10.852660 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:05:11.917549 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-10-01 09:05:11.917549 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 09:05:11.918544 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-10-01 09:05:12.357130 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-10-01 09:05:12.359123 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-01 09:05:12.359123 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 09:05:12.359123 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-01 09:05:12.547107 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-01 09:05:12.548040 (Thread-1): finished collecting timing info
2021-10-01 09:05:12.548040 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-01 09:05:12.892765 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ed26a24-aebe-4856-8468-52df6ac70789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF995E310>]}
2021-10-01 09:05:12.892765 (Thread-1): 11:05:12 | 4 of 4 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 2.05s]
2021-10-01 09:05:12.893254 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 09:05:12.894260 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 09:05:12.894260 (MainThread): Using snowflake connection "master".
2021-10-01 09:05:12.894260 (MainThread): On master: BEGIN
2021-10-01 09:05:12.895331 (MainThread): Opening a new connection, currently in state closed
2021-10-01 09:05:13.769068 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-01 09:05:13.770063 (MainThread): On master: COMMIT
2021-10-01 09:05:13.770063 (MainThread): Using snowflake connection "master".
2021-10-01 09:05:13.770063 (MainThread): On master: COMMIT
2021-10-01 09:05:14.033135 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-01 09:05:14.033135 (MainThread): On master: Close
2021-10-01 09:05:14.385225 (MainThread): 11:05:14 | 
2021-10-01 09:05:14.386227 (MainThread): 11:05:14 | Finished running 3 table models, 1 view model in 18.09s.
2021-10-01 09:05:14.391788 (MainThread): Connection 'master' was properly closed.
2021-10-01 09:05:14.391788 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-01 09:05:14.391788 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-01 09:05:14.391788 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-01 09:05:14.407743 (MainThread): 
2021-10-01 09:05:14.407743 (MainThread): Completed successfully
2021-10-01 09:05:14.409734 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-01 09:05:14.409734 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF98D50A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF9C54400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF9C543D0>]}
2021-10-01 09:05:14.409734 (MainThread): Flushing usage events
2021-10-01 09:06:18.707946 (MainThread): Running with dbt=0.20.2
2021-10-01 09:06:19.190167 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-01 09:06:19.190167 (MainThread): Tracking: tracking
2021-10-01 09:06:19.190167 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002960372DD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029604C4BC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029604C4BBE0>]}
2021-10-01 09:06:19.196147 (MainThread): Partial parsing not enabled
2021-10-01 09:06:19.207447 (MainThread): Parsing macros\adapters.sql
2021-10-01 09:06:19.225956 (MainThread): Parsing macros\catalog.sql
2021-10-01 09:06:19.226953 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-01 09:06:19.232218 (MainThread): Parsing macros\materializations\merge.sql
2021-10-01 09:06:19.234222 (MainThread): Parsing macros\materializations\table.sql
2021-10-01 09:06:19.236215 (MainThread): Parsing macros\materializations\view.sql
2021-10-01 09:06:19.236215 (MainThread): Parsing macros\core.sql
2021-10-01 09:06:19.239123 (MainThread): Parsing macros\adapters\common.sql
2021-10-01 09:06:19.265688 (MainThread): Parsing macros\etc\datetime.sql
2021-10-01 09:06:19.270669 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-01 09:06:19.270669 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-01 09:06:19.271660 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-01 09:06:19.272655 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-01 09:06:19.273652 (MainThread): Parsing macros\etc\query.sql
2021-10-01 09:06:19.274657 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-01 09:06:19.280136 (MainThread): Parsing macros\materializations\test.sql
2021-10-01 09:06:19.284123 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-01 09:06:19.292104 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-01 09:06:19.293094 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-01 09:06:19.297072 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-01 09:06:19.309033 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-01 09:06:19.326579 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-01 09:06:19.327618 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-01 09:06:19.337575 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-01 09:06:19.341568 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-01 09:06:19.344563 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-01 09:06:19.347542 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-01 09:06:19.348542 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-01 09:06:19.349535 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-01 09:06:19.350532 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-01 09:06:19.451549 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-01 09:06:19.457459 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 09:06:19.459452 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 09:06:19.461446 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 09:06:19.478488 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 09:06:19.479486 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 09:06:19.480482 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 09:06:19.481479 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 09:06:19.482475 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 09:06:19.485465 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 09:06:19.488455 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-01 09:06:19.532027 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f700197-d73c-4250-9aad-4f30a0835a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029604DDFAF0>]}
2021-10-01 09:06:19.559092 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-01 09:06:19.559092 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f700197-d73c-4250-9aad-4f30a0835a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029604DDF640>]}
2021-10-01 09:06:19.559092 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-01 09:06:19.561089 (MainThread): 
2021-10-01 09:06:19.562083 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 09:06:19.563674 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-01 09:06:19.571645 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-01 09:06:19.571645 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-01 09:06:19.571645 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-01 09:06:20.687720 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.12 seconds
2021-10-01 09:06:20.693697 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-01 09:06:20.989363 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-01 09:06:20.996343 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-01 09:06:20.996343 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-01 09:06:20.996343 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-01 09:06:21.848407 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.85 seconds
2021-10-01 09:06:21.850400 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-01 09:06:22.151559 (MainThread): Using snowflake connection "master".
2021-10-01 09:06:22.151559 (MainThread): On master: BEGIN
2021-10-01 09:06:22.151559 (MainThread): Opening a new connection, currently in state init
2021-10-01 09:06:23.185870 (MainThread): SQL status: SUCCESS 1 in 1.03 seconds
2021-10-01 09:06:23.185870 (MainThread): On master: COMMIT
2021-10-01 09:06:23.185870 (MainThread): Using snowflake connection "master".
2021-10-01 09:06:23.186865 (MainThread): On master: COMMIT
2021-10-01 09:06:23.435930 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-01 09:06:23.436892 (MainThread): On master: Close
2021-10-01 09:06:23.735159 (MainThread): 11:06:23 | Concurrency: 1 threads (target='dev')
2021-10-01 09:06:23.736089 (MainThread): 11:06:23 | 
2021-10-01 09:06:23.742946 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 09:06:23.742946 (Thread-1): 11:06:23 | 1 of 4 START table model dbt.my_first_dbt_model...................... [RUN]
2021-10-01 09:06:23.743943 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 09:06:23.743943 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 09:06:23.747998 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 09:06:23.749581 (Thread-1): finished collecting timing info
2021-10-01 09:06:23.767169 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-01 09:06:23.768927 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 09:06:23.768927 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-01 09:06:23.768927 (Thread-1): Opening a new connection, currently in state init
2021-10-01 09:06:24.926777 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2021-10-01 09:06:24.926777 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 09:06:24.926777 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-01 09:06:25.924882 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-01 09:06:25.924882 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-01 09:06:25.925879 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-01 09:06:25.925879 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-01 09:06:26.085300 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-01 09:06:26.096250 (Thread-1): finished collecting timing info
2021-10-01 09:06:26.096250 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-01 09:06:26.425788 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f700197-d73c-4250-9aad-4f30a0835a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002960500F9D0>]}
2021-10-01 09:06:26.425788 (Thread-1): 11:06:26 | 1 of 4 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.68s]
2021-10-01 09:06:26.426857 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-01 09:06:26.426857 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-01 09:06:26.427855 (Thread-1): 11:06:26 | 2 of 4 START table model dbt.cul_order_price......................... [RUN]
2021-10-01 09:06:26.427855 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-01 09:06:26.427855 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-01 09:06:26.429932 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-01 09:06:26.433905 (Thread-1): finished collecting timing info
2021-10-01 09:06:26.435826 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-01 09:06:26.477745 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-01 09:06:26.478745 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-01 09:06:26.478745 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:06:27.367139 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-10-01 09:06:27.367139 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-01 09:06:27.367139 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (

SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-01 09:06:28.771579 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-10-01 09:06:28.772568 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-01 09:06:28.773562 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-01 09:06:28.773562 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-01 09:06:28.952388 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-01 09:06:28.953340 (Thread-1): finished collecting timing info
2021-10-01 09:06:28.953340 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-01 09:06:29.263507 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f700197-d73c-4250-9aad-4f30a0835a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029604F4A1F0>]}
2021-10-01 09:06:29.264504 (Thread-1): 11:06:29 | 2 of 4 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.84s]
2021-10-01 09:06:29.265501 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-01 09:06:29.265501 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-01 09:06:29.266497 (Thread-1): 11:06:29 | 3 of 4 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-01 09:06:29.267494 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 09:06:29.267494 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-01 09:06:29.270483 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-01 09:06:29.272476 (Thread-1): finished collecting timing info
2021-10-01 09:06:29.274469 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-01 09:06:29.275466 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 09:06:29.276462 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-01 09:06:29.276462 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:06:30.127717 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-01 09:06:30.127717 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 09:06:30.127717 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-01 09:06:31.550130 (Thread-1): SQL status: SUCCESS 1 in 1.42 seconds
2021-10-01 09:06:31.551144 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-01 09:06:31.552122 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-01 09:06:31.552122 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-01 09:06:31.732725 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-01 09:06:31.734716 (Thread-1): finished collecting timing info
2021-10-01 09:06:31.734716 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-01 09:06:32.029453 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f700197-d73c-4250-9aad-4f30a0835a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029604CDE940>]}
2021-10-01 09:06:32.029453 (Thread-1): 11:06:32 | 3 of 4 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.76s]
2021-10-01 09:06:32.031243 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-01 09:06:32.031243 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 09:06:32.031243 (Thread-1): 11:06:32 | 4 of 4 START view model dbt.my_second_dbt_model...................... [RUN]
2021-10-01 09:06:32.031696 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 09:06:32.031696 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 09:06:32.032769 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-01 09:06:32.034339 (Thread-1): finished collecting timing info
2021-10-01 09:06:32.045312 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-01 09:06:32.047017 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 09:06:32.047017 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-01 09:06:32.047017 (Thread-1): Opening a new connection, currently in state closed
2021-10-01 09:06:33.085402 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-10-01 09:06:33.086400 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 09:06:33.086400 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-10-01 09:06:33.500902 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-10-01 09:06:33.502825 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-01 09:06:33.503893 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-01 09:06:33.503893 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-01 09:06:33.685054 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-01 09:06:33.686051 (Thread-1): finished collecting timing info
2021-10-01 09:06:33.687047 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-01 09:06:33.992617 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f700197-d73c-4250-9aad-4f30a0835a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029604CDEBB0>]}
2021-10-01 09:06:33.992617 (Thread-1): 11:06:33 | 4 of 4 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 1.96s]
2021-10-01 09:06:33.993611 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-01 09:06:33.995519 (MainThread): Acquiring new snowflake connection "master".
2021-10-01 09:06:33.996586 (MainThread): Using snowflake connection "master".
2021-10-01 09:06:33.996586 (MainThread): On master: BEGIN
2021-10-01 09:06:33.996586 (MainThread): Opening a new connection, currently in state closed
2021-10-01 09:06:34.859474 (MainThread): SQL status: SUCCESS 1 in 0.86 seconds
2021-10-01 09:06:34.860462 (MainThread): On master: COMMIT
2021-10-01 09:06:34.860462 (MainThread): Using snowflake connection "master".
2021-10-01 09:06:34.860462 (MainThread): On master: COMMIT
2021-10-01 09:06:35.104393 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-01 09:06:35.104393 (MainThread): On master: Close
2021-10-01 09:06:35.400757 (MainThread): 11:06:35 | 
2021-10-01 09:06:35.401715 (MainThread): 11:06:35 | Finished running 3 table models, 1 view model in 15.84s.
2021-10-01 09:06:35.404951 (MainThread): Connection 'master' was properly closed.
2021-10-01 09:06:35.404951 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-01 09:06:35.404951 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-01 09:06:35.404951 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-01 09:06:35.417640 (MainThread): 
2021-10-01 09:06:35.418636 (MainThread): Completed successfully
2021-10-01 09:06:35.418636 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-01 09:06:35.419633 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029604DDF070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029604CDE940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029605040460>]}
2021-10-01 09:06:35.419633 (MainThread): Flushing usage events
2021-10-06 08:36:53.796921 (MainThread): Running with dbt=0.20.2
2021-10-06 08:36:54.267855 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 08:36:54.279782 (MainThread): Tracking: tracking
2021-10-06 08:36:54.280738 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D72655BE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D727AB64F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D727AB6760>]}
2021-10-06 08:36:54.293128 (MainThread): Partial parsing not enabled
2021-10-06 08:36:54.455649 (MainThread): Parsing macros\adapters.sql
2021-10-06 08:36:54.474104 (MainThread): Parsing macros\catalog.sql
2021-10-06 08:36:54.475103 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 08:36:54.480267 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 08:36:54.481271 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 08:36:54.483252 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 08:36:54.484251 (MainThread): Parsing macros\core.sql
2021-10-06 08:36:54.486736 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 08:36:54.513999 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 08:36:54.519329 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 08:36:54.519329 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 08:36:54.520395 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 08:36:54.521391 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 08:36:54.523465 (MainThread): Parsing macros\etc\query.sql
2021-10-06 08:36:54.524467 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 08:36:54.530523 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 08:36:54.534502 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 08:36:54.542099 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 08:36:54.543096 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 08:36:54.548081 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 08:36:54.560871 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 08:36:54.579691 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 08:36:54.580690 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 08:36:54.590154 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 08:36:54.594509 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 08:36:54.597496 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 08:36:54.600489 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 08:36:54.602731 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 08:36:54.602822 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 08:36:54.603889 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 08:36:54.706952 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 08:36:54.713310 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 08:36:54.715303 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 08:36:54.717296 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 08:36:54.733929 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:36:54.734927 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:36:54.735923 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:36:54.736920 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:36:54.738913 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:36:54.741199 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:36:54.744191 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:36:54.786223 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f110ba8-a0fc-46a2-b933-657b612283e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D727C0F970>]}
2021-10-06 08:36:54.800336 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 08:36:54.801334 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f110ba8-a0fc-46a2-b933-657b612283e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D727C0F3A0>]}
2021-10-06 08:36:54.801334 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 08:36:54.802330 (MainThread): 
2021-10-06 08:36:54.803327 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 08:36:54.804323 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 08:36:54.813001 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 08:36:54.813001 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 08:36:54.813001 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 08:36:56.360011 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.55 seconds
2021-10-06 08:36:56.379707 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 08:36:56.678618 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 08:36:56.685759 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 08:36:56.685759 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 08:36:56.685759 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 08:36:57.735178 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 1.05 seconds
2021-10-06 08:36:57.737241 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 08:36:58.039357 (MainThread): Using snowflake connection "master".
2021-10-06 08:36:58.039357 (MainThread): On master: BEGIN
2021-10-06 08:36:58.039357 (MainThread): Opening a new connection, currently in state init
2021-10-06 08:36:58.833564 (MainThread): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-06 08:36:58.834551 (MainThread): On master: COMMIT
2021-10-06 08:36:58.834850 (MainThread): Using snowflake connection "master".
2021-10-06 08:36:58.835025 (MainThread): On master: COMMIT
2021-10-06 08:36:59.096684 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-06 08:36:59.097682 (MainThread): On master: Close
2021-10-06 08:36:59.386279 (MainThread): 10:36:59 | Concurrency: 1 threads (target='dev')
2021-10-06 08:36:59.387277 (MainThread): 10:36:59 | 
2021-10-06 08:36:59.394010 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 08:36:59.394010 (Thread-1): 10:36:59 | 1 of 4 START table model dbt.my_first_dbt_model...................... [RUN]
2021-10-06 08:36:59.394977 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 08:36:59.394977 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 08:36:59.397969 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 08:36:59.405078 (Thread-1): finished collecting timing info
2021-10-06 08:36:59.422894 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 08:36:59.430591 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 08:36:59.430591 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-06 08:36:59.430591 (Thread-1): Opening a new connection, currently in state init
2021-10-06 08:37:00.243498 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-06 08:37:00.243498 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 08:37:00.243498 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-06 08:37:01.850129 (Thread-1): SQL status: SUCCESS 1 in 1.61 seconds
2021-10-06 08:37:01.852122 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-06 08:37:01.853120 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 08:37:01.853120 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-06 08:37:02.015498 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 08:37:02.027873 (Thread-1): finished collecting timing info
2021-10-06 08:37:02.027873 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-06 08:37:02.365124 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f110ba8-a0fc-46a2-b933-657b612283e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D727EA9910>]}
2021-10-06 08:37:02.365124 (Thread-1): 10:37:02 | 1 of 4 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.97s]
2021-10-06 08:37:02.366309 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 08:37:02.366309 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 08:37:02.366309 (Thread-1): 10:37:02 | 2 of 4 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 08:37:02.366309 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 08:37:02.367419 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 08:37:02.368595 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 08:37:02.372208 (Thread-1): finished collecting timing info
2021-10-06 08:37:02.373213 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 08:37:02.388675 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 08:37:02.388675 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 08:37:02.388675 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 08:37:03.193290 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-06 08:37:03.194273 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 08:37:03.194273 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (

SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 08:37:05.258699 (Thread-1): SQL status: SUCCESS 1 in 2.06 seconds
2021-10-06 08:37:05.261374 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 08:37:05.261374 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 08:37:05.261374 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 08:37:05.426005 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 08:37:05.427001 (Thread-1): finished collecting timing info
2021-10-06 08:37:05.427001 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 08:37:05.740913 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f110ba8-a0fc-46a2-b933-657b612283e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D727EC91C0>]}
2021-10-06 08:37:05.741215 (Thread-1): 10:37:05 | 2 of 4 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.37s]
2021-10-06 08:37:05.741916 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 08:37:05.741916 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 08:37:05.741916 (Thread-1): 10:37:05 | 3 of 4 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 08:37:05.742921 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 08:37:05.742921 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 08:37:05.743985 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 08:37:05.748240 (Thread-1): finished collecting timing info
2021-10-06 08:37:05.750235 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 08:37:05.753531 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 08:37:05.753531 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 08:37:05.753531 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 08:37:06.712623 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-10-06 08:37:06.713612 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 08:37:06.713612 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 08:37:08.355227 (Thread-1): SQL status: SUCCESS 1 in 1.64 seconds
2021-10-06 08:37:08.357295 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 08:37:08.357295 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 08:37:08.357295 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 08:37:08.521630 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 08:37:08.523593 (Thread-1): finished collecting timing info
2021-10-06 08:37:08.523593 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 08:37:08.822609 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f110ba8-a0fc-46a2-b933-657b612283e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D727EA9790>]}
2021-10-06 08:37:08.822609 (Thread-1): 10:37:08 | 3 of 4 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.08s]
2021-10-06 08:37:08.823698 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 08:37:08.823698 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 08:37:08.823698 (Thread-1): 10:37:08 | 4 of 4 START view model dbt.my_second_dbt_model...................... [RUN]
2021-10-06 08:37:08.825320 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 08:37:08.825320 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 08:37:08.827323 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 08:37:08.830760 (Thread-1): finished collecting timing info
2021-10-06 08:37:08.843546 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 08:37:08.848857 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 08:37:08.848857 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 08:37:08.848857 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 08:37:09.618981 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-06 08:37:09.618981 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 08:37:09.618981 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-10-06 08:37:09.978836 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-06 08:37:09.979832 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 08:37:09.979832 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 08:37:09.979832 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 08:37:10.138351 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 08:37:10.139352 (Thread-1): finished collecting timing info
2021-10-06 08:37:10.139352 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 08:37:10.461083 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f110ba8-a0fc-46a2-b933-657b612283e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D727F07190>]}
2021-10-06 08:37:10.461083 (Thread-1): 10:37:10 | 4 of 4 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 1.64s]
2021-10-06 08:37:10.462119 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 08:37:10.463119 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 08:37:10.463119 (MainThread): Using snowflake connection "master".
2021-10-06 08:37:10.463119 (MainThread): On master: BEGIN
2021-10-06 08:37:10.463119 (MainThread): Opening a new connection, currently in state closed
2021-10-06 08:37:11.302996 (MainThread): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-06 08:37:11.302996 (MainThread): On master: COMMIT
2021-10-06 08:37:11.302996 (MainThread): Using snowflake connection "master".
2021-10-06 08:37:11.302996 (MainThread): On master: COMMIT
2021-10-06 08:37:11.633745 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-06 08:37:11.634741 (MainThread): On master: Close
2021-10-06 08:37:11.960640 (MainThread): 10:37:11 | 
2021-10-06 08:37:11.961296 (MainThread): 10:37:11 | Finished running 3 table models, 1 view model in 17.16s.
2021-10-06 08:37:11.961791 (MainThread): Connection 'master' was properly closed.
2021-10-06 08:37:11.961791 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 08:37:11.961791 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 08:37:11.961791 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 08:37:11.985664 (MainThread): 
2021-10-06 08:37:11.986660 (MainThread): Completed successfully
2021-10-06 08:37:11.986660 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-06 08:37:11.988357 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D727D83610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D727D839D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D727D83B50>]}
2021-10-06 08:37:11.988357 (MainThread): Flushing usage events
2021-10-06 08:37:46.782752 (MainThread): Running with dbt=0.20.2
2021-10-06 08:37:47.290808 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-10-06 08:37:47.291792 (MainThread): Tracking: tracking
2021-10-06 08:37:47.291792 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6EF1DDE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6F0724280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6F0724730>]}
2021-10-06 08:37:47.297173 (MainThread): Partial parsing not enabled
2021-10-06 08:37:47.308020 (MainThread): Parsing macros\adapters.sql
2021-10-06 08:37:47.325248 (MainThread): Parsing macros\catalog.sql
2021-10-06 08:37:47.326320 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 08:37:47.332225 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 08:37:47.333223 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 08:37:47.335936 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 08:37:47.335936 (MainThread): Parsing macros\core.sql
2021-10-06 08:37:47.338927 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 08:37:47.367869 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 08:37:47.372854 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 08:37:47.373855 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 08:37:47.374779 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 08:37:47.375776 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 08:37:47.376990 (MainThread): Parsing macros\etc\query.sql
2021-10-06 08:37:47.377101 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 08:37:47.383082 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 08:37:47.386072 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 08:37:47.394150 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 08:37:47.395147 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 08:37:47.399466 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 08:37:47.411933 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 08:37:47.428890 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 08:37:47.430125 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 08:37:47.439164 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 08:37:47.443592 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 08:37:47.445584 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 08:37:47.450634 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 08:37:47.452501 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 08:37:47.453014 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 08:37:47.454003 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 08:37:47.553799 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 08:37:47.560303 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 08:37:47.562308 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 08:37:47.564288 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 08:37:47.581383 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:37:47.582380 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:37:47.583381 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:37:47.584372 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:37:47.585368 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:37:47.589042 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:37:47.592103 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:37:47.637582 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6796dbf-e221-40cc-9341-567d74907a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6F089E670>]}
2021-10-06 08:37:47.650523 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 08:37:47.651451 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6796dbf-e221-40cc-9341-567d74907a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6F089E6A0>]}
2021-10-06 08:37:47.651855 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 08:37:47.652852 (MainThread): 
2021-10-06 08:37:47.652852 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 08:37:47.655269 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 08:37:47.662685 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 08:37:47.662685 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 08:37:47.662685 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 08:37:49.048353 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 1.39 seconds
2021-10-06 08:37:49.054880 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 08:37:49.350327 (MainThread): 10:37:49 | Concurrency: 1 threads (target='dev')
2021-10-06 08:37:49.351276 (MainThread): 10:37:49 | 
2021-10-06 08:37:49.358213 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_cul_order_price_cul_daily_amount.6c576ebf4f
2021-10-06 08:37:49.358520 (Thread-1): 10:37:49 | 1 of 7 START test not_cul_order_price_cul_daily_amount............... [RUN]
2021-10-06 08:37:49.358520 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_cul_order_price_cul_daily_amount.6c576ebf4f".
2021-10-06 08:37:49.358520 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_cul_order_price_cul_daily_amount.6c576ebf4f
2021-10-06 08:37:49.368057 (Thread-1): finished collecting timing info
2021-10-06 08:37:49.368057 (Thread-1): Compilation Error in test not_cul_order_price_cul_daily_amount (models\example\schema.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 517, in catch_jinja
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'test_not' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 464, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 371, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 522, in catch_jinja
    raise UndefinedMacroException(str(e), node) from e
dbt.exceptions.UndefinedMacroException: Compilation Error in test not_cul_order_price_cul_daily_amount (models\example\schema.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-06 08:37:49.410857 (Thread-1): 10:37:49 | 1 of 7 ERROR not_cul_order_price_cul_daily_amount.................... [ERROR in 0.05s]
2021-10-06 08:37:49.411771 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_cul_order_price_cul_daily_amount.6c576ebf4f
2021-10-06 08:37:49.411771 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-06 08:37:49.411771 (Thread-1): 10:37:49 | 2 of 7 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-10-06 08:37:49.412656 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-06 08:37:49.412656 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-06 08:37:49.415728 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-06 08:37:49.417642 (Thread-1): finished collecting timing info
2021-10-06 08:37:49.426884 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-06 08:37:49.427839 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-06 08:37:49.427839 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: BEGIN
2021-10-06 08:37:49.427839 (Thread-1): Opening a new connection, currently in state init
2021-10-06 08:37:50.272310 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-06 08:37:50.273378 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-06 08:37:50.273507 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
2021-10-06 08:37:50.688239 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-10-06 08:37:50.704652 (Thread-1): finished collecting timing info
2021-10-06 08:37:50.704652 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: ROLLBACK
2021-10-06 08:37:50.949335 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: Close
2021-10-06 08:37:51.254520 (Thread-1): 10:37:51 | 2 of 7 FAIL 1 not_null_my_first_dbt_model_id......................... [FAIL 1 in 1.84s]
2021-10-06 08:37:51.256887 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-06 08:37:51.256887 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-06 08:37:51.257889 (Thread-1): 10:37:51 | 3 of 7 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-10-06 08:37:51.258351 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-06 08:37:51.258351 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-06 08:37:51.264554 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-06 08:37:51.264554 (Thread-1): finished collecting timing info
2021-10-06 08:37:51.266548 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-06 08:37:51.267546 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-06 08:37:51.267546 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: BEGIN
2021-10-06 08:37:51.267546 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 08:37:52.233871 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-06 08:37:52.234866 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-06 08:37:52.234866 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
2021-10-06 08:37:52.631485 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-10-06 08:37:52.632660 (Thread-1): finished collecting timing info
2021-10-06 08:37:52.632660 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: ROLLBACK
2021-10-06 08:37:52.920379 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-10-06 08:37:53.230694 (Thread-1): 10:37:53 | 3 of 7 PASS not_null_my_second_dbt_model_id.......................... [PASS in 1.97s]
2021-10-06 08:37:53.232690 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-06 08:37:53.232690 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_snowflake_customer_purchases_c_custkey.f25eb372f5
2021-10-06 08:37:53.232690 (Thread-1): 10:37:53 | 4 of 7 START test not_snowflake_customer_purchases_c_custkey......... [RUN]
2021-10-06 08:37:53.233682 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_snowflake_customer_purchases_c_custkey.f25eb372f5".
2021-10-06 08:37:53.233682 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_snowflake_customer_purchases_c_custkey.f25eb372f5
2021-10-06 08:37:53.235754 (Thread-1): finished collecting timing info
2021-10-06 08:37:53.235754 (Thread-1): Compilation Error in test not_snowflake_customer_purchases_c_custkey (models\example\schema.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 517, in catch_jinja
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'test_not' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 464, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 371, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 522, in catch_jinja
    raise UndefinedMacroException(str(e), node) from e
dbt.exceptions.UndefinedMacroException: Compilation Error in test not_snowflake_customer_purchases_c_custkey (models\example\schema.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-06 08:37:53.236748 (Thread-1): 10:37:53 | 4 of 7 ERROR not_snowflake_customer_purchases_c_custkey.............. [ERROR in 0.00s]
2021-10-06 08:37:53.237722 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_snowflake_customer_purchases_c_custkey.f25eb372f5
2021-10-06 08:37:53.237722 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-06 08:37:53.237722 (Thread-1): 10:37:53 | 5 of 7 START test unique_my_first_dbt_model_id....................... [RUN]
2021-10-06 08:37:53.237722 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-06 08:37:53.237722 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-06 08:37:53.242227 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-06 08:37:53.252828 (Thread-1): finished collecting timing info
2021-10-06 08:37:53.253836 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-06 08:37:53.254949 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-06 08:37:53.254949 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: BEGIN
2021-10-06 08:37:53.254949 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 08:37:54.084507 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-06 08:37:54.085487 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-06 08:37:54.085487 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-06 08:37:54.420272 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-06 08:37:54.422262 (Thread-1): finished collecting timing info
2021-10-06 08:37:54.422262 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: ROLLBACK
2021-10-06 08:37:54.661630 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-06 08:37:54.964850 (Thread-1): 10:37:54 | 5 of 7 PASS unique_my_first_dbt_model_id............................. [PASS in 1.73s]
2021-10-06 08:37:54.966524 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-06 08:37:54.966524 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-06 08:37:54.967532 (Thread-1): 10:37:54 | 6 of 7 START test unique_my_second_dbt_model_id...................... [RUN]
2021-10-06 08:37:54.967532 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-06 08:37:54.968532 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-06 08:37:54.973581 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-06 08:37:54.974883 (Thread-1): finished collecting timing info
2021-10-06 08:37:54.976882 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-06 08:37:54.976882 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-06 08:37:54.976882 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: BEGIN
2021-10-06 08:37:54.977944 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 08:37:55.782302 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-06 08:37:55.782302 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-06 08:37:55.782302 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-06 08:37:56.143998 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-06 08:37:56.144993 (Thread-1): finished collecting timing info
2021-10-06 08:37:56.144993 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: ROLLBACK
2021-10-06 08:37:56.402201 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: Close
2021-10-06 08:37:56.688697 (Thread-1): 10:37:56 | 6 of 7 PASS unique_my_second_dbt_model_id............................ [PASS in 1.72s]
2021-10-06 08:37:56.690680 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-06 08:37:56.690680 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-06 08:37:56.691683 (Thread-1): 10:37:56 | 7 of 7 START test unique_snowflake_customer_purchases_c_custkey...... [RUN]
2021-10-06 08:37:56.691683 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-06 08:37:56.692679 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-06 08:37:56.697441 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-06 08:37:56.698330 (Thread-1): finished collecting timing info
2021-10-06 08:37:56.699401 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-06 08:37:56.699401 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-06 08:37:56.699401 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: BEGIN
2021-10-06 08:37:56.700399 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 08:37:57.564642 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-06 08:37:57.565637 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-06 08:37:57.565637 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.snowflake_customer_purchases
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-06 08:37:58.029638 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-10-06 08:37:58.029805 (Thread-1): finished collecting timing info
2021-10-06 08:37:58.030871 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: ROLLBACK
2021-10-06 08:37:58.272441 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: Close
2021-10-06 08:37:58.569438 (Thread-1): 10:37:58 | 7 of 7 PASS unique_snowflake_customer_purchases_c_custkey............ [PASS in 1.88s]
2021-10-06 08:37:58.571690 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-06 08:37:58.573862 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 08:37:58.573862 (MainThread): 10:37:58 | 
2021-10-06 08:37:58.574944 (MainThread): 10:37:58 | Finished running 7 tests in 10.92s.
2021-10-06 08:37:58.574944 (MainThread): Connection 'master' was properly closed.
2021-10-06 08:37:58.574944 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 08:37:58.574944 (MainThread): Connection 'test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8' was properly closed.
2021-10-06 08:37:58.596087 (MainThread): 
2021-10-06 08:37:58.597131 (MainThread): Completed with 3 errors and 0 warnings:
2021-10-06 08:37:58.598050 (MainThread): 
2021-10-06 08:37:58.599294 (MainThread): Compilation Error in test not_cul_order_price_cul_daily_amount (models\example\schema.yml)
2021-10-06 08:37:58.600002 (MainThread):   'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-06 08:37:58.600002 (MainThread): 
2021-10-06 08:37:58.600002 (MainThread): Failure in test not_null_my_first_dbt_model_id (models\example\schema.yml)
2021-10-06 08:37:58.601313 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-06 08:37:58.601313 (MainThread): 
2021-10-06 08:37:58.601886 (MainThread):   compiled SQL at target\compiled\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\not_null_my_first_dbt_model_id.sql
2021-10-06 08:37:58.602537 (MainThread): 
2021-10-06 08:37:58.602537 (MainThread): Compilation Error in test not_snowflake_customer_purchases_c_custkey (models\example\schema.yml)
2021-10-06 08:37:58.603253 (MainThread):   'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-06 08:37:58.603253 (MainThread): 
Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
2021-10-06 08:37:58.603849 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6F0709D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6F080F9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6F082FD90>]}
2021-10-06 08:37:58.603849 (MainThread): Flushing usage events
2021-10-06 08:56:42.988665 (MainThread): Running with dbt=0.20.2
2021-10-06 08:56:43.510236 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 08:56:43.510236 (MainThread): Tracking: tracking
2021-10-06 08:56:43.510236 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDE310DE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDE463CDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDE463C670>]}
2021-10-06 08:56:43.516374 (MainThread): Partial parsing not enabled
2021-10-06 08:56:43.527337 (MainThread): Parsing macros\adapters.sql
2021-10-06 08:56:43.545637 (MainThread): Parsing macros\catalog.sql
2021-10-06 08:56:43.546634 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 08:56:43.551617 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 08:56:43.552614 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 08:56:43.554607 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 08:56:43.555604 (MainThread): Parsing macros\core.sql
2021-10-06 08:56:43.557611 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 08:56:43.586719 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 08:56:43.591841 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 08:56:43.591841 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 08:56:43.592839 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 08:56:43.593835 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 08:56:43.594832 (MainThread): Parsing macros\etc\query.sql
2021-10-06 08:56:43.595828 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 08:56:43.601808 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 08:56:43.605795 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 08:56:43.613767 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 08:56:43.614764 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 08:56:43.619747 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 08:56:43.632984 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 08:56:43.652069 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 08:56:43.653066 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 08:56:43.665589 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 08:56:43.669575 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 08:56:43.672566 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 08:56:43.675556 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 08:56:43.677550 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 08:56:43.677550 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 08:56:43.678547 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 08:56:43.778984 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 08:56:43.785177 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 08:56:43.787171 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 08:56:43.789174 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 08:56:43.806929 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:56:43.808007 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:56:43.809002 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:56:43.809995 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:56:43.810992 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:56:43.813985 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:56:43.816927 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:56:43.863777 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cf5f904-2b4f-40ea-a63e-4f578da11ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDE47CFAF0>]}
2021-10-06 08:56:43.890930 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 08:56:43.890930 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cf5f904-2b4f-40ea-a63e-4f578da11ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDE47CF1F0>]}
2021-10-06 08:56:43.890930 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 08:56:43.891943 (MainThread): 
2021-10-06 08:56:43.893056 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 08:56:43.894570 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 08:56:43.904284 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 08:56:43.904284 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 08:56:43.905282 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 08:56:45.500387 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.60 seconds
2021-10-06 08:56:45.503377 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 08:56:45.928573 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 08:56:45.935066 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 08:56:45.935066 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 08:56:45.935066 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 08:56:46.856981 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.92 seconds
2021-10-06 08:56:46.856981 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 08:56:47.142961 (MainThread): Using snowflake connection "master".
2021-10-06 08:56:47.142961 (MainThread): On master: BEGIN
2021-10-06 08:56:47.142961 (MainThread): Opening a new connection, currently in state init
2021-10-06 08:56:47.979143 (MainThread): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-06 08:56:47.979143 (MainThread): On master: COMMIT
2021-10-06 08:56:47.980229 (MainThread): Using snowflake connection "master".
2021-10-06 08:56:47.980229 (MainThread): On master: COMMIT
2021-10-06 08:56:48.226384 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-06 08:56:48.226384 (MainThread): On master: Close
2021-10-06 08:56:48.539162 (MainThread): 10:56:48 | Concurrency: 1 threads (target='dev')
2021-10-06 08:56:48.539553 (MainThread): 10:56:48 | 
2021-10-06 08:56:48.543587 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 08:56:48.543587 (Thread-1): 10:56:48 | 1 of 4 START table model dbt.my_first_dbt_model...................... [RUN]
2021-10-06 08:56:48.543587 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 08:56:48.544638 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 08:56:48.545875 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 08:56:48.550861 (Thread-1): finished collecting timing info
2021-10-06 08:56:48.571984 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 08:56:48.576691 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 08:56:48.576691 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-06 08:56:48.576691 (Thread-1): Opening a new connection, currently in state init
2021-10-06 08:56:49.371512 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-06 08:56:49.371512 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 08:56:49.372541 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-06 08:56:51.242468 (Thread-1): SQL status: SUCCESS 1 in 1.87 seconds
2021-10-06 08:56:51.243465 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-06 08:56:51.244459 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 08:56:51.244459 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-06 08:56:51.422207 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 08:56:51.427248 (Thread-1): finished collecting timing info
2021-10-06 08:56:51.427248 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-06 08:56:51.899139 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cf5f904-2b4f-40ea-a63e-4f578da11ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDE4920E50>]}
2021-10-06 08:56:51.899139 (Thread-1): 10:56:51 | 1 of 4 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 3.36s]
2021-10-06 08:56:51.900136 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 08:56:51.900136 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 08:56:51.900136 (Thread-1): 10:56:51 | 2 of 4 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 08:56:51.901164 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 08:56:51.901164 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 08:56:51.903135 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 08:56:51.906628 (Thread-1): finished collecting timing info
2021-10-06 08:56:51.907566 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 08:56:51.912551 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 08:56:51.912551 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 08:56:51.912551 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 08:56:52.771633 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-10-06 08:56:52.771633 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 08:56:52.771633 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (

SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 08:56:55.507183 (Thread-1): SQL status: SUCCESS 1 in 2.74 seconds
2021-10-06 08:56:55.509168 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 08:56:55.510168 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 08:56:55.510168 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 08:56:55.688692 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 08:56:55.690680 (Thread-1): finished collecting timing info
2021-10-06 08:56:55.690680 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 08:56:55.981833 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cf5f904-2b4f-40ea-a63e-4f578da11ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDE48ED880>]}
2021-10-06 08:56:55.982823 (Thread-1): 10:56:55 | 2 of 4 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 4.08s]
2021-10-06 08:56:55.984886 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 08:56:55.984886 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 08:56:55.984886 (Thread-1): 10:56:55 | 3 of 4 START view model dbt.snowflake_customer_purchases............. [RUN]
2021-10-06 08:56:55.985895 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 08:56:55.985895 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 08:56:55.989878 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 08:56:55.995722 (Thread-1): finished collecting timing info
2021-10-06 08:56:56.009921 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 08:56:56.009921 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */
drop table if exists "ANALYTICS"."DBT"."SNOWFLAKE_CUSTOMER_PURCHASES" cascade
2021-10-06 08:56:56.009921 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 08:56:56.850835 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-06 08:56:56.856816 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 08:56:56.861799 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 08:56:56.861799 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 08:56:57.113163 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-06 08:56:57.113163 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 08:56:57.113163 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */

  create or replace  view analytics.dbt.snowflake_customer_purchases  as (
    

SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
  );
2021-10-06 08:56:57.535600 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-10-06 08:56:57.536635 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 08:56:57.536635 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 08:56:57.536635 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 08:56:57.702307 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 08:56:57.703304 (Thread-1): finished collecting timing info
2021-10-06 08:56:57.703304 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 08:56:58.058252 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cf5f904-2b4f-40ea-a63e-4f578da11ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDE4A36490>]}
2021-10-06 08:56:58.058252 (Thread-1): 10:56:58 | 3 of 4 OK created view model dbt.snowflake_customer_purchases........ [SUCCESS 1 in 2.07s]
2021-10-06 08:56:58.059185 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 08:56:58.059185 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 08:56:58.060250 (Thread-1): 10:56:58 | 4 of 4 START view model dbt.my_second_dbt_model...................... [RUN]
2021-10-06 08:56:58.060250 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 08:56:58.060250 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 08:56:58.061345 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 08:56:58.065333 (Thread-1): finished collecting timing info
2021-10-06 08:56:58.067409 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 08:56:58.071311 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 08:56:58.071311 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 08:56:58.071311 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 08:56:59.083476 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-06 08:56:59.083971 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 08:56:59.083971 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-10-06 08:56:59.465191 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-10-06 08:56:59.466188 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 08:56:59.466188 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 08:56:59.466188 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 08:56:59.629876 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 08:56:59.631924 (Thread-1): finished collecting timing info
2021-10-06 08:56:59.631924 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 08:56:59.917207 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cf5f904-2b4f-40ea-a63e-4f578da11ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDE4AC21F0>]}
2021-10-06 08:56:59.917207 (Thread-1): 10:56:59 | 4 of 4 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 1.86s]
2021-10-06 08:56:59.919350 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 08:56:59.921348 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 08:56:59.921348 (MainThread): Using snowflake connection "master".
2021-10-06 08:56:59.922426 (MainThread): On master: BEGIN
2021-10-06 08:56:59.922426 (MainThread): Opening a new connection, currently in state closed
2021-10-06 08:57:00.927235 (MainThread): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-06 08:57:00.927235 (MainThread): On master: COMMIT
2021-10-06 08:57:00.927235 (MainThread): Using snowflake connection "master".
2021-10-06 08:57:00.927235 (MainThread): On master: COMMIT
2021-10-06 08:57:01.280424 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-10-06 08:57:01.280424 (MainThread): On master: Close
2021-10-06 08:57:01.579946 (MainThread): 10:57:01 | 
2021-10-06 08:57:01.579946 (MainThread): 10:57:01 | Finished running 2 table models, 2 view models in 17.69s.
2021-10-06 08:57:01.581858 (MainThread): Connection 'master' was properly closed.
2021-10-06 08:57:01.581858 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 08:57:01.581858 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 08:57:01.581858 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 08:57:01.593008 (MainThread): 
2021-10-06 08:57:01.594004 (MainThread): Completed successfully
2021-10-06 08:57:01.594004 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-06 08:57:01.595002 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDE4AC23D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDE4711E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDE4711E20>]}
2021-10-06 08:57:01.595002 (MainThread): Flushing usage events
2021-10-06 08:58:21.357595 (MainThread): Running with dbt=0.20.2
2021-10-06 08:58:21.852025 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 08:58:21.852025 (MainThread): Tracking: tracking
2021-10-06 08:58:21.853022 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D6FF9CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D714CCA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D714CC400>]}
2021-10-06 08:58:21.858005 (MainThread): Partial parsing not enabled
2021-10-06 08:58:21.869080 (MainThread): Parsing macros\adapters.sql
2021-10-06 08:58:21.886738 (MainThread): Parsing macros\catalog.sql
2021-10-06 08:58:21.888731 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 08:58:21.893714 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 08:58:21.894711 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 08:58:21.896704 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 08:58:21.897701 (MainThread): Parsing macros\core.sql
2021-10-06 08:58:21.899694 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 08:58:21.927677 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 08:58:21.932660 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 08:58:21.932660 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 08:58:21.933657 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 08:58:21.934654 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 08:58:21.935650 (MainThread): Parsing macros\etc\query.sql
2021-10-06 08:58:21.936647 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 08:58:21.942627 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 08:58:21.947734 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 08:58:21.955706 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 08:58:21.956703 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 08:58:21.960685 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 08:58:21.972645 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 08:58:21.990973 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 08:58:21.992978 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 08:58:22.002026 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 08:58:22.006060 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 08:58:22.008166 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 08:58:22.012167 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 08:58:22.013154 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 08:58:22.014150 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 08:58:22.015150 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 08:58:22.116389 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 08:58:22.122441 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 08:58:22.124435 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'fc2c6638-8383-4394-b43d-12c0e79f65f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D715BFBB0>]}
2021-10-06 08:58:22.125431 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 08:58:22.127424 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 08:58:22.144480 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:58:22.145477 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:58:22.146474 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:58:22.147470 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:58:22.148593 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:58:22.151645 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:58:22.154635 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 08:58:22.199045 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc2c6638-8383-4394-b43d-12c0e79f65f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D71600670>]}
2021-10-06 08:58:22.224417 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 08:58:22.224417 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc2c6638-8383-4394-b43d-12c0e79f65f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D716000A0>]}
2021-10-06 08:58:22.224417 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 08:58:22.226346 (MainThread): 
2021-10-06 08:58:22.226346 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 08:58:22.228718 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 08:58:22.236689 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 08:58:22.237686 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 08:58:22.237686 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 08:58:23.640545 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.40 seconds
2021-10-06 08:58:23.646521 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 08:58:23.997571 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 08:58:24.003634 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 08:58:24.003634 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 08:58:24.003634 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 08:58:24.866831 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.86 seconds
2021-10-06 08:58:24.867897 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 08:58:25.165789 (MainThread): Using snowflake connection "master".
2021-10-06 08:58:25.165789 (MainThread): On master: BEGIN
2021-10-06 08:58:25.165789 (MainThread): Opening a new connection, currently in state init
2021-10-06 08:58:26.164656 (MainThread): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-06 08:58:26.165650 (MainThread): On master: COMMIT
2021-10-06 08:58:26.165650 (MainThread): Using snowflake connection "master".
2021-10-06 08:58:26.165650 (MainThread): On master: COMMIT
2021-10-06 08:58:26.414830 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-06 08:58:26.414830 (MainThread): On master: Close
2021-10-06 08:58:26.744000 (MainThread): 10:58:26 | Concurrency: 1 threads (target='dev')
2021-10-06 08:58:26.744642 (MainThread): 10:58:26 | 
2021-10-06 08:58:26.750178 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 08:58:26.750178 (Thread-1): 10:58:26 | 1 of 4 START view model dbt.my_first_dbt_model....................... [RUN]
2021-10-06 08:58:26.751565 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 08:58:26.751565 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 08:58:26.755631 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 08:58:26.757898 (Thread-1): finished collecting timing info
2021-10-06 08:58:26.780108 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 08:58:26.781104 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */
drop table if exists "ANALYTICS"."DBT"."MY_FIRST_DBT_MODEL" cascade
2021-10-06 08:58:26.781104 (Thread-1): Opening a new connection, currently in state init
2021-10-06 08:58:27.838256 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-10-06 08:58:27.844633 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 08:58:27.845525 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 08:58:27.845525 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-06 08:58:28.047507 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-06 08:58:28.048502 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 08:58:28.048502 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */

  create or replace  view analytics.dbt.my_first_dbt_model  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2021-10-06 08:58:28.417258 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-10-06 08:58:28.419180 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-06 08:58:28.420367 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 08:58:28.420367 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-06 08:58:28.573288 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-06 08:58:28.583211 (Thread-1): finished collecting timing info
2021-10-06 08:58:28.583211 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-06 08:58:28.884034 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc2c6638-8383-4394-b43d-12c0e79f65f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D717B1C10>]}
2021-10-06 08:58:28.884034 (Thread-1): 10:58:28 | 1 of 4 OK created view model dbt.my_first_dbt_model.................. [SUCCESS 1 in 2.13s]
2021-10-06 08:58:28.886072 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 08:58:28.886072 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 08:58:28.887129 (Thread-1): 10:58:28 | 2 of 4 START view model dbt.cul_order_price.......................... [RUN]
2021-10-06 08:58:28.888073 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 08:58:28.888073 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 08:58:28.891131 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 08:58:28.898993 (Thread-1): finished collecting timing info
2021-10-06 08:58:28.901260 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 08:58:28.901260 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */
drop table if exists "ANALYTICS"."DBT"."CUL_ORDER_PRICE" cascade
2021-10-06 08:58:28.901260 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 08:58:29.800253 (Thread-1): SQL status: SUCCESS 1 in 0.90 seconds
2021-10-06 08:58:29.802244 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 08:58:29.803241 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 08:58:29.803241 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 08:58:30.000561 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-06 08:58:30.000561 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 08:58:30.000561 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */

  create or replace  view analytics.dbt.cul_order_price  as (
    

SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
  );
2021-10-06 08:58:30.380547 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-10-06 08:58:30.382539 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 08:58:30.382539 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 08:58:30.382539 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 08:58:30.565259 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 08:58:30.566286 (Thread-1): finished collecting timing info
2021-10-06 08:58:30.566286 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 08:58:30.867078 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc2c6638-8383-4394-b43d-12c0e79f65f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D700DB310>]}
2021-10-06 08:58:30.868075 (Thread-1): 10:58:30 | 2 of 4 OK created view model dbt.cul_order_price..................... [SUCCESS 1 in 1.98s]
2021-10-06 08:58:30.869463 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 08:58:30.869463 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 08:58:30.869463 (Thread-1): 10:58:30 | 3 of 4 START view model dbt.snowflake_customer_purchases............. [RUN]
2021-10-06 08:58:30.869463 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 08:58:30.870462 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 08:58:30.871460 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 08:58:30.872541 (Thread-1): finished collecting timing info
2021-10-06 08:58:30.874450 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 08:58:30.878098 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 08:58:30.878098 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 08:58:30.879104 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 08:58:31.720117 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-06 08:58:31.721122 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 08:58:31.721122 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */

  create or replace  view analytics.dbt.snowflake_customer_purchases  as (
    

SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
  );
2021-10-06 08:58:32.200211 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2021-10-06 08:58:32.202271 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 08:58:32.203270 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 08:58:32.203270 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 08:58:32.388079 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 08:58:32.390114 (Thread-1): finished collecting timing info
2021-10-06 08:58:32.390114 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 08:58:32.787070 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc2c6638-8383-4394-b43d-12c0e79f65f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D700DB310>]}
2021-10-06 08:58:32.788067 (Thread-1): 10:58:32 | 3 of 4 OK created view model dbt.snowflake_customer_purchases........ [SUCCESS 1 in 1.92s]
2021-10-06 08:58:32.789319 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 08:58:32.789319 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 08:58:32.789319 (Thread-1): 10:58:32 | 4 of 4 START view model dbt.my_second_dbt_model...................... [RUN]
2021-10-06 08:58:32.790346 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 08:58:32.790346 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 08:58:32.792413 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 08:58:32.793807 (Thread-1): finished collecting timing info
2021-10-06 08:58:32.795809 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 08:58:32.797533 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 08:58:32.798540 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 08:58:32.798540 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 08:58:33.633327 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-06 08:58:33.634328 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 08:58:33.634328 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models



select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-10-06 08:58:34.049555 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-10-06 08:58:34.050546 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 08:58:34.050546 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 08:58:34.050546 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 08:58:34.221933 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 08:58:34.222931 (Thread-1): finished collecting timing info
2021-10-06 08:58:34.222931 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 08:58:34.586892 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc2c6638-8383-4394-b43d-12c0e79f65f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D715C3A60>]}
2021-10-06 08:58:34.586892 (Thread-1): 10:58:34 | 4 of 4 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 1.80s]
2021-10-06 08:58:34.588332 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 08:58:34.588989 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 08:58:34.588989 (MainThread): Using snowflake connection "master".
2021-10-06 08:58:34.588989 (MainThread): On master: BEGIN
2021-10-06 08:58:34.589989 (MainThread): Opening a new connection, currently in state closed
2021-10-06 08:58:35.687521 (MainThread): SQL status: SUCCESS 1 in 1.10 seconds
2021-10-06 08:58:35.687521 (MainThread): On master: COMMIT
2021-10-06 08:58:35.687521 (MainThread): Using snowflake connection "master".
2021-10-06 08:58:35.687521 (MainThread): On master: COMMIT
2021-10-06 08:58:36.019063 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-06 08:58:36.019063 (MainThread): On master: Close
2021-10-06 08:58:36.337503 (MainThread): 10:58:36 | 
2021-10-06 08:58:36.337503 (MainThread): 10:58:36 | Finished running 4 view models in 14.11s.
2021-10-06 08:58:36.339509 (MainThread): Connection 'master' was properly closed.
2021-10-06 08:58:36.339509 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 08:58:36.339509 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 08:58:36.339509 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 08:58:36.353931 (MainThread): 
2021-10-06 08:58:36.353931 (MainThread): Completed successfully
2021-10-06 08:58:36.355386 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-06 08:58:36.355386 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D717AE610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D717AEDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D717AE8E0>]}
2021-10-06 08:58:36.355386 (MainThread): Flushing usage events
2021-10-06 09:09:57.462919 (MainThread): Running with dbt=0.20.2
2021-10-06 09:09:58.177387 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 09:09:58.178388 (MainThread): Tracking: tracking
2021-10-06 09:09:58.179368 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EDDBCE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EF3044F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EF304760>]}
2021-10-06 09:09:58.186365 (MainThread): Partial parsing not enabled
2021-10-06 09:09:58.207244 (MainThread): Parsing macros\adapters.sql
2021-10-06 09:09:58.226227 (MainThread): Parsing macros\catalog.sql
2021-10-06 09:09:58.227227 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 09:09:58.232212 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 09:09:58.233142 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 09:09:58.236191 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 09:09:58.236191 (MainThread): Parsing macros\core.sql
2021-10-06 09:09:58.238115 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 09:09:58.265724 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 09:09:58.270811 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 09:09:58.271808 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 09:09:58.272804 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 09:09:58.273801 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 09:09:58.274798 (MainThread): Parsing macros\etc\query.sql
2021-10-06 09:09:58.275794 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 09:09:58.280777 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 09:09:58.285289 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 09:09:58.293267 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 09:09:58.294264 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 09:09:58.299247 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 09:09:58.312202 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 09:09:58.330751 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 09:09:58.331749 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 09:09:58.342804 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 09:09:58.345771 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 09:09:58.348760 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 09:09:58.352746 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 09:09:58.353749 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 09:09:58.353749 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 09:09:58.354671 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 09:09:58.459406 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 09:09:58.464435 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 09:09:58.465472 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 09:09:58.468463 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 09:09:58.484322 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:09:58.485395 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:09:58.487242 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:09:58.488888 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:09:58.489878 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:09:58.492912 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:09:58.496899 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:09:58.544544 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b24da67a-1598-4787-a2ec-85bbbc200e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EF451B20>]}
2021-10-06 09:09:58.577435 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 09:09:58.579110 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b24da67a-1598-4787-a2ec-85bbbc200e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EF32C6A0>]}
2021-10-06 09:09:58.579110 (MainThread): Found 4 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 09:09:58.580948 (MainThread): 
2021-10-06 09:09:58.581403 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 09:09:58.582912 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 09:09:58.593933 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 09:09:58.593933 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 09:09:58.593933 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 09:10:00.307011 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.71 seconds
2021-10-06 09:10:00.316763 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 09:10:00.615164 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 09:10:00.623044 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 09:10:00.624107 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 09:10:00.624107 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 09:10:01.629151 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 1.01 seconds
2021-10-06 09:10:01.630169 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 09:10:01.927307 (MainThread): Using snowflake connection "master".
2021-10-06 09:10:01.927307 (MainThread): On master: BEGIN
2021-10-06 09:10:01.928304 (MainThread): Opening a new connection, currently in state init
2021-10-06 09:10:02.703107 (MainThread): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-06 09:10:02.703107 (MainThread): On master: COMMIT
2021-10-06 09:10:02.703107 (MainThread): Using snowflake connection "master".
2021-10-06 09:10:02.703107 (MainThread): On master: COMMIT
2021-10-06 09:10:02.943956 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-06 09:10:02.943956 (MainThread): On master: Close
2021-10-06 09:10:03.275082 (MainThread): 11:10:03 | Concurrency: 1 threads (target='dev')
2021-10-06 09:10:03.275999 (MainThread): 11:10:03 | 
2021-10-06 09:10:03.280890 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 09:10:03.280890 (Thread-1): 11:10:03 | 1 of 4 START table model dbt.my_first_dbt_model...................... [RUN]
2021-10-06 09:10:03.281606 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 09:10:03.281606 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 09:10:03.282681 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 09:10:03.287026 (Thread-1): finished collecting timing info
2021-10-06 09:10:03.300580 (Thread-1): Dropping relation "ANALYTICS"."DBT"."MY_FIRST_DBT_MODEL" because it is of type view
2021-10-06 09:10:03.303570 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 09:10:03.304566 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */
drop view if exists "ANALYTICS"."DBT"."MY_FIRST_DBT_MODEL" cascade
2021-10-06 09:10:03.304566 (Thread-1): Opening a new connection, currently in state init
2021-10-06 09:10:04.200341 (Thread-1): SQL status: SUCCESS 1 in 0.90 seconds
2021-10-06 09:10:04.207915 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 09:10:04.212898 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 09:10:04.212898 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-06 09:10:04.476299 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-06 09:10:04.477278 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 09:10:04.477278 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-06 09:10:06.139594 (Thread-1): SQL status: SUCCESS 1 in 1.66 seconds
2021-10-06 09:10:06.140609 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-06 09:10:06.140609 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 09:10:06.140609 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-06 09:10:06.384845 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-06 09:10:06.392472 (Thread-1): finished collecting timing info
2021-10-06 09:10:06.392472 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-06 09:10:06.878603 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b24da67a-1598-4787-a2ec-85bbbc200e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EF6F6C10>]}
2021-10-06 09:10:06.879602 (Thread-1): 11:10:06 | 1 of 4 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 3.60s]
2021-10-06 09:10:06.879602 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 09:10:06.880637 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 09:10:06.880637 (Thread-1): 11:10:06 | 2 of 4 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 09:10:06.880637 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 09:10:06.881593 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 09:10:06.881593 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 09:10:06.885814 (Thread-1): finished collecting timing info
2021-10-06 09:10:06.887167 (Thread-1): Dropping relation "ANALYTICS"."DBT"."CUL_ORDER_PRICE" because it is of type view
2021-10-06 09:10:06.888170 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 09:10:06.888170 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */
drop view if exists "ANALYTICS"."DBT"."CUL_ORDER_PRICE" cascade
2021-10-06 09:10:06.888170 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 09:10:07.915979 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-10-06 09:10:07.917047 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 09:10:07.933610 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 09:10:07.933610 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 09:10:08.178660 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-06 09:10:08.178660 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 09:10:08.178660 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 09:10:09.869023 (Thread-1): SQL status: SUCCESS 1 in 1.69 seconds
2021-10-06 09:10:09.870008 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 09:10:09.870008 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 09:10:09.870008 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 09:10:10.068897 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-06 09:10:10.069946 (Thread-1): finished collecting timing info
2021-10-06 09:10:10.069946 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 09:10:10.569577 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b24da67a-1598-4787-a2ec-85bbbc200e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EF704760>]}
2021-10-06 09:10:10.569577 (Thread-1): 11:10:10 | 2 of 4 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.69s]
2021-10-06 09:10:10.570573 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 09:10:10.570573 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 09:10:10.571570 (Thread-1): 11:10:10 | 3 of 4 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 09:10:10.571570 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 09:10:10.571570 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 09:10:10.572567 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 09:10:10.577550 (Thread-1): finished collecting timing info
2021-10-06 09:10:10.579553 (Thread-1): Dropping relation "ANALYTICS"."DBT"."SNOWFLAKE_CUSTOMER_PURCHASES" because it is of type view
2021-10-06 09:10:10.580540 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 09:10:10.580540 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */
drop view if exists "ANALYTICS"."DBT"."SNOWFLAKE_CUSTOMER_PURCHASES" cascade
2021-10-06 09:10:10.580540 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 09:10:11.714650 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2021-10-06 09:10:11.715595 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 09:10:11.729016 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 09:10:11.729016 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 09:10:11.963207 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-06 09:10:11.964194 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 09:10:11.964194 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 09:10:13.653989 (Thread-1): SQL status: SUCCESS 1 in 1.69 seconds
2021-10-06 09:10:13.654984 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 09:10:13.654984 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 09:10:13.654984 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 09:10:13.993391 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-10-06 09:10:13.993391 (Thread-1): finished collecting timing info
2021-10-06 09:10:13.993391 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 09:10:14.489957 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b24da67a-1598-4787-a2ec-85bbbc200e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EF5D1B80>]}
2021-10-06 09:10:14.489957 (Thread-1): 11:10:14 | 3 of 4 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.92s]
2021-10-06 09:10:14.490953 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 09:10:14.490953 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 09:10:14.490953 (Thread-1): 11:10:14 | 4 of 4 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 09:10:14.491950 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 09:10:14.491950 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 09:10:14.492957 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 09:10:14.509011 (Thread-1): finished collecting timing info
2021-10-06 09:10:14.511083 (Thread-1): Dropping relation "ANALYTICS"."DBT"."MY_SECOND_DBT_MODEL" because it is of type view
2021-10-06 09:10:14.512060 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 09:10:14.512060 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */
drop view if exists "ANALYTICS"."DBT"."MY_SECOND_DBT_MODEL" cascade
2021-10-06 09:10:14.512060 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 09:10:15.762569 (Thread-1): SQL status: SUCCESS 1 in 1.25 seconds
2021-10-06 09:10:15.762569 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 09:10:15.767036 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 09:10:15.767036 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 09:10:16.010131 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-06 09:10:16.010131 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 09:10:16.010131 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.my_first_dbt_model
where id = 1
      );
2021-10-06 09:10:17.076587 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-10-06 09:10:17.078579 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 09:10:17.078579 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 09:10:17.078579 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 09:10:17.241814 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 09:10:17.241814 (Thread-1): finished collecting timing info
2021-10-06 09:10:17.241814 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 09:10:17.590279 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b24da67a-1598-4787-a2ec-85bbbc200e29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EF690280>]}
2021-10-06 09:10:17.590279 (Thread-1): 11:10:17 | 4 of 4 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 3.10s]
2021-10-06 09:10:17.592071 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 09:10:17.605406 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 09:10:17.606413 (MainThread): Using snowflake connection "master".
2021-10-06 09:10:17.606413 (MainThread): On master: BEGIN
2021-10-06 09:10:17.606413 (MainThread): Opening a new connection, currently in state closed
2021-10-06 09:10:18.408789 (MainThread): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-06 09:10:18.408789 (MainThread): On master: COMMIT
2021-10-06 09:10:18.409278 (MainThread): Using snowflake connection "master".
2021-10-06 09:10:18.409278 (MainThread): On master: COMMIT
2021-10-06 09:10:18.686548 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-06 09:10:18.686548 (MainThread): On master: Close
2021-10-06 09:10:18.989876 (MainThread): 11:10:18 | 
2021-10-06 09:10:18.989876 (MainThread): 11:10:18 | Finished running 4 table models in 20.41s.
2021-10-06 09:10:18.990854 (MainThread): Connection 'master' was properly closed.
2021-10-06 09:10:18.990854 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 09:10:18.990854 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 09:10:18.990854 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 09:10:19.015721 (MainThread): 
2021-10-06 09:10:19.015721 (MainThread): Completed successfully
2021-10-06 09:10:19.015721 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-06 09:10:19.017675 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EF78D490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EF56FF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EF56F2E0>]}
2021-10-06 09:10:19.017675 (MainThread): Flushing usage events
2021-10-06 09:37:33.921175 (MainThread): Running with dbt=0.20.2
2021-10-06 09:37:34.422182 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 09:37:34.423179 (MainThread): Tracking: tracking
2021-10-06 09:37:34.423179 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002558FB5CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255910A44F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255910A4700>]}
2021-10-06 09:37:34.429160 (MainThread): Partial parsing not enabled
2021-10-06 09:37:34.441625 (MainThread): Parsing macros\adapters.sql
2021-10-06 09:37:34.462797 (MainThread): Parsing macros\catalog.sql
2021-10-06 09:37:34.463793 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 09:37:34.470803 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 09:37:34.472382 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 09:37:34.475448 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 09:37:34.476445 (MainThread): Parsing macros\core.sql
2021-10-06 09:37:34.478437 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 09:37:34.506780 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 09:37:34.511723 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 09:37:34.512757 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 09:37:34.513757 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 09:37:34.514820 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 09:37:34.514820 (MainThread): Parsing macros\etc\query.sql
2021-10-06 09:37:34.515913 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 09:37:34.521820 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 09:37:34.524883 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 09:37:34.533051 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 09:37:34.534047 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 09:37:34.539024 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 09:37:34.550163 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 09:37:34.567463 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 09:37:34.568447 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 09:37:34.579339 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 09:37:34.582329 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 09:37:34.585319 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 09:37:34.589306 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 09:37:34.590303 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 09:37:34.590303 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 09:37:34.591299 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 09:37:34.688083 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 09:37:34.693066 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 09:37:34.707284 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025591119FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025591185A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002559116D700>]}
2021-10-06 09:37:34.707284 (MainThread): Flushing usage events
2021-10-06 09:37:35.283728 (MainThread): Connection 'model.lukeclarke_learn_dbt.dates' was properly closed.
2021-10-06 09:37:35.283728 (MainThread): Encountered an error:
2021-10-06 09:37:35.283728 (MainThread): Compilation Error in model dates (models\example\dates.sql)
  expected token 'end of statement block', got '%'
    line 9
      {% endif %%}
2021-10-06 09:37:35.330595 (MainThread): Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 517, in catch_jinja
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 544, in get_template
    return env.from_string(template_source, globals=ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 9, in template
jinja2.exceptions.TemplateSyntaxError: expected token 'end of statement block', got '%'
  line 9
    {% endif %%}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 298, in load
    self.parse_project(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 407, in parse_project
    parser.parse_file(block)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\base.py", line 412, in parse_file
    self.parse_node(file_block)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\base.py", line 385, in parse_node
    self.render_update(node, config)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\models.py", line 59, in render_update
    super().render_update(node, config)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\base.py", line 360, in render_update
    self.render_with_context(node, config)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\base.py", line 273, in render_with_context
    get_rendered(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 591, in get_rendered
    template = get_template(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 544, in get_template
    return env.from_string(template_source, globals=ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 520, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model dates (models\example\dates.sql)
  expected token 'end of statement block', got '%'
    line 9
      {% endif %%}

2021-10-06 09:37:52.954632 (MainThread): Running with dbt=0.20.2
2021-10-06 09:37:53.451895 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 09:37:53.452893 (MainThread): Tracking: tracking
2021-10-06 09:37:53.452893 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236B91BCDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BA7060D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BA706250>]}
2021-10-06 09:37:53.458066 (MainThread): Partial parsing not enabled
2021-10-06 09:37:53.469029 (MainThread): Parsing macros\adapters.sql
2021-10-06 09:37:53.487867 (MainThread): Parsing macros\catalog.sql
2021-10-06 09:37:53.488864 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 09:37:53.493846 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 09:37:53.494844 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 09:37:53.497833 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 09:37:53.497833 (MainThread): Parsing macros\core.sql
2021-10-06 09:37:53.499827 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 09:37:53.527824 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 09:37:53.532870 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 09:37:53.532870 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 09:37:53.534191 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 09:37:53.535195 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 09:37:53.536193 (MainThread): Parsing macros\etc\query.sql
2021-10-06 09:37:53.537187 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 09:37:53.542170 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 09:37:53.546158 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 09:37:53.554056 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 09:37:53.555053 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 09:37:53.560036 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 09:37:53.571996 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 09:37:53.589212 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 09:37:53.590209 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 09:37:53.600282 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 09:37:53.604269 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 09:37:53.606262 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 09:37:53.610249 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 09:37:53.611246 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 09:37:53.612241 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 09:37:53.613238 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 09:37:53.710699 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 09:37:53.716680 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 09:37:53.720667 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 09:37:53.722658 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 09:37:53.724652 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 09:37:53.740599 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:37:53.741597 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:37:53.742593 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:37:53.743590 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:37:53.745583 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:37:53.748573 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:37:53.777841 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:37:53.792789 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0883cf6-f445-416e-bb91-417f973dd7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BA831EE0>]}
2021-10-06 09:37:53.828719 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 09:37:53.829801 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0883cf6-f445-416e-bb91-417f973dd7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BA8319D0>]}
2021-10-06 09:37:53.830299 (MainThread): Found 5 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 09:37:53.831308 (MainThread): 
2021-10-06 09:37:53.831308 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 09:37:53.833301 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 09:37:53.841712 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 09:37:53.841712 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 09:37:53.841712 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 09:37:57.146724 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 3.31 seconds
2021-10-06 09:37:57.153868 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 09:37:57.463352 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 09:37:57.470323 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 09:37:57.470323 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 09:37:57.470323 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 09:37:58.556423 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 1.09 seconds
2021-10-06 09:37:58.557418 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 09:37:58.865713 (MainThread): Using snowflake connection "master".
2021-10-06 09:37:58.865713 (MainThread): On master: BEGIN
2021-10-06 09:37:58.865713 (MainThread): Opening a new connection, currently in state init
2021-10-06 09:37:59.677666 (MainThread): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-06 09:37:59.677666 (MainThread): On master: COMMIT
2021-10-06 09:37:59.677666 (MainThread): Using snowflake connection "master".
2021-10-06 09:37:59.678662 (MainThread): On master: COMMIT
2021-10-06 09:37:59.956854 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-06 09:37:59.956854 (MainThread): On master: Close
2021-10-06 09:38:00.313041 (MainThread): 11:38:00 | Concurrency: 1 threads (target='dev')
2021-10-06 09:38:00.314096 (MainThread): 11:38:00 | 
2021-10-06 09:38:00.320592 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 09:38:00.320592 (Thread-1): 11:38:00 | 1 of 5 START table model dbt.my_first_dbt_model...................... [RUN]
2021-10-06 09:38:00.321622 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 09:38:00.321622 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 09:38:00.323692 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 09:38:00.332828 (Thread-1): finished collecting timing info
2021-10-06 09:38:00.351965 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 09:38:00.358170 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 09:38:00.358170 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-06 09:38:00.358170 (Thread-1): Opening a new connection, currently in state init
2021-10-06 09:38:01.139874 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-06 09:38:01.139874 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 09:38:01.139874 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-06 09:38:02.641792 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-10-06 09:38:02.643854 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-06 09:38:02.643854 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 09:38:02.643854 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-06 09:38:02.825896 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 09:38:02.837938 (Thread-1): finished collecting timing info
2021-10-06 09:38:02.837938 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-06 09:38:03.150435 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0883cf6-f445-416e-bb91-417f973dd7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BAAAEF40>]}
2021-10-06 09:38:03.151433 (Thread-1): 11:38:03 | 1 of 5 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.83s]
2021-10-06 09:38:03.152795 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 09:38:03.152795 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 09:38:03.153793 (Thread-1): 11:38:03 | 2 of 5 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 09:38:03.155088 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 09:38:03.155088 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 09:38:03.157086 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 09:38:03.165254 (Thread-1): finished collecting timing info
2021-10-06 09:38:03.167324 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 09:38:03.183359 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 09:38:03.183359 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 09:38:03.183359 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 09:38:04.165035 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-06 09:38:04.166042 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 09:38:04.166042 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 09:38:05.929963 (Thread-1): SQL status: SUCCESS 1 in 1.76 seconds
2021-10-06 09:38:05.931956 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 09:38:05.931956 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 09:38:05.931956 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 09:38:06.103917 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 09:38:06.105908 (Thread-1): finished collecting timing info
2021-10-06 09:38:06.105908 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 09:38:06.421183 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0883cf6-f445-416e-bb91-417f973dd7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BAAAEF40>]}
2021-10-06 09:38:06.422167 (Thread-1): 11:38:06 | 2 of 5 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.27s]
2021-10-06 09:38:06.424311 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 09:38:06.424311 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 09:38:06.424311 (Thread-1): 11:38:06 | 3 of 5 START incremental model dbt.dates............................. [RUN]
2021-10-06 09:38:06.425313 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 09:38:06.426310 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 09:38:06.430366 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 09:38:06.431365 (Thread-1): finished collecting timing info
2021-10-06 09:38:06.447315 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 09:38:06.448312 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 09:38:06.448312 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 09:38:06.448312 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 09:38:07.348086 (Thread-1): SQL status: SUCCESS 1 in 0.90 seconds
2021-10-06 09:38:07.349079 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 09:38:07.349079 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


      create or replace transient table analytics.dbt.dates  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


      );
2021-10-06 09:38:08.413468 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-10-06 09:38:08.415462 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 09:38:08.415462 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 09:38:08.415462 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 09:38:08.591662 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 09:38:08.593655 (Thread-1): finished collecting timing info
2021-10-06 09:38:08.593655 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 09:38:08.900643 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0883cf6-f445-416e-bb91-417f973dd7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BAAAEDC0>]}
2021-10-06 09:38:08.900643 (Thread-1): 11:38:08 | 3 of 5 OK created incremental model dbt.dates........................ [SUCCESS 1 in 2.47s]
2021-10-06 09:38:08.902655 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 09:38:08.902655 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 09:38:08.902655 (Thread-1): 11:38:08 | 4 of 5 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 09:38:08.902655 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 09:38:08.902655 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 09:38:08.903723 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 09:38:08.908639 (Thread-1): finished collecting timing info
2021-10-06 09:38:08.910630 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 09:38:08.915718 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 09:38:08.915718 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 09:38:08.915718 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 09:38:09.958567 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-10-06 09:38:09.958567 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 09:38:09.959646 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 09:38:11.423978 (Thread-1): SQL status: SUCCESS 1 in 1.46 seconds
2021-10-06 09:38:11.425981 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 09:38:11.425981 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 09:38:11.426963 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 09:38:11.623166 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-06 09:38:11.625160 (Thread-1): finished collecting timing info
2021-10-06 09:38:11.625160 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 09:38:11.902715 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0883cf6-f445-416e-bb91-417f973dd7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BAAAEF40>]}
2021-10-06 09:38:11.903713 (Thread-1): 11:38:11 | 4 of 5 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.00s]
2021-10-06 09:38:11.905708 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 09:38:11.905708 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 09:38:11.906707 (Thread-1): 11:38:11 | 5 of 5 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 09:38:11.908419 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 09:38:11.908419 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 09:38:11.911480 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 09:38:11.916291 (Thread-1): finished collecting timing info
2021-10-06 09:38:11.917297 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 09:38:11.932190 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 09:38:11.932190 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 09:38:11.932190 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 09:38:12.899089 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-06 09:38:12.900081 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 09:38:12.900081 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.my_first_dbt_model
where id = 1
      );
2021-10-06 09:38:14.020474 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-10-06 09:38:14.021479 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 09:38:14.021479 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 09:38:14.021479 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 09:38:14.183233 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 09:38:14.185296 (Thread-1): finished collecting timing info
2021-10-06 09:38:14.185296 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 09:38:14.528863 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0883cf6-f445-416e-bb91-417f973dd7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BAAAEFA0>]}
2021-10-06 09:38:14.529854 (Thread-1): 11:38:14 | 5 of 5 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.62s]
2021-10-06 09:38:14.532066 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 09:38:14.534139 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 09:38:14.534139 (MainThread): Using snowflake connection "master".
2021-10-06 09:38:14.534139 (MainThread): On master: BEGIN
2021-10-06 09:38:14.534139 (MainThread): Opening a new connection, currently in state closed
2021-10-06 09:38:15.458352 (MainThread): SQL status: SUCCESS 1 in 0.92 seconds
2021-10-06 09:38:15.459347 (MainThread): On master: COMMIT
2021-10-06 09:38:15.459347 (MainThread): Using snowflake connection "master".
2021-10-06 09:38:15.459347 (MainThread): On master: COMMIT
2021-10-06 09:38:15.718401 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-06 09:38:15.719399 (MainThread): On master: Close
2021-10-06 09:38:16.024409 (MainThread): 11:38:16 | 
2021-10-06 09:38:16.025410 (MainThread): 11:38:16 | Finished running 4 table models, 1 incremental model in 22.19s.
2021-10-06 09:38:16.026715 (MainThread): Connection 'master' was properly closed.
2021-10-06 09:38:16.027727 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 09:38:16.027727 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 09:38:16.027727 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 09:38:16.043754 (MainThread): 
2021-10-06 09:38:16.043754 (MainThread): Completed successfully
2021-10-06 09:38:16.044747 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-10-06 09:38:16.044747 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BA781070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BA9EE100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BA9EEE20>]}
2021-10-06 09:38:16.045743 (MainThread): Flushing usage events
2021-10-06 09:40:14.019121 (MainThread): Running with dbt=0.20.2
2021-10-06 09:40:14.526714 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 09:40:14.526714 (MainThread): Tracking: tracking
2021-10-06 09:40:14.526714 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F3D25DE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F3E7A5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F3E7A56D0>]}
2021-10-06 09:40:14.532694 (MainThread): Partial parsing not enabled
2021-10-06 09:40:14.543776 (MainThread): Parsing macros\adapters.sql
2021-10-06 09:40:14.561150 (MainThread): Parsing macros\catalog.sql
2021-10-06 09:40:14.562147 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 09:40:14.568128 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 09:40:14.569125 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 09:40:14.571118 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 09:40:14.572116 (MainThread): Parsing macros\core.sql
2021-10-06 09:40:14.574108 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 09:40:14.602153 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 09:40:14.608133 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 09:40:14.608133 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 09:40:14.609130 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 09:40:14.610127 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 09:40:14.611123 (MainThread): Parsing macros\etc\query.sql
2021-10-06 09:40:14.612120 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 09:40:14.618098 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 09:40:14.622085 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 09:40:14.629615 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 09:40:14.630621 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 09:40:14.635603 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 09:40:14.648720 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 09:40:14.666848 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 09:40:14.667845 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 09:40:14.678806 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 09:40:14.681796 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 09:40:14.684786 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 09:40:14.688773 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 09:40:14.690766 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 09:40:14.690766 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 09:40:14.691763 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 09:40:14.793966 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 09:40:14.799871 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 09:40:14.807302 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 09:40:14.809464 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 09:40:14.811461 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 09:40:14.831313 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:40:14.832310 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:40:14.833316 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:40:14.834311 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:40:14.837291 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:40:14.840864 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:40:14.881865 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 09:40:14.913521 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '442af252-5737-4c1d-b9a6-09bc73ca052b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F3E8CAA90>]}
2021-10-06 09:40:14.929589 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 09:40:14.929589 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '442af252-5737-4c1d-b9a6-09bc73ca052b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F3E8CA9A0>]}
2021-10-06 09:40:14.929589 (MainThread): Found 5 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 09:40:14.931501 (MainThread): 
2021-10-06 09:40:14.931501 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 09:40:14.933496 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 09:40:14.945406 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 09:40:14.945406 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 09:40:14.945902 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 09:40:16.792763 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.85 seconds
2021-10-06 09:40:16.794738 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 09:40:17.076550 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 09:40:17.082481 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 09:40:17.082481 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 09:40:17.082481 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 09:40:17.819212 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.74 seconds
2021-10-06 09:40:17.820210 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 09:40:18.133811 (MainThread): Using snowflake connection "master".
2021-10-06 09:40:18.133811 (MainThread): On master: BEGIN
2021-10-06 09:40:18.133811 (MainThread): Opening a new connection, currently in state init
2021-10-06 09:40:18.900558 (MainThread): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-06 09:40:18.900558 (MainThread): On master: COMMIT
2021-10-06 09:40:18.900558 (MainThread): Using snowflake connection "master".
2021-10-06 09:40:18.900558 (MainThread): On master: COMMIT
2021-10-06 09:40:19.148027 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-06 09:40:19.148027 (MainThread): On master: Close
2021-10-06 09:40:19.438608 (MainThread): 11:40:19 | Concurrency: 1 threads (target='dev')
2021-10-06 09:40:19.439126 (MainThread): 11:40:19 | 
2021-10-06 09:40:19.444566 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 09:40:19.445648 (Thread-1): 11:40:19 | 1 of 5 START table model dbt.my_first_dbt_model...................... [RUN]
2021-10-06 09:40:19.445648 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 09:40:19.446569 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 09:40:19.447567 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 09:40:19.448563 (Thread-1): finished collecting timing info
2021-10-06 09:40:19.467373 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 09:40:19.468404 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 09:40:19.469442 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-06 09:40:19.469442 (Thread-1): Opening a new connection, currently in state init
2021-10-06 09:40:20.634691 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2021-10-06 09:40:20.634691 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 09:40:20.634691 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-06 09:40:21.642018 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-06 09:40:21.643024 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-06 09:40:21.643024 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 09:40:21.643024 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-06 09:40:21.872395 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-06 09:40:21.883037 (Thread-1): finished collecting timing info
2021-10-06 09:40:21.884036 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-06 09:40:22.177296 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '442af252-5737-4c1d-b9a6-09bc73ca052b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F3EA92100>]}
2021-10-06 09:40:22.177296 (Thread-1): 11:40:22 | 1 of 5 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.73s]
2021-10-06 09:40:22.178293 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 09:40:22.179288 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 09:40:22.179288 (Thread-1): 11:40:22 | 2 of 5 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 09:40:22.179288 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 09:40:22.180286 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 09:40:22.181282 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 09:40:22.183275 (Thread-1): finished collecting timing info
2021-10-06 09:40:22.187262 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 09:40:22.189475 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 09:40:22.189475 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 09:40:22.189475 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 09:40:22.952460 (Thread-1): SQL status: SUCCESS 1 in 0.76 seconds
2021-10-06 09:40:22.952460 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 09:40:22.952957 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 09:40:24.362003 (Thread-1): SQL status: SUCCESS 1 in 1.41 seconds
2021-10-06 09:40:24.363087 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 09:40:24.363087 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 09:40:24.363087 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 09:40:24.519415 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 09:40:24.520537 (Thread-1): finished collecting timing info
2021-10-06 09:40:24.521802 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 09:40:24.822808 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '442af252-5737-4c1d-b9a6-09bc73ca052b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F3E87B970>]}
2021-10-06 09:40:24.822808 (Thread-1): 11:40:24 | 2 of 5 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.64s]
2021-10-06 09:40:24.823803 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 09:40:24.823803 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 09:40:24.824802 (Thread-1): 11:40:24 | 3 of 5 START incremental model dbt.dates............................. [RUN]
2021-10-06 09:40:24.825796 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 09:40:24.825796 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 09:40:24.828795 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 09:40:24.835002 (Thread-1): finished collecting timing info
2021-10-06 09:40:24.849966 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 09:40:24.849966 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 09:40:24.849966 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 09:40:26.101334 (Thread-1): SQL status: SUCCESS 1 in 1.25 seconds
2021-10-06 09:40:26.109315 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 09:40:26.109315 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 09:40:26.328989 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-06 09:40:26.332060 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 09:40:26.332060 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 09:40:26.497040 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 09:40:26.500663 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 09:40:26.500663 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 09:40:26.663097 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 09:40:26.672076 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 09:40:26.676284 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 09:40:26.676284 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 09:40:26.871626 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-06 09:40:26.871626 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 09:40:26.871626 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 09:40:27.273259 (Thread-1): SQL status: SUCCESS 0 in 0.40 seconds
2021-10-06 09:40:27.274241 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 09:40:27.274241 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 09:40:27.275246 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 09:40:27.592281 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-06 09:40:27.593283 (Thread-1): finished collecting timing info
2021-10-06 09:40:27.593283 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 09:40:27.900626 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '442af252-5737-4c1d-b9a6-09bc73ca052b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F3EBCAD00>]}
2021-10-06 09:40:27.901628 (Thread-1): 11:40:27 | 3 of 5 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.08s]
2021-10-06 09:40:27.903154 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 09:40:27.903154 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 09:40:27.903154 (Thread-1): 11:40:27 | 4 of 5 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 09:40:27.904191 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 09:40:27.904191 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 09:40:27.905473 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 09:40:27.906504 (Thread-1): finished collecting timing info
2021-10-06 09:40:27.908517 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 09:40:27.909536 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 09:40:27.909536 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 09:40:27.909536 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 09:40:28.889846 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-06 09:40:28.889846 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 09:40:28.889846 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 09:40:30.683271 (Thread-1): SQL status: SUCCESS 1 in 1.79 seconds
2021-10-06 09:40:30.685340 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 09:40:30.685340 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 09:40:30.685340 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 09:40:30.922333 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-06 09:40:30.922454 (Thread-1): finished collecting timing info
2021-10-06 09:40:30.923517 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 09:40:31.244561 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '442af252-5737-4c1d-b9a6-09bc73ca052b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F3EBB0370>]}
2021-10-06 09:40:31.245557 (Thread-1): 11:40:31 | 4 of 5 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.34s]
2021-10-06 09:40:31.246484 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 09:40:31.247483 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 09:40:31.247483 (Thread-1): 11:40:31 | 5 of 5 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 09:40:31.248478 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 09:40:31.248478 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 09:40:31.250538 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 09:40:31.251468 (Thread-1): finished collecting timing info
2021-10-06 09:40:31.253537 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 09:40:31.255453 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 09:40:31.255453 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 09:40:31.255453 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 09:40:32.498924 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-10-06 09:40:32.498924 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 09:40:32.498924 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.my_first_dbt_model
where id = 1
      );
2021-10-06 09:40:33.554284 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-10-06 09:40:33.556488 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 09:40:33.556488 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 09:40:33.556488 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 09:40:34.276476 (Thread-1): SQL status: SUCCESS 1 in 0.72 seconds
2021-10-06 09:40:34.277471 (Thread-1): finished collecting timing info
2021-10-06 09:40:34.278468 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 09:40:34.695341 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '442af252-5737-4c1d-b9a6-09bc73ca052b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F3EC2BA60>]}
2021-10-06 09:40:34.695341 (Thread-1): 11:40:34 | 5 of 5 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 3.45s]
2021-10-06 09:40:34.696264 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 09:40:34.698257 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 09:40:34.698257 (MainThread): Using snowflake connection "master".
2021-10-06 09:40:34.698257 (MainThread): On master: BEGIN
2021-10-06 09:40:34.698257 (MainThread): Opening a new connection, currently in state closed
2021-10-06 09:40:37.193351 (MainThread): SQL status: SUCCESS 1 in 2.50 seconds
2021-10-06 09:40:37.193351 (MainThread): On master: COMMIT
2021-10-06 09:40:37.193351 (MainThread): Using snowflake connection "master".
2021-10-06 09:40:37.193351 (MainThread): On master: COMMIT
2021-10-06 09:40:37.451293 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-06 09:40:37.451293 (MainThread): On master: Close
2021-10-06 09:40:37.838535 (MainThread): 11:40:37 | 
2021-10-06 09:40:37.839746 (MainThread): 11:40:37 | Finished running 4 table models, 1 incremental model in 22.91s.
2021-10-06 09:40:37.840745 (MainThread): Connection 'master' was properly closed.
2021-10-06 09:40:37.840745 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 09:40:37.840745 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 09:40:37.840745 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 09:40:37.852707 (MainThread): 
2021-10-06 09:40:37.852707 (MainThread): Completed successfully
2021-10-06 09:40:37.853701 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-10-06 09:40:37.854697 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F3EBEB100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F3EBEB4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F3EBB6B20>]}
2021-10-06 09:40:37.854697 (MainThread): Flushing usage events
2021-10-06 10:02:06.067383 (MainThread): Running with dbt=0.20.2
2021-10-06 10:02:06.595242 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 10:02:06.595242 (MainThread): Tracking: tracking
2021-10-06 10:02:06.596238 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E4943DC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E4A96C100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E4A96C670>]}
2021-10-06 10:02:06.601221 (MainThread): Partial parsing not enabled
2021-10-06 10:02:06.612375 (MainThread): Parsing macros\adapters.sql
2021-10-06 10:02:06.630238 (MainThread): Parsing macros\catalog.sql
2021-10-06 10:02:06.631235 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 10:02:06.637515 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 10:02:06.638581 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 10:02:06.640581 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 10:02:06.641503 (MainThread): Parsing macros\core.sql
2021-10-06 10:02:06.643564 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 10:02:06.670653 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 10:02:06.675636 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 10:02:06.676633 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 10:02:06.677630 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 10:02:06.678626 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 10:02:06.679623 (MainThread): Parsing macros\etc\query.sql
2021-10-06 10:02:06.679623 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 10:02:06.685727 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 10:02:06.689713 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 10:02:06.697687 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 10:02:06.698684 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 10:02:06.702670 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 10:02:06.717352 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 10:02:06.737407 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 10:02:06.738405 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 10:02:06.748488 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 10:02:06.752475 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 10:02:06.755465 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 10:02:06.759452 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 10:02:06.760520 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 10:02:06.761730 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 10:02:06.761730 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 10:02:06.863934 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:02:06.868918 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:02:06.874028 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:02:06.876021 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:02:06.878015 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:02:06.895086 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:02:06.896083 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:02:06.897079 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:02:06.898076 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:02:06.900069 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:02:06.903059 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:02:06.937714 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:02:06.966881 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1873211-9982-4a65-bd4a-5fa7261bcde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E4A97C100>]}
2021-10-06 10:02:07.005951 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:02:07.006952 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1873211-9982-4a65-bd4a-5fa7261bcde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E4A97CA90>]}
2021-10-06 10:02:07.006952 (MainThread): Found 5 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 10:02:07.008404 (MainThread): 
2021-10-06 10:02:07.008903 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:02:07.010304 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 10:02:07.020170 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 10:02:07.020170 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 10:02:07.020170 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:02:08.476366 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.46 seconds
2021-10-06 10:02:08.479298 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 10:02:08.773484 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 10:02:08.779416 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 10:02:08.779416 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 10:02:08.779416 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 10:02:09.801939 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.02 seconds
2021-10-06 10:02:09.802935 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 10:02:10.122848 (MainThread): Using snowflake connection "master".
2021-10-06 10:02:10.122848 (MainThread): On master: BEGIN
2021-10-06 10:02:10.122848 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:02:11.286572 (MainThread): SQL status: SUCCESS 1 in 1.16 seconds
2021-10-06 10:02:11.286572 (MainThread): On master: COMMIT
2021-10-06 10:02:11.286572 (MainThread): Using snowflake connection "master".
2021-10-06 10:02:11.287528 (MainThread): On master: COMMIT
2021-10-06 10:02:11.525082 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-06 10:02:11.525082 (MainThread): On master: Close
2021-10-06 10:02:11.847754 (MainThread): 12:02:11 | Concurrency: 1 threads (target='dev')
2021-10-06 10:02:11.847754 (MainThread): 12:02:11 | 
2021-10-06 10:02:11.851692 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:02:11.851692 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:02:11.851692 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:02:11.853858 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 10:02:11.854319 (Thread-1): finished collecting timing info
2021-10-06 10:02:11.855327 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:02:11.855327 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:02:11.855327 (Thread-1): 12:02:11 | 1 of 4 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 10:02:11.855327 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:02:11.855327 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:02:11.856323 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:02:11.858319 (Thread-1): finished collecting timing info
2021-10-06 10:02:11.885120 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:02:11.887122 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:02:11.887122 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 10:02:11.887122 (Thread-1): Opening a new connection, currently in state init
2021-10-06 10:02:13.486638 (Thread-1): SQL status: SUCCESS 1 in 1.60 seconds
2021-10-06 10:02:13.486638 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:02:13.487134 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 10:02:19.009442 (Thread-1): SQL status: SUCCESS 1 in 5.52 seconds
2021-10-06 10:02:19.010454 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:02:19.010454 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:02:19.010454 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:02:19.273994 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-06 10:02:19.280790 (Thread-1): finished collecting timing info
2021-10-06 10:02:19.280790 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 10:02:19.813799 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1873211-9982-4a65-bd4a-5fa7261bcde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E4AAE6040>]}
2021-10-06 10:02:19.813799 (Thread-1): 12:02:19 | 1 of 4 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 7.96s]
2021-10-06 10:02:19.814799 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:02:19.814799 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:02:19.814799 (Thread-1): 12:02:19 | 2 of 4 START incremental model dbt.dates............................. [RUN]
2021-10-06 10:02:19.815793 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:02:19.815793 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 10:02:19.818792 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:02:19.823942 (Thread-1): finished collecting timing info
2021-10-06 10:02:19.837976 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:02:19.837976 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 10:02:19.837976 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:02:21.570525 (Thread-1): SQL status: SUCCESS 1 in 1.73 seconds
2021-10-06 10:02:21.577847 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:02:21.577847 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 10:02:21.763386 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-06 10:02:21.764468 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:02:21.764468 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:02:21.938668 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:02:21.940178 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:02:21.940178 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:02:22.113479 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:02:22.123406 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:02:22.128391 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:02:22.128391 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 10:02:22.312156 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:02:22.312156 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:02:22.312156 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 10:02:22.686565 (Thread-1): SQL status: SUCCESS 0 in 0.37 seconds
2021-10-06 10:02:22.687556 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:02:22.687556 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:02:22.687556 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:02:22.958655 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-06 10:02:22.959721 (Thread-1): finished collecting timing info
2021-10-06 10:02:22.959721 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 10:02:23.271014 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1873211-9982-4a65-bd4a-5fa7261bcde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E4ADA4940>]}
2021-10-06 10:02:23.272093 (Thread-1): 12:02:23 | 2 of 4 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.46s]
2021-10-06 10:02:23.273089 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:02:23.274084 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:02:23.274084 (Thread-1): 12:02:23 | 3 of 4 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 10:02:23.275085 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:02:23.275085 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:02:23.276078 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:02:23.278072 (Thread-1): finished collecting timing info
2021-10-06 10:02:23.280064 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:02:23.284052 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:02:23.284052 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 10:02:23.284052 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:02:24.329249 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-10-06 10:02:24.329249 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:02:24.330249 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 10:02:25.971475 (Thread-1): SQL status: SUCCESS 1 in 1.64 seconds
2021-10-06 10:02:25.972604 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:02:25.972604 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:02:25.973067 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:02:26.128240 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 10:02:26.129240 (Thread-1): finished collecting timing info
2021-10-06 10:02:26.129240 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 10:02:26.439515 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1873211-9982-4a65-bd4a-5fa7261bcde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E4ADF5700>]}
2021-10-06 10:02:26.440472 (Thread-1): 12:02:26 | 3 of 4 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.16s]
2021-10-06 10:02:26.440472 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:02:26.441476 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:02:26.441476 (Thread-1): 12:02:26 | 4 of 4 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 10:02:26.442473 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:02:26.442473 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:02:26.455095 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:02:26.457088 (Thread-1): finished collecting timing info
2021-10-06 10:02:26.460146 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:02:26.461363 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:02:26.461363 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 10:02:26.461363 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:02:27.278217 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-06 10:02:27.278217 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:02:27.278217 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (with __dbt__cte__my_first_dbt_model as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
)-- Use the `ref` function to select from other models


select *
from __dbt__cte__my_first_dbt_model
where id = 1
      );
2021-10-06 10:02:28.280850 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-06 10:02:28.281985 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:02:28.281985 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:02:28.281985 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:02:28.452546 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:02:28.452546 (Thread-1): finished collecting timing info
2021-10-06 10:02:28.453620 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 10:02:28.738207 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1873211-9982-4a65-bd4a-5fa7261bcde8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E4AE045E0>]}
2021-10-06 10:02:28.739204 (Thread-1): 12:02:28 | 4 of 4 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.30s]
2021-10-06 10:02:28.741197 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:02:28.742193 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:02:28.742193 (MainThread): Using snowflake connection "master".
2021-10-06 10:02:28.742193 (MainThread): On master: BEGIN
2021-10-06 10:02:28.742193 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:02:29.613249 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-06 10:02:29.613249 (MainThread): On master: COMMIT
2021-10-06 10:02:29.613249 (MainThread): Using snowflake connection "master".
2021-10-06 10:02:29.613249 (MainThread): On master: COMMIT
2021-10-06 10:02:29.888394 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-06 10:02:29.888394 (MainThread): On master: Close
2021-10-06 10:02:30.209032 (MainThread): 12:02:30 | 
2021-10-06 10:02:30.210006 (MainThread): 12:02:30 | Finished running 3 table models, 1 incremental model in 23.20s.
2021-10-06 10:02:30.212058 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:02:30.212340 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 10:02:30.212340 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 10:02:30.212340 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 10:02:30.228038 (MainThread): 
2021-10-06 10:02:30.228336 (MainThread): Completed successfully
2021-10-06 10:02:30.229387 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-06 10:02:30.230430 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E4AC71790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E4AC71370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E4AE045E0>]}
2021-10-06 10:02:30.231440 (MainThread): Flushing usage events
2021-10-06 10:03:38.342623 (MainThread): Running with dbt=0.20.2
2021-10-06 10:03:38.933912 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 10:03:38.933912 (MainThread): Tracking: tracking
2021-10-06 10:03:38.933912 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A28E2CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2A374C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2A3746A0>]}
2021-10-06 10:03:38.942704 (MainThread): Partial parsing not enabled
2021-10-06 10:03:38.959822 (MainThread): Parsing macros\adapters.sql
2021-10-06 10:03:38.979768 (MainThread): Parsing macros\catalog.sql
2021-10-06 10:03:38.980761 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 10:03:38.987738 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 10:03:38.988725 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 10:03:38.991716 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 10:03:38.992721 (MainThread): Parsing macros\core.sql
2021-10-06 10:03:38.994705 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 10:03:39.027411 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 10:03:39.032486 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 10:03:39.033525 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 10:03:39.034522 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 10:03:39.035519 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 10:03:39.037514 (MainThread): Parsing macros\etc\query.sql
2021-10-06 10:03:39.038509 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 10:03:39.044488 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 10:03:39.048769 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 10:03:39.058597 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 10:03:39.059715 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 10:03:39.065919 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 10:03:39.081537 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 10:03:39.100587 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 10:03:39.101574 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 10:03:39.117520 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 10:03:39.122502 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 10:03:39.126489 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 10:03:39.130476 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 10:03:39.131472 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 10:03:39.132469 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 10:03:39.133466 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 10:03:39.249276 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:03:39.254389 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:03:39.259372 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:03:39.261366 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:03:39.263359 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:03:39.279844 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:03:39.281918 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:03:39.282951 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:03:39.284944 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:03:39.288357 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:03:39.291345 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:03:39.325779 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:03:39.340654 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b7c9f2f-3df5-4ee5-a91e-9af3f699a39f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A28E2C970>]}
2021-10-06 10:03:39.363325 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:03:39.363325 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b7c9f2f-3df5-4ee5-a91e-9af3f699a39f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2A4ACC40>]}
2021-10-06 10:03:39.363325 (MainThread): Found 5 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 10:03:39.365226 (MainThread): 
2021-10-06 10:03:39.365927 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:03:39.367868 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 10:03:39.378097 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 10:03:39.378097 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 10:03:39.379095 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:03:40.897732 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.52 seconds
2021-10-06 10:03:40.900719 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 10:03:41.245205 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 10:03:41.249307 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 10:03:41.249307 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 10:03:41.249307 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 10:03:42.365161 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 1.12 seconds
2021-10-06 10:03:42.366272 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 10:03:42.689052 (MainThread): Using snowflake connection "master".
2021-10-06 10:03:42.689052 (MainThread): On master: BEGIN
2021-10-06 10:03:42.689052 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:03:43.565354 (MainThread): SQL status: SUCCESS 1 in 0.88 seconds
2021-10-06 10:03:43.566360 (MainThread): On master: COMMIT
2021-10-06 10:03:43.566360 (MainThread): Using snowflake connection "master".
2021-10-06 10:03:43.566360 (MainThread): On master: COMMIT
2021-10-06 10:03:43.855840 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-06 10:03:43.855840 (MainThread): On master: Close
2021-10-06 10:03:44.140852 (MainThread): 12:03:44 | Concurrency: 1 threads (target='dev')
2021-10-06 10:03:44.140852 (MainThread): 12:03:44 | 
2021-10-06 10:03:44.143727 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:03:44.144735 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:03:44.144735 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:03:44.146728 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 10:03:44.151336 (Thread-1): finished collecting timing info
2021-10-06 10:03:44.152352 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:03:44.152352 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:03:44.153343 (Thread-1): 12:03:44 | 1 of 4 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 10:03:44.153343 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:03:44.153343 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:03:44.154622 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:03:44.155344 (Thread-1): finished collecting timing info
2021-10-06 10:03:44.177101 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:03:44.179093 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:03:44.179093 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 10:03:44.179093 (Thread-1): Opening a new connection, currently in state init
2021-10-06 10:03:44.971951 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-06 10:03:44.973018 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:03:44.973018 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 10:03:46.528327 (Thread-1): SQL status: SUCCESS 1 in 1.56 seconds
2021-10-06 10:03:46.530188 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:03:46.530862 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:03:46.530862 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:03:47.207925 (Thread-1): SQL status: SUCCESS 1 in 0.68 seconds
2021-10-06 10:03:47.215983 (Thread-1): finished collecting timing info
2021-10-06 10:03:47.216977 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 10:03:48.510574 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b7c9f2f-3df5-4ee5-a91e-9af3f699a39f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A28F6C2E0>]}
2021-10-06 10:03:48.511570 (Thread-1): 12:03:48 | 1 of 4 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 4.36s]
2021-10-06 10:03:48.512567 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:03:48.512567 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:03:48.512567 (Thread-1): 12:03:48 | 2 of 4 START incremental model dbt.dates............................. [RUN]
2021-10-06 10:03:48.512567 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:03:48.513565 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 10:03:48.516622 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:03:48.517551 (Thread-1): finished collecting timing info
2021-10-06 10:03:48.532916 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:03:48.532916 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 10:03:48.532916 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:03:50.332021 (Thread-1): SQL status: SUCCESS 1 in 1.80 seconds
2021-10-06 10:03:50.340065 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:03:50.340065 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 10:03:50.548912 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-06 10:03:50.550547 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:03:50.550547 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:03:50.747816 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-06 10:03:50.749820 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:03:50.749820 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:03:50.908037 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 10:03:50.915998 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:03:50.916994 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:03:50.917991 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 10:03:51.096304 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:03:51.096304 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:03:51.096304 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 10:03:51.480117 (Thread-1): SQL status: SUCCESS 0 in 0.38 seconds
2021-10-06 10:03:51.481114 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:03:51.481114 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:03:51.481114 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:03:51.769097 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-06 10:03:51.771090 (Thread-1): finished collecting timing info
2021-10-06 10:03:51.771090 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 10:03:52.139417 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b7c9f2f-3df5-4ee5-a91e-9af3f699a39f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2A752DC0>]}
2021-10-06 10:03:52.139913 (Thread-1): 12:03:52 | 2 of 4 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.63s]
2021-10-06 10:03:52.139913 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:03:52.141082 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:03:52.141082 (Thread-1): 12:03:52 | 3 of 4 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 10:03:52.142093 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:03:52.142093 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:03:52.143074 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:03:52.144072 (Thread-1): finished collecting timing info
2021-10-06 10:03:52.145068 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:03:52.146065 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:03:52.147071 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 10:03:52.147071 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:03:53.279303 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2021-10-06 10:03:53.279303 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:03:53.279303 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 10:03:55.336430 (Thread-1): SQL status: SUCCESS 1 in 2.06 seconds
2021-10-06 10:03:55.337516 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:03:55.338429 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:03:55.338429 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:03:55.494819 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 10:03:55.495889 (Thread-1): finished collecting timing info
2021-10-06 10:03:55.495889 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 10:03:55.811943 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b7c9f2f-3df5-4ee5-a91e-9af3f699a39f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2A7E3670>]}
2021-10-06 10:03:55.812935 (Thread-1): 12:03:55 | 3 of 4 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.67s]
2021-10-06 10:03:55.812935 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:03:55.812935 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:03:55.812935 (Thread-1): 12:03:55 | 4 of 4 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 10:03:55.813933 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:03:55.813933 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:03:55.820086 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:03:55.824067 (Thread-1): finished collecting timing info
2021-10-06 10:03:55.826054 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:03:55.832249 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:03:55.832249 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 10:03:55.832249 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:03:56.621957 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-06 10:03:56.621957 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:03:56.621957 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (with __dbt__cte__my_first_dbt_model as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
)-- Use the `ref` function to select from other models


select *
from __dbt__cte__my_first_dbt_model
where id = 1
      );
2021-10-06 10:03:57.654044 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-10-06 10:03:57.655160 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:03:57.655160 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:03:57.655160 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:03:57.820948 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:03:57.821948 (Thread-1): finished collecting timing info
2021-10-06 10:03:57.821948 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 10:03:58.117006 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b7c9f2f-3df5-4ee5-a91e-9af3f699a39f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2A3F33A0>]}
2021-10-06 10:03:58.117006 (Thread-1): 12:03:58 | 4 of 4 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.30s]
2021-10-06 10:03:58.118002 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:03:58.119758 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:03:58.120040 (MainThread): Using snowflake connection "master".
2021-10-06 10:03:58.120040 (MainThread): On master: BEGIN
2021-10-06 10:03:58.120040 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:03:58.918035 (MainThread): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-06 10:03:58.919101 (MainThread): On master: COMMIT
2021-10-06 10:03:58.919101 (MainThread): Using snowflake connection "master".
2021-10-06 10:03:58.919101 (MainThread): On master: COMMIT
2021-10-06 10:03:59.168424 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-06 10:03:59.168424 (MainThread): On master: Close
2021-10-06 10:03:59.461506 (MainThread): 12:03:59 | 
2021-10-06 10:03:59.461506 (MainThread): 12:03:59 | Finished running 3 table models, 1 incremental model in 20.09s.
2021-10-06 10:03:59.463499 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:03:59.463499 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 10:03:59.463499 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 10:03:59.463499 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 10:03:59.478677 (MainThread): 
2021-10-06 10:03:59.478677 (MainThread): Completed successfully
2021-10-06 10:03:59.479659 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-10-06 10:03:59.480631 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2A7953D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2A75CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2A75C100>]}
2021-10-06 10:03:59.480631 (MainThread): Flushing usage events
2021-10-06 10:18:24.945069 (MainThread): Running with dbt=0.20.2
2021-10-06 10:18:25.439583 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 10:18:25.440590 (MainThread): Tracking: tracking
2021-10-06 10:18:25.440590 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B44BBE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B5A046D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B5A041C0>]}
2021-10-06 10:18:25.446570 (MainThread): Partial parsing not enabled
2021-10-06 10:18:25.457607 (MainThread): Parsing macros\adapters.sql
2021-10-06 10:18:25.477249 (MainThread): Parsing macros\catalog.sql
2021-10-06 10:18:25.478246 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 10:18:25.484543 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 10:18:25.485687 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 10:18:25.488705 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 10:18:25.488705 (MainThread): Parsing macros\core.sql
2021-10-06 10:18:25.491707 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 10:18:25.521549 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 10:18:25.526548 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 10:18:25.527545 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 10:18:25.528526 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 10:18:25.529532 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 10:18:25.530514 (MainThread): Parsing macros\etc\query.sql
2021-10-06 10:18:25.530514 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 10:18:25.536495 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 10:18:25.540485 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 10:18:25.549382 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 10:18:25.550379 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 10:18:25.554365 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 10:18:25.566325 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 10:18:25.584419 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 10:18:25.585416 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 10:18:25.595381 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 10:18:25.599368 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 10:18:25.601361 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 10:18:25.605348 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 10:18:25.606345 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 10:18:25.607341 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 10:18:25.608338 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 10:18:25.706977 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:18:25.711952 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:18:25.716945 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:18:25.718938 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:18:25.720924 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:18:25.722156 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:18:25.739167 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:18:25.740173 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:18:25.742158 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:18:25.743162 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:18:25.771064 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:18:25.774052 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:18:25.777059 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:18:25.791922 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12b401da-7183-4c11-8e1d-d22939c1c8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B5A53B80>]}
2021-10-06 10:18:25.814542 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:18:25.815038 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12b401da-7183-4c11-8e1d-d22939c1c8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B44BBD90>]}
2021-10-06 10:18:25.815038 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 10:18:25.816119 (MainThread): 
2021-10-06 10:18:25.817039 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:18:25.819033 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 10:18:25.827333 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 10:18:25.827333 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 10:18:25.827333 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:18:27.490003 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.66 seconds
2021-10-06 10:18:27.493986 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 10:18:27.802517 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 10:18:27.813496 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 10:18:27.813496 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 10:18:27.813496 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 10:18:28.643073 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.83 seconds
2021-10-06 10:18:28.645303 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 10:18:28.967493 (MainThread): Using snowflake connection "master".
2021-10-06 10:18:28.967493 (MainThread): On master: BEGIN
2021-10-06 10:18:28.967493 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:18:29.785382 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-06 10:18:29.786376 (MainThread): On master: COMMIT
2021-10-06 10:18:29.786376 (MainThread): Using snowflake connection "master".
2021-10-06 10:18:29.786376 (MainThread): On master: COMMIT
2021-10-06 10:18:30.045031 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-06 10:18:30.045031 (MainThread): On master: Close
2021-10-06 10:18:30.345786 (MainThread): 12:18:30 | Concurrency: 1 threads (target='dev')
2021-10-06 10:18:30.346431 (MainThread): 12:18:30 | 
2021-10-06 10:18:30.351452 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:18:30.352526 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:18:30.352526 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:18:30.356467 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 10:18:30.357703 (Thread-1): finished collecting timing info
2021-10-06 10:18:30.357703 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:18:30.357703 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:18:30.357703 (Thread-1): 12:18:30 | 1 of 5 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 10:18:30.358707 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:18:30.358707 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:18:30.359705 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:18:30.360702 (Thread-1): finished collecting timing info
2021-10-06 10:18:30.377054 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:18:30.378907 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:18:30.378907 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 10:18:30.378907 (Thread-1): Opening a new connection, currently in state init
2021-10-06 10:18:31.249163 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-06 10:18:31.249163 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:18:31.249163 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 10:18:34.299865 (Thread-1): SQL status: SUCCESS 1 in 3.05 seconds
2021-10-06 10:18:34.300889 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:18:34.301889 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:18:34.301889 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:18:34.463539 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 10:18:34.470519 (Thread-1): finished collecting timing info
2021-10-06 10:18:34.470519 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 10:18:34.760381 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12b401da-7183-4c11-8e1d-d22939c1c8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B5AFD0D0>]}
2021-10-06 10:18:34.761363 (Thread-1): 12:18:34 | 1 of 5 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 4.40s]
2021-10-06 10:18:34.762896 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:18:34.762896 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:18:34.762896 (Thread-1): 12:18:34 | 2 of 5 START incremental model dbt.dates............................. [RUN]
2021-10-06 10:18:34.764411 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:18:34.764411 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 10:18:34.773507 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:18:34.775066 (Thread-1): finished collecting timing info
2021-10-06 10:18:34.791532 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:18:34.791532 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 10:18:34.791532 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:18:37.005920 (Thread-1): SQL status: SUCCESS 1 in 2.21 seconds
2021-10-06 10:18:37.013900 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:18:37.013900 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 10:18:37.282982 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-06 10:18:37.285194 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:18:37.285194 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:18:37.462422 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:18:37.466407 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:18:37.466407 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:18:37.643317 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:18:37.652360 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:18:37.653286 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:18:37.653286 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 10:18:37.958443 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-10-06 10:18:37.959429 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:18:37.959429 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 10:18:38.375010 (Thread-1): SQL status: SUCCESS 0 in 0.42 seconds
2021-10-06 10:18:38.377009 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:18:38.377009 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:18:38.377932 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:18:38.703630 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-06 10:18:38.704644 (Thread-1): finished collecting timing info
2021-10-06 10:18:38.704644 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 10:18:39.142219 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12b401da-7183-4c11-8e1d-d22939c1c8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B5E2B070>]}
2021-10-06 10:18:39.142219 (Thread-1): 12:18:39 | 2 of 5 OK created incremental model dbt.dates........................ [SUCCESS 0 in 4.38s]
2021-10-06 10:18:39.143897 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:18:39.143897 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:18:39.143897 (Thread-1): 12:18:39 | 3 of 5 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 10:18:39.143897 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:18:39.143897 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:18:39.144896 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:18:39.147889 (Thread-1): finished collecting timing info
2021-10-06 10:18:39.149967 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:18:39.152552 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:18:39.152552 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 10:18:39.152552 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:18:40.568939 (Thread-1): SQL status: SUCCESS 1 in 1.42 seconds
2021-10-06 10:18:40.568939 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:18:40.568939 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 10:18:42.446983 (Thread-1): SQL status: SUCCESS 1 in 1.88 seconds
2021-10-06 10:18:42.448976 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:18:42.448976 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:18:42.448976 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:18:42.621896 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:18:42.623879 (Thread-1): finished collecting timing info
2021-10-06 10:18:42.623879 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 10:18:42.935417 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12b401da-7183-4c11-8e1d-d22939c1c8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B5E8F190>]}
2021-10-06 10:18:42.936414 (Thread-1): 12:18:42 | 3 of 5 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.79s]
2021-10-06 10:18:42.938135 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:18:42.938135 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-06 10:18:42.939137 (Thread-1): 12:18:42 | 4 of 5 START incremental model dbt.time.............................. [RUN]
2021-10-06 10:18:42.939735 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:18:42.939735 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-06 10:18:42.943801 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 10:18:42.944792 (Thread-1): finished collecting timing info
2021-10-06 10:18:42.946783 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 10:18:42.947712 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:18:42.947712 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-06 10:18:42.947712 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:18:43.925498 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-06 10:18:43.925498 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:18:43.925498 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND::varchar)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF100TCL"."TIME_DIM"
WHERE TIME <= current_time


      );
2021-10-06 10:18:45.328991 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-10-06 10:18:45.330585 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-06 10:18:45.330585 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:18:45.330585 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-06 10:18:45.491497 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 10:18:45.493421 (Thread-1): finished collecting timing info
2021-10-06 10:18:45.493421 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-06 10:18:45.781573 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12b401da-7183-4c11-8e1d-d22939c1c8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B5E1E910>]}
2021-10-06 10:18:45.782571 (Thread-1): 12:18:45 | 4 of 5 OK created incremental model dbt.time......................... [SUCCESS 1 in 2.84s]
2021-10-06 10:18:45.783619 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-06 10:18:45.784568 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:18:45.784568 (Thread-1): 12:18:45 | 5 of 5 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 10:18:45.786559 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:18:45.786559 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:18:45.794529 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:18:45.795525 (Thread-1): finished collecting timing info
2021-10-06 10:18:45.796522 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:18:45.797532 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:18:45.797532 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 10:18:45.798592 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:18:46.573179 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-06 10:18:46.574175 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:18:46.574175 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (with __dbt__cte__my_first_dbt_model as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
)-- Use the `ref` function to select from other models


select *
from __dbt__cte__my_first_dbt_model
where id = 1
      );
2021-10-06 10:18:47.612351 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-10-06 10:18:47.614343 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:18:47.614343 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:18:47.615340 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:18:47.784215 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:18:47.785211 (Thread-1): finished collecting timing info
2021-10-06 10:18:47.785211 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 10:18:48.094333 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12b401da-7183-4c11-8e1d-d22939c1c8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B5A862E0>]}
2021-10-06 10:18:48.095330 (Thread-1): 12:18:48 | 5 of 5 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.31s]
2021-10-06 10:18:48.096327 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:18:48.097325 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:18:48.098361 (MainThread): Using snowflake connection "master".
2021-10-06 10:18:48.098361 (MainThread): On master: BEGIN
2021-10-06 10:18:48.098361 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:18:48.943063 (MainThread): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-06 10:18:48.943063 (MainThread): On master: COMMIT
2021-10-06 10:18:48.944127 (MainThread): Using snowflake connection "master".
2021-10-06 10:18:48.944127 (MainThread): On master: COMMIT
2021-10-06 10:18:49.207877 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-06 10:18:49.208873 (MainThread): On master: Close
2021-10-06 10:18:49.550560 (MainThread): 12:18:49 | 
2021-10-06 10:18:49.550560 (MainThread): 12:18:49 | Finished running 3 table models, 2 incremental models in 23.73s.
2021-10-06 10:18:49.552483 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:18:49.552483 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 10:18:49.552483 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 10:18:49.552483 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 10:18:49.565519 (MainThread): 
2021-10-06 10:18:49.565519 (MainThread): Completed successfully
2021-10-06 10:18:49.566987 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-10-06 10:18:49.567685 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B5E19D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B5CFD310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B5CF1A90>]}
2021-10-06 10:18:49.567685 (MainThread): Flushing usage events
2021-10-06 10:29:21.240841 (MainThread): Running with dbt=0.20.2
2021-10-06 10:29:21.774884 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 10:29:21.774884 (MainThread): Tracking: tracking
2021-10-06 10:29:21.774884 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017215B3CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001721706B8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001721706B400>]}
2021-10-06 10:29:21.781036 (MainThread): Partial parsing not enabled
2021-10-06 10:29:21.791999 (MainThread): Parsing macros\adapters.sql
2021-10-06 10:29:21.810050 (MainThread): Parsing macros\catalog.sql
2021-10-06 10:29:21.811153 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 10:29:21.817285 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 10:29:21.818282 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 10:29:21.820274 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 10:29:21.821272 (MainThread): Parsing macros\core.sql
2021-10-06 10:29:21.823265 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 10:29:21.850175 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 10:29:21.855158 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 10:29:21.856155 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 10:29:21.857224 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 10:29:21.859231 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 10:29:21.861232 (MainThread): Parsing macros\etc\query.sql
2021-10-06 10:29:21.862227 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 10:29:21.868200 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 10:29:21.872188 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 10:29:21.880280 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 10:29:21.881277 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 10:29:21.886260 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 10:29:21.898226 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 10:29:21.916980 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 10:29:21.918048 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 10:29:21.928011 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 10:29:21.931998 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 10:29:21.934989 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 10:29:21.938976 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 10:29:21.939972 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 10:29:21.940972 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 10:29:21.941980 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 10:29:22.049514 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:29:22.056217 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:29:22.061189 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:29:22.064114 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:29:22.066131 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:29:22.068103 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:29:22.088148 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:29:22.091147 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:29:22.092143 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:29:22.093131 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:29:22.130077 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:29:22.132998 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:29:22.136055 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:29:22.151223 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '767e97ec-6d01-4e94-946f-d84c4c096b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017217188DF0>]}
2021-10-06 10:29:22.169815 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:29:22.169815 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '767e97ec-6d01-4e94-946f-d84c4c096b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172171887F0>]}
2021-10-06 10:29:22.169815 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 10:29:22.172190 (MainThread): 
2021-10-06 10:29:22.172399 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:29:22.175395 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 10:29:22.182371 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 10:29:22.183368 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 10:29:22.183368 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:29:24.078961 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.90 seconds
2021-10-06 10:29:24.082038 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 10:29:24.390387 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 10:29:24.394375 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 10:29:24.394375 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 10:29:24.394375 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 10:29:25.188597 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.79 seconds
2021-10-06 10:29:25.189590 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 10:29:25.474511 (MainThread): Using snowflake connection "master".
2021-10-06 10:29:25.474511 (MainThread): On master: BEGIN
2021-10-06 10:29:25.474511 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:29:26.454284 (MainThread): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-06 10:29:26.454284 (MainThread): On master: COMMIT
2021-10-06 10:29:26.455314 (MainThread): Using snowflake connection "master".
2021-10-06 10:29:26.455314 (MainThread): On master: COMMIT
2021-10-06 10:29:26.774323 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-06 10:29:26.774323 (MainThread): On master: Close
2021-10-06 10:29:27.122738 (MainThread): 12:29:27 | Concurrency: 1 threads (target='dev')
2021-10-06 10:29:27.122738 (MainThread): 12:29:27 | 
2021-10-06 10:29:27.128652 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:29:27.128652 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:29:27.128652 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:29:27.132649 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 10:29:27.134482 (Thread-1): finished collecting timing info
2021-10-06 10:29:27.134482 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:29:27.134482 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:29:27.135488 (Thread-1): 12:29:27 | 1 of 5 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 10:29:27.136505 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:29:27.136505 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:29:27.137481 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:29:27.157019 (Thread-1): finished collecting timing info
2021-10-06 10:29:27.178893 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:29:27.179583 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:29:27.179583 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 10:29:27.179583 (Thread-1): Opening a new connection, currently in state init
2021-10-06 10:29:28.233413 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-10-06 10:29:28.234409 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:29:28.234409 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 10:29:34.503543 (Thread-1): SQL status: SUCCESS 1 in 6.27 seconds
2021-10-06 10:29:34.503543 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:29:34.503543 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:29:34.504551 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:29:34.828256 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-06 10:29:34.835309 (Thread-1): finished collecting timing info
2021-10-06 10:29:34.835309 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 10:29:35.374325 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '767e97ec-6d01-4e94-946f-d84c4c096b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017217381880>]}
2021-10-06 10:29:35.374325 (Thread-1): 12:29:35 | 1 of 5 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 8.24s]
2021-10-06 10:29:35.374325 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:29:35.374325 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:29:35.375310 (Thread-1): 12:29:35 | 2 of 5 START incremental model dbt.dates............................. [RUN]
2021-10-06 10:29:35.375310 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:29:35.375310 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 10:29:35.378301 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:29:35.380294 (Thread-1): finished collecting timing info
2021-10-06 10:29:35.394234 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:29:35.394234 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 10:29:35.394234 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:29:37.318395 (Thread-1): SQL status: SUCCESS 1 in 1.92 seconds
2021-10-06 10:29:37.329343 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:29:37.329343 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 10:29:37.533294 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-06 10:29:37.536950 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:29:37.536950 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:29:37.710336 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:29:37.712331 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:29:37.712331 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:29:37.867803 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-06 10:29:37.880754 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:29:37.881749 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:29:37.881749 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 10:29:38.159920 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-06 10:29:38.159920 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:29:38.159920 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 10:29:38.580060 (Thread-1): SQL status: SUCCESS 0 in 0.42 seconds
2021-10-06 10:29:38.581055 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:29:38.581055 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:29:38.581055 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:29:38.869095 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-06 10:29:38.870092 (Thread-1): finished collecting timing info
2021-10-06 10:29:38.871084 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 10:29:39.269775 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '767e97ec-6d01-4e94-946f-d84c4c096b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017217132D30>]}
2021-10-06 10:29:39.269775 (Thread-1): 12:29:39 | 2 of 5 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.89s]
2021-10-06 10:29:39.271942 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:29:39.271942 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:29:39.271942 (Thread-1): 12:29:39 | 3 of 5 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 10:29:39.272933 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:29:39.272933 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:29:39.274926 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:29:39.276920 (Thread-1): finished collecting timing info
2021-10-06 10:29:39.277987 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:29:39.279719 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:29:39.279719 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 10:29:39.279719 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:29:40.081256 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-06 10:29:40.081256 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:29:40.081256 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 10:29:41.853239 (Thread-1): SQL status: SUCCESS 1 in 1.77 seconds
2021-10-06 10:29:41.856234 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:29:41.856234 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:29:41.856234 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:29:42.029903 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:29:42.030904 (Thread-1): finished collecting timing info
2021-10-06 10:29:42.030904 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 10:29:42.315931 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '767e97ec-6d01-4e94-946f-d84c4c096b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017217509520>]}
2021-10-06 10:29:42.316927 (Thread-1): 12:29:42 | 3 of 5 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.04s]
2021-10-06 10:29:42.317852 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:29:42.318890 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-06 10:29:42.318890 (Thread-1): 12:29:42 | 4 of 5 START incremental model dbt.time.............................. [RUN]
2021-10-06 10:29:42.319847 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:29:42.319847 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-06 10:29:42.322912 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 10:29:42.341662 (Thread-1): finished collecting timing info
2021-10-06 10:29:42.343666 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:29:42.344662 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND::varchar)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF100TCL"."TIME_DIM"
WHERE TIME <= current_time


  and t_time > (select max(t_time) from analytics.dbt.time)

      );
2021-10-06 10:29:42.344662 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:29:43.608538 (Thread-1): Snowflake query id: 019f6cb5-0601-3497-0000-00664703893d
2021-10-06 10:29:43.608538 (Thread-1): Snowflake error: 002036 (42601): SQL compilation error:
Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:29:43.608538 (Thread-1): finished collecting timing info
2021-10-06 10:29:43.609553 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-06 10:29:43.906582 (Thread-1): Database Error in model time (models\example\time.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002036 (42601): SQL compilation error:
Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model time (models\example\time.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:29:43.907612 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '767e97ec-6d01-4e94-946f-d84c4c096b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172174C6F10>]}
2021-10-06 10:29:43.907612 (Thread-1): 12:29:43 | 4 of 5 ERROR creating incremental model dbt.time..................... [ERROR in 1.59s]
2021-10-06 10:29:43.909692 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-06 10:29:43.909692 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:29:43.909692 (Thread-1): 12:29:43 | 5 of 5 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 10:29:43.910363 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:29:43.910363 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:29:43.917672 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:29:43.919527 (Thread-1): finished collecting timing info
2021-10-06 10:29:43.921528 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:29:43.922425 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:29:43.922425 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 10:29:43.923430 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:29:44.999398 (Thread-1): SQL status: SUCCESS 1 in 1.08 seconds
2021-10-06 10:29:44.999398 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:29:44.999398 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (with __dbt__cte__my_first_dbt_model as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
)-- Use the `ref` function to select from other models


select *
from __dbt__cte__my_first_dbt_model
where id = 1
      );
2021-10-06 10:29:45.921124 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2021-10-06 10:29:45.922120 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:29:45.923134 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:29:45.923134 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:29:46.084854 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 10:29:46.085895 (Thread-1): finished collecting timing info
2021-10-06 10:29:46.085895 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 10:29:46.373728 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '767e97ec-6d01-4e94-946f-d84c4c096b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017217132D30>]}
2021-10-06 10:29:46.373728 (Thread-1): 12:29:46 | 5 of 5 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.46s]
2021-10-06 10:29:46.374716 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:29:46.375712 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:29:46.375712 (MainThread): Using snowflake connection "master".
2021-10-06 10:29:46.375712 (MainThread): On master: BEGIN
2021-10-06 10:29:46.375712 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:29:47.512456 (MainThread): SQL status: SUCCESS 1 in 1.14 seconds
2021-10-06 10:29:47.512456 (MainThread): On master: COMMIT
2021-10-06 10:29:47.512456 (MainThread): Using snowflake connection "master".
2021-10-06 10:29:47.512456 (MainThread): On master: COMMIT
2021-10-06 10:29:48.157632 (MainThread): SQL status: SUCCESS 1 in 0.65 seconds
2021-10-06 10:29:48.157632 (MainThread): On master: Close
2021-10-06 10:29:49.027509 (MainThread): 12:29:49 | 
2021-10-06 10:29:49.028548 (MainThread): 12:29:49 | Finished running 3 table models, 2 incremental models in 26.86s.
2021-10-06 10:29:49.029220 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:29:49.029220 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 10:29:49.029220 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 10:29:49.029220 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 10:29:49.044887 (MainThread): 
2021-10-06 10:29:49.044887 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:29:49.046471 (MainThread): 
2021-10-06 10:29:49.046965 (MainThread): Database Error in model time (models\example\time.sql)
2021-10-06 10:29:49.047962 (MainThread):   002036 (42601): SQL compilation error:
2021-10-06 10:29:49.048574 (MainThread):   Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:29:49.048927 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-10-06 10:29:49.048927 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017217132D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001721743DD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001721743D640>]}
2021-10-06 10:29:49.048927 (MainThread): Flushing usage events
2021-10-06 10:31:19.663624 (MainThread): Running with dbt=0.20.2
2021-10-06 10:31:20.136805 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 10:31:20.136805 (MainThread): Tracking: tracking
2021-10-06 10:31:20.136805 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E8B9CEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174EA0CCD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174EA0CC400>]}
2021-10-06 10:31:20.142786 (MainThread): Partial parsing not enabled
2021-10-06 10:31:20.153748 (MainThread): Parsing macros\adapters.sql
2021-10-06 10:31:20.171162 (MainThread): Parsing macros\catalog.sql
2021-10-06 10:31:20.172168 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 10:31:20.177140 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 10:31:20.179129 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 10:31:20.181131 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 10:31:20.181131 (MainThread): Parsing macros\core.sql
2021-10-06 10:31:20.184108 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 10:31:20.211424 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 10:31:20.216408 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 10:31:20.217335 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 10:31:20.217335 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 10:31:20.218401 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 10:31:20.219448 (MainThread): Parsing macros\etc\query.sql
2021-10-06 10:31:20.220555 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 10:31:20.225538 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 10:31:20.229527 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 10:31:20.238427 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 10:31:20.239424 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 10:31:20.243410 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 10:31:20.255925 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 10:31:20.272992 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 10:31:20.273990 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 10:31:20.284059 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 10:31:20.287048 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 10:31:20.290038 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 10:31:20.294024 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 10:31:20.295022 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 10:31:20.296018 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 10:31:20.297015 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 10:31:20.392322 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:31:20.398443 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:31:20.402430 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:31:20.404427 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:31:20.406418 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:31:20.408413 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:31:20.425657 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:31:20.426654 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:31:20.427651 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:31:20.428647 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:31:20.458134 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:31:20.462120 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:31:20.464114 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:31:20.482684 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8632bc5f-8932-461f-95e1-b9dca1f85ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174EA1E8DF0>]}
2021-10-06 10:31:20.506853 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:31:20.507038 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8632bc5f-8932-461f-95e1-b9dca1f85ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174EA1E87F0>]}
2021-10-06 10:31:20.507534 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 10:31:20.509025 (MainThread): 
2021-10-06 10:31:20.509523 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:31:20.510528 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 10:31:20.518501 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 10:31:20.519498 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 10:31:20.519498 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:31:22.150506 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.63 seconds
2021-10-06 10:31:22.153532 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 10:31:22.557310 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 10:31:22.564356 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 10:31:22.564356 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 10:31:22.565362 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 10:31:23.521475 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.96 seconds
2021-10-06 10:31:23.522459 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 10:31:23.871611 (MainThread): Using snowflake connection "master".
2021-10-06 10:31:23.871611 (MainThread): On master: BEGIN
2021-10-06 10:31:23.871611 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:31:25.021686 (MainThread): SQL status: SUCCESS 1 in 1.15 seconds
2021-10-06 10:31:25.021686 (MainThread): On master: COMMIT
2021-10-06 10:31:25.021686 (MainThread): Using snowflake connection "master".
2021-10-06 10:31:25.021686 (MainThread): On master: COMMIT
2021-10-06 10:31:25.355667 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-06 10:31:25.356661 (MainThread): On master: Close
2021-10-06 10:31:25.742287 (MainThread): 12:31:25 | Concurrency: 1 threads (target='dev')
2021-10-06 10:31:25.743306 (MainThread): 12:31:25 | 
2021-10-06 10:31:25.748112 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:31:25.748112 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:31:25.749121 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:31:25.753106 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 10:31:25.755376 (Thread-1): finished collecting timing info
2021-10-06 10:31:25.756382 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:31:25.756382 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:31:25.756382 (Thread-1): 12:31:25 | 1 of 5 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 10:31:25.757377 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:31:25.757377 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:31:25.759371 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:31:25.760367 (Thread-1): finished collecting timing info
2021-10-06 10:31:25.781752 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:31:25.782748 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:31:25.782748 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 10:31:25.782748 (Thread-1): Opening a new connection, currently in state init
2021-10-06 10:31:26.934147 (Thread-1): SQL status: SUCCESS 1 in 1.15 seconds
2021-10-06 10:31:26.934147 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:31:26.935143 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 10:31:28.590454 (Thread-1): SQL status: SUCCESS 1 in 1.66 seconds
2021-10-06 10:31:28.592446 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:31:28.592446 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:31:28.592446 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:31:28.752330 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 10:31:28.762382 (Thread-1): finished collecting timing info
2021-10-06 10:31:28.763478 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 10:31:29.048204 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8632bc5f-8932-461f-95e1-b9dca1f85ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174EA0C3D60>]}
2021-10-06 10:31:29.049197 (Thread-1): 12:31:29 | 1 of 5 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.29s]
2021-10-06 10:31:29.050798 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:31:29.050798 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:31:29.050798 (Thread-1): 12:31:29 | 2 of 5 START incremental model dbt.dates............................. [RUN]
2021-10-06 10:31:29.051839 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:31:29.051839 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 10:31:29.057779 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:31:29.058783 (Thread-1): finished collecting timing info
2021-10-06 10:31:29.072301 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:31:29.072301 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 10:31:29.072301 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:31:30.432198 (Thread-1): SQL status: SUCCESS 1 in 1.36 seconds
2021-10-06 10:31:30.439358 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:31:30.439358 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 10:31:30.619233 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:31:30.623220 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:31:30.623220 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:31:30.808710 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-06 10:31:30.811703 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:31:30.811703 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:31:30.997722 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-06 10:31:31.006899 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:31:31.008859 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:31:31.008859 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 10:31:31.256945 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-06 10:31:31.256945 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:31:31.256945 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 10:31:31.660883 (Thread-1): SQL status: SUCCESS 0 in 0.40 seconds
2021-10-06 10:31:31.662857 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:31:31.662857 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:31:31.663850 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:31:32.104447 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-10-06 10:31:32.106440 (Thread-1): finished collecting timing info
2021-10-06 10:31:32.106440 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 10:31:32.441060 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8632bc5f-8932-461f-95e1-b9dca1f85ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174EA3A2220>]}
2021-10-06 10:31:32.442059 (Thread-1): 12:31:32 | 2 of 5 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.39s]
2021-10-06 10:31:32.444055 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:31:32.444055 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:31:32.444055 (Thread-1): 12:31:32 | 3 of 5 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 10:31:32.445117 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:31:32.445117 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:31:32.448217 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:31:32.449542 (Thread-1): finished collecting timing info
2021-10-06 10:31:32.451544 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:31:32.454512 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:31:32.454512 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 10:31:32.454512 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:31:33.580770 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2021-10-06 10:31:33.581771 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:31:33.581771 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 10:31:35.334686 (Thread-1): SQL status: SUCCESS 1 in 1.75 seconds
2021-10-06 10:31:35.335766 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:31:35.335766 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:31:35.335766 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:31:35.557841 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-06 10:31:35.559840 (Thread-1): finished collecting timing info
2021-10-06 10:31:35.559840 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 10:31:35.921871 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8632bc5f-8932-461f-95e1-b9dca1f85ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174EA202760>]}
2021-10-06 10:31:35.922901 (Thread-1): 12:31:35 | 3 of 5 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.48s]
2021-10-06 10:31:35.925045 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:31:35.925045 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-06 10:31:35.926053 (Thread-1): 12:31:35 | 4 of 5 START incremental model dbt.time.............................. [RUN]
2021-10-06 10:31:35.926647 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:31:35.926647 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-06 10:31:35.931705 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 10:31:35.938218 (Thread-1): finished collecting timing info
2021-10-06 10:31:35.941218 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:31:35.941218 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF100TCL"."TIME_DIM"
WHERE to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND::varchar)) <= current_time


  and t_time > (select max(t_time) from analytics.dbt.time)

      );
2021-10-06 10:31:35.941218 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:31:36.954984 (Thread-1): Snowflake query id: 019f6cb7-0601-3497-0000-0066470389a9
2021-10-06 10:31:36.954984 (Thread-1): Snowflake error: 002036 (42601): SQL compilation error:
Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:31:36.954984 (Thread-1): finished collecting timing info
2021-10-06 10:31:36.955980 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-06 10:31:37.328795 (Thread-1): Database Error in model time (models\example\time.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002036 (42601): SQL compilation error:
Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model time (models\example\time.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:31:37.331784 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8632bc5f-8932-461f-95e1-b9dca1f85ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174EA4FB070>]}
2021-10-06 10:31:37.332780 (Thread-1): 12:31:37 | 4 of 5 ERROR creating incremental model dbt.time..................... [ERROR in 1.41s]
2021-10-06 10:31:37.333778 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-06 10:31:37.333778 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:31:37.333778 (Thread-1): 12:31:37 | 5 of 5 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 10:31:37.335203 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:31:37.335203 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:31:37.343254 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:31:37.344977 (Thread-1): finished collecting timing info
2021-10-06 10:31:37.345983 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:31:37.347976 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:31:37.347976 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 10:31:37.347976 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:31:38.188694 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-06 10:31:38.188694 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:31:38.188694 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (with __dbt__cte__my_first_dbt_model as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
)-- Use the `ref` function to select from other models


select *
from __dbt__cte__my_first_dbt_model
where id = 1
      );
2021-10-06 10:31:39.200133 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-06 10:31:39.201120 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:31:39.201120 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:31:39.201120 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:31:39.361134 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 10:31:39.361696 (Thread-1): finished collecting timing info
2021-10-06 10:31:39.361696 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 10:31:39.690223 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8632bc5f-8932-461f-95e1-b9dca1f85ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174EA4C7640>]}
2021-10-06 10:31:39.691291 (Thread-1): 12:31:39 | 5 of 5 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.36s]
2021-10-06 10:35:16.350209 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:35:16.352179 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:35:16.353498 (MainThread): Using snowflake connection "master".
2021-10-06 10:35:16.353498 (MainThread): On master: BEGIN
2021-10-06 10:35:16.353498 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:35:17.716111 (MainThread): SQL status: SUCCESS 1 in 1.36 seconds
2021-10-06 10:35:17.716111 (MainThread): On master: COMMIT
2021-10-06 10:35:17.716111 (MainThread): Using snowflake connection "master".
2021-10-06 10:35:17.716111 (MainThread): On master: COMMIT
2021-10-06 10:35:17.977063 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-06 10:35:17.977244 (MainThread): On master: Close
2021-10-06 10:35:18.275839 (MainThread): 12:35:18 | 
2021-10-06 10:35:18.276845 (MainThread): 12:35:18 | Finished running 3 table models, 2 incremental models in 237.77s.
2021-10-06 10:35:18.277815 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:35:18.277815 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 10:35:18.277815 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 10:35:18.277815 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 10:35:18.292933 (MainThread): 
2021-10-06 10:35:18.293848 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:35:18.294854 (MainThread): 
2021-10-06 10:35:18.294854 (MainThread): Database Error in model time (models\example\time.sql)
2021-10-06 10:35:18.294854 (MainThread):   002036 (42601): SQL compilation error:
2021-10-06 10:35:18.295841 (MainThread):   Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:35:18.295841 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-10-06 10:35:18.295841 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174EA0C3D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174EA560A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174EA5602B0>]}
2021-10-06 10:35:18.296839 (MainThread): Flushing usage events
2021-10-06 10:35:27.551048 (MainThread): Running with dbt=0.20.2
2021-10-06 10:35:28.054486 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 10:35:28.054486 (MainThread): Tracking: tracking
2021-10-06 10:35:28.054486 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F7FCECDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0121BEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0121B400>]}
2021-10-06 10:35:28.062387 (MainThread): Partial parsing not enabled
2021-10-06 10:35:28.073350 (MainThread): Parsing macros\adapters.sql
2021-10-06 10:35:28.091509 (MainThread): Parsing macros\catalog.sql
2021-10-06 10:35:28.092507 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 10:35:28.097496 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 10:35:28.098486 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 10:35:28.100481 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 10:35:28.101476 (MainThread): Parsing macros\core.sql
2021-10-06 10:35:28.104016 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 10:35:28.131440 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 10:35:28.136600 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 10:35:28.136600 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 10:35:28.137623 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 10:35:28.138622 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 10:35:28.139616 (MainThread): Parsing macros\etc\query.sql
2021-10-06 10:35:28.140619 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 10:35:28.146604 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 10:35:28.152574 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 10:35:28.160546 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 10:35:28.162553 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 10:35:28.169450 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 10:35:28.182471 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 10:35:28.202337 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 10:35:28.203334 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 10:35:28.213389 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 10:35:28.216881 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 10:35:28.219871 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 10:35:28.222861 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 10:35:28.223858 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 10:35:28.224855 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 10:35:28.225852 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 10:35:28.324634 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:35:28.330614 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:35:28.334601 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:35:28.336594 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:35:28.339222 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:35:28.340195 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:35:28.357742 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:35:28.359732 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:35:28.360740 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:35:28.361726 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:35:28.389933 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:35:28.392923 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:35:28.395913 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:35:28.411079 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d07a463-0eef-4a5f-ae8a-efa590bee738', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F01282BE0>]}
2021-10-06 10:35:28.431027 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:35:28.431027 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d07a463-0eef-4a5f-ae8a-efa590bee738', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0129EB20>]}
2021-10-06 10:35:28.431027 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 10:35:28.433004 (MainThread): 
2021-10-06 10:35:28.433004 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:35:28.434998 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 10:35:28.442971 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 10:35:28.442971 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 10:35:28.442971 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:35:29.867567 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.42 seconds
2021-10-06 10:35:29.874541 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 10:35:30.224828 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 10:35:30.231804 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 10:35:30.231804 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 10:35:30.231804 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 10:35:31.181125 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.95 seconds
2021-10-06 10:35:31.182199 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 10:35:31.486173 (MainThread): Using snowflake connection "master".
2021-10-06 10:35:31.486173 (MainThread): On master: BEGIN
2021-10-06 10:35:31.486173 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:35:32.323863 (MainThread): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-06 10:35:32.324851 (MainThread): On master: COMMIT
2021-10-06 10:35:32.324851 (MainThread): Using snowflake connection "master".
2021-10-06 10:35:32.324851 (MainThread): On master: COMMIT
2021-10-06 10:35:32.683890 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-06 10:35:32.684949 (MainThread): On master: Close
2021-10-06 10:35:32.992288 (MainThread): 12:35:32 | Concurrency: 1 threads (target='dev')
2021-10-06 10:35:32.993116 (MainThread): 12:35:32 | 
2021-10-06 10:35:32.996182 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:35:32.996182 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:35:32.996182 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:35:32.998401 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 10:35:33.000455 (Thread-1): finished collecting timing info
2021-10-06 10:35:33.000455 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:35:33.000455 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:35:33.000455 (Thread-1): 12:35:33 | 1 of 5 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 10:35:33.001448 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:35:33.001448 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:35:33.001448 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:35:33.003444 (Thread-1): finished collecting timing info
2021-10-06 10:35:33.019563 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:35:33.021554 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:35:33.021554 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 10:35:33.021554 (Thread-1): Opening a new connection, currently in state init
2021-10-06 10:35:34.127970 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2021-10-06 10:35:34.128965 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:35:34.128965 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 10:35:35.846812 (Thread-1): SQL status: SUCCESS 1 in 1.72 seconds
2021-10-06 10:35:35.848802 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:35:35.848802 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:35:35.849806 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:35:36.049327 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-06 10:35:36.062274 (Thread-1): finished collecting timing info
2021-10-06 10:35:36.062274 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 10:35:36.378695 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d07a463-0eef-4a5f-ae8a-efa590bee738', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F01282EE0>]}
2021-10-06 10:35:36.379693 (Thread-1): 12:35:36 | 1 of 5 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.38s]
2021-10-06 10:35:36.380642 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:35:36.380642 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:35:36.381644 (Thread-1): 12:35:36 | 2 of 5 START incremental model dbt.dates............................. [RUN]
2021-10-06 10:35:36.381644 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:35:36.382641 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 10:35:36.387622 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:35:36.388620 (Thread-1): finished collecting timing info
2021-10-06 10:35:36.402353 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:35:36.402353 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 10:35:36.402353 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:35:37.774476 (Thread-1): SQL status: SUCCESS 1 in 1.37 seconds
2021-10-06 10:35:37.786434 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:35:37.786434 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 10:35:37.964555 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:35:37.968540 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:35:37.968540 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:35:38.139927 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:35:38.141971 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:35:38.141971 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:35:38.312542 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:35:38.323502 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:35:38.325408 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:35:38.325408 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 10:35:38.636000 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-10-06 10:35:38.636994 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:35:38.636994 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 10:35:39.132838 (Thread-1): SQL status: SUCCESS 0 in 0.50 seconds
2021-10-06 10:35:39.134830 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:35:39.135827 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:35:39.135827 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:35:39.492611 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-06 10:35:39.494671 (Thread-1): finished collecting timing info
2021-10-06 10:35:39.494671 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 10:35:39.849750 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d07a463-0eef-4a5f-ae8a-efa590bee738', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F015E06A0>]}
2021-10-06 10:35:39.849750 (Thread-1): 12:35:39 | 2 of 5 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.47s]
2021-10-06 10:35:39.852041 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:35:39.852566 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:35:39.852566 (Thread-1): 12:35:39 | 3 of 5 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 10:35:39.853839 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:35:39.853839 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:35:39.856827 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:35:39.858562 (Thread-1): finished collecting timing info
2021-10-06 10:35:39.860614 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:35:39.862759 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:35:39.862759 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 10:35:39.862759 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:35:40.683848 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-06 10:35:40.684843 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:35:40.684843 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 10:35:42.192813 (Thread-1): SQL status: SUCCESS 1 in 1.51 seconds
2021-10-06 10:35:42.193809 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:35:42.194806 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:35:42.194806 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:35:42.377211 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:35:42.379232 (Thread-1): finished collecting timing info
2021-10-06 10:35:42.379232 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 10:35:42.802970 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d07a463-0eef-4a5f-ae8a-efa590bee738', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F016BBE20>]}
2021-10-06 10:35:42.803967 (Thread-1): 12:35:42 | 3 of 5 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.95s]
2021-10-06 10:35:42.805892 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:35:42.805892 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-06 10:35:42.805892 (Thread-1): 12:35:42 | 4 of 5 START incremental model dbt.time.............................. [RUN]
2021-10-06 10:35:42.806889 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:35:42.806889 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-06 10:35:42.808958 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 10:35:42.815854 (Thread-1): finished collecting timing info
2021-10-06 10:35:42.818917 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:35:42.818917 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF100TCL"."TIME_DIM"
WHERE to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) <= current_time


  and t_time > (select max(t_time) from analytics.dbt.time)

      );
2021-10-06 10:35:42.818917 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:35:44.123716 (Thread-1): Snowflake query id: 019f6cbb-0601-33d0-0000-006647037a21
2021-10-06 10:35:44.123716 (Thread-1): Snowflake error: 002036 (42601): SQL compilation error:
Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:35:44.123716 (Thread-1): finished collecting timing info
2021-10-06 10:35:44.123716 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-06 10:35:44.518996 (Thread-1): Database Error in model time (models\example\time.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002036 (42601): SQL compilation error:
Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model time (models\example\time.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:35:44.520990 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d07a463-0eef-4a5f-ae8a-efa590bee738', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0152D280>]}
2021-10-06 10:35:44.520990 (Thread-1): 12:35:44 | 4 of 5 ERROR creating incremental model dbt.time..................... [ERROR in 1.72s]
2021-10-06 10:35:44.522493 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-06 10:35:44.522493 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:35:44.522493 (Thread-1): 12:35:44 | 5 of 5 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 10:35:44.523143 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:35:44.523143 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:35:44.528423 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:35:44.530088 (Thread-1): finished collecting timing info
2021-10-06 10:35:44.531094 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:35:44.532962 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:35:44.532962 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 10:35:44.532962 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:35:45.555922 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-06 10:35:45.555922 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:35:45.556910 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (with __dbt__cte__my_first_dbt_model as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
)-- Use the `ref` function to select from other models


select *
from __dbt__cte__my_first_dbt_model
where id = 1
      );
2021-10-06 10:35:46.747220 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2021-10-06 10:35:46.749200 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:35:46.749200 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:35:46.750201 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:35:46.932951 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:35:46.934938 (Thread-1): finished collecting timing info
2021-10-06 10:35:46.934938 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 10:35:47.246108 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d07a463-0eef-4a5f-ae8a-efa590bee738', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F015E0AF0>]}
2021-10-06 10:35:47.246108 (Thread-1): 12:35:47 | 5 of 5 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.72s]
2021-10-06 10:35:47.247204 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:35:47.249212 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:35:47.249212 (MainThread): Using snowflake connection "master".
2021-10-06 10:35:47.249212 (MainThread): On master: BEGIN
2021-10-06 10:35:47.249212 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:35:48.350163 (MainThread): SQL status: SUCCESS 1 in 1.10 seconds
2021-10-06 10:35:48.350163 (MainThread): On master: COMMIT
2021-10-06 10:35:48.350163 (MainThread): Using snowflake connection "master".
2021-10-06 10:35:48.351160 (MainThread): On master: COMMIT
2021-10-06 10:35:48.689912 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-10-06 10:35:48.689912 (MainThread): On master: Close
2021-10-06 10:35:48.997102 (MainThread): 12:35:48 | 
2021-10-06 10:35:48.998102 (MainThread): 12:35:48 | Finished running 3 table models, 2 incremental models in 20.56s.
2021-10-06 10:35:48.999155 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:35:49.000091 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 10:35:49.000091 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 10:35:49.000091 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 10:35:49.014710 (MainThread): 
2021-10-06 10:35:49.014710 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:35:49.015707 (MainThread): 
2021-10-06 10:35:49.017582 (MainThread): Database Error in model time (models\example\time.sql)
2021-10-06 10:35:49.017865 (MainThread):   002036 (42601): SQL compilation error:
2021-10-06 10:35:49.018361 (MainThread):   Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:35:49.018361 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-10-06 10:35:49.018361 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F016432E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F01203940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0131E5E0>]}
2021-10-06 10:35:49.019370 (MainThread): Flushing usage events
2021-10-06 10:37:13.267505 (MainThread): Running with dbt=0.20.2
2021-10-06 10:37:13.763148 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 10:37:13.763148 (MainThread): Tracking: tracking
2021-10-06 10:37:13.763148 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002084C8ECDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002084DE1C5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002084DE1C400>]}
2021-10-06 10:37:13.769129 (MainThread): Partial parsing not enabled
2021-10-06 10:37:13.780698 (MainThread): Parsing macros\adapters.sql
2021-10-06 10:37:13.797811 (MainThread): Parsing macros\catalog.sql
2021-10-06 10:37:13.798806 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 10:37:13.804794 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 10:37:13.805967 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 10:37:13.809793 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 10:37:13.810291 (MainThread): Parsing macros\core.sql
2021-10-06 10:37:13.813005 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 10:37:13.848633 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 10:37:13.854731 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 10:37:13.855728 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 10:37:13.856724 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 10:37:13.857721 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 10:37:13.857721 (MainThread): Parsing macros\etc\query.sql
2021-10-06 10:37:13.858717 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 10:37:13.864697 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 10:37:13.867866 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 10:37:13.875888 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 10:37:13.876883 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 10:37:13.881865 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 10:37:13.893750 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 10:37:13.910802 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 10:37:13.911799 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 10:37:13.921765 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 10:37:13.924755 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 10:37:13.927745 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 10:37:13.931809 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 10:37:13.932806 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 10:37:13.933803 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 10:37:13.934800 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 10:37:14.031569 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:37:14.036549 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:37:14.041825 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:37:14.043817 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:37:14.045812 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:37:14.046806 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:37:14.065741 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:37:14.066743 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:37:14.067736 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:37:14.068731 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:37:14.098232 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:37:14.102211 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:37:14.104136 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:37:14.121618 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63bd3ff7-20c0-48b9-b3b8-16dd48f42765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002084DF38DF0>]}
2021-10-06 10:37:14.143440 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:37:14.144438 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63bd3ff7-20c0-48b9-b3b8-16dd48f42765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002084DF387F0>]}
2021-10-06 10:37:14.144438 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 10:37:14.145435 (MainThread): 
2021-10-06 10:37:14.146431 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:37:14.148042 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 10:37:14.157127 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 10:37:14.157127 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 10:37:14.157127 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:37:15.746066 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.59 seconds
2021-10-06 10:37:15.751046 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 10:37:16.103620 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 10:37:16.111664 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 10:37:16.111664 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 10:37:16.111664 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 10:37:16.871653 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.76 seconds
2021-10-06 10:37:16.872649 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 10:37:17.178526 (MainThread): Using snowflake connection "master".
2021-10-06 10:37:17.178526 (MainThread): On master: BEGIN
2021-10-06 10:37:17.178526 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:37:18.277032 (MainThread): SQL status: SUCCESS 1 in 1.10 seconds
2021-10-06 10:37:18.278028 (MainThread): On master: COMMIT
2021-10-06 10:37:18.278028 (MainThread): Using snowflake connection "master".
2021-10-06 10:37:18.278028 (MainThread): On master: COMMIT
2021-10-06 10:37:18.630431 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-10-06 10:37:18.630431 (MainThread): On master: Close
2021-10-06 10:37:18.925911 (MainThread): 12:37:18 | Concurrency: 1 threads (target='dev')
2021-10-06 10:37:18.925911 (MainThread): 12:37:18 | 
2021-10-06 10:37:18.931089 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:37:18.931089 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:37:18.931089 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:37:18.934090 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 10:37:18.937242 (Thread-1): finished collecting timing info
2021-10-06 10:37:18.937242 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:37:18.937242 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:37:18.937242 (Thread-1): 12:37:18 | 1 of 5 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 10:37:18.938238 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:37:18.938238 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:37:18.940072 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:37:18.954001 (Thread-1): finished collecting timing info
2021-10-06 10:37:18.973678 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:37:18.975239 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:37:18.975239 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 10:37:18.975239 (Thread-1): Opening a new connection, currently in state init
2021-10-06 10:37:19.866003 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-10-06 10:37:19.866003 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:37:19.866003 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 10:37:21.323992 (Thread-1): SQL status: SUCCESS 1 in 1.46 seconds
2021-10-06 10:37:21.325971 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:37:21.325971 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:37:21.326967 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:37:21.499037 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:37:21.507480 (Thread-1): finished collecting timing info
2021-10-06 10:37:21.508477 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 10:37:21.902916 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63bd3ff7-20c0-48b9-b3b8-16dd48f42765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002084DF2ABB0>]}
2021-10-06 10:37:21.902916 (Thread-1): 12:37:21 | 1 of 5 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.96s]
2021-10-06 10:37:21.905465 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:37:21.905465 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:37:21.905904 (Thread-1): 12:37:21 | 2 of 5 START incremental model dbt.dates............................. [RUN]
2021-10-06 10:37:21.905904 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:37:21.905904 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 10:37:21.911964 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:37:21.913605 (Thread-1): finished collecting timing info
2021-10-06 10:37:21.927565 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:37:21.927565 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 10:37:21.927565 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:37:23.335356 (Thread-1): SQL status: SUCCESS 1 in 1.41 seconds
2021-10-06 10:37:23.342331 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:37:23.342331 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 10:37:23.546959 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-06 10:37:23.548960 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:37:23.548960 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:37:23.715340 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:37:23.717419 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:37:23.717419 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:37:23.880892 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 10:37:23.890407 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:37:23.892071 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:37:23.892071 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 10:37:24.416105 (Thread-1): SQL status: SUCCESS 1 in 0.52 seconds
2021-10-06 10:37:24.416105 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:37:24.416105 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 10:37:24.804493 (Thread-1): SQL status: SUCCESS 0 in 0.39 seconds
2021-10-06 10:37:24.805490 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:37:24.806490 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:37:24.806490 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:37:25.219830 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-10-06 10:37:25.219830 (Thread-1): finished collecting timing info
2021-10-06 10:37:25.219830 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 10:37:25.567165 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63bd3ff7-20c0-48b9-b3b8-16dd48f42765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002084E127580>]}
2021-10-06 10:37:25.568162 (Thread-1): 12:37:25 | 2 of 5 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.66s]
2021-10-06 10:37:25.569158 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:37:25.569158 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:37:25.570217 (Thread-1): 12:37:25 | 3 of 5 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 10:37:25.570217 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:37:25.571233 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:37:25.572229 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:37:25.575219 (Thread-1): finished collecting timing info
2021-10-06 10:37:25.576216 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:37:25.578244 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:37:25.578244 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 10:37:25.578244 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:37:26.595376 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-06 10:37:26.595376 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:37:26.595376 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 10:37:28.250838 (Thread-1): SQL status: SUCCESS 1 in 1.65 seconds
2021-10-06 10:37:28.251834 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:37:28.252831 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:37:28.252831 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:37:28.449768 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-06 10:37:28.450766 (Thread-1): finished collecting timing info
2021-10-06 10:37:28.450766 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 10:37:28.752673 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63bd3ff7-20c0-48b9-b3b8-16dd48f42765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002084E127580>]}
2021-10-06 10:37:28.752673 (Thread-1): 12:37:28 | 3 of 5 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.18s]
2021-10-06 10:37:28.755032 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:37:28.755032 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-06 10:37:28.755032 (Thread-1): 12:37:28 | 4 of 5 START incremental model dbt.time.............................. [RUN]
2021-10-06 10:37:28.756039 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:37:28.757034 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-06 10:37:28.760089 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 10:37:28.765148 (Thread-1): finished collecting timing info
2021-10-06 10:37:28.767137 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:37:28.768210 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF100TCL"."TIME_DIM"
WHERE to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) <= current_time


  and t_time > (select max(t_time) from analytics.dbt.time)

      );
2021-10-06 10:37:28.768210 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:37:29.968135 (Thread-1): Snowflake query id: 019f6cbd-0601-33d0-0000-006647037a4d
2021-10-06 10:37:29.968135 (Thread-1): Snowflake error: 002036 (42601): SQL compilation error:
Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:37:29.968135 (Thread-1): finished collecting timing info
2021-10-06 10:37:29.968135 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-06 10:37:30.317767 (Thread-1): Database Error in model time (models\example\time.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002036 (42601): SQL compilation error:
Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model time (models\example\time.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:37:30.319762 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63bd3ff7-20c0-48b9-b3b8-16dd48f42765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002084E0E2940>]}
2021-10-06 10:37:30.320757 (Thread-1): 12:37:30 | 4 of 5 ERROR creating incremental model dbt.time..................... [ERROR in 1.56s]
2021-10-06 10:37:30.321702 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-06 10:37:30.321702 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:37:30.321702 (Thread-1): 12:37:30 | 5 of 5 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 10:37:30.322468 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:37:30.322468 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:37:30.329533 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:37:30.331306 (Thread-1): finished collecting timing info
2021-10-06 10:37:30.333307 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:37:30.334075 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:37:30.334075 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 10:37:30.334075 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:37:31.347826 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-06 10:37:31.347826 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:37:31.347826 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (with __dbt__cte__my_first_dbt_model as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
)-- Use the `ref` function to select from other models


select *
from __dbt__cte__my_first_dbt_model
where id = 1
      );
2021-10-06 10:37:32.237466 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-10-06 10:37:32.239457 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:37:32.239457 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:37:32.239457 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:37:32.437184 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-06 10:37:32.439176 (Thread-1): finished collecting timing info
2021-10-06 10:37:32.439176 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 10:37:32.775190 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63bd3ff7-20c0-48b9-b3b8-16dd48f42765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002084E122FA0>]}
2021-10-06 10:37:32.775190 (Thread-1): 12:37:32 | 5 of 5 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.45s]
2021-10-06 10:37:32.776688 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:37:32.777776 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:37:32.777776 (MainThread): Using snowflake connection "master".
2021-10-06 10:37:32.777776 (MainThread): On master: BEGIN
2021-10-06 10:37:32.777776 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:37:33.541000 (MainThread): SQL status: SUCCESS 1 in 0.76 seconds
2021-10-06 10:37:33.541995 (MainThread): On master: COMMIT
2021-10-06 10:37:33.541995 (MainThread): Using snowflake connection "master".
2021-10-06 10:37:33.541995 (MainThread): On master: COMMIT
2021-10-06 10:37:33.805579 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-06 10:37:33.805579 (MainThread): On master: Close
2021-10-06 10:37:34.097695 (MainThread): 12:37:34 | 
2021-10-06 10:37:34.098622 (MainThread): 12:37:34 | Finished running 3 table models, 2 incremental models in 19.95s.
2021-10-06 10:37:34.099615 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:37:34.099615 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 10:37:34.099615 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 10:37:34.099615 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 10:37:34.115791 (MainThread): 
2021-10-06 10:37:34.116803 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:37:34.118271 (MainThread): 
2021-10-06 10:37:34.118271 (MainThread): Database Error in model time (models\example\time.sql)
2021-10-06 10:37:34.119430 (MainThread):   002036 (42601): SQL compilation error:
2021-10-06 10:37:34.119678 (MainThread):   Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:37:34.120054 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-10-06 10:37:34.120054 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002084E12DB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002084E1093D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002084E109580>]}
2021-10-06 10:37:34.120054 (MainThread): Flushing usage events
2021-10-06 10:42:32.757996 (MainThread): Running with dbt=0.20.2
2021-10-06 10:42:33.261876 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 10:42:33.262873 (MainThread): Tracking: tracking
2021-10-06 10:42:33.262873 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CBD2CDE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CBE814250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CBE814760>]}
2021-10-06 10:42:33.268853 (MainThread): Partial parsing not enabled
2021-10-06 10:42:33.279817 (MainThread): Parsing macros\adapters.sql
2021-10-06 10:42:33.298835 (MainThread): Parsing macros\catalog.sql
2021-10-06 10:42:33.299917 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 10:42:33.304960 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 10:42:33.306955 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 10:42:33.308947 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 10:42:33.309945 (MainThread): Parsing macros\core.sql
2021-10-06 10:42:33.311937 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 10:42:33.347619 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 10:42:33.352714 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 10:42:33.353712 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 10:42:33.354708 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 10:42:33.355705 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 10:42:33.356701 (MainThread): Parsing macros\etc\query.sql
2021-10-06 10:42:33.357697 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 10:42:33.364172 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 10:42:33.368234 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 10:42:33.376201 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 10:42:33.377202 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 10:42:33.381811 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 10:42:33.395363 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 10:42:33.412569 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 10:42:33.413562 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 10:42:33.423529 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 10:42:33.427676 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 10:42:33.430662 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 10:42:33.434650 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 10:42:33.435645 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 10:42:33.435645 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 10:42:33.437570 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 10:42:33.537278 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:42:33.543259 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:42:33.547246 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:42:33.549341 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:42:33.551369 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:42:33.553362 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:42:33.571300 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:42:33.573294 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:42:33.574291 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:42:33.575287 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:42:33.605822 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:42:33.608812 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:42:33.610805 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:42:33.628048 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20bd2885-2e55-4f2b-aa6f-8431674c130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CBE872220>]}
2021-10-06 10:42:33.656768 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:42:33.657688 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20bd2885-2e55-4f2b-aa6f-8431674c130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CBD2CDEE0>]}
2021-10-06 10:42:33.657688 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 10:42:33.658683 (MainThread): 
2021-10-06 10:42:33.659680 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:42:33.660677 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 10:42:33.668230 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 10:42:33.668230 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 10:42:33.669227 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:42:35.577750 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.91 seconds
2021-10-06 10:42:35.582740 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 10:42:35.910654 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 10:42:35.915639 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 10:42:35.915639 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 10:42:35.915639 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 10:42:37.051942 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.14 seconds
2021-10-06 10:42:37.053487 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 10:42:37.430667 (MainThread): Using snowflake connection "master".
2021-10-06 10:42:37.430667 (MainThread): On master: BEGIN
2021-10-06 10:42:37.430667 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:42:38.213791 (MainThread): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-06 10:42:38.214791 (MainThread): On master: COMMIT
2021-10-06 10:42:38.214791 (MainThread): Using snowflake connection "master".
2021-10-06 10:42:38.214791 (MainThread): On master: COMMIT
2021-10-06 10:42:38.578829 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-06 10:42:38.579824 (MainThread): On master: Close
2021-10-06 10:42:38.884735 (MainThread): 12:42:38 | Concurrency: 1 threads (target='dev')
2021-10-06 10:42:38.885520 (MainThread): 12:42:38 | 
2021-10-06 10:42:38.889172 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:42:38.890243 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:42:38.890243 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:42:38.892234 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 10:42:38.894451 (Thread-1): finished collecting timing info
2021-10-06 10:42:38.894948 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:42:38.894948 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:42:38.894948 (Thread-1): 12:42:38 | 1 of 5 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 10:42:38.895954 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:42:38.895954 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:42:38.896952 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:42:38.898946 (Thread-1): finished collecting timing info
2021-10-06 10:42:38.917096 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:42:38.919092 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:42:38.919092 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 10:42:38.919092 (Thread-1): Opening a new connection, currently in state init
2021-10-06 10:42:39.731778 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-06 10:42:39.732772 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:42:39.732772 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 10:42:41.072076 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-10-06 10:42:41.074074 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:42:41.074074 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:42:41.074074 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:42:41.242157 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:42:41.254193 (Thread-1): finished collecting timing info
2021-10-06 10:42:41.254193 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 10:42:41.555762 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20bd2885-2e55-4f2b-aa6f-8431674c130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CBE7E38E0>]}
2021-10-06 10:42:41.556758 (Thread-1): 12:42:41 | 1 of 5 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.66s]
2021-10-06 10:42:41.558333 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:42:41.558333 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:42:41.558333 (Thread-1): 12:42:41 | 2 of 5 START incremental model dbt.dates............................. [RUN]
2021-10-06 10:42:41.559475 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:42:41.559475 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 10:42:41.565536 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:42:41.566586 (Thread-1): finished collecting timing info
2021-10-06 10:42:41.580558 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:42:41.580558 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 10:42:41.580558 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:42:42.838900 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-10-06 10:42:42.848866 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:42:42.848866 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 10:42:43.022748 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:42:43.026810 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:42:43.026810 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:42:43.188496 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 10:42:43.191566 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:42:43.191566 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:42:43.388220 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-06 10:42:43.396195 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:42:43.397871 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:42:43.397871 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 10:42:43.576848 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:42:43.576848 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:42:43.577843 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 10:42:43.994780 (Thread-1): SQL status: SUCCESS 0 in 0.42 seconds
2021-10-06 10:42:43.996841 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:42:43.996841 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:42:43.997847 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:42:44.303676 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-10-06 10:42:44.305739 (Thread-1): finished collecting timing info
2021-10-06 10:42:44.305739 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 10:42:44.655830 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20bd2885-2e55-4f2b-aa6f-8431674c130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CBE7E0280>]}
2021-10-06 10:42:44.656826 (Thread-1): 12:42:44 | 2 of 5 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.10s]
2021-10-06 10:42:44.658193 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:42:44.658193 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:42:44.658193 (Thread-1): 12:42:44 | 3 of 5 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 10:42:44.659170 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:42:44.659170 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:42:44.660179 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:42:44.661066 (Thread-1): finished collecting timing info
2021-10-06 10:42:44.662074 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:42:44.664081 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:42:44.664081 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 10:42:44.664081 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:42:45.953469 (Thread-1): SQL status: SUCCESS 1 in 1.29 seconds
2021-10-06 10:42:45.953469 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:42:45.953469 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 10:42:47.876111 (Thread-1): SQL status: SUCCESS 1 in 1.92 seconds
2021-10-06 10:42:47.877104 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:42:47.878101 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:42:47.878101 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:42:48.067188 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-06 10:42:48.068455 (Thread-1): finished collecting timing info
2021-10-06 10:42:48.068455 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 10:42:48.355171 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20bd2885-2e55-4f2b-aa6f-8431674c130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CBE7E38E0>]}
2021-10-06 10:42:48.356167 (Thread-1): 12:42:48 | 3 of 5 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.70s]
2021-10-06 10:42:52.283807 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:42:52.283807 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-06 10:42:52.284813 (Thread-1): 12:42:52 | 4 of 5 START incremental model dbt.time.............................. [RUN]
2021-10-06 10:42:52.285551 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:42:52.285551 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-06 10:42:52.287580 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 10:42:52.289115 (Thread-1): finished collecting timing info
2021-10-06 10:42:52.291232 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:42:52.291232 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND::varchar)) <= current_time


  and t_time > (select max(t_time) from analytics.dbt.time)

      );
2021-10-06 10:42:52.291232 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:42:53.596510 (Thread-1): Snowflake query id: 019f6cc2-0601-3497-0000-006647038acd
2021-10-06 10:42:53.597507 (Thread-1): Snowflake error: 002036 (42601): SQL compilation error:
Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:42:53.597507 (Thread-1): finished collecting timing info
2021-10-06 10:42:53.597507 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-06 10:42:54.028099 (Thread-1): Database Error in model time (models\example\time.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002036 (42601): SQL compilation error:
Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model time (models\example\time.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:42:54.029080 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20bd2885-2e55-4f2b-aa6f-8431674c130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CBE7EE7F0>]}
2021-10-06 10:42:54.029080 (Thread-1): 12:42:54 | 4 of 5 ERROR creating incremental model dbt.time..................... [ERROR in 1.74s]
2021-10-06 10:43:51.140726 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-06 10:43:51.140726 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:43:51.140726 (Thread-1): 12:43:51 | 5 of 5 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 10:43:51.141356 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:43:51.141356 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:43:51.146927 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:43:51.148516 (Thread-1): finished collecting timing info
2021-10-06 10:43:51.149521 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:43:51.151193 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:43:51.151193 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 10:43:51.151193 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:43:52.411881 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-10-06 10:43:52.411881 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:43:52.411881 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (with __dbt__cte__my_first_dbt_model as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
)-- Use the `ref` function to select from other models


select *
from __dbt__cte__my_first_dbt_model
where id = 1
      );
2021-10-06 10:43:53.379705 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-06 10:43:53.380713 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:43:53.381707 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:43:53.381707 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:43:53.544407 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 10:43:53.545404 (Thread-1): finished collecting timing info
2021-10-06 10:43:53.545404 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 10:43:53.831271 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20bd2885-2e55-4f2b-aa6f-8431674c130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CBE888970>]}
2021-10-06 10:43:53.832268 (Thread-1): 12:43:53 | 5 of 5 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.69s]
2021-10-06 10:43:53.833280 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:43:53.833588 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:43:53.833588 (MainThread): Using snowflake connection "master".
2021-10-06 10:43:53.834594 (MainThread): On master: BEGIN
2021-10-06 10:43:53.834594 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:43:54.643102 (MainThread): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-06 10:43:54.643102 (MainThread): On master: COMMIT
2021-10-06 10:43:54.643102 (MainThread): Using snowflake connection "master".
2021-10-06 10:43:54.643102 (MainThread): On master: COMMIT
2021-10-06 10:43:54.897586 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-06 10:43:54.897586 (MainThread): On master: Close
2021-10-06 10:43:55.202820 (MainThread): 12:43:55 | 
2021-10-06 10:43:55.202820 (MainThread): 12:43:55 | Finished running 3 table models, 2 incremental models in 81.54s.
2021-10-06 10:43:55.203817 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:43:55.203817 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 10:43:55.203817 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 10:43:55.203817 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 10:43:55.217295 (MainThread): 
2021-10-06 10:43:55.217295 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:43:55.218261 (MainThread): 
2021-10-06 10:43:55.218261 (MainThread): Database Error in model time (models\example\time.sql)
2021-10-06 10:43:55.219258 (MainThread):   002036 (42601): SQL compilation error:
2021-10-06 10:43:55.219327 (MainThread):   Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:43:55.219950 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-10-06 10:43:55.220207 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CBE7EE7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CBE7F9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CBE7F9520>]}
2021-10-06 10:43:55.220207 (MainThread): Flushing usage events
2021-10-06 10:46:15.825908 (MainThread): Running with dbt=0.20.2
2021-10-06 10:46:16.316086 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 10:46:16.316086 (MainThread): Tracking: tracking
2021-10-06 10:46:16.316086 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDACFDE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDC2441F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDC244220>]}
2021-10-06 10:46:16.322076 (MainThread): Partial parsing not enabled
2021-10-06 10:46:16.332271 (MainThread): Parsing macros\adapters.sql
2021-10-06 10:46:16.350197 (MainThread): Parsing macros\catalog.sql
2021-10-06 10:46:16.351195 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 10:46:16.357174 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 10:46:16.358172 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 10:46:16.360166 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 10:46:16.361237 (MainThread): Parsing macros\core.sql
2021-10-06 10:46:16.363234 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 10:46:16.389146 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 10:46:16.394480 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 10:46:16.395485 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 10:46:16.396484 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 10:46:16.397474 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 10:46:16.398471 (MainThread): Parsing macros\etc\query.sql
2021-10-06 10:46:16.398471 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 10:46:16.404453 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 10:46:16.407444 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 10:46:16.415415 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 10:46:16.416406 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 10:46:16.421388 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 10:46:16.432530 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 10:46:16.449601 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 10:46:16.450598 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 10:46:16.461174 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 10:46:16.465160 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 10:46:16.468150 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 10:46:16.471208 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 10:46:16.473272 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 10:46:16.473272 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 10:46:16.474275 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 10:46:16.573743 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:46:16.578727 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:46:16.582931 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:46:16.584922 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:46:16.586915 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:46:16.588911 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:46:16.606202 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:46:16.607204 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:46:16.608199 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:46:16.609197 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:46:16.638323 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:46:16.641390 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:46:16.643562 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:46:16.662295 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df773bf1-6471-4d58-a87b-193e2408ba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDC2A3B50>]}
2021-10-06 10:46:16.685201 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:46:16.686273 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df773bf1-6471-4d58-a87b-193e2408ba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDC244550>]}
2021-10-06 10:46:16.686273 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 10:46:16.687194 (MainThread): 
2021-10-06 10:46:16.687194 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:46:16.689393 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 10:46:16.696656 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 10:46:16.696656 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 10:46:16.696656 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:46:18.532177 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.84 seconds
2021-10-06 10:46:18.539151 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 10:46:18.878265 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 10:46:18.884949 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 10:46:18.884949 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 10:46:18.884949 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 10:46:19.677822 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.79 seconds
2021-10-06 10:46:19.679888 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 10:46:19.979160 (MainThread): Using snowflake connection "master".
2021-10-06 10:46:19.980152 (MainThread): On master: BEGIN
2021-10-06 10:46:19.980152 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:46:21.143180 (MainThread): SQL status: SUCCESS 1 in 1.16 seconds
2021-10-06 10:46:21.143180 (MainThread): On master: COMMIT
2021-10-06 10:46:21.143180 (MainThread): Using snowflake connection "master".
2021-10-06 10:46:21.143180 (MainThread): On master: COMMIT
2021-10-06 10:46:21.403577 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-06 10:46:21.404618 (MainThread): On master: Close
2021-10-06 10:46:21.715006 (MainThread): 12:46:21 | Concurrency: 1 threads (target='dev')
2021-10-06 10:46:21.715465 (MainThread): 12:46:21 | 
2021-10-06 10:46:21.717019 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:46:21.717929 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:46:21.717929 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:46:21.720920 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 10:46:21.722561 (Thread-1): finished collecting timing info
2021-10-06 10:46:21.723568 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:46:21.723568 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:46:21.723568 (Thread-1): 12:46:21 | 1 of 5 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 10:46:21.724568 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:46:21.724568 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:46:21.725599 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:46:21.726589 (Thread-1): finished collecting timing info
2021-10-06 10:46:21.743184 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:46:21.744932 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:46:21.745954 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 10:46:21.745954 (Thread-1): Opening a new connection, currently in state init
2021-10-06 10:46:22.545593 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-06 10:46:22.545593 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:46:22.545593 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 10:46:23.882451 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-10-06 10:46:23.884444 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:46:23.885437 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:46:23.885437 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:46:24.066032 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:46:24.077571 (Thread-1): finished collecting timing info
2021-10-06 10:46:24.077571 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 10:46:24.375984 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df773bf1-6471-4d58-a87b-193e2408ba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDACFDA30>]}
2021-10-06 10:46:24.375984 (Thread-1): 12:46:24 | 1 of 5 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.65s]
2021-10-06 10:46:24.377040 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:46:24.377040 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:46:24.377040 (Thread-1): 12:46:24 | 2 of 5 START incremental model dbt.dates............................. [RUN]
2021-10-06 10:46:24.377976 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:46:24.377976 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 10:46:24.381084 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:46:24.382116 (Thread-1): finished collecting timing info
2021-10-06 10:46:24.395081 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:46:24.395081 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 10:46:24.395081 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:46:25.713730 (Thread-1): SQL status: SUCCESS 1 in 1.32 seconds
2021-10-06 10:46:25.722702 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:46:25.723699 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 10:46:25.895379 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:46:25.898933 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:46:25.898933 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:46:26.066122 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:46:26.067117 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:46:26.067117 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:46:26.229138 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 10:46:26.238022 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:46:26.239782 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:46:26.239782 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 10:46:26.425440 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-06 10:46:26.425440 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:46:26.425440 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 10:46:26.803160 (Thread-1): SQL status: SUCCESS 0 in 0.38 seconds
2021-10-06 10:46:26.805147 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:46:26.806159 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:46:26.806159 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:46:27.061995 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-06 10:46:27.061995 (Thread-1): finished collecting timing info
2021-10-06 10:46:27.062993 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 10:46:27.399986 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df773bf1-6471-4d58-a87b-193e2408ba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDC23EDC0>]}
2021-10-06 10:46:27.399986 (Thread-1): 12:46:27 | 2 of 5 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.02s]
2021-10-06 10:46:27.401982 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:46:27.401982 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:46:27.401982 (Thread-1): 12:46:27 | 3 of 5 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 10:46:27.403053 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:46:27.403053 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:46:27.406039 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:46:27.407959 (Thread-1): finished collecting timing info
2021-10-06 10:46:27.410179 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:46:27.412180 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:46:27.412180 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 10:46:27.412672 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:46:28.250394 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-06 10:46:28.251390 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:46:28.251390 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 10:46:29.577177 (Thread-1): SQL status: SUCCESS 1 in 1.33 seconds
2021-10-06 10:46:29.580150 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:46:29.580150 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:46:29.580150 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:46:29.755632 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:46:29.756628 (Thread-1): finished collecting timing info
2021-10-06 10:46:29.756628 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 10:46:30.081130 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df773bf1-6471-4d58-a87b-193e2408ba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDC37E970>]}
2021-10-06 10:46:30.082128 (Thread-1): 12:46:30 | 3 of 5 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.68s]
2021-10-06 10:46:30.084123 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:46:30.084123 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-06 10:46:30.084123 (Thread-1): 12:46:30 | 4 of 5 START incremental model dbt.time.............................. [RUN]
2021-10-06 10:46:30.085118 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:46:30.085118 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-06 10:46:30.088106 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 10:46:30.092018 (Thread-1): finished collecting timing info
2021-10-06 10:46:30.094081 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:46:30.094081 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND::varchar)) <= current_time


  and t_time > (select current_time from analytics.dbt.time)

      );
2021-10-06 10:46:30.094081 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:46:31.126098 (Thread-1): Snowflake query id: 019f6cc6-0601-33d0-0000-006647037bad
2021-10-06 10:46:31.126098 (Thread-1): Snowflake error: 001038 (22023): SQL compilation error:
Can not convert parameter '(SELECT CURRENT_TIME() AS "CURRENT_TIME" FROM ANALYTICS.DBT.TIME AS TIME)' of type [TIME(9)] into expected type [NUMBER(38,0)]
2021-10-06 10:46:31.127095 (Thread-1): finished collecting timing info
2021-10-06 10:46:31.127095 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-06 10:46:31.416021 (Thread-1): Database Error in model time (models\example\time.sql)
  001038 (22023): SQL compilation error:
  Can not convert parameter '(SELECT CURRENT_TIME() AS "CURRENT_TIME" FROM ANALYTICS.DBT.TIME AS TIME)' of type [TIME(9)] into expected type [NUMBER(38,0)]
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001038 (22023): SQL compilation error:
Can not convert parameter '(SELECT CURRENT_TIME() AS "CURRENT_TIME" FROM ANALYTICS.DBT.TIME AS TIME)' of type [TIME(9)] into expected type [NUMBER(38,0)]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model time (models\example\time.sql)
  001038 (22023): SQL compilation error:
  Can not convert parameter '(SELECT CURRENT_TIME() AS "CURRENT_TIME" FROM ANALYTICS.DBT.TIME AS TIME)' of type [TIME(9)] into expected type [NUMBER(38,0)]
2021-10-06 10:46:31.417015 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df773bf1-6471-4d58-a87b-193e2408ba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDC37E970>]}
2021-10-06 10:46:31.417015 (Thread-1): 12:46:31 | 4 of 5 ERROR creating incremental model dbt.time..................... [ERROR in 1.33s]
2021-10-06 10:46:31.417942 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-06 10:46:31.417942 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:46:31.417942 (Thread-1): 12:46:31 | 5 of 5 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 10:46:31.418963 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:46:31.418963 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:46:31.424999 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:46:31.425916 (Thread-1): finished collecting timing info
2021-10-06 10:46:31.426980 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:46:31.428999 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:46:31.428999 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 10:46:31.428999 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:46:32.517517 (Thread-1): SQL status: SUCCESS 1 in 1.09 seconds
2021-10-06 10:46:32.517517 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:46:32.517517 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (with __dbt__cte__my_first_dbt_model as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
)-- Use the `ref` function to select from other models


select *
from __dbt__cte__my_first_dbt_model
where id = 1
      );
2021-10-06 10:46:33.428575 (Thread-1): SQL status: SUCCESS 1 in 0.91 seconds
2021-10-06 10:46:33.430566 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:46:33.431563 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:46:33.431563 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:46:33.608494 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:46:33.609501 (Thread-1): finished collecting timing info
2021-10-06 10:46:33.610487 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 10:46:33.899762 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df773bf1-6471-4d58-a87b-193e2408ba07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDC2C1C10>]}
2021-10-06 10:46:33.900758 (Thread-1): 12:46:33 | 5 of 5 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.48s]
2021-10-06 10:46:33.901511 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:46:33.902506 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:46:33.902506 (MainThread): Using snowflake connection "master".
2021-10-06 10:46:33.902506 (MainThread): On master: BEGIN
2021-10-06 10:46:33.902506 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:46:34.723109 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-06 10:46:34.724104 (MainThread): On master: COMMIT
2021-10-06 10:46:34.724104 (MainThread): Using snowflake connection "master".
2021-10-06 10:46:34.724104 (MainThread): On master: COMMIT
2021-10-06 10:46:34.973975 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-06 10:46:34.973975 (MainThread): On master: Close
2021-10-06 10:46:35.287429 (MainThread): 12:46:35 | 
2021-10-06 10:46:35.288426 (MainThread): 12:46:35 | Finished running 3 table models, 2 incremental models in 18.60s.
2021-10-06 10:46:35.288426 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:46:35.288426 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 10:46:35.288426 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 10:46:35.289496 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 10:46:35.306282 (MainThread): 
2021-10-06 10:46:35.306282 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:46:35.307296 (MainThread): 
2021-10-06 10:46:35.307296 (MainThread): Database Error in model time (models\example\time.sql)
2021-10-06 10:46:35.308285 (MainThread):   001038 (22023): SQL compilation error:
2021-10-06 10:46:35.308285 (MainThread):   Can not convert parameter '(SELECT CURRENT_TIME() AS "CURRENT_TIME" FROM ANALYTICS.DBT.TIME AS TIME)' of type [TIME(9)] into expected type [NUMBER(38,0)]
2021-10-06 10:46:35.308285 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-10-06 10:46:35.309281 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDC229520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDC2293D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDC2C1400>]}
2021-10-06 10:46:35.309281 (MainThread): Flushing usage events
2021-10-06 10:47:27.699147 (MainThread): Running with dbt=0.20.2
2021-10-06 10:47:28.213594 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 10:47:28.213594 (MainThread): Tracking: tracking
2021-10-06 10:47:28.214591 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002071FE2BD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002072135BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002072135B520>]}
2021-10-06 10:47:28.220569 (MainThread): Partial parsing not enabled
2021-10-06 10:47:28.233526 (MainThread): Parsing macros\adapters.sql
2021-10-06 10:47:28.252373 (MainThread): Parsing macros\catalog.sql
2021-10-06 10:47:28.253370 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 10:47:28.258353 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 10:47:28.259350 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 10:47:28.261343 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 10:47:28.262340 (MainThread): Parsing macros\core.sql
2021-10-06 10:47:28.264333 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 10:47:28.292840 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 10:47:28.297815 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 10:47:28.298812 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 10:47:28.299820 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 10:47:28.300815 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 10:47:28.301810 (MainThread): Parsing macros\etc\query.sql
2021-10-06 10:47:28.301810 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 10:47:28.307790 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 10:47:28.311770 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 10:47:28.319750 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 10:47:28.320819 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 10:47:28.325794 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 10:47:28.337831 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 10:47:28.355756 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 10:47:28.356746 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 10:47:28.367874 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 10:47:28.371861 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 10:47:28.374936 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 10:47:28.378837 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 10:47:28.379834 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 10:47:28.380833 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 10:47:28.381840 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 10:47:28.483241 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:47:28.489421 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:47:28.494404 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:47:28.496398 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:47:28.498391 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:47:28.500388 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:47:28.519415 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:47:28.521417 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:47:28.522413 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:47:28.523410 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:47:28.556098 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:47:28.559088 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:47:28.562078 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:47:28.577028 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2308c425-1011-4eaa-b2cc-34fb1ce7f7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207213C2730>]}
2021-10-06 10:47:28.598167 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:47:28.599151 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2308c425-1011-4eaa-b2cc-34fb1ce7f7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002071FE2BEE0>]}
2021-10-06 10:47:28.599151 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 10:47:28.601145 (MainThread): 
2021-10-06 10:47:28.601145 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:47:28.603138 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 10:47:28.612389 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 10:47:28.612389 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 10:47:28.612389 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:47:30.166054 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.55 seconds
2021-10-06 10:47:30.170034 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 10:47:30.526671 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 10:47:30.536671 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 10:47:30.536671 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 10:47:30.536671 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 10:47:31.361499 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.82 seconds
2021-10-06 10:47:31.362500 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 10:47:31.665387 (MainThread): Using snowflake connection "master".
2021-10-06 10:47:31.665387 (MainThread): On master: BEGIN
2021-10-06 10:47:31.665387 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:47:32.442932 (MainThread): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-06 10:47:32.443929 (MainThread): On master: COMMIT
2021-10-06 10:47:32.443929 (MainThread): Using snowflake connection "master".
2021-10-06 10:47:32.443929 (MainThread): On master: COMMIT
2021-10-06 10:47:32.781639 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-10-06 10:47:32.781639 (MainThread): On master: Close
2021-10-06 10:47:33.087471 (MainThread): 12:47:33 | Concurrency: 1 threads (target='dev')
2021-10-06 10:47:33.087471 (MainThread): 12:47:33 | 
2021-10-06 10:47:33.090343 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:47:33.090343 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:47:33.090343 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:47:33.092356 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 10:47:33.094028 (Thread-1): finished collecting timing info
2021-10-06 10:47:33.094028 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:47:33.094028 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:47:33.095037 (Thread-1): 12:47:33 | 1 of 5 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 10:47:33.095037 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:47:33.095037 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:47:33.095037 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:47:33.097023 (Thread-1): finished collecting timing info
2021-10-06 10:47:33.116576 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:47:33.118755 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:47:33.118755 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 10:47:33.118755 (Thread-1): Opening a new connection, currently in state init
2021-10-06 10:47:34.250950 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2021-10-06 10:47:34.250950 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:47:34.250950 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 10:47:35.822753 (Thread-1): SQL status: SUCCESS 1 in 1.57 seconds
2021-10-06 10:47:35.824744 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:47:35.824744 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:47:35.825742 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:47:35.986557 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 10:47:35.998094 (Thread-1): finished collecting timing info
2021-10-06 10:47:35.998094 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 10:47:36.330958 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2308c425-1011-4eaa-b2cc-34fb1ce7f7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002071FF6B2E0>]}
2021-10-06 10:47:36.330958 (Thread-1): 12:47:36 | 1 of 5 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.23s]
2021-10-06 10:47:36.332970 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:47:36.332970 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:47:36.332970 (Thread-1): 12:47:36 | 2 of 5 START incremental model dbt.dates............................. [RUN]
2021-10-06 10:47:36.334969 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:47:36.334969 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 10:47:36.341000 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:47:36.341455 (Thread-1): finished collecting timing info
2021-10-06 10:47:36.356918 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:47:36.356918 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 10:47:36.356918 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:47:37.566635 (Thread-1): SQL status: SUCCESS 1 in 1.21 seconds
2021-10-06 10:47:37.573608 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:47:37.574605 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 10:47:37.748490 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:47:37.752476 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:47:37.752476 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:47:37.958422 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-06 10:47:37.961411 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:47:37.961411 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:47:38.194925 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-06 10:47:38.205887 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:47:38.208286 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:47:38.208286 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 10:47:38.384296 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:47:38.384296 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:47:38.385292 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 10:47:38.754288 (Thread-1): SQL status: SUCCESS 0 in 0.37 seconds
2021-10-06 10:47:38.756349 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:47:38.756349 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:47:38.756349 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:47:39.014820 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-06 10:47:39.015828 (Thread-1): finished collecting timing info
2021-10-06 10:47:39.016814 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 10:47:39.332236 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2308c425-1011-4eaa-b2cc-34fb1ce7f7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002071FF6B2E0>]}
2021-10-06 10:47:39.332236 (Thread-1): 12:47:39 | 2 of 5 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.00s]
2021-10-06 10:47:39.334738 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:47:39.334738 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:47:39.334738 (Thread-1): 12:47:39 | 3 of 5 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 10:47:39.335760 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:47:39.335760 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:47:39.338802 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:47:39.340726 (Thread-1): finished collecting timing info
2021-10-06 10:47:39.343083 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:47:39.345078 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:47:39.345078 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 10:47:39.346106 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:47:40.228485 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-10-06 10:47:40.228485 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:47:40.229481 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 10:47:42.067062 (Thread-1): SQL status: SUCCESS 1 in 1.84 seconds
2021-10-06 10:47:42.069006 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:47:42.070002 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:47:42.070002 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:47:42.235256 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:47:42.236174 (Thread-1): finished collecting timing info
2021-10-06 10:47:42.236174 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 10:47:42.525967 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2308c425-1011-4eaa-b2cc-34fb1ce7f7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020721780C70>]}
2021-10-06 10:47:42.526963 (Thread-1): 12:47:42 | 3 of 5 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.19s]
2021-10-06 10:47:42.528616 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:47:42.528616 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-06 10:47:42.528616 (Thread-1): 12:47:42 | 4 of 5 START incremental model dbt.time.............................. [RUN]
2021-10-06 10:47:42.529654 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:47:42.529654 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-06 10:47:42.532835 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 10:47:42.538997 (Thread-1): finished collecting timing info
2021-10-06 10:47:42.540954 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:47:42.540954 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) <= current_time


  and t_time > (select current_time from analytics.dbt.time)

      );
2021-10-06 10:47:42.540954 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:47:43.360355 (Thread-1): Snowflake query id: 019f6cc7-0601-33d0-0000-006647037bd5
2021-10-06 10:47:43.360355 (Thread-1): Snowflake error: 001038 (22023): SQL compilation error:
Can not convert parameter '(SELECT CURRENT_TIME() AS "CURRENT_TIME" FROM ANALYTICS.DBT.TIME AS TIME)' of type [TIME(9)] into expected type [NUMBER(38,0)]
2021-10-06 10:47:43.360355 (Thread-1): finished collecting timing info
2021-10-06 10:47:43.360355 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-06 10:47:43.659088 (Thread-1): Database Error in model time (models\example\time.sql)
  001038 (22023): SQL compilation error:
  Can not convert parameter '(SELECT CURRENT_TIME() AS "CURRENT_TIME" FROM ANALYTICS.DBT.TIME AS TIME)' of type [TIME(9)] into expected type [NUMBER(38,0)]
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001038 (22023): SQL compilation error:
Can not convert parameter '(SELECT CURRENT_TIME() AS "CURRENT_TIME" FROM ANALYTICS.DBT.TIME AS TIME)' of type [TIME(9)] into expected type [NUMBER(38,0)]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model time (models\example\time.sql)
  001038 (22023): SQL compilation error:
  Can not convert parameter '(SELECT CURRENT_TIME() AS "CURRENT_TIME" FROM ANALYTICS.DBT.TIME AS TIME)' of type [TIME(9)] into expected type [NUMBER(38,0)]
2021-10-06 10:47:43.660101 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2308c425-1011-4eaa-b2cc-34fb1ce7f7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002071FE2B0A0>]}
2021-10-06 10:47:43.660101 (Thread-1): 12:47:43 | 4 of 5 ERROR creating incremental model dbt.time..................... [ERROR in 1.13s]
2021-10-06 10:47:43.661021 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-06 10:47:43.661021 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:47:43.661021 (Thread-1): 12:47:43 | 5 of 5 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 10:47:43.662018 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:47:43.662018 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:47:43.667078 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:47:43.667998 (Thread-1): finished collecting timing info
2021-10-06 10:47:43.670064 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:47:43.671984 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:47:43.671984 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 10:47:43.671984 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:47:44.684188 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-06 10:47:44.684188 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:47:44.684188 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (with __dbt__cte__my_first_dbt_model as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
)-- Use the `ref` function to select from other models


select *
from __dbt__cte__my_first_dbt_model
where id = 1
      );
2021-10-06 10:47:45.630963 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-10-06 10:47:45.632968 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:47:45.632968 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:47:45.632968 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:47:45.838449 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-06 10:47:45.839253 (Thread-1): finished collecting timing info
2021-10-06 10:47:45.839253 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 10:47:46.167664 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2308c425-1011-4eaa-b2cc-34fb1ce7f7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020721780C70>]}
2021-10-06 10:47:46.168662 (Thread-1): 12:47:46 | 5 of 5 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.51s]
2021-10-06 10:47:46.169866 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:47:46.170868 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:47:46.170868 (MainThread): Using snowflake connection "master".
2021-10-06 10:47:46.170868 (MainThread): On master: BEGIN
2021-10-06 10:47:46.170868 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:47:46.961430 (MainThread): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-06 10:47:46.962349 (MainThread): On master: COMMIT
2021-10-06 10:47:46.962349 (MainThread): Using snowflake connection "master".
2021-10-06 10:47:46.962349 (MainThread): On master: COMMIT
2021-10-06 10:47:47.249250 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-06 10:47:47.249250 (MainThread): On master: Close
2021-10-06 10:47:47.561195 (MainThread): 12:47:47 | 
2021-10-06 10:47:47.561195 (MainThread): 12:47:47 | Finished running 3 table models, 2 incremental models in 18.96s.
2021-10-06 10:47:47.564121 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:47:47.564121 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 10:47:47.564121 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 10:47:47.564121 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 10:47:47.583126 (MainThread): 
2021-10-06 10:47:47.584056 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:47:47.584688 (MainThread): 
2021-10-06 10:47:47.584688 (MainThread): Database Error in model time (models\example\time.sql)
2021-10-06 10:47:47.585962 (MainThread):   001038 (22023): SQL compilation error:
2021-10-06 10:47:47.585962 (MainThread):   Can not convert parameter '(SELECT CURRENT_TIME() AS "CURRENT_TIME" FROM ANALYTICS.DBT.TIME AS TIME)' of type [TIME(9)] into expected type [NUMBER(38,0)]
2021-10-06 10:47:47.586740 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-10-06 10:47:47.586740 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207213F01F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207217887F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020721788400>]}
2021-10-06 10:47:47.586740 (MainThread): Flushing usage events
2021-10-06 10:48:19.301256 (MainThread): Running with dbt=0.20.2
2021-10-06 10:48:19.797133 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 10:48:19.797133 (MainThread): Tracking: tracking
2021-10-06 10:48:19.797133 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E16150CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E162A55C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E162A55EB0>]}
2021-10-06 10:48:19.803213 (MainThread): Partial parsing not enabled
2021-10-06 10:48:19.814177 (MainThread): Parsing macros\adapters.sql
2021-10-06 10:48:19.831048 (MainThread): Parsing macros\catalog.sql
2021-10-06 10:48:19.833060 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 10:48:19.838021 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 10:48:19.839018 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 10:48:19.841011 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 10:48:19.842015 (MainThread): Parsing macros\core.sql
2021-10-06 10:48:19.844001 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 10:48:19.872238 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 10:48:19.877221 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 10:48:19.877221 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 10:48:19.878307 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 10:48:19.879351 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 10:48:19.880348 (MainThread): Parsing macros\etc\query.sql
2021-10-06 10:48:19.881344 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 10:48:19.886327 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 10:48:19.890313 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 10:48:19.900349 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 10:48:19.901346 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 10:48:19.905332 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 10:48:19.918425 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 10:48:19.936630 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 10:48:19.937627 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 10:48:19.947827 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 10:48:19.951821 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 10:48:19.953806 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 10:48:19.957796 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 10:48:19.958790 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 10:48:19.959795 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 10:48:19.960778 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 10:48:20.059243 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:48:20.064227 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:48:20.069210 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:48:20.071203 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:48:20.073197 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:48:20.074193 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:48:20.093128 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:48:20.094125 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:48:20.095122 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:48:20.097117 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:48:20.125183 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:48:20.128172 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:48:20.132160 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:48:20.147572 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5feb57c5-c46a-4ebc-af9f-4a3865133994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E162B59DF0>]}
2021-10-06 10:48:20.171833 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:48:20.171833 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5feb57c5-c46a-4ebc-af9f-4a3865133994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E162B59880>]}
2021-10-06 10:48:20.171833 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 10:48:20.173846 (MainThread): 
2021-10-06 10:48:20.173846 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:48:20.176424 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 10:48:20.185758 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 10:48:20.185987 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 10:48:20.185987 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:48:21.454809 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.27 seconds
2021-10-06 10:48:21.458788 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 10:48:21.748949 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 10:48:21.751939 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 10:48:21.751939 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 10:48:21.751939 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 10:48:22.576153 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.82 seconds
2021-10-06 10:48:22.578145 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 10:48:22.898850 (MainThread): Using snowflake connection "master".
2021-10-06 10:48:22.899896 (MainThread): On master: BEGIN
2021-10-06 10:48:22.899896 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:48:23.780890 (MainThread): SQL status: SUCCESS 1 in 0.88 seconds
2021-10-06 10:48:23.780890 (MainThread): On master: COMMIT
2021-10-06 10:48:23.780890 (MainThread): Using snowflake connection "master".
2021-10-06 10:48:23.780890 (MainThread): On master: COMMIT
2021-10-06 10:48:24.012268 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-06 10:48:24.012268 (MainThread): On master: Close
2021-10-06 10:48:24.334911 (MainThread): 12:48:24 | Concurrency: 1 threads (target='dev')
2021-10-06 10:48:24.334911 (MainThread): 12:48:24 | 
2021-10-06 10:48:24.339467 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:48:24.339467 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:48:24.340474 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:48:24.344459 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 10:48:24.347450 (Thread-1): finished collecting timing info
2021-10-06 10:48:24.347450 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:48:24.347450 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:48:24.348447 (Thread-1): 12:48:24 | 1 of 5 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 10:48:24.348447 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:48:24.349443 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:48:24.350439 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:48:24.351504 (Thread-1): finished collecting timing info
2021-10-06 10:48:24.370009 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:48:24.371004 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:48:24.371004 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 10:48:24.371004 (Thread-1): Opening a new connection, currently in state init
2021-10-06 10:48:25.439336 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-10-06 10:48:25.440331 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:48:25.440331 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 10:48:26.876490 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-10-06 10:48:26.877487 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:48:26.877487 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:48:26.877487 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:48:27.040402 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 10:48:27.052376 (Thread-1): finished collecting timing info
2021-10-06 10:48:27.052376 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 10:48:27.387169 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5feb57c5-c46a-4ebc-af9f-4a3865133994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E162A27400>]}
2021-10-06 10:48:27.387169 (Thread-1): 12:48:27 | 1 of 5 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.04s]
2021-10-06 10:48:27.388625 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:48:27.388625 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:48:27.389626 (Thread-1): 12:48:27 | 2 of 5 START incremental model dbt.dates............................. [RUN]
2021-10-06 10:48:27.389626 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:48:27.390622 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 10:48:27.395603 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:48:27.396009 (Thread-1): finished collecting timing info
2021-10-06 10:48:27.409102 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:48:27.409102 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 10:48:27.410158 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:48:28.679583 (Thread-1): SQL status: SUCCESS 1 in 1.27 seconds
2021-10-06 10:48:28.687840 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:48:28.687840 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 10:48:28.866831 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:48:28.867827 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:48:28.867827 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:48:29.090965 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-06 10:48:29.093955 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:48:29.093955 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:48:29.273904 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:48:29.281874 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:48:29.283894 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:48:29.283894 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 10:48:29.467829 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:48:29.468824 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:48:29.468824 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 10:48:29.956165 (Thread-1): SQL status: SUCCESS 0 in 0.49 seconds
2021-10-06 10:48:29.958139 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:48:29.959136 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:48:29.959136 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:48:30.229038 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-06 10:48:30.231027 (Thread-1): finished collecting timing info
2021-10-06 10:48:30.231027 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 10:48:30.568445 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5feb57c5-c46a-4ebc-af9f-4a3865133994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E162A39460>]}
2021-10-06 10:48:30.569370 (Thread-1): 12:48:30 | 2 of 5 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.18s]
2021-10-06 10:48:30.571114 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:48:30.571114 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:48:30.572190 (Thread-1): 12:48:30 | 3 of 5 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 10:48:30.572190 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:48:30.573112 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:48:30.576185 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:48:30.578307 (Thread-1): finished collecting timing info
2021-10-06 10:48:30.581306 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:48:30.584296 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:48:30.584296 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 10:48:30.584296 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:48:31.460757 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-10-06 10:48:31.461772 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:48:31.461772 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 10:48:33.570970 (Thread-1): SQL status: SUCCESS 1 in 2.11 seconds
2021-10-06 10:48:33.572967 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:48:33.572967 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:48:33.572967 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:48:33.790004 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-06 10:48:33.792025 (Thread-1): finished collecting timing info
2021-10-06 10:48:33.792025 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 10:48:34.099344 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5feb57c5-c46a-4ebc-af9f-4a3865133994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E162D0E790>]}
2021-10-06 10:48:34.100346 (Thread-1): 12:48:34 | 3 of 5 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.53s]
2021-10-06 10:48:34.102102 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:48:34.102102 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-06 10:48:34.102102 (Thread-1): 12:48:34 | 4 of 5 START incremental model dbt.time.............................. [RUN]
2021-10-06 10:48:34.103103 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:48:34.103103 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-06 10:48:34.107088 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 10:48:34.111748 (Thread-1): finished collecting timing info
2021-10-06 10:48:34.113744 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:48:34.113744 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS t_time <= current_time


  and t_time > (select current_time from analytics.dbt.time)

      );
2021-10-06 10:48:34.113744 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:48:35.330544 (Thread-1): Snowflake query id: 019f6cc8-0601-3497-0000-006647038b89
2021-10-06 10:48:35.330544 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 69 unexpected 'AS'.
2021-10-06 10:48:35.330544 (Thread-1): finished collecting timing info
2021-10-06 10:48:35.330544 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-06 10:48:35.673431 (Thread-1): Database Error in model time (models\example\time.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 69 unexpected 'AS'.
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 6 at position 69 unexpected 'AS'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model time (models\example\time.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 69 unexpected 'AS'.
2021-10-06 10:48:35.676422 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5feb57c5-c46a-4ebc-af9f-4a3865133994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E162E95EB0>]}
2021-10-06 10:48:35.676422 (Thread-1): 12:48:35 | 4 of 5 ERROR creating incremental model dbt.time..................... [ERROR in 1.57s]
2021-10-06 10:48:35.677938 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-06 10:48:35.677938 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:48:35.677938 (Thread-1): 12:48:35 | 5 of 5 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 10:48:35.678387 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:48:35.678387 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:48:35.684368 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:48:35.685365 (Thread-1): finished collecting timing info
2021-10-06 10:48:35.686362 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:48:35.687772 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:48:35.687772 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 10:48:35.687772 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:48:36.712572 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-06 10:48:36.713556 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:48:36.713556 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (with __dbt__cte__my_first_dbt_model as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
)-- Use the `ref` function to select from other models


select *
from __dbt__cte__my_first_dbt_model
where id = 1
      );
2021-10-06 10:48:37.923898 (Thread-1): SQL status: SUCCESS 1 in 1.21 seconds
2021-10-06 10:48:37.925904 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:48:37.925904 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:48:37.925904 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:48:38.116319 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-06 10:48:38.116816 (Thread-1): finished collecting timing info
2021-10-06 10:48:38.116816 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 10:48:38.476578 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5feb57c5-c46a-4ebc-af9f-4a3865133994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E162E08D00>]}
2021-10-06 10:48:38.476578 (Thread-1): 12:48:38 | 5 of 5 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.80s]
2021-10-06 10:48:38.477575 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:48:38.478359 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:48:38.478359 (MainThread): Using snowflake connection "master".
2021-10-06 10:48:38.478359 (MainThread): On master: BEGIN
2021-10-06 10:48:38.478359 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:48:39.296982 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-06 10:48:39.296982 (MainThread): On master: COMMIT
2021-10-06 10:48:39.296982 (MainThread): Using snowflake connection "master".
2021-10-06 10:48:39.298062 (MainThread): On master: COMMIT
2021-10-06 10:48:39.622342 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-06 10:48:39.623345 (MainThread): On master: Close
2021-10-06 10:48:39.920940 (MainThread): 12:48:39 | 
2021-10-06 10:48:39.921961 (MainThread): 12:48:39 | Finished running 3 table models, 2 incremental models in 19.75s.
2021-10-06 10:48:39.922451 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:48:39.922451 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 10:48:39.922451 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 10:48:39.922451 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 10:48:39.934536 (MainThread): 
2021-10-06 10:48:39.935544 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:48:39.936357 (MainThread): 
2021-10-06 10:48:39.936357 (MainThread): Database Error in model time (models\example\time.sql)
2021-10-06 10:48:39.936357 (MainThread):   001003 (42000): SQL compilation error:
2021-10-06 10:48:39.937364 (MainThread):   syntax error line 6 at position 69 unexpected 'AS'.
2021-10-06 10:48:39.937364 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-10-06 10:48:39.937364 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E162A39490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E162A39460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E162D4D520>]}
2021-10-06 10:48:39.938361 (MainThread): Flushing usage events
2021-10-06 10:50:49.060213 (MainThread): Running with dbt=0.20.2
2021-10-06 10:50:49.618949 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 10:50:49.618949 (MainThread): Tracking: tracking
2021-10-06 10:50:49.619947 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001936346CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193649A6E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193649A6250>]}
2021-10-06 10:50:49.625955 (MainThread): Partial parsing not enabled
2021-10-06 10:50:49.639010 (MainThread): Parsing macros\adapters.sql
2021-10-06 10:50:49.658045 (MainThread): Parsing macros\catalog.sql
2021-10-06 10:50:49.659062 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 10:50:49.665737 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 10:50:49.666734 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 10:50:49.668727 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 10:50:49.669724 (MainThread): Parsing macros\core.sql
2021-10-06 10:50:49.671717 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 10:50:49.708592 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 10:50:49.714572 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 10:50:49.715065 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 10:50:49.716146 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 10:50:49.718139 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 10:50:49.719136 (MainThread): Parsing macros\etc\query.sql
2021-10-06 10:50:49.720132 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 10:50:49.726986 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 10:50:49.730773 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 10:50:49.739266 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 10:50:49.740263 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 10:50:49.745652 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 10:50:49.759667 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 10:50:49.779685 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 10:50:49.780682 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 10:50:49.792123 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 10:50:49.796109 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 10:50:49.800813 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 10:50:49.804799 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 10:50:49.805797 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 10:50:49.806793 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 10:50:49.807790 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 10:50:49.912286 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:50:49.921257 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:50:49.926240 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:50:49.929230 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:50:49.931223 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:50:49.932219 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:50:49.951230 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:50:49.952067 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:50:49.953247 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:50:49.954222 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:50:49.984711 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:50:49.988148 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:50:49.991137 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:50:50.008305 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0f5b025-fbfe-4e74-8d7f-872c430a3439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193649E6C10>]}
2021-10-06 10:50:50.031360 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:50:50.031360 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0f5b025-fbfe-4e74-8d7f-872c430a3439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019364A03B20>]}
2021-10-06 10:50:50.031360 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 10:50:50.033519 (MainThread): 
2021-10-06 10:50:50.034016 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:50:50.035904 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 10:50:50.045453 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 10:50:50.045453 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 10:50:50.045453 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:50:51.977359 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.93 seconds
2021-10-06 10:50:51.979699 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 10:50:52.306393 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 10:50:52.310489 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 10:50:52.310489 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 10:50:52.310489 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 10:50:53.295865 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.99 seconds
2021-10-06 10:50:53.296862 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 10:50:53.589917 (MainThread): Using snowflake connection "master".
2021-10-06 10:50:53.590914 (MainThread): On master: BEGIN
2021-10-06 10:50:53.590914 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:50:54.358089 (MainThread): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-06 10:50:54.358089 (MainThread): On master: COMMIT
2021-10-06 10:50:54.359084 (MainThread): Using snowflake connection "master".
2021-10-06 10:50:54.359084 (MainThread): On master: COMMIT
2021-10-06 10:50:54.591445 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-06 10:50:54.591445 (MainThread): On master: Close
2021-10-06 10:50:54.885736 (MainThread): 12:50:54 | Concurrency: 1 threads (target='dev')
2021-10-06 10:50:54.885736 (MainThread): 12:50:54 | 
2021-10-06 10:50:54.888582 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:50:54.888582 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:50:54.888582 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:50:54.890649 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 10:50:54.897901 (Thread-1): finished collecting timing info
2021-10-06 10:50:54.897901 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:50:54.897901 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:50:54.898849 (Thread-1): 12:50:54 | 1 of 5 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 10:50:54.898849 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:50:54.898849 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:50:54.899819 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:50:54.900886 (Thread-1): finished collecting timing info
2021-10-06 10:50:54.923013 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:50:54.924874 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:50:54.924874 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 10:50:54.924874 (Thread-1): Opening a new connection, currently in state init
2021-10-06 10:50:55.741788 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-06 10:50:55.741788 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:50:55.741788 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 10:50:57.162314 (Thread-1): SQL status: SUCCESS 1 in 1.42 seconds
2021-10-06 10:50:57.163310 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:50:57.163310 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:50:57.163310 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:50:57.412692 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-06 10:50:57.419668 (Thread-1): finished collecting timing info
2021-10-06 10:50:57.419668 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 10:50:57.769474 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0f5b025-fbfe-4e74-8d7f-872c430a3439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193649777C0>]}
2021-10-06 10:50:57.770473 (Thread-1): 12:50:57 | 1 of 5 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.87s]
2021-10-06 10:50:57.771479 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:50:57.771479 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:50:57.771479 (Thread-1): 12:50:57 | 2 of 5 START incremental model dbt.dates............................. [RUN]
2021-10-06 10:50:57.772463 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:50:57.772463 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 10:50:57.776550 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:50:57.777548 (Thread-1): finished collecting timing info
2021-10-06 10:50:57.792196 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:50:57.792196 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 10:50:57.792196 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:50:59.191412 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-10-06 10:50:59.198385 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:50:59.198385 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 10:50:59.522327 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-06 10:50:59.526241 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:50:59.526241 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:50:59.684117 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 10:50:59.687193 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:50:59.687193 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:50:59.869432 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:50:59.877407 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:50:59.881405 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:50:59.881405 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 10:51:00.066976 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-06 10:51:00.066976 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:51:00.067973 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 10:51:00.501561 (Thread-1): SQL status: SUCCESS 0 in 0.43 seconds
2021-10-06 10:51:00.501561 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:51:00.501561 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:51:00.502571 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:51:00.794937 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-06 10:51:00.794937 (Thread-1): finished collecting timing info
2021-10-06 10:51:00.795933 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 10:51:01.119825 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0f5b025-fbfe-4e74-8d7f-872c430a3439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019364D4F880>]}
2021-10-06 10:51:01.119825 (Thread-1): 12:51:01 | 2 of 5 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.35s]
2021-10-06 10:51:01.120822 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:51:01.120822 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:51:01.120822 (Thread-1): 12:51:01 | 3 of 5 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 10:51:01.121819 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:51:01.121819 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:51:01.122816 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:51:01.126802 (Thread-1): finished collecting timing info
2021-10-06 10:51:01.127800 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:51:01.128796 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:51:01.129794 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 10:51:01.129794 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:51:02.031441 (Thread-1): SQL status: SUCCESS 1 in 0.90 seconds
2021-10-06 10:51:02.031441 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:51:02.031736 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 10:51:03.476713 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-10-06 10:51:03.476713 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:51:03.476713 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:51:03.476713 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:51:03.655790 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:51:03.656787 (Thread-1): finished collecting timing info
2021-10-06 10:51:03.656787 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 10:51:03.964408 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0f5b025-fbfe-4e74-8d7f-872c430a3439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193634AC370>]}
2021-10-06 10:51:03.964408 (Thread-1): 12:51:03 | 3 of 5 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.84s]
2021-10-06 10:51:03.965402 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:51:03.965822 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-06 10:51:03.966062 (Thread-1): 12:51:03 | 4 of 5 START incremental model dbt.time.............................. [RUN]
2021-10-06 10:51:03.966558 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:51:03.966621 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-06 10:51:03.968126 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 10:51:03.973720 (Thread-1): finished collecting timing info
2021-10-06 10:51:03.976906 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:51:03.976906 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS time_x
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE time_x <= current_time


  and time_X > (select max(time_x) from analytics.dbt.time)

      );
2021-10-06 10:51:03.976906 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:51:05.148244 (Thread-1): Snowflake query id: 019f6ccb-0601-3497-0000-006647038bc5
2021-10-06 10:51:05.148244 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 27
invalid identifier 'TIME_X'
2021-10-06 10:51:05.148244 (Thread-1): finished collecting timing info
2021-10-06 10:51:05.148244 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-06 10:51:05.494515 (Thread-1): Database Error in model time (models\example\time.sql)
  000904 (42000): SQL compilation error: error line 9 at position 27
  invalid identifier 'TIME_X'
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 9 at position 27
invalid identifier 'TIME_X'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model time (models\example\time.sql)
  000904 (42000): SQL compilation error: error line 9 at position 27
  invalid identifier 'TIME_X'
2021-10-06 10:51:05.495512 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0f5b025-fbfe-4e74-8d7f-872c430a3439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019364D54370>]}
2021-10-06 10:51:05.495512 (Thread-1): 12:51:05 | 4 of 5 ERROR creating incremental model dbt.time..................... [ERROR in 1.53s]
2021-10-06 10:51:05.496507 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-06 10:51:05.496507 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:51:05.496507 (Thread-1): 12:51:05 | 5 of 5 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 10:51:05.496507 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:51:05.497564 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:51:05.502576 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:51:05.504560 (Thread-1): finished collecting timing info
2021-10-06 10:51:05.505568 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:51:05.509544 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:51:05.509544 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 10:51:05.509544 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:51:06.415645 (Thread-1): SQL status: SUCCESS 1 in 0.91 seconds
2021-10-06 10:51:06.415788 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:51:06.415788 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (with __dbt__cte__my_first_dbt_model as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
)-- Use the `ref` function to select from other models


select *
from __dbt__cte__my_first_dbt_model
where id = 1
      );
2021-10-06 10:51:07.373338 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-10-06 10:51:07.374335 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:51:07.374335 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:51:07.374335 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:51:07.552941 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:51:07.553938 (Thread-1): finished collecting timing info
2021-10-06 10:51:07.554935 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 10:51:07.915337 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0f5b025-fbfe-4e74-8d7f-872c430a3439', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019364DB9370>]}
2021-10-06 10:51:07.915337 (Thread-1): 12:51:07 | 5 of 5 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.42s]
2021-10-06 10:51:07.916334 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:51:07.917330 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:51:07.917330 (MainThread): Using snowflake connection "master".
2021-10-06 10:51:07.917330 (MainThread): On master: BEGIN
2021-10-06 10:51:07.917330 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:51:08.915914 (MainThread): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-06 10:51:08.915914 (MainThread): On master: COMMIT
2021-10-06 10:51:08.915914 (MainThread): Using snowflake connection "master".
2021-10-06 10:51:08.915914 (MainThread): On master: COMMIT
2021-10-06 10:51:09.185429 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-06 10:51:09.185429 (MainThread): On master: Close
2021-10-06 10:51:09.496248 (MainThread): 12:51:09 | 
2021-10-06 10:51:09.496248 (MainThread): 12:51:09 | Finished running 3 table models, 2 incremental models in 19.46s.
2021-10-06 10:51:09.498237 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:51:09.498237 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 10:51:09.498237 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 10:51:09.498237 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 10:51:09.523646 (MainThread): 
2021-10-06 10:51:09.523646 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:51:09.524725 (MainThread): 
2021-10-06 10:51:09.526635 (MainThread): Database Error in model time (models\example\time.sql)
2021-10-06 10:51:09.526635 (MainThread):   000904 (42000): SQL compilation error: error line 9 at position 27
2021-10-06 10:51:09.527633 (MainThread):   invalid identifier 'TIME_X'
2021-10-06 10:51:09.527633 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-10-06 10:51:09.527633 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193649F1EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193634AC100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193649778B0>]}
2021-10-06 10:51:09.527633 (MainThread): Flushing usage events
2021-10-06 10:52:27.856947 (MainThread): Running with dbt=0.20.2
2021-10-06 10:52:28.431567 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 10:52:28.431567 (MainThread): Tracking: tracking
2021-10-06 10:52:28.431567 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ECD97BE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ECEEC62B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ECEEC6700>]}
2021-10-06 10:52:28.437547 (MainThread): Partial parsing not enabled
2021-10-06 10:52:28.448647 (MainThread): Parsing macros\adapters.sql
2021-10-06 10:52:28.466497 (MainThread): Parsing macros\catalog.sql
2021-10-06 10:52:28.467495 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 10:52:28.472478 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 10:52:28.473474 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 10:52:28.476464 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 10:52:28.476464 (MainThread): Parsing macros\core.sql
2021-10-06 10:52:28.478600 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 10:52:28.505625 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 10:52:28.511171 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 10:52:28.511171 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 10:52:28.512168 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 10:52:28.513164 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 10:52:28.514161 (MainThread): Parsing macros\etc\query.sql
2021-10-06 10:52:28.515158 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 10:52:28.521138 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 10:52:28.525185 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 10:52:28.533159 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 10:52:28.534156 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 10:52:28.538142 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 10:52:28.550229 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 10:52:28.568272 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 10:52:28.569270 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 10:52:28.579507 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 10:52:28.582497 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 10:52:28.585487 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 10:52:28.589472 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 10:52:28.590469 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 10:52:28.591466 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 10:52:28.592463 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 10:52:28.691598 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:52:28.697120 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:52:28.701106 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:52:28.704098 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:52:28.705093 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:52:28.707086 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:52:28.724603 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:52:28.725600 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:52:28.727733 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:52:28.728730 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:52:28.755641 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:52:28.759627 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:52:28.761620 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:52:28.775686 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15ccc1c2-241d-4e6a-ad3b-ac4225959886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ECEFBC1C0>]}
2021-10-06 10:52:28.809117 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:52:28.809117 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15ccc1c2-241d-4e6a-ad3b-ac4225959886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ECEFBC8B0>]}
2021-10-06 10:52:28.810113 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 10:52:28.811110 (MainThread): 
2021-10-06 10:52:28.811110 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:52:28.812599 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 10:52:28.824352 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 10:52:28.824352 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 10:52:28.824352 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:52:31.027811 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.20 seconds
2021-10-06 10:52:31.030801 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 10:52:31.356793 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 10:52:31.364092 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 10:52:31.364092 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 10:52:31.364092 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 10:52:32.376832 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.01 seconds
2021-10-06 10:52:32.377825 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 10:52:32.683568 (MainThread): Using snowflake connection "master".
2021-10-06 10:52:32.683568 (MainThread): On master: BEGIN
2021-10-06 10:52:32.683568 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:52:33.519989 (MainThread): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-06 10:52:33.519989 (MainThread): On master: COMMIT
2021-10-06 10:52:33.519989 (MainThread): Using snowflake connection "master".
2021-10-06 10:52:33.520943 (MainThread): On master: COMMIT
2021-10-06 10:52:33.765314 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-06 10:52:33.765314 (MainThread): On master: Close
2021-10-06 10:52:34.045944 (MainThread): 12:52:34 | Concurrency: 1 threads (target='dev')
2021-10-06 10:52:34.045944 (MainThread): 12:52:34 | 
2021-10-06 10:52:34.047937 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:52:34.047937 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:52:34.047937 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:52:34.051195 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 10:52:34.052691 (Thread-1): finished collecting timing info
2021-10-06 10:52:34.052691 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:52:34.053688 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:52:34.053688 (Thread-1): 12:52:34 | 1 of 5 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 10:52:34.053688 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:52:34.053688 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:52:34.055251 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:52:34.056678 (Thread-1): finished collecting timing info
2021-10-06 10:52:34.078929 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:52:34.080825 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:52:34.080825 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 10:52:34.080825 (Thread-1): Opening a new connection, currently in state init
2021-10-06 10:52:34.981543 (Thread-1): SQL status: SUCCESS 1 in 0.90 seconds
2021-10-06 10:52:34.981543 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:52:34.982536 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 10:52:36.530735 (Thread-1): SQL status: SUCCESS 1 in 1.55 seconds
2021-10-06 10:52:36.532782 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:52:36.533850 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:52:36.533850 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:52:36.707451 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:52:36.721649 (Thread-1): finished collecting timing info
2021-10-06 10:52:36.722647 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 10:52:37.025331 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15ccc1c2-241d-4e6a-ad3b-ac4225959886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ECEE99E20>]}
2021-10-06 10:52:37.025331 (Thread-1): 12:52:37 | 1 of 5 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.97s]
2021-10-06 10:52:37.026342 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:52:37.026342 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:52:37.027340 (Thread-1): 12:52:37 | 2 of 5 START incremental model dbt.dates............................. [RUN]
2021-10-06 10:52:37.027340 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:52:37.027340 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 10:52:37.030328 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:52:37.032322 (Thread-1): finished collecting timing info
2021-10-06 10:52:37.051924 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:52:37.051924 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 10:52:37.051924 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:52:38.350215 (Thread-1): SQL status: SUCCESS 1 in 1.30 seconds
2021-10-06 10:52:38.360316 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:52:38.360316 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 10:52:38.608043 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-06 10:52:38.609037 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:52:38.609037 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:52:38.794953 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:52:38.796945 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:52:38.796945 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:52:38.954662 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 10:52:38.969752 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:52:38.972730 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:52:38.972730 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 10:52:39.159523 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-06 10:52:39.160531 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:52:39.160531 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 10:52:39.546549 (Thread-1): SQL status: SUCCESS 0 in 0.39 seconds
2021-10-06 10:52:39.547514 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:52:39.547514 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:52:39.547514 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:52:39.797750 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-06 10:52:39.797750 (Thread-1): finished collecting timing info
2021-10-06 10:52:39.797750 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 10:52:40.095505 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15ccc1c2-241d-4e6a-ad3b-ac4225959886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ECEFA6400>]}
2021-10-06 10:52:40.096503 (Thread-1): 12:52:40 | 2 of 5 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.07s]
2021-10-06 10:52:40.096503 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:52:40.097499 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:52:40.097499 (Thread-1): 12:52:40 | 3 of 5 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 10:52:40.098578 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:52:40.098578 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:52:40.100556 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:52:40.102485 (Thread-1): finished collecting timing info
2021-10-06 10:52:40.104560 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:52:40.106544 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:52:40.106544 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 10:52:40.106544 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:52:40.904188 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-06 10:52:40.904188 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:52:40.904188 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 10:52:42.345960 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-10-06 10:52:42.347951 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:52:42.347951 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:52:42.347951 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:52:42.523007 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:52:42.524049 (Thread-1): finished collecting timing info
2021-10-06 10:52:42.524049 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 10:52:42.874038 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15ccc1c2-241d-4e6a-ad3b-ac4225959886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ECF2DD160>]}
2021-10-06 10:52:42.875029 (Thread-1): 12:52:42 | 3 of 5 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.78s]
2021-10-06 10:52:42.875957 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:52:42.876993 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-06 10:52:42.876993 (Thread-1): 12:52:42 | 4 of 5 START incremental model dbt.time.............................. [RUN]
2021-10-06 10:52:42.876993 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:52:42.877951 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-06 10:52:42.880992 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 10:52:42.886028 (Thread-1): finished collecting timing info
2021-10-06 10:52:42.888030 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:52:42.888030 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) <= current_time


  and t_time > (select max(t_time) from analytics.dbt.time)

      );
2021-10-06 10:52:42.888030 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:52:44.068850 (Thread-1): Snowflake query id: 019f6ccc-0601-33d0-0000-006647037c65
2021-10-06 10:52:44.068850 (Thread-1): Snowflake error: 002036 (42601): SQL compilation error:
Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:52:44.069856 (Thread-1): finished collecting timing info
2021-10-06 10:52:44.069856 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-06 10:52:44.361688 (Thread-1): Database Error in model time (models\example\time.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002036 (42601): SQL compilation error:
Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model time (models\example\time.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:52:44.362684 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15ccc1c2-241d-4e6a-ad3b-ac4225959886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ECEFA5E80>]}
2021-10-06 10:52:44.363316 (Thread-1): 12:52:44 | 4 of 5 ERROR creating incremental model dbt.time..................... [ERROR in 1.49s]
2021-10-06 10:52:44.364016 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-06 10:52:44.364225 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:52:44.364722 (Thread-1): 12:52:44 | 5 of 5 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 10:52:44.364722 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:52:44.364722 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:52:44.372849 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:52:44.377609 (Thread-1): finished collecting timing info
2021-10-06 10:52:44.380597 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:52:44.382591 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:52:44.382591 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 10:52:44.382591 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:52:45.398797 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-06 10:52:45.398797 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:52:45.398797 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (with __dbt__cte__my_first_dbt_model as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
)-- Use the `ref` function to select from other models


select *
from __dbt__cte__my_first_dbt_model
where id = 1
      );
2021-10-06 10:52:46.308877 (Thread-1): SQL status: SUCCESS 1 in 0.91 seconds
2021-10-06 10:52:46.309895 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:52:46.309895 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:52:46.309895 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:52:46.486680 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:52:46.488671 (Thread-1): finished collecting timing info
2021-10-06 10:52:46.488671 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 10:52:46.880957 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15ccc1c2-241d-4e6a-ad3b-ac4225959886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ECEFA5E80>]}
2021-10-06 10:52:46.882028 (Thread-1): 12:52:46 | 5 of 5 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.52s]
2021-10-06 10:52:46.882949 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:52:46.883946 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:52:46.883946 (MainThread): Using snowflake connection "master".
2021-10-06 10:52:46.883946 (MainThread): On master: BEGIN
2021-10-06 10:52:46.883946 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:52:47.693446 (MainThread): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-06 10:52:47.693446 (MainThread): On master: COMMIT
2021-10-06 10:52:47.694442 (MainThread): Using snowflake connection "master".
2021-10-06 10:52:47.694442 (MainThread): On master: COMMIT
2021-10-06 10:52:47.927442 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-06 10:52:47.927442 (MainThread): On master: Close
2021-10-06 10:52:48.233482 (MainThread): 12:52:48 | 
2021-10-06 10:52:48.233482 (MainThread): 12:52:48 | Finished running 3 table models, 2 incremental models in 19.42s.
2021-10-06 10:52:48.236949 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:52:48.236949 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 10:52:48.236949 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 10:52:48.236949 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 10:52:48.255149 (MainThread): 
2021-10-06 10:52:48.255149 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:52:48.256146 (MainThread): 
2021-10-06 10:52:48.257468 (MainThread): Database Error in model time (models\example\time.sql)
2021-10-06 10:52:48.259582 (MainThread):   002036 (42601): SQL compilation error:
2021-10-06 10:52:48.261565 (MainThread):   Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:52:48.261565 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-10-06 10:52:48.261565 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ECF2D20A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ECF358DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ECF358760>]}
2021-10-06 10:52:48.261565 (MainThread): Flushing usage events
2021-10-06 10:54:23.294284 (MainThread): Running with dbt=0.20.2
2021-10-06 10:54:23.818544 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 10:54:23.819610 (MainThread): Tracking: tracking
2021-10-06 10:54:23.819610 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DA27DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DB7ACDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DB7AC760>]}
2021-10-06 10:54:23.825589 (MainThread): Partial parsing not enabled
2021-10-06 10:54:23.836707 (MainThread): Parsing macros\adapters.sql
2021-10-06 10:54:23.854026 (MainThread): Parsing macros\catalog.sql
2021-10-06 10:54:23.855028 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 10:54:23.861003 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 10:54:23.862006 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 10:54:23.863993 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 10:54:23.864987 (MainThread): Parsing macros\core.sql
2021-10-06 10:54:23.866909 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 10:54:23.894023 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 10:54:23.899466 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 10:54:23.900722 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 10:54:23.901459 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 10:54:23.902455 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 10:54:23.903452 (MainThread): Parsing macros\etc\query.sql
2021-10-06 10:54:23.904039 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 10:54:23.909441 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 10:54:23.913498 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 10:54:23.922547 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 10:54:23.923543 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 10:54:23.927538 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 10:54:23.940189 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 10:54:23.957228 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 10:54:23.958226 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 10:54:23.967728 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 10:54:23.971714 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 10:54:23.974704 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 10:54:23.977825 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 10:54:23.979819 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 10:54:23.979819 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 10:54:23.980815 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 10:54:24.087136 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:54:24.093117 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:54:24.098100 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:54:24.101806 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:54:24.102806 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:54:24.104798 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:54:24.121852 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:54:24.122849 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:54:24.123845 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:54:24.124842 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:54:24.153867 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:54:24.156857 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:54:24.159847 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:54:24.178919 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '694141e9-67b1-434c-8b1a-3d19e66fcf5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DA27D970>]}
2021-10-06 10:54:24.197647 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:54:24.197647 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '694141e9-67b1-434c-8b1a-3d19e66fcf5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DA27DEE0>]}
2021-10-06 10:54:24.198600 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 10:54:24.199803 (MainThread): 
2021-10-06 10:54:24.199803 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:54:24.200800 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 10:54:24.211704 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 10:54:24.211704 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 10:54:24.211704 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:54:26.249825 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.04 seconds
2021-10-06 10:54:26.253823 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 10:54:26.650979 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 10:54:26.658956 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 10:54:26.658956 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 10:54:26.658956 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 10:54:27.449841 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.79 seconds
2021-10-06 10:54:27.451834 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 10:54:27.801180 (MainThread): Using snowflake connection "master".
2021-10-06 10:54:27.801180 (MainThread): On master: BEGIN
2021-10-06 10:54:27.801180 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:54:28.828468 (MainThread): SQL status: SUCCESS 1 in 1.03 seconds
2021-10-06 10:54:28.829464 (MainThread): On master: COMMIT
2021-10-06 10:54:28.829464 (MainThread): Using snowflake connection "master".
2021-10-06 10:54:28.829464 (MainThread): On master: COMMIT
2021-10-06 10:54:29.100007 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-06 10:54:29.100007 (MainThread): On master: Close
2021-10-06 10:54:29.392582 (MainThread): 12:54:29 | Concurrency: 1 threads (target='dev')
2021-10-06 10:54:29.392582 (MainThread): 12:54:29 | 
2021-10-06 10:54:29.395595 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:54:29.395595 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:54:29.395595 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:54:29.397597 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 10:54:29.399938 (Thread-1): finished collecting timing info
2021-10-06 10:54:29.399938 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:54:29.400935 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:54:29.400935 (Thread-1): 12:54:29 | 1 of 5 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 10:54:29.400935 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:54:29.400935 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:54:29.402003 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:54:29.402927 (Thread-1): finished collecting timing info
2021-10-06 10:54:29.422140 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:54:29.424369 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:54:29.424369 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 10:54:29.424369 (Thread-1): Opening a new connection, currently in state init
2021-10-06 10:54:30.259123 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-06 10:54:30.259123 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:54:30.259123 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 10:54:31.705869 (Thread-1): SQL status: SUCCESS 1 in 1.45 seconds
2021-10-06 10:54:31.706868 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:54:31.706868 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:54:31.706868 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:54:31.931855 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-06 10:54:31.939827 (Thread-1): finished collecting timing info
2021-10-06 10:54:31.939827 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 10:54:32.248952 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '694141e9-67b1-434c-8b1a-3d19e66fcf5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DB82B9A0>]}
2021-10-06 10:54:32.248952 (Thread-1): 12:54:32 | 1 of 5 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.85s]
2021-10-06 10:54:32.251485 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:54:32.251485 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:54:32.251485 (Thread-1): 12:54:32 | 2 of 5 START incremental model dbt.dates............................. [RUN]
2021-10-06 10:54:32.252486 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:54:32.252486 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 10:54:32.257593 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:54:32.259127 (Thread-1): finished collecting timing info
2021-10-06 10:54:32.273593 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:54:32.273593 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 10:54:32.274094 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:54:33.524404 (Thread-1): SQL status: SUCCESS 1 in 1.25 seconds
2021-10-06 10:54:33.533365 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:54:33.533365 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 10:54:33.717223 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:54:33.719216 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:54:33.719216 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:54:33.923617 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-06 10:54:33.927822 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:54:33.927822 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:54:34.114721 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-06 10:54:34.121723 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:54:34.123631 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:54:34.123631 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 10:54:34.319087 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-06 10:54:34.320110 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:54:34.320110 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 10:54:34.713819 (Thread-1): SQL status: SUCCESS 0 in 0.39 seconds
2021-10-06 10:54:34.714819 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:54:34.715886 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:54:34.715886 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:54:34.967636 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-06 10:54:34.968632 (Thread-1): finished collecting timing info
2021-10-06 10:54:34.968632 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 10:54:35.293190 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '694141e9-67b1-434c-8b1a-3d19e66fcf5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DB82B9A0>]}
2021-10-06 10:54:35.295389 (Thread-1): 12:54:35 | 2 of 5 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.04s]
2021-10-06 10:54:35.297374 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:54:35.297374 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:54:35.297374 (Thread-1): 12:54:35 | 3 of 5 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 10:54:35.299366 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:54:35.299366 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:54:35.300358 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:54:35.301975 (Thread-1): finished collecting timing info
2021-10-06 10:54:35.302980 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:54:35.304973 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:54:35.304973 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 10:54:35.304973 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:54:36.280910 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-06 10:54:36.280910 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:54:36.280910 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 10:54:37.735452 (Thread-1): SQL status: SUCCESS 1 in 1.45 seconds
2021-10-06 10:54:37.737411 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:54:37.737411 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:54:37.737411 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:54:37.920176 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:54:37.922159 (Thread-1): finished collecting timing info
2021-10-06 10:54:37.922159 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 10:54:38.217357 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '694141e9-67b1-434c-8b1a-3d19e66fcf5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DB82B9A0>]}
2021-10-06 10:54:38.217357 (Thread-1): 12:54:38 | 3 of 5 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.92s]
2021-10-06 10:54:38.219304 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:54:38.219304 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-06 10:54:38.220340 (Thread-1): 12:54:38 | 4 of 5 START incremental model dbt.time.............................. [RUN]
2021-10-06 10:54:38.220340 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:54:38.221370 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-06 10:54:38.225361 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 10:54:38.229828 (Thread-1): finished collecting timing info
2021-10-06 10:54:38.232744 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:54:38.232744 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and t_time > (select max(t_time) from analytics.dbt.time)

      );
2021-10-06 10:54:38.232744 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:54:39.198895 (Thread-1): Snowflake query id: 019f6cce-0601-3497-0000-006647038c15
2021-10-06 10:54:39.198895 (Thread-1): Snowflake error: 002036 (42601): SQL compilation error:
Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:54:39.198895 (Thread-1): finished collecting timing info
2021-10-06 10:54:39.198895 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-06 10:54:39.479789 (Thread-1): Database Error in model time (models\example\time.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002036 (42601): SQL compilation error:
Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model time (models\example\time.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:54:39.481780 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '694141e9-67b1-434c-8b1a-3d19e66fcf5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DB89FC70>]}
2021-10-06 10:54:39.482833 (Thread-1): 12:54:39 | 4 of 5 ERROR creating incremental model dbt.time..................... [ERROR in 1.26s]
2021-10-06 10:54:39.484698 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-06 10:54:39.484698 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:54:39.484698 (Thread-1): 12:54:39 | 5 of 5 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 10:54:39.485742 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:54:39.485742 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:54:39.491753 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:54:39.492671 (Thread-1): finished collecting timing info
2021-10-06 10:54:39.493668 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:54:39.495663 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:54:39.495663 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 10:54:39.495663 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:54:40.518526 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-06 10:54:40.518526 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:54:40.518526 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (with __dbt__cte__my_first_dbt_model as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
)-- Use the `ref` function to select from other models


select *
from __dbt__cte__my_first_dbt_model
where id = 1
      );
2021-10-06 10:54:41.927339 (Thread-1): SQL status: SUCCESS 1 in 1.41 seconds
2021-10-06 10:54:41.929340 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:54:41.929340 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:54:41.929340 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:54:42.108923 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:54:42.109928 (Thread-1): finished collecting timing info
2021-10-06 10:54:42.109928 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 10:54:42.445310 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '694141e9-67b1-434c-8b1a-3d19e66fcf5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DB89F2B0>]}
2021-10-06 10:54:42.445310 (Thread-1): 12:54:42 | 5 of 5 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.96s]
2021-10-06 10:54:42.446307 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:54:42.449222 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:54:42.449222 (MainThread): Using snowflake connection "master".
2021-10-06 10:54:42.449222 (MainThread): On master: BEGIN
2021-10-06 10:54:42.449222 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:54:43.360920 (MainThread): SQL status: SUCCESS 1 in 0.91 seconds
2021-10-06 10:54:43.361913 (MainThread): On master: COMMIT
2021-10-06 10:54:43.361913 (MainThread): Using snowflake connection "master".
2021-10-06 10:54:43.361913 (MainThread): On master: COMMIT
2021-10-06 10:54:43.650846 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-06 10:54:43.651840 (MainThread): On master: Close
2021-10-06 10:54:43.977964 (MainThread): 12:54:43 | 
2021-10-06 10:54:43.978537 (MainThread): 12:54:43 | Finished running 3 table models, 2 incremental models in 19.78s.
2021-10-06 10:54:43.979839 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:54:43.980848 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 10:54:43.980848 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 10:54:43.980848 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 10:54:44.000746 (MainThread): 
2021-10-06 10:54:44.001755 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 10:54:44.001755 (MainThread): 
2021-10-06 10:54:44.002792 (MainThread): Database Error in model time (models\example\time.sql)
2021-10-06 10:54:44.004862 (MainThread):   002036 (42601): SQL compilation error:
2021-10-06 10:54:44.004862 (MainThread):   Subquery containing correlated aggregate function [MAX(TIME_DIM.T_TIME)] can only appear in having or select clause
2021-10-06 10:54:44.006000 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-10-06 10:54:44.006000 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DB8F6BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DB7EB0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9DB7BC130>]}
2021-10-06 10:54:44.006000 (MainThread): Flushing usage events
2021-10-06 10:54:57.636834 (MainThread): Running with dbt=0.20.2
2021-10-06 10:54:58.150674 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 10:54:58.151783 (MainThread): Tracking: tracking
2021-10-06 10:54:58.151783 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A101BEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A254CAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A254C400>]}
2021-10-06 10:54:58.157784 (MainThread): Partial parsing not enabled
2021-10-06 10:54:58.167841 (MainThread): Parsing macros\adapters.sql
2021-10-06 10:54:58.185941 (MainThread): Parsing macros\catalog.sql
2021-10-06 10:54:58.186938 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 10:54:58.192918 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 10:54:58.193915 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 10:54:58.195908 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 10:54:58.196905 (MainThread): Parsing macros\core.sql
2021-10-06 10:54:58.198963 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 10:54:58.226160 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 10:54:58.233982 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 10:54:58.234473 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 10:54:58.235282 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 10:54:58.237314 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 10:54:58.238307 (MainThread): Parsing macros\etc\query.sql
2021-10-06 10:54:58.238307 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 10:54:58.244881 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 10:54:58.248957 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 10:54:58.257929 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 10:54:58.258923 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 10:54:58.263474 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 10:54:58.275524 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 10:54:58.293152 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 10:54:58.293152 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 10:54:58.303119 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 10:54:58.307171 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 10:54:58.310328 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 10:54:58.314324 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 10:54:58.315310 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 10:54:58.316309 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 10:54:58.316309 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 10:54:58.412815 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:54:58.417911 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:54:58.421898 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:54:58.423892 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:54:58.425885 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:54:58.427878 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:54:58.444935 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:54:58.445933 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:54:58.447926 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:54:58.449079 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:54:58.477993 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:54:58.481980 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:54:58.483973 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 10:54:58.498922 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e76a90e8-d978-4e50-9d83-f7ffd0ddb211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A25B2D90>]}
2021-10-06 10:54:58.523883 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 10:54:58.523883 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e76a90e8-d978-4e50-9d83-f7ffd0ddb211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A255C070>]}
2021-10-06 10:54:58.524879 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 10:54:58.525875 (MainThread): 
2021-10-06 10:54:58.525875 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:54:58.526870 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 10:54:58.537094 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 10:54:58.538165 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 10:54:58.538165 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 10:55:00.245846 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.71 seconds
2021-10-06 10:55:00.249828 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 10:55:00.564683 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 10:55:00.572661 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 10:55:00.572661 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 10:55:00.572661 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 10:55:01.464435 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.89 seconds
2021-10-06 10:55:01.466019 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 10:55:01.774727 (MainThread): Using snowflake connection "master".
2021-10-06 10:55:01.774727 (MainThread): On master: BEGIN
2021-10-06 10:55:01.774727 (MainThread): Opening a new connection, currently in state init
2021-10-06 10:55:02.772249 (MainThread): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-06 10:55:02.773243 (MainThread): On master: COMMIT
2021-10-06 10:55:02.773243 (MainThread): Using snowflake connection "master".
2021-10-06 10:55:02.773243 (MainThread): On master: COMMIT
2021-10-06 10:55:03.008149 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-06 10:55:03.008149 (MainThread): On master: Close
2021-10-06 10:55:03.316405 (MainThread): 12:55:03 | Concurrency: 1 threads (target='dev')
2021-10-06 10:55:03.316405 (MainThread): 12:55:03 | 
2021-10-06 10:55:03.322111 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:55:03.323184 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 10:55:03.323184 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:55:03.327169 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 10:55:03.329156 (Thread-1): finished collecting timing info
2021-10-06 10:55:03.329156 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 10:55:03.329156 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:55:03.329156 (Thread-1): 12:55:03 | 1 of 5 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 10:55:03.330295 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:55:03.330295 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:55:03.331292 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:55:03.333323 (Thread-1): finished collecting timing info
2021-10-06 10:55:03.355661 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 10:55:03.357653 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:55:03.357653 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 10:55:03.357653 (Thread-1): Opening a new connection, currently in state init
2021-10-06 10:55:04.396877 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-10-06 10:55:04.396877 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:55:04.396877 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 10:55:05.803413 (Thread-1): SQL status: SUCCESS 1 in 1.41 seconds
2021-10-06 10:55:05.805405 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:55:05.805405 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 10:55:05.805405 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 10:55:05.968546 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 10:55:05.974619 (Thread-1): finished collecting timing info
2021-10-06 10:55:05.974619 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 10:55:06.275217 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e76a90e8-d978-4e50-9d83-f7ffd0ddb211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A267AEB0>]}
2021-10-06 10:55:06.275217 (Thread-1): 12:55:06 | 1 of 5 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.94s]
2021-10-06 10:55:06.277315 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 10:55:06.277315 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:55:06.277315 (Thread-1): 12:55:06 | 2 of 5 START incremental model dbt.dates............................. [RUN]
2021-10-06 10:55:06.277315 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:55:06.277315 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 10:55:06.282302 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:55:06.283346 (Thread-1): finished collecting timing info
2021-10-06 10:55:06.301174 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:55:06.301174 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 10:55:06.301174 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:55:07.587039 (Thread-1): SQL status: SUCCESS 1 in 1.29 seconds
2021-10-06 10:55:07.595013 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:55:07.595013 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 10:55:07.775445 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:55:07.779432 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:55:07.780397 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:55:08.025314 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-06 10:55:08.026299 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:55:08.026299 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 10:55:08.206762 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:55:08.214767 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 10:55:08.216694 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:55:08.216694 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 10:55:08.497786 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-06 10:55:08.498779 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:55:08.498779 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 10:55:08.921342 (Thread-1): SQL status: SUCCESS 0 in 0.42 seconds
2021-10-06 10:55:08.922335 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:55:08.922832 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 10:55:08.922832 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 10:55:09.169209 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-06 10:55:09.170206 (Thread-1): finished collecting timing info
2021-10-06 10:55:09.171202 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 10:55:09.572144 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e76a90e8-d978-4e50-9d83-f7ffd0ddb211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A283A850>]}
2021-10-06 10:55:09.573137 (Thread-1): 12:55:09 | 2 of 5 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.29s]
2021-10-06 10:55:09.574133 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 10:55:09.574133 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:55:09.575129 (Thread-1): 12:55:09 | 3 of 5 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 10:55:09.575129 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:55:09.576126 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:55:09.579116 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:55:09.581310 (Thread-1): finished collecting timing info
2021-10-06 10:55:09.584454 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 10:55:09.585554 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:55:09.585554 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 10:55:09.586630 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:55:10.522541 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-10-06 10:55:10.522541 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:55:10.522541 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 10:55:12.007928 (Thread-1): SQL status: SUCCESS 1 in 1.49 seconds
2021-10-06 10:55:12.009910 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:55:12.009910 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 10:55:12.009910 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 10:55:12.180532 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:55:12.181540 (Thread-1): finished collecting timing info
2021-10-06 10:55:12.181540 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 10:55:12.489552 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e76a90e8-d978-4e50-9d83-f7ffd0ddb211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A2863B80>]}
2021-10-06 10:55:12.489552 (Thread-1): 12:55:12 | 3 of 5 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.91s]
2021-10-06 10:55:12.491317 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 10:55:12.491317 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-06 10:55:12.491317 (Thread-1): 12:55:12 | 4 of 5 START incremental model dbt.time.............................. [RUN]
2021-10-06 10:55:12.491766 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:55:12.491766 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-06 10:55:12.496754 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 10:55:12.503319 (Thread-1): finished collecting timing info
2021-10-06 10:55:12.505388 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:55:12.506381 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-06 10:55:12.506381 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:55:14.346793 (Thread-1): SQL status: SUCCESS 1 in 1.84 seconds
2021-10-06 10:55:14.349782 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:55:14.350779 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-06 10:55:14.535416 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:55:14.538406 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:55:14.538406 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-06 10:55:14.694465 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 10:55:14.697381 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:55:14.697381 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-06 10:55:14.858831 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 10:55:14.861819 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 10:55:14.868784 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:55:14.868784 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-06 10:55:15.049388 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 10:55:15.049388 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:55:15.049388 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-06 10:55:15.902106 (Thread-1): SQL status: SUCCESS 2190 in 0.85 seconds
2021-10-06 10:55:15.904315 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-06 10:55:15.905311 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 10:55:15.905311 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-06 10:55:16.256034 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-10-06 10:55:16.258172 (Thread-1): finished collecting timing info
2021-10-06 10:55:16.258172 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-06 10:55:16.602153 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e76a90e8-d978-4e50-9d83-f7ffd0ddb211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A2978A30>]}
2021-10-06 10:55:16.602153 (Thread-1): 12:55:16 | 4 of 5 OK created incremental model dbt.time......................... [SUCCESS 2190 in 4.11s]
2021-10-06 10:55:16.603396 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-06 10:55:16.603396 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:55:16.603396 (Thread-1): 12:55:16 | 5 of 5 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 10:55:16.603396 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:55:16.603396 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:55:16.609377 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:55:16.610375 (Thread-1): finished collecting timing info
2021-10-06 10:55:16.611485 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 10:55:16.614950 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:55:16.614950 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 10:55:16.615478 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 10:55:17.570368 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-10-06 10:55:17.571363 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:55:17.571363 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (with __dbt__cte__my_first_dbt_model as (
/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
)-- Use the `ref` function to select from other models


select *
from __dbt__cte__my_first_dbt_model
where id = 1
      );
2021-10-06 10:55:18.490653 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2021-10-06 10:55:18.492566 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:55:18.492566 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 10:55:18.493634 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 10:55:18.660288 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 10:55:18.661286 (Thread-1): finished collecting timing info
2021-10-06 10:55:18.661286 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 10:55:18.968128 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e76a90e8-d978-4e50-9d83-f7ffd0ddb211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A294F100>]}
2021-10-06 10:55:18.968128 (Thread-1): 12:55:18 | 5 of 5 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.36s]
2021-10-06 10:55:18.970462 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 10:55:18.972667 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 10:55:18.972667 (MainThread): Using snowflake connection "master".
2021-10-06 10:55:18.972667 (MainThread): On master: BEGIN
2021-10-06 10:55:18.972667 (MainThread): Opening a new connection, currently in state closed
2021-10-06 10:55:19.889339 (MainThread): SQL status: SUCCESS 1 in 0.92 seconds
2021-10-06 10:55:19.890336 (MainThread): On master: COMMIT
2021-10-06 10:55:19.890336 (MainThread): Using snowflake connection "master".
2021-10-06 10:55:19.890336 (MainThread): On master: COMMIT
2021-10-06 10:55:20.185057 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-06 10:55:20.185057 (MainThread): On master: Close
2021-10-06 10:55:20.535351 (MainThread): 12:55:20 | 
2021-10-06 10:55:20.536284 (MainThread): 12:55:20 | Finished running 3 table models, 2 incremental models in 22.01s.
2021-10-06 10:55:20.536284 (MainThread): Connection 'master' was properly closed.
2021-10-06 10:55:20.537250 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 10:55:20.537250 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 10:55:20.537250 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 10:55:20.549463 (MainThread): 
2021-10-06 10:55:20.549463 (MainThread): Completed successfully
2021-10-06 10:55:20.550470 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-10-06 10:55:20.550470 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A2856580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A2616130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A2616FD0>]}
2021-10-06 10:55:20.550470 (MainThread): Flushing usage events
2021-10-06 11:00:56.310547 (MainThread): Running with dbt=0.20.2
2021-10-06 11:00:56.820424 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 11:00:56.820424 (MainThread): Tracking: tracking
2021-10-06 11:00:56.820424 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA71E0DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA73354E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA73354730>]}
2021-10-06 11:00:56.826405 (MainThread): Partial parsing not enabled
2021-10-06 11:00:56.837368 (MainThread): Parsing macros\adapters.sql
2021-10-06 11:00:56.857261 (MainThread): Parsing macros\catalog.sql
2021-10-06 11:00:56.858265 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 11:00:56.863944 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 11:00:56.864950 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 11:00:56.866946 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 11:00:56.867931 (MainThread): Parsing macros\core.sql
2021-10-06 11:00:56.869935 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 11:00:56.896979 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 11:00:56.901962 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 11:00:56.902959 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 11:00:56.903956 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 11:00:56.904952 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 11:00:56.905949 (MainThread): Parsing macros\etc\query.sql
2021-10-06 11:00:56.905949 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 11:00:56.911520 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 11:00:56.915506 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 11:00:56.924015 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 11:00:56.925012 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 11:00:56.929995 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 11:00:56.942610 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 11:00:56.960699 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 11:00:56.961695 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 11:00:56.970841 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 11:00:56.974834 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 11:00:56.977823 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 11:00:56.980806 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 11:00:56.982804 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 11:00:56.983725 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 11:00:56.983725 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 11:00:57.085236 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:00:57.090209 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:00:57.096815 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:00:57.100798 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:00:57.100798 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 11:00:57.103283 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:00:57.105344 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:00:57.122254 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:00:57.124281 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:00:57.125360 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:00:57.126407 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:00:57.127439 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:00:57.158348 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:00:57.161324 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:00:57.176796 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c00b9b90-084f-4d55-bebb-2ae4e4971c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA733A82E0>]}
2021-10-06 11:00:57.191950 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 11:00:57.191950 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c00b9b90-084f-4d55-bebb-2ae4e4971c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA733A2970>]}
2021-10-06 11:00:57.191950 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 11:00:57.192946 (MainThread): 
2021-10-06 11:00:57.193944 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 11:00:57.194940 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 11:00:57.203895 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 11:00:57.203895 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 11:00:57.203895 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 11:00:59.055729 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.85 seconds
2021-10-06 11:00:59.058719 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 11:00:59.478847 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 11:00:59.489046 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 11:00:59.489046 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 11:00:59.489046 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 11:01:00.313398 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.82 seconds
2021-10-06 11:01:00.313398 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 11:01:00.619839 (MainThread): Using snowflake connection "master".
2021-10-06 11:01:00.619839 (MainThread): On master: BEGIN
2021-10-06 11:01:00.620835 (MainThread): Opening a new connection, currently in state init
2021-10-06 11:01:01.732378 (MainThread): SQL status: SUCCESS 1 in 1.11 seconds
2021-10-06 11:01:01.733373 (MainThread): On master: COMMIT
2021-10-06 11:01:01.733373 (MainThread): Using snowflake connection "master".
2021-10-06 11:01:01.733373 (MainThread): On master: COMMIT
2021-10-06 11:01:02.023996 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-06 11:01:02.023996 (MainThread): On master: Close
2021-10-06 11:01:02.398351 (MainThread): 13:01:02 | Concurrency: 1 threads (target='dev')
2021-10-06 11:01:02.399468 (MainThread): 13:01:02 | 
2021-10-06 11:01:02.405728 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 11:01:02.405728 (Thread-1): 13:01:02 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-06 11:01:02.406899 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:01:02.406899 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 11:01:02.411887 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 11:01:02.413881 (Thread-1): finished collecting timing info
2021-10-06 11:01:02.431352 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 11:01:02.437419 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:01:02.437915 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-06 11:01:02.437915 (Thread-1): Opening a new connection, currently in state init
2021-10-06 11:01:03.252996 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-06 11:01:03.252996 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:01:03.252996 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-06 11:01:04.319091 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-10-06 11:01:04.320506 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-06 11:01:04.320506 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:01:04.320506 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-06 11:01:04.493886 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 11:01:04.501801 (Thread-1): finished collecting timing info
2021-10-06 11:01:04.501801 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-06 11:01:04.842564 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c00b9b90-084f-4d55-bebb-2ae4e4971c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA73627AF0>]}
2021-10-06 11:01:04.843561 (Thread-1): 13:01:04 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.44s]
2021-10-06 11:01:04.844557 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 11:01:04.844557 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 11:01:04.846028 (Thread-1): 13:01:04 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 11:01:04.846539 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:01:04.846539 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 11:01:04.847540 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 11:01:04.850298 (Thread-1): finished collecting timing info
2021-10-06 11:01:04.852222 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 11:01:04.854212 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:01:04.854212 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 11:01:04.854212 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:01:05.683241 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-06 11:01:05.683241 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:01:05.683241 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 11:01:07.226264 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2021-10-06 11:01:07.228256 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 11:01:07.229254 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:01:07.229254 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 11:01:07.421740 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-06 11:01:07.423764 (Thread-1): finished collecting timing info
2021-10-06 11:01:07.423764 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 11:01:07.753077 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c00b9b90-084f-4d55-bebb-2ae4e4971c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA733275E0>]}
2021-10-06 11:01:07.754064 (Thread-1): 13:01:07 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.91s]
2021-10-06 11:01:07.755064 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 11:01:07.755064 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 11:01:07.756055 (Thread-1): 13:01:07 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-06 11:01:07.756055 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:01:07.756055 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 11:01:07.760044 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 11:01:07.761042 (Thread-1): finished collecting timing info
2021-10-06 11:01:07.779180 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:01:07.779180 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 11:01:07.779180 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:01:09.368083 (Thread-1): SQL status: SUCCESS 1 in 1.59 seconds
2021-10-06 11:01:09.379128 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:01:09.379128 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 11:01:09.660733 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-06 11:01:09.663813 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:01:09.663813 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 11:01:09.854707 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-06 11:01:09.856810 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:01:09.857817 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 11:01:10.055668 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-06 11:01:10.065845 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 11:01:10.067640 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:01:10.067640 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 11:01:10.292250 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-06 11:01:10.292250 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:01:10.292250 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 11:01:10.723365 (Thread-1): SQL status: SUCCESS 0 in 0.43 seconds
2021-10-06 11:01:10.723365 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 11:01:10.723365 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:01:10.724360 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 11:01:11.014731 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-06 11:01:11.015725 (Thread-1): finished collecting timing info
2021-10-06 11:01:11.015725 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 11:01:11.333167 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c00b9b90-084f-4d55-bebb-2ae4e4971c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA733303D0>]}
2021-10-06 11:01:11.333167 (Thread-1): 13:01:11 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.58s]
2021-10-06 11:01:11.333167 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 11:01:11.333167 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 11:01:11.334121 (Thread-1): 13:01:11 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 11:01:11.335242 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:01:11.335242 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 11:01:11.336243 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 11:01:11.338237 (Thread-1): finished collecting timing info
2021-10-06 11:01:11.340238 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 11:01:11.341833 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:01:11.341833 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 11:01:11.341833 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:01:12.673246 (Thread-1): SQL status: SUCCESS 1 in 1.33 seconds
2021-10-06 11:01:12.674321 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:01:12.674321 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 11:01:14.150263 (Thread-1): SQL status: SUCCESS 1 in 1.48 seconds
2021-10-06 11:01:14.151283 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 11:01:14.151283 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:01:14.151283 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 11:01:14.305662 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-06 11:01:14.306667 (Thread-1): finished collecting timing info
2021-10-06 11:01:14.306667 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 11:01:14.644479 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c00b9b90-084f-4d55-bebb-2ae4e4971c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA73483A00>]}
2021-10-06 11:01:14.645463 (Thread-1): 13:01:14 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.31s]
2021-10-06 11:01:14.646393 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 11:01:14.646393 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-06 11:01:14.646393 (Thread-1): 13:01:14 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-06 11:01:14.646393 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:01:14.647395 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-06 11:01:14.649386 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 11:01:14.654215 (Thread-1): finished collecting timing info
2021-10-06 11:01:14.657208 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:01:14.657208 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-06 11:01:14.657208 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:01:16.274128 (Thread-1): SQL status: SUCCESS 1 in 1.62 seconds
2021-10-06 11:01:16.275126 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:01:16.275126 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-06 11:01:16.476681 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-06 11:01:16.478743 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:01:16.478743 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-06 11:01:16.645235 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 11:01:16.647304 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:01:16.647304 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-06 11:01:16.815987 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 11:01:16.816983 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 11:01:16.822982 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:01:16.822982 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-06 11:01:17.015759 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-06 11:01:17.015759 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:01:17.015759 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-06 11:01:17.703730 (Thread-1): SQL status: SUCCESS 362 in 0.69 seconds
2021-10-06 11:01:17.705918 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-06 11:01:17.705918 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:01:17.705918 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-06 11:01:18.062721 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-06 11:01:18.062721 (Thread-1): finished collecting timing info
2021-10-06 11:01:18.062721 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-06 11:01:18.413176 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c00b9b90-084f-4d55-bebb-2ae4e4971c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA737719D0>]}
2021-10-06 11:01:18.413176 (Thread-1): 13:01:18 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 362 in 3.77s]
2021-10-06 11:01:18.415198 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-06 11:01:18.415198 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 11:01:18.415198 (Thread-1): 13:01:18 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 11:01:18.416208 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 11:01:18.417277 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 11:01:18.420443 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 11:01:18.421475 (Thread-1): finished collecting timing info
2021-10-06 11:01:18.422472 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 11:01:18.424390 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 11:01:18.424390 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 11:01:18.424390 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:01:19.474208 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-10-06 11:01:19.474208 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 11:01:19.474208 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
where id = 1
      );
2021-10-06 11:01:20.553276 (Thread-1): SQL status: SUCCESS 1 in 1.08 seconds
2021-10-06 11:01:20.555276 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 11:01:20.555276 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 11:01:20.555276 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 11:01:20.731899 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 11:01:20.733965 (Thread-1): finished collecting timing info
2021-10-06 11:01:20.733965 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 11:01:21.021821 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c00b9b90-084f-4d55-bebb-2ae4e4971c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA7332EB80>]}
2021-10-06 11:01:21.021821 (Thread-1): 13:01:21 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.61s]
2021-10-06 11:01:21.023910 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 11:01:21.023910 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 11:01:21.025127 (MainThread): Using snowflake connection "master".
2021-10-06 11:01:21.025127 (MainThread): On master: BEGIN
2021-10-06 11:01:21.025127 (MainThread): Opening a new connection, currently in state closed
2021-10-06 11:01:21.861304 (MainThread): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-06 11:01:21.861304 (MainThread): On master: COMMIT
2021-10-06 11:01:21.861304 (MainThread): Using snowflake connection "master".
2021-10-06 11:01:21.861304 (MainThread): On master: COMMIT
2021-10-06 11:01:22.130201 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-06 11:01:22.130201 (MainThread): On master: Close
2021-10-06 11:01:22.436374 (MainThread): 13:01:22 | 
2021-10-06 11:01:22.436374 (MainThread): 13:01:22 | Finished running 4 table models, 2 incremental models in 25.24s.
2021-10-06 11:01:22.437364 (MainThread): Connection 'master' was properly closed.
2021-10-06 11:01:22.438357 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 11:01:22.438357 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 11:01:22.438357 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 11:01:22.449989 (MainThread): 
2021-10-06 11:01:22.449989 (MainThread): Completed successfully
2021-10-06 11:01:22.451339 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-06 11:01:22.451339 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA733275E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA737F5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA73407B50>]}
2021-10-06 11:01:22.452339 (MainThread): Flushing usage events
2021-10-06 11:04:39.105450 (MainThread): Running with dbt=0.20.2
2021-10-06 11:04:39.641663 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 11:04:39.642689 (MainThread): Tracking: tracking
2021-10-06 11:04:39.642689 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE316CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE469C5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE469C4F0>]}
2021-10-06 11:04:39.649642 (MainThread): Partial parsing not enabled
2021-10-06 11:04:39.660802 (MainThread): Parsing macros\adapters.sql
2021-10-06 11:04:39.678997 (MainThread): Parsing macros\catalog.sql
2021-10-06 11:04:39.680916 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 11:04:39.685977 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 11:04:39.687034 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 11:04:39.690074 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 11:04:39.690074 (MainThread): Parsing macros\core.sql
2021-10-06 11:04:39.692067 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 11:04:39.719559 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 11:04:39.724542 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 11:04:39.725539 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 11:04:39.726536 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 11:04:39.727533 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 11:04:39.728529 (MainThread): Parsing macros\etc\query.sql
2021-10-06 11:04:39.728529 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 11:04:39.735658 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 11:04:39.739645 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 11:04:39.747618 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 11:04:39.749618 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 11:04:39.755654 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 11:04:39.769545 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 11:04:39.787088 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 11:04:39.788076 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 11:04:39.798133 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 11:04:39.803576 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 11:04:39.806548 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 11:04:39.809539 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 11:04:39.811540 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 11:04:39.811540 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 11:04:39.813081 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 11:04:39.913635 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:04:39.919614 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:04:39.924155 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:04:39.926222 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:04:39.926222 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:04:39.927228 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 11:04:39.929213 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:04:39.931134 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:04:39.948325 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:04:39.950310 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:04:39.951307 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:04:39.952303 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:04:39.953392 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:04:39.986007 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:04:39.990039 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:04:40.005509 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0977212d-0315-4792-9d16-52fa0e5ef395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE471F1C0>]}
2021-10-06 11:04:40.019716 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 11:04:40.019716 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0977212d-0315-4792-9d16-52fa0e5ef395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE316C820>]}
2021-10-06 11:04:40.019716 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 11:04:40.020714 (MainThread): 
2021-10-06 11:04:40.021709 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 11:04:40.024427 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 11:04:40.031735 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 11:04:40.031735 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 11:04:40.031735 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 11:04:41.797722 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.77 seconds
2021-10-06 11:04:41.800752 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 11:04:42.105572 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 11:04:42.106567 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 11:04:42.106567 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 11:04:42.106567 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-06 11:04:42.923249 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.82 seconds
2021-10-06 11:04:42.924246 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 11:04:43.224982 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt_luke_test".
2021-10-06 11:04:43.224982 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt_luke_test".
2021-10-06 11:04:43.225490 (ThreadPoolExecutor-0_0): Creating schema "analytics.dbt_luke_test"
2021-10-06 11:04:43.228490 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt_luke_test".
2021-10-06 11:04:43.228490 (ThreadPoolExecutor-0_0): On create_analytics_dbt_luke_test: BEGIN
2021-10-06 11:04:43.228490 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-06 11:04:44.209522 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-06 11:04:44.209522 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt_luke_test".
2021-10-06 11:04:44.210518 (ThreadPoolExecutor-0_0): On create_analytics_dbt_luke_test: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "create_analytics_dbt_luke_test"} */
create schema if not exists analytics.dbt_luke_test
2021-10-06 11:04:44.406881 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-06 11:04:44.407879 (ThreadPoolExecutor-0_0): On create_analytics_dbt_luke_test: COMMIT
2021-10-06 11:04:44.407879 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt_luke_test".
2021-10-06 11:04:44.407879 (ThreadPoolExecutor-0_0): On create_analytics_dbt_luke_test: COMMIT
2021-10-06 11:04:44.710872 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.30 seconds
2021-10-06 11:04:44.710872 (ThreadPoolExecutor-0_0): On create_analytics_dbt_luke_test: Close
2021-10-06 11:04:45.019010 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_luke_test".
2021-10-06 11:04:45.024506 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_luke_test".
2021-10-06 11:04:45.025503 (ThreadPoolExecutor-1_0): On list_analytics_dbt_luke_test: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt_luke_test"} */

    show terse objects in analytics.dbt_luke_test
2021-10-06 11:04:45.025503 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 11:04:45.987197 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.96 seconds
2021-10-06 11:04:45.988276 (ThreadPoolExecutor-1_0): On list_analytics_dbt_luke_test: Close
2021-10-06 11:04:46.274810 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 11:04:46.276787 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 11:04:46.276787 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 11:04:46.276787 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 11:04:47.167798 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.89 seconds
2021-10-06 11:04:47.168794 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 11:04:47.621121 (MainThread): Using snowflake connection "master".
2021-10-06 11:04:47.622088 (MainThread): On master: BEGIN
2021-10-06 11:04:47.622088 (MainThread): Opening a new connection, currently in state init
2021-10-06 11:04:48.632513 (MainThread): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-06 11:04:48.632513 (MainThread): On master: COMMIT
2021-10-06 11:04:48.632513 (MainThread): Using snowflake connection "master".
2021-10-06 11:04:48.632513 (MainThread): On master: COMMIT
2021-10-06 11:04:49.015283 (MainThread): SQL status: SUCCESS 1 in 0.38 seconds
2021-10-06 11:04:49.015283 (MainThread): On master: Close
2021-10-06 11:04:49.592411 (MainThread): 13:04:49 | Concurrency: 1 threads (target='dev')
2021-10-06 11:04:49.592411 (MainThread): 13:04:49 | 
2021-10-06 11:04:49.597901 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 11:04:49.597901 (Thread-1): 13:04:49 | 1 of 6 START table model dbt_luke_test.first_model................... [RUN]
2021-10-06 11:04:49.598910 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:04:49.598910 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 11:04:49.601976 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 11:04:49.603888 (Thread-1): finished collecting timing info
2021-10-06 11:04:49.623767 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 11:04:49.631133 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:04:49.631133 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-06 11:04:49.631133 (Thread-1): Opening a new connection, currently in state init
2021-10-06 11:04:50.524532 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-10-06 11:04:50.525529 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:04:50.525529 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt_luke_test.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-06 11:04:51.418719 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-10-06 11:04:51.420780 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-06 11:04:51.420780 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:04:51.420780 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-06 11:04:51.587737 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 11:04:51.594710 (Thread-1): finished collecting timing info
2021-10-06 11:04:51.594835 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-06 11:04:51.891249 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0977212d-0315-4792-9d16-52fa0e5ef395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE4A9ED90>]}
2021-10-06 11:04:51.891249 (Thread-1): 13:04:51 | 1 of 6 OK created table model dbt_luke_test.first_model.............. [SUCCESS 1 in 2.29s]
2021-10-06 11:04:51.892249 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 11:04:51.892249 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 11:04:51.892249 (Thread-1): 13:04:51 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 11:04:51.893242 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:04:51.893242 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 11:04:51.894313 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 11:04:51.895235 (Thread-1): finished collecting timing info
2021-10-06 11:04:51.897228 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 11:04:51.898959 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:04:51.898959 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 11:04:51.898959 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:04:52.867907 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-06 11:04:52.867907 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:04:52.867907 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 11:04:54.296589 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2021-10-06 11:04:54.297605 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 11:04:54.299592 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:04:54.299592 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 11:04:54.600353 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-10-06 11:04:54.601845 (Thread-1): finished collecting timing info
2021-10-06 11:04:54.601845 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 11:04:55.086045 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0977212d-0315-4792-9d16-52fa0e5ef395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE49E3490>]}
2021-10-06 11:04:55.086542 (Thread-1): 13:04:55 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.19s]
2021-10-06 11:04:55.087038 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 11:04:55.087356 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 11:04:55.087356 (Thread-1): 13:04:55 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-06 11:04:55.087356 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:04:55.087356 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 11:04:55.091418 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 11:04:55.092323 (Thread-1): finished collecting timing info
2021-10-06 11:04:55.114879 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:04:55.114879 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 11:04:55.114879 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:04:57.157773 (Thread-1): SQL status: SUCCESS 1 in 2.04 seconds
2021-10-06 11:04:57.167118 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:04:57.167118 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 11:04:57.485281 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-06 11:04:57.487987 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:04:57.487987 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 11:04:57.793676 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-10-06 11:04:57.794711 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:04:57.795708 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 11:04:58.043132 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-06 11:04:58.052341 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 11:04:58.054259 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:04:58.054259 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 11:04:58.414194 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-06 11:04:58.414691 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:04:58.414691 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 11:04:58.837511 (Thread-1): SQL status: SUCCESS 0 in 0.42 seconds
2021-10-06 11:04:58.838585 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 11:04:58.838585 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:04:58.838585 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 11:04:59.073675 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-06 11:04:59.075600 (Thread-1): finished collecting timing info
2021-10-06 11:04:59.075600 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 11:04:59.378514 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0977212d-0315-4792-9d16-52fa0e5ef395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE495F040>]}
2021-10-06 11:04:59.378514 (Thread-1): 13:04:59 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 4.29s]
2021-10-06 11:04:59.379513 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 11:04:59.379513 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 11:04:59.379513 (Thread-1): 13:04:59 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 11:04:59.380619 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:04:59.380619 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 11:04:59.383347 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 11:04:59.384345 (Thread-1): finished collecting timing info
2021-10-06 11:04:59.386346 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 11:04:59.386907 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:04:59.386907 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 11:04:59.386907 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:05:00.504854 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-10-06 11:05:00.504854 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:05:00.504854 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 11:05:02.033593 (Thread-1): SQL status: SUCCESS 1 in 1.53 seconds
2021-10-06 11:05:02.034591 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 11:05:02.035597 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:05:02.035597 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 11:05:02.265203 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-06 11:05:02.266204 (Thread-1): finished collecting timing info
2021-10-06 11:05:02.266204 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 11:05:02.660152 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0977212d-0315-4792-9d16-52fa0e5ef395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE4A74C10>]}
2021-10-06 11:05:02.660152 (Thread-1): 13:05:02 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.28s]
2021-10-06 11:05:02.661159 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 11:05:02.661159 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-06 11:05:02.662144 (Thread-1): 13:05:02 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-06 11:05:02.663142 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:05:02.663142 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-06 11:05:02.666248 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 11:05:02.668233 (Thread-1): finished collecting timing info
2021-10-06 11:05:02.670234 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:05:02.670234 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-06 11:05:02.670234 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:05:05.539957 (Thread-1): SQL status: SUCCESS 1 in 2.87 seconds
2021-10-06 11:05:05.542944 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:05:05.543935 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-06 11:05:05.972493 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-10-06 11:05:05.974538 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:05:05.974538 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-06 11:05:06.185064 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-06 11:05:06.186626 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:05:06.186626 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-06 11:05:06.438451 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-06 11:05:06.439450 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 11:05:06.441442 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:05:06.441442 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-06 11:05:06.634346 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-06 11:05:06.634346 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:05:06.634346 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-06 11:05:07.254912 (Thread-1): SQL status: SUCCESS 229 in 0.62 seconds
2021-10-06 11:05:07.255912 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-06 11:05:07.255912 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:05:07.255912 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-06 11:05:07.618528 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-06 11:05:07.619534 (Thread-1): finished collecting timing info
2021-10-06 11:05:07.619534 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-06 11:05:07.965539 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0977212d-0315-4792-9d16-52fa0e5ef395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE4ADD8E0>]}
2021-10-06 11:05:07.966837 (Thread-1): 13:05:07 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 229 in 5.30s]
2021-10-06 11:05:07.967444 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-06 11:05:07.967444 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 11:05:07.967940 (Thread-1): 13:05:07 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 11:05:07.968323 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 11:05:07.968323 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 11:05:07.969444 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 11:05:07.974426 (Thread-1): finished collecting timing info
2021-10-06 11:05:07.976420 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 11:05:07.983416 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 11:05:07.983416 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 11:05:07.983416 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:05:08.798055 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-06 11:05:08.798644 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 11:05:08.798644 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt_luke_test.first_model
where id = 1
      );
2021-10-06 11:05:09.876758 (Thread-1): SQL status: SUCCESS 1 in 1.08 seconds
2021-10-06 11:05:09.877761 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 11:05:09.878751 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 11:05:09.878751 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 11:05:10.044859 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 11:05:10.046860 (Thread-1): finished collecting timing info
2021-10-06 11:05:10.047860 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 11:05:10.374215 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0977212d-0315-4792-9d16-52fa0e5ef395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE47405E0>]}
2021-10-06 11:05:10.374215 (Thread-1): 13:05:10 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.41s]
2021-10-06 11:05:10.376277 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 11:05:10.378280 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 11:05:10.378280 (MainThread): Using snowflake connection "master".
2021-10-06 11:05:10.378280 (MainThread): On master: BEGIN
2021-10-06 11:05:10.378280 (MainThread): Opening a new connection, currently in state closed
2021-10-06 11:05:11.357120 (MainThread): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-06 11:05:11.357120 (MainThread): On master: COMMIT
2021-10-06 11:05:11.357120 (MainThread): Using snowflake connection "master".
2021-10-06 11:05:11.357120 (MainThread): On master: COMMIT
2021-10-06 11:05:11.646619 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-06 11:05:11.646619 (MainThread): On master: Close
2021-10-06 11:05:11.968610 (MainThread): 13:05:11 | 
2021-10-06 11:05:11.968610 (MainThread): 13:05:11 | Finished running 4 table models, 2 incremental models in 31.95s.
2021-10-06 11:05:11.970786 (MainThread): Connection 'master' was properly closed.
2021-10-06 11:05:11.970786 (MainThread): Connection 'create_analytics_dbt_luke_test' was properly closed.
2021-10-06 11:05:11.970786 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 11:05:11.970786 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 11:05:11.989074 (MainThread): 
2021-10-06 11:05:11.989996 (MainThread): Completed successfully
2021-10-06 11:05:11.990701 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-06 11:05:11.992134 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE47405E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE495F040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CE472C1C0>]}
2021-10-06 11:05:11.992134 (MainThread): Flushing usage events
2021-10-06 11:11:36.127389 (MainThread): Running with dbt=0.20.2
2021-10-06 11:11:36.639981 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 11:11:36.640979 (MainThread): Tracking: tracking
2021-10-06 11:11:36.640979 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21013DDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21166CCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21166C850>]}
2021-10-06 11:11:36.646959 (MainThread): Partial parsing not enabled
2021-10-06 11:11:36.660518 (MainThread): Parsing macros\adapters.sql
2021-10-06 11:11:36.678037 (MainThread): Parsing macros\catalog.sql
2021-10-06 11:11:36.680025 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 11:11:36.685442 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 11:11:36.686437 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 11:11:36.688432 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 11:11:36.689431 (MainThread): Parsing macros\core.sql
2021-10-06 11:11:36.691435 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 11:11:36.719035 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 11:11:36.724037 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 11:11:36.724992 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 11:11:36.726020 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 11:11:36.727042 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 11:11:36.728030 (MainThread): Parsing macros\etc\query.sql
2021-10-06 11:11:36.729071 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 11:11:36.734103 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 11:11:36.738081 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 11:11:36.747053 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 11:11:36.748048 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 11:11:36.752029 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 11:11:36.764154 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 11:11:36.782311 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 11:11:36.783297 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 11:11:36.794413 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 11:11:36.798400 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 11:11:36.800393 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 11:11:36.804380 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 11:11:36.806498 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 11:11:36.806498 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 11:11:36.807516 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 11:11:36.907132 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:11:36.912814 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:11:36.917190 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:11:36.919293 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:11:36.919293 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:11:36.920245 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 11:11:36.922306 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:11:36.923316 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:11:36.942171 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:11:36.944164 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:11:36.945161 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:11:36.946158 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:11:36.947154 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:11:36.978739 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:11:36.981956 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:11:36.996102 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b052435-ab35-41a8-88f9-0ee6ac6097dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B211701460>]}
2021-10-06 11:11:37.017963 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 11:11:37.017963 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b052435-ab35-41a8-88f9-0ee6ac6097dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21170FB20>]}
2021-10-06 11:11:37.017963 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 11:11:37.020536 (MainThread): 
2021-10-06 11:11:37.021068 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 11:11:37.024069 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics_test".
2021-10-06 11:11:37.032229 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics_test".
2021-10-06 11:11:37.032229 (ThreadPoolExecutor-0_0): On list_analytics_test: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_test"} */

    show terse schemas in database analytics_test
    limit 10000
2021-10-06 11:11:37.032229 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 11:11:38.941557 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 1.91 seconds
2021-10-06 11:11:38.943549 (ThreadPoolExecutor-0_0): On list_analytics_test: Close
2021-10-06 11:11:39.239875 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 11:11:39.240910 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 11:11:39.240910 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 11:11:39.241869 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-06 11:11:40.032057 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.79 seconds
2021-10-06 11:11:40.034047 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 11:11:40.329664 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_test_dbt_luke_test".
2021-10-06 11:11:40.329664 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_test_dbt_luke_test".
2021-10-06 11:11:40.329664 (ThreadPoolExecutor-0_0): Creating schema "analytics_test.dbt_luke_test"
2021-10-06 11:11:40.334239 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_test_dbt_luke_test".
2021-10-06 11:11:40.334239 (ThreadPoolExecutor-0_0): On create_analytics_test_dbt_luke_test: BEGIN
2021-10-06 11:11:40.334239 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-06 11:11:41.288494 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.95 seconds
2021-10-06 11:11:41.289559 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_test_dbt_luke_test".
2021-10-06 11:11:41.289559 (ThreadPoolExecutor-0_0): On create_analytics_test_dbt_luke_test: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "create_analytics_test_dbt_luke_test"} */
create schema if not exists analytics_test.dbt_luke_test
2021-10-06 11:11:41.494690 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-06 11:11:41.495686 (ThreadPoolExecutor-0_0): On create_analytics_test_dbt_luke_test: COMMIT
2021-10-06 11:11:41.495686 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_test_dbt_luke_test".
2021-10-06 11:11:41.495686 (ThreadPoolExecutor-0_0): On create_analytics_test_dbt_luke_test: COMMIT
2021-10-06 11:11:41.904608 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.41 seconds
2021-10-06 11:11:41.904608 (ThreadPoolExecutor-0_0): On create_analytics_test_dbt_luke_test: Close
2021-10-06 11:11:42.205050 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 11:11:42.211136 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 11:11:42.211136 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 11:11:42.211136 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 11:11:43.197358 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.99 seconds
2021-10-06 11:11:43.198452 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 11:11:43.533732 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_test_dbt_luke_test".
2021-10-06 11:11:43.536731 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_test_dbt_luke_test".
2021-10-06 11:11:43.536731 (ThreadPoolExecutor-1_0): On list_analytics_test_dbt_luke_test: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_test_dbt_luke_test"} */

    show terse objects in analytics_test.dbt_luke_test
2021-10-06 11:11:43.536731 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 11:11:44.532399 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.00 seconds
2021-10-06 11:11:44.532399 (ThreadPoolExecutor-1_0): On list_analytics_test_dbt_luke_test: Close
2021-10-06 11:11:44.827092 (MainThread): Using snowflake connection "master".
2021-10-06 11:11:44.828094 (MainThread): On master: BEGIN
2021-10-06 11:11:44.828094 (MainThread): Opening a new connection, currently in state init
2021-10-06 11:11:45.704053 (MainThread): SQL status: SUCCESS 1 in 0.88 seconds
2021-10-06 11:11:45.705052 (MainThread): On master: COMMIT
2021-10-06 11:11:45.705052 (MainThread): Using snowflake connection "master".
2021-10-06 11:11:45.705052 (MainThread): On master: COMMIT
2021-10-06 11:11:46.090739 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2021-10-06 11:11:46.090739 (MainThread): On master: Close
2021-10-06 11:11:46.529323 (MainThread): 13:11:46 | Concurrency: 1 threads (target='dev')
2021-10-06 11:11:46.530339 (MainThread): 13:11:46 | 
2021-10-06 11:11:46.534382 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 11:11:46.534382 (Thread-1): 13:11:46 | 1 of 6 START table model analytics_test.dbt_luke_test.first_model.... [RUN]
2021-10-06 11:11:46.535382 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:11:46.535382 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 11:11:46.538297 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 11:11:46.540323 (Thread-1): finished collecting timing info
2021-10-06 11:11:46.559349 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-06 11:11:46.568399 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:11:46.568399 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-06 11:11:46.568399 (Thread-1): Opening a new connection, currently in state init
2021-10-06 11:11:47.828227 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-10-06 11:11:47.828227 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:11:47.828227 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics_test.dbt_luke_test.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-06 11:11:49.537269 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2021-10-06 11:11:49.538276 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-06 11:11:49.538276 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:11:49.539273 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-06 11:11:49.692462 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-06 11:11:49.710571 (Thread-1): finished collecting timing info
2021-10-06 11:11:49.710571 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-06 11:11:50.002652 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b052435-ab35-41a8-88f9-0ee6ac6097dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B211A9B880>]}
2021-10-06 11:11:50.003645 (Thread-1): 13:11:50 | 1 of 6 OK created table model analytics_test.dbt_luke_test.first_model [SUCCESS 1 in 3.47s]
2021-10-06 11:11:50.004574 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 11:11:50.005570 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 11:11:50.005570 (Thread-1): 13:11:50 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 11:11:50.006638 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:11:50.006638 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 11:11:50.008702 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 11:11:50.011081 (Thread-1): finished collecting timing info
2021-10-06 11:11:50.015108 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 11:11:50.018704 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:11:50.018704 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 11:11:50.018704 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:11:51.014643 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-06 11:11:51.014643 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:11:51.014643 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 11:11:53.851342 (Thread-1): SQL status: SUCCESS 1 in 2.84 seconds
2021-10-06 11:11:53.854362 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 11:11:53.854362 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:11:53.854362 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 11:11:54.027156 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 11:11:54.029165 (Thread-1): finished collecting timing info
2021-10-06 11:11:54.029165 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 11:11:54.321164 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b052435-ab35-41a8-88f9-0ee6ac6097dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21197D0A0>]}
2021-10-06 11:11:54.321164 (Thread-1): 13:11:54 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 4.31s]
2021-10-06 11:11:54.322161 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 11:11:54.322161 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 11:11:54.323158 (Thread-1): 13:11:54 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-06 11:11:54.323158 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:11:54.323158 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 11:11:54.329243 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 11:11:54.331236 (Thread-1): finished collecting timing info
2021-10-06 11:11:54.355372 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:11:54.355372 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 11:11:54.355372 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:11:55.914510 (Thread-1): SQL status: SUCCESS 1 in 1.56 seconds
2021-10-06 11:11:55.925798 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:11:55.925798 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 11:11:56.138432 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-06 11:11:56.140332 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:11:56.140332 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 11:11:56.303928 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 11:11:56.305872 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:11:56.305872 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 11:11:56.490054 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 11:11:56.505442 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 11:11:56.507434 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:11:56.507434 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 11:11:56.749200 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-06 11:11:56.750195 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:11:56.750195 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 11:11:57.161998 (Thread-1): SQL status: SUCCESS 0 in 0.41 seconds
2021-10-06 11:11:57.162911 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 11:11:57.162911 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:11:57.162911 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 11:11:57.427276 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-06 11:11:57.428333 (Thread-1): finished collecting timing info
2021-10-06 11:11:57.428333 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 11:11:57.781529 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b052435-ab35-41a8-88f9-0ee6ac6097dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B21170F1C0>]}
2021-10-06 11:11:57.782525 (Thread-1): 13:11:57 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.46s]
2021-10-06 11:11:57.783522 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 11:11:57.783522 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 11:11:57.784554 (Thread-1): 13:11:57 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 11:11:57.785303 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:11:57.785448 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 11:11:57.786525 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 11:11:57.787532 (Thread-1): finished collecting timing info
2021-10-06 11:11:57.788527 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 11:11:57.789514 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:11:57.789514 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 11:11:57.789514 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:11:58.618494 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-06 11:11:58.618494 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:11:58.618494 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 11:12:00.212269 (Thread-1): SQL status: SUCCESS 1 in 1.59 seconds
2021-10-06 11:12:00.213347 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 11:12:00.213347 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:12:00.213347 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 11:12:00.371755 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 11:12:00.372782 (Thread-1): finished collecting timing info
2021-10-06 11:12:00.372782 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 11:12:00.709230 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b052435-ab35-41a8-88f9-0ee6ac6097dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B211B13EB0>]}
2021-10-06 11:12:00.710228 (Thread-1): 13:12:00 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.92s]
2021-10-06 11:12:00.711677 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 11:12:00.711677 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-06 11:12:00.711677 (Thread-1): 13:12:00 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-06 11:12:00.712686 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:12:00.712686 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-06 11:12:00.715736 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 11:12:00.717664 (Thread-1): finished collecting timing info
2021-10-06 11:12:00.720652 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:12:00.721648 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-06 11:12:00.721648 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:12:02.574672 (Thread-1): SQL status: SUCCESS 1 in 1.85 seconds
2021-10-06 11:12:02.575771 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:12:02.575771 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-06 11:12:02.802780 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-06 11:12:02.805784 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:12:02.805784 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-06 11:12:02.962948 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 11:12:02.966009 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:12:02.967009 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-06 11:12:03.130605 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 11:12:03.132598 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 11:12:03.134784 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:12:03.134784 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-06 11:12:03.330002 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-06 11:12:03.330002 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:12:03.330002 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-06 11:12:03.996464 (Thread-1): SQL status: SUCCESS 417 in 0.67 seconds
2021-10-06 11:12:03.997484 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-06 11:12:03.997484 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:12:03.998459 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-06 11:12:04.423180 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-10-06 11:12:04.425175 (Thread-1): finished collecting timing info
2021-10-06 11:12:04.425175 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-06 11:12:04.794424 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b052435-ab35-41a8-88f9-0ee6ac6097dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B211657100>]}
2021-10-06 11:12:04.794424 (Thread-1): 13:12:04 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 417 in 4.08s]
2021-10-06 11:12:04.794424 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-06 11:12:04.795421 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 11:12:04.795421 (Thread-1): 13:12:04 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-06 11:12:04.795421 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 11:12:04.795421 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 11:12:04.798497 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 11:12:04.803438 (Thread-1): finished collecting timing info
2021-10-06 11:12:04.807457 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-06 11:12:04.813179 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 11:12:04.813179 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-06 11:12:04.813179 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:12:05.837047 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-06 11:12:05.838006 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 11:12:05.838006 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics_test.dbt_luke_test.first_model
where id = 1
      );
2021-10-06 11:12:06.945543 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2021-10-06 11:12:06.947554 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 11:12:06.947554 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 11:12:06.947554 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-06 11:12:07.121177 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 11:12:07.122188 (Thread-1): finished collecting timing info
2021-10-06 11:12:07.122188 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-06 11:12:07.430052 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b052435-ab35-41a8-88f9-0ee6ac6097dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B211B2D8E0>]}
2021-10-06 11:12:07.431067 (Thread-1): 13:12:07 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.63s]
2021-10-06 11:12:07.431940 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 11:12:07.433946 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 11:12:07.433946 (MainThread): Using snowflake connection "master".
2021-10-06 11:12:07.433946 (MainThread): On master: BEGIN
2021-10-06 11:12:07.434942 (MainThread): Opening a new connection, currently in state closed
2021-10-06 11:12:08.210197 (MainThread): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-06 11:12:08.210197 (MainThread): On master: COMMIT
2021-10-06 11:12:08.210197 (MainThread): Using snowflake connection "master".
2021-10-06 11:12:08.210197 (MainThread): On master: COMMIT
2021-10-06 11:12:08.469323 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-06 11:12:08.469323 (MainThread): On master: Close
2021-10-06 11:12:08.759825 (MainThread): 13:12:08 | 
2021-10-06 11:12:08.759825 (MainThread): 13:12:08 | Finished running 4 table models, 2 incremental models in 31.74s.
2021-10-06 11:12:08.760827 (MainThread): Connection 'master' was properly closed.
2021-10-06 11:12:08.760827 (MainThread): Connection 'create_analytics_test_dbt_luke_test' was properly closed.
2021-10-06 11:12:08.760827 (MainThread): Connection 'list_analytics_test_dbt_luke_test' was properly closed.
2021-10-06 11:12:08.760827 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-06 11:12:08.774775 (MainThread): 
2021-10-06 11:12:08.774775 (MainThread): Completed successfully
2021-10-06 11:12:08.776179 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-06 11:12:08.776179 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2116E39A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2116E3040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2116E3970>]}
2021-10-06 11:12:08.776179 (MainThread): Flushing usage events
2021-10-06 11:22:23.115947 (MainThread): Running with dbt=0.20.2
2021-10-06 11:22:23.611503 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 11:22:23.612500 (MainThread): Tracking: tracking
2021-10-06 11:22:23.612500 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276FA3FCCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276FB92CD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276FB92C400>]}
2021-10-06 11:22:23.617483 (MainThread): Partial parsing not enabled
2021-10-06 11:22:23.630682 (MainThread): Parsing macros\adapters.sql
2021-10-06 11:22:23.650656 (MainThread): Parsing macros\catalog.sql
2021-10-06 11:22:23.652636 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 11:22:23.657619 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 11:22:23.658616 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 11:22:23.660609 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 11:22:23.661606 (MainThread): Parsing macros\core.sql
2021-10-06 11:22:23.663599 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 11:22:23.691519 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 11:22:23.698536 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 11:22:23.699532 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 11:22:23.700529 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 11:22:23.701526 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 11:22:23.702522 (MainThread): Parsing macros\etc\query.sql
2021-10-06 11:22:23.702522 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 11:22:23.709640 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 11:22:23.714028 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 11:22:23.724019 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 11:22:23.726067 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 11:22:23.730053 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 11:22:23.742075 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 11:22:23.760532 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 11:22:23.761541 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 11:22:23.771524 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 11:22:23.775484 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 11:22:23.778472 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 11:22:23.782461 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 11:22:23.783459 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 11:22:23.784454 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 11:22:23.785451 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 11:22:23.884486 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:22:23.889488 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:22:23.893456 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:22:23.895450 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:22:23.896444 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 11:22:23.898370 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:22:23.899367 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:22:23.917306 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:22:23.918303 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:22:23.919300 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:22:23.920297 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:22:23.948204 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:22:23.951194 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:22:23.953187 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:22:23.969180 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lukeclarke_learn_dbt.example.vars

2021-10-06 11:22:23.973198 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ea16639-180b-49c3-893c-26d470acf3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276FB992B20>]}
2021-10-06 11:22:24.001458 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 11:22:24.001954 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ea16639-180b-49c3-893c-26d470acf3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276FA3FCF40>]}
2021-10-06 11:22:24.002956 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 11:22:24.003953 (MainThread): 
2021-10-06 11:22:24.003953 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 11:22:24.005947 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 11:22:24.015540 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 11:22:24.015540 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 11:22:24.015540 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 11:22:25.675798 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.66 seconds
2021-10-06 11:22:25.678790 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 11:22:25.976905 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 11:22:25.984881 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 11:22:25.984881 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 11:22:25.984881 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 11:22:27.038106 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.05 seconds
2021-10-06 11:22:27.038106 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 11:22:27.401976 (MainThread): Using snowflake connection "master".
2021-10-06 11:22:27.401976 (MainThread): On master: BEGIN
2021-10-06 11:22:27.401976 (MainThread): Opening a new connection, currently in state init
2021-10-06 11:22:28.277436 (MainThread): SQL status: SUCCESS 1 in 0.88 seconds
2021-10-06 11:22:28.277436 (MainThread): On master: COMMIT
2021-10-06 11:22:28.277436 (MainThread): Using snowflake connection "master".
2021-10-06 11:22:28.277436 (MainThread): On master: COMMIT
2021-10-06 11:22:28.549591 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-06 11:22:28.550585 (MainThread): On master: Close
2021-10-06 11:22:28.841577 (MainThread): 13:22:28 | Concurrency: 1 threads (target='dev')
2021-10-06 11:22:28.841851 (MainThread): 13:22:28 | 
2021-10-06 11:22:28.844886 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 11:22:28.844886 (Thread-1): 13:22:28 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-06 11:22:28.845842 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:22:28.845842 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 11:22:28.848830 (Thread-1): finished collecting timing info
2021-10-06 11:22:28.848830 (Thread-1): Compilation Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models\example\my_first_dbt_model.sql)
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 464, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 371, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\context\base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\context\base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-06 11:22:28.874639 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ea16639-180b-49c3-893c-26d470acf3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276FBCFEA30>]}
2021-10-06 11:22:28.874639 (Thread-1): 13:22:28 | 1 of 6 ERROR creating table model dbt.first_model.................... [ERROR in 0.03s]
2021-10-06 11:22:28.875574 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 11:22:28.875574 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 11:22:28.875574 (Thread-1): 13:22:28 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 11:22:28.876584 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:22:28.876584 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 11:22:28.877637 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 11:22:28.878660 (Thread-1): finished collecting timing info
2021-10-06 11:22:28.899171 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 11:22:28.901164 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:22:28.901164 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 11:22:28.901164 (Thread-1): Opening a new connection, currently in state init
2021-10-06 11:22:29.797778 (Thread-1): SQL status: SUCCESS 1 in 0.90 seconds
2021-10-06 11:22:29.797778 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:22:29.797778 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 11:22:32.048897 (Thread-1): SQL status: SUCCESS 1 in 2.25 seconds
2021-10-06 11:22:32.049894 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 11:22:32.050890 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:22:32.050890 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 11:22:32.224853 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 11:22:32.242792 (Thread-1): finished collecting timing info
2021-10-06 11:22:32.242792 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 11:22:32.562631 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ea16639-180b-49c3-893c-26d470acf3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276FBC34700>]}
2021-10-06 11:22:32.563628 (Thread-1): 13:22:32 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.69s]
2021-10-06 11:22:32.564007 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 11:22:32.564007 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 11:22:32.564007 (Thread-1): 13:22:32 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-06 11:22:32.564007 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:22:32.564007 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 11:22:32.570359 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 11:22:32.573375 (Thread-1): finished collecting timing info
2021-10-06 11:22:32.594586 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:22:32.595582 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 11:22:32.595582 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:22:34.279476 (Thread-1): SQL status: SUCCESS 1 in 1.68 seconds
2021-10-06 11:22:34.288441 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:22:34.288441 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 11:22:34.480006 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-06 11:22:34.482995 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:22:34.482995 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 11:22:34.646793 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 11:22:34.649815 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:22:34.650828 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 11:22:34.815351 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 11:22:34.827309 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 11:22:34.828305 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:22:34.828305 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 11:22:35.019789 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-06 11:22:35.019789 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:22:35.019789 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 11:22:35.401820 (Thread-1): SQL status: SUCCESS 0 in 0.38 seconds
2021-10-06 11:22:35.402978 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 11:22:35.402978 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:22:35.402978 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 11:22:35.687711 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-06 11:22:35.689699 (Thread-1): finished collecting timing info
2021-10-06 11:22:35.689699 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 11:22:36.000751 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ea16639-180b-49c3-893c-26d470acf3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276FBA1EBE0>]}
2021-10-06 11:22:36.000751 (Thread-1): 13:22:36 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.44s]
2021-10-06 11:22:36.002786 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 11:22:36.002786 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 11:22:36.003813 (Thread-1): 13:22:36 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 11:22:36.004809 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:22:36.004809 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 11:22:36.006872 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 11:22:36.008758 (Thread-1): finished collecting timing info
2021-10-06 11:22:36.010760 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 11:22:36.012753 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:22:36.012753 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 11:22:36.013750 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:22:37.046882 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-10-06 11:22:37.046882 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:22:37.046882 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 11:22:38.745235 (Thread-1): SQL status: SUCCESS 1 in 1.70 seconds
2021-10-06 11:22:38.746257 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 11:22:38.746257 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:22:38.746257 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 11:22:38.905117 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 11:22:38.906122 (Thread-1): finished collecting timing info
2021-10-06 11:22:38.907109 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 11:22:39.242376 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ea16639-180b-49c3-893c-26d470acf3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276FB917670>]}
2021-10-06 11:22:39.242376 (Thread-1): 13:22:39 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.24s]
2021-10-06 11:22:39.246630 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 11:22:39.246630 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-06 11:22:39.246630 (Thread-1): 13:22:39 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-06 11:22:39.247475 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:22:39.247475 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-06 11:22:39.249479 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 11:22:39.251485 (Thread-1): finished collecting timing info
2021-10-06 11:22:39.253458 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:22:39.253458 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-06 11:22:39.253458 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:22:41.216522 (Thread-1): SQL status: SUCCESS 1 in 1.96 seconds
2021-10-06 11:22:41.218514 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:22:41.218514 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-06 11:22:41.393649 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 11:22:41.397640 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:22:41.397640 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-06 11:22:41.561526 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 11:22:41.566565 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:22:41.566565 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-06 11:22:41.726029 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 11:22:41.727028 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 11:22:41.728977 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:22:41.728977 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-06 11:22:41.952400 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-06 11:22:41.952400 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:22:41.952400 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-06 11:22:42.740750 (Thread-1): SQL status: SUCCESS 639 in 0.79 seconds
2021-10-06 11:22:42.742740 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-06 11:22:42.742740 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:22:42.742740 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-06 11:22:43.208192 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2021-10-06 11:22:43.210185 (Thread-1): finished collecting timing info
2021-10-06 11:22:43.210185 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-06 11:22:43.628701 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ea16639-180b-49c3-893c-26d470acf3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276FB91ECA0>]}
2021-10-06 11:22:43.628701 (Thread-1): 13:22:43 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 639 in 4.38s]
2021-10-06 11:22:43.629698 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-06 11:22:43.630694 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 11:22:43.630694 (Thread-1): 13:22:43 | 6 of 6 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-10-06 11:22:43.632060 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 11:22:43.633528 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 11:22:43.633528 (MainThread): Using snowflake connection "master".
2021-10-06 11:22:43.634524 (MainThread): On master: BEGIN
2021-10-06 11:22:43.634524 (MainThread): Opening a new connection, currently in state closed
2021-10-06 11:22:44.699341 (MainThread): SQL status: SUCCESS 1 in 1.06 seconds
2021-10-06 11:22:44.700336 (MainThread): On master: COMMIT
2021-10-06 11:22:44.700336 (MainThread): Using snowflake connection "master".
2021-10-06 11:22:44.700336 (MainThread): On master: COMMIT
2021-10-06 11:22:44.996809 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-10-06 11:22:44.997804 (MainThread): On master: Close
2021-10-06 11:22:45.343342 (MainThread): 13:22:45 | 
2021-10-06 11:22:45.343888 (MainThread): 13:22:45 | Finished running 4 table models, 2 incremental models in 21.34s.
2021-10-06 11:22:45.344936 (MainThread): Connection 'master' was properly closed.
2021-10-06 11:22:45.344936 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 11:22:45.345945 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 11:22:45.345945 (MainThread): Connection 'model.lukeclarke_learn_dbt.time' was properly closed.
2021-10-06 11:22:45.361520 (MainThread): 
2021-10-06 11:22:45.361520 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 11:22:45.362964 (MainThread): 
2021-10-06 11:22:45.363865 (MainThread): Compilation Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-06 11:22:45.364495 (MainThread):   Required var 'my_first_variable' not found in config:
2021-10-06 11:22:45.364495 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-10-06 11:22:45.365102 (MainThread):   
2021-10-06 11:22:45.365102 (MainThread):   > in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-06 11:22:45.365102 (MainThread):   > called by model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-06 11:22:45.365102 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
2021-10-06 11:22:45.366101 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276FBCF58B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276FB91ECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276FBA1EEB0>]}
2021-10-06 11:22:45.366101 (MainThread): Flushing usage events
2021-10-06 11:26:46.217697 (MainThread): Running with dbt=0.20.2
2021-10-06 11:26:46.716488 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 11:26:46.717004 (MainThread): Tracking: tracking
2021-10-06 11:26:46.717004 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215F455DCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215F5AA3A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215F5AA3250>]}
2021-10-06 11:26:46.722480 (MainThread): Partial parsing not enabled
2021-10-06 11:26:46.734210 (MainThread): Parsing macros\adapters.sql
2021-10-06 11:26:46.751431 (MainThread): Parsing macros\catalog.sql
2021-10-06 11:26:46.753423 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 11:26:46.758646 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 11:26:46.759652 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 11:26:46.761743 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 11:26:46.762712 (MainThread): Parsing macros\core.sql
2021-10-06 11:26:46.764703 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 11:26:46.792133 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 11:26:46.797116 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 11:26:46.798113 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 11:26:46.799110 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 11:26:46.800106 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 11:26:46.800106 (MainThread): Parsing macros\etc\query.sql
2021-10-06 11:26:46.801103 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 11:26:46.806625 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 11:26:46.810611 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 11:26:46.818584 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 11:26:46.819649 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 11:26:46.823794 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 11:26:46.836745 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 11:26:46.853752 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 11:26:46.854749 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 11:26:46.864715 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 11:26:46.868827 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 11:26:46.871817 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 11:26:46.874806 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 11:26:46.876800 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 11:26:46.876800 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 11:26:46.877797 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 11:26:46.979191 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:26:46.984174 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:26:46.989158 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:26:46.991217 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:26:46.991217 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 11:26:46.993287 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:26:46.994282 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:26:47.013499 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:26:47.014504 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:26:47.015495 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:26:47.016483 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:26:47.045730 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:26:47.048790 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:26:47.050781 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:26:47.066660 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lukeclarke_learn_dbt.example.vars

2021-10-06 11:26:47.071924 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e4dd663-d2db-498b-a8c5-ea3b73fdcf23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215F5A9C070>]}
2021-10-06 11:26:47.092471 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 11:26:47.092471 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e4dd663-d2db-498b-a8c5-ea3b73fdcf23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215F5A9CD90>]}
2021-10-06 11:26:47.092471 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 11:26:47.093409 (MainThread): 
2021-10-06 11:26:47.094445 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 11:26:47.095442 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 11:26:47.103617 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 11:26:47.103617 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 11:26:47.103617 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 11:26:48.481959 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.38 seconds
2021-10-06 11:26:48.485942 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 11:26:48.796324 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 11:26:48.805692 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 11:26:48.806689 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 11:26:48.806689 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 11:26:49.659966 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.85 seconds
2021-10-06 11:26:49.660928 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 11:26:49.975391 (MainThread): Using snowflake connection "master".
2021-10-06 11:26:49.975391 (MainThread): On master: BEGIN
2021-10-06 11:26:49.975391 (MainThread): Opening a new connection, currently in state init
2021-10-06 11:26:50.839617 (MainThread): SQL status: SUCCESS 1 in 0.86 seconds
2021-10-06 11:26:50.840612 (MainThread): On master: COMMIT
2021-10-06 11:26:50.840612 (MainThread): Using snowflake connection "master".
2021-10-06 11:26:50.840612 (MainThread): On master: COMMIT
2021-10-06 11:26:51.095991 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-06 11:26:51.095991 (MainThread): On master: Close
2021-10-06 11:26:51.483767 (MainThread): 13:26:51 | Concurrency: 1 threads (target='dev')
2021-10-06 11:26:51.484693 (MainThread): 13:26:51 | 
2021-10-06 11:26:51.488428 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 11:26:51.488428 (Thread-1): 13:26:51 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-06 11:26:51.489357 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:26:51.490359 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 11:26:51.496342 (Thread-1): finished collecting timing info
2021-10-06 11:26:51.497335 (Thread-1): Compilation Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models\example\my_first_dbt_model.sql)
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 464, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 371, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\context\base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\context\base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-06 11:26:51.500324 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e4dd663-d2db-498b-a8c5-ea3b73fdcf23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215F5D75C40>]}
2021-10-06 11:26:51.500324 (Thread-1): 13:26:51 | 1 of 6 ERROR creating table model dbt.first_model.................... [ERROR in 0.01s]
2021-10-06 11:26:51.501374 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 11:26:51.501374 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 11:26:51.501374 (Thread-1): 13:26:51 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 11:26:51.502024 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:26:51.502024 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 11:26:51.504027 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 11:26:51.504353 (Thread-1): finished collecting timing info
2021-10-06 11:26:51.521548 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 11:26:51.522543 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:26:51.522543 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 11:26:51.522543 (Thread-1): Opening a new connection, currently in state init
2021-10-06 11:26:52.399706 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-10-06 11:26:52.399706 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:26:52.400645 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 11:26:53.735850 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-10-06 11:26:53.736838 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 11:26:53.736838 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:26:53.736838 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 11:26:53.937901 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-06 11:26:53.946681 (Thread-1): finished collecting timing info
2021-10-06 11:26:53.946681 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 11:26:54.294833 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e4dd663-d2db-498b-a8c5-ea3b73fdcf23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215F5A8D790>]}
2021-10-06 11:26:54.294833 (Thread-1): 13:26:54 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.79s]
2021-10-06 11:26:54.295870 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 11:26:54.296827 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 11:26:54.296827 (Thread-1): 13:26:54 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-06 11:26:54.297823 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:26:54.297823 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 11:26:54.301879 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 11:26:54.304609 (Thread-1): finished collecting timing info
2021-10-06 11:26:54.318488 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:26:54.318488 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 11:26:54.319249 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:26:55.952510 (Thread-1): SQL status: SUCCESS 1 in 1.63 seconds
2021-10-06 11:26:55.959566 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:26:55.959566 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 11:26:56.135726 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 11:26:56.138651 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:26:56.138651 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 11:26:56.303818 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 11:26:56.306803 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:26:56.306803 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 11:26:56.463064 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 11:26:56.472032 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 11:26:56.474084 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:26:56.474084 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 11:26:56.676101 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-06 11:26:56.676101 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:26:56.676101 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 11:26:57.094815 (Thread-1): SQL status: SUCCESS 0 in 0.42 seconds
2021-10-06 11:26:57.096801 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 11:26:57.096801 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:26:57.096801 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 11:26:57.434990 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-10-06 11:26:57.437067 (Thread-1): finished collecting timing info
2021-10-06 11:26:57.437067 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 11:26:57.800525 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e4dd663-d2db-498b-a8c5-ea3b73fdcf23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215F5BCC2E0>]}
2021-10-06 11:26:57.801539 (Thread-1): 13:26:57 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.50s]
2021-10-06 11:26:57.802522 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 11:26:57.802522 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 11:26:57.803515 (Thread-1): 13:26:57 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 11:26:57.803515 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:26:57.803515 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 11:26:57.805585 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 11:26:57.806504 (Thread-1): finished collecting timing info
2021-10-06 11:26:57.808505 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 11:26:57.810145 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:26:57.810145 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 11:26:57.810145 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:26:58.625907 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-06 11:26:58.626908 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:26:58.626908 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 11:27:00.130937 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-10-06 11:27:00.132961 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 11:27:00.132961 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:27:00.132961 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 11:27:00.303128 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 11:27:00.304127 (Thread-1): finished collecting timing info
2021-10-06 11:27:00.304127 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 11:27:00.662203 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e4dd663-d2db-498b-a8c5-ea3b73fdcf23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215F5F6FDF0>]}
2021-10-06 11:27:00.663200 (Thread-1): 13:27:00 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.86s]
2021-10-06 11:27:00.664221 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 11:27:00.664221 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-06 11:27:00.664221 (Thread-1): 13:27:00 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-06 11:27:00.664536 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:27:00.664536 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-06 11:27:00.668596 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 11:27:00.670590 (Thread-1): finished collecting timing info
2021-10-06 11:27:00.672540 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:27:00.672540 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-06 11:27:00.672540 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:27:02.687680 (Thread-1): SQL status: SUCCESS 1 in 2.02 seconds
2021-10-06 11:27:02.690663 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:27:02.690663 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-06 11:27:02.903283 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-06 11:27:02.907269 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:27:02.907269 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-06 11:27:03.079844 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 11:27:03.083360 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:27:03.083498 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-06 11:27:03.244294 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-06 11:27:03.246289 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 11:27:03.249204 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:27:03.249204 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-06 11:27:03.437899 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-06 11:27:03.437899 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:27:03.437899 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-06 11:27:04.525112 (Thread-1): SQL status: SUCCESS 261 in 1.09 seconds
2021-10-06 11:27:04.527106 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-06 11:27:04.527106 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:27:04.527106 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-06 11:27:04.972410 (Thread-1): SQL status: SUCCESS 1 in 0.45 seconds
2021-10-06 11:27:04.974395 (Thread-1): finished collecting timing info
2021-10-06 11:27:04.974395 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-06 11:27:05.312669 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e4dd663-d2db-498b-a8c5-ea3b73fdcf23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215F5B8C910>]}
2021-10-06 11:27:05.312669 (Thread-1): 13:27:05 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 261 in 4.65s]
2021-10-06 11:27:05.315026 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-06 11:27:05.315026 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 11:27:05.315953 (Thread-1): 13:27:05 | 6 of 6 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-10-06 11:27:05.316814 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 11:27:05.318026 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 11:27:05.319108 (MainThread): Using snowflake connection "master".
2021-10-06 11:27:05.319108 (MainThread): On master: BEGIN
2021-10-06 11:27:05.319108 (MainThread): Opening a new connection, currently in state closed
2021-10-06 11:27:06.196502 (MainThread): SQL status: SUCCESS 1 in 0.88 seconds
2021-10-06 11:27:06.196502 (MainThread): On master: COMMIT
2021-10-06 11:27:06.196502 (MainThread): Using snowflake connection "master".
2021-10-06 11:27:06.196502 (MainThread): On master: COMMIT
2021-10-06 11:27:06.465791 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-06 11:27:06.465791 (MainThread): On master: Close
2021-10-06 11:27:06.796231 (MainThread): 13:27:06 | 
2021-10-06 11:27:06.797308 (MainThread): 13:27:06 | Finished running 4 table models, 2 incremental models in 19.70s.
2021-10-06 11:27:06.798266 (MainThread): Connection 'master' was properly closed.
2021-10-06 11:27:06.798266 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 11:27:06.798266 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 11:27:06.798266 (MainThread): Connection 'model.lukeclarke_learn_dbt.time' was properly closed.
2021-10-06 11:27:06.810195 (MainThread): 
2021-10-06 11:27:06.810195 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 11:27:06.812318 (MainThread): 
2021-10-06 11:27:06.812318 (MainThread): Compilation Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-06 11:27:06.814270 (MainThread):   Required var 'my_first_variable' not found in config:
2021-10-06 11:27:06.814270 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-10-06 11:27:06.815270 (MainThread):   
2021-10-06 11:27:06.815270 (MainThread):   > in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-06 11:27:06.815270 (MainThread):   > called by model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-06 11:27:06.816265 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
2021-10-06 11:27:06.816265 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215F5B8C910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215F5A728E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215F5AF3460>]}
2021-10-06 11:27:06.816265 (MainThread): Flushing usage events
2021-10-06 11:30:48.833680 (MainThread): Running with dbt=0.20.2
2021-10-06 11:30:49.345322 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-06 11:30:49.346264 (MainThread): Tracking: tracking
2021-10-06 11:30:49.346264 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001199267CD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011993BAC220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011993BAC4C0>]}
2021-10-06 11:30:49.351917 (MainThread): Partial parsing not enabled
2021-10-06 11:30:49.363090 (MainThread): Parsing macros\adapters.sql
2021-10-06 11:30:49.380943 (MainThread): Parsing macros\catalog.sql
2021-10-06 11:30:49.381940 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-06 11:30:49.386924 (MainThread): Parsing macros\materializations\merge.sql
2021-10-06 11:30:49.387921 (MainThread): Parsing macros\materializations\table.sql
2021-10-06 11:30:49.389914 (MainThread): Parsing macros\materializations\view.sql
2021-10-06 11:30:49.390911 (MainThread): Parsing macros\core.sql
2021-10-06 11:30:49.392904 (MainThread): Parsing macros\adapters\common.sql
2021-10-06 11:30:49.420837 (MainThread): Parsing macros\etc\datetime.sql
2021-10-06 11:30:49.425820 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-06 11:30:49.426817 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-06 11:30:49.426817 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-06 11:30:49.428810 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-06 11:30:49.428810 (MainThread): Parsing macros\etc\query.sql
2021-10-06 11:30:49.429807 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-06 11:30:49.435787 (MainThread): Parsing macros\materializations\test.sql
2021-10-06 11:30:49.439773 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-06 11:30:49.447746 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-06 11:30:49.448742 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-06 11:30:49.453725 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-06 11:30:49.466221 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-06 11:30:49.484160 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-06 11:30:49.485158 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-06 11:30:49.496120 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-06 11:30:49.500107 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-06 11:30:49.502100 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-06 11:30:49.506087 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-06 11:30:49.507084 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-06 11:30:49.508081 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-06 11:30:49.509077 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-06 11:30:49.607679 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:30:49.612588 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:30:49.616578 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:30:49.618637 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:30:49.619780 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-06 11:30:49.620865 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:30:49.622849 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:30:49.640439 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:30:49.641433 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:30:49.642363 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:30:49.643429 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:30:49.672337 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:30:49.675332 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:30:49.678321 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-06 11:30:49.688212 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lukeclarke_learn_dbt.example.vars

2021-10-06 11:30:49.692198 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99afcf29-8bd3-40d1-87e2-37085bd924c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011993D2F460>]}
2021-10-06 11:30:49.713237 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 11:30:49.713237 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99afcf29-8bd3-40d1-87e2-37085bd924c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011993D2F9A0>]}
2021-10-06 11:30:49.714161 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-06 11:30:49.715235 (MainThread): 
2021-10-06 11:30:49.715235 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 11:30:49.717165 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-06 11:30:49.725208 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-06 11:30:49.725208 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-06 11:30:49.725208 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 11:30:51.740706 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.02 seconds
2021-10-06 11:30:51.746637 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-06 11:30:52.058899 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-06 11:30:52.062886 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-06 11:30:52.062886 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-06 11:30:52.062886 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-06 11:30:52.851822 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.79 seconds
2021-10-06 11:30:52.851822 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-06 11:30:53.239969 (MainThread): Using snowflake connection "master".
2021-10-06 11:30:53.239969 (MainThread): On master: BEGIN
2021-10-06 11:30:53.241036 (MainThread): Opening a new connection, currently in state init
2021-10-06 11:30:54.078383 (MainThread): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-06 11:30:54.078383 (MainThread): On master: COMMIT
2021-10-06 11:30:54.078383 (MainThread): Using snowflake connection "master".
2021-10-06 11:30:54.079380 (MainThread): On master: COMMIT
2021-10-06 11:30:54.490012 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-10-06 11:30:54.491006 (MainThread): On master: Close
2021-10-06 11:30:55.386575 (MainThread): 13:30:55 | Concurrency: 1 threads (target='dev')
2021-10-06 11:30:55.387288 (MainThread): 13:30:55 | 
2021-10-06 11:30:55.391553 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 11:30:55.391553 (Thread-1): 13:30:55 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-06 11:30:55.392508 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-06 11:30:55.392508 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 11:30:55.397496 (Thread-1): finished collecting timing info
2021-10-06 11:30:55.398497 (Thread-1): Compilation Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models\example\my_first_dbt_model.sql)
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 464, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 371, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\context\base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\context\base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-06 11:30:55.399489 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99afcf29-8bd3-40d1-87e2-37085bd924c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011993E98E20>]}
2021-10-06 11:30:55.399489 (Thread-1): 13:30:55 | 1 of 6 ERROR creating table model dbt.first_model.................... [ERROR in 0.01s]
2021-10-06 11:30:55.400486 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-06 11:30:55.400486 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 11:30:55.401484 (Thread-1): 13:30:55 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-06 11:30:55.401484 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:30:55.401484 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 11:30:55.403474 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 11:30:55.404471 (Thread-1): finished collecting timing info
2021-10-06 11:30:55.421963 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-06 11:30:55.423001 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:30:55.424032 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-06 11:30:55.424032 (Thread-1): Opening a new connection, currently in state init
2021-10-06 11:30:56.517010 (Thread-1): SQL status: SUCCESS 1 in 1.09 seconds
2021-10-06 11:30:56.517010 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:30:56.517010 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-06 11:30:58.049659 (Thread-1): SQL status: SUCCESS 1 in 1.53 seconds
2021-10-06 11:30:58.051648 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 11:30:58.051648 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-06 11:30:58.051648 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-06 11:30:58.326389 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-06 11:30:58.336349 (Thread-1): finished collecting timing info
2021-10-06 11:30:58.336349 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-06 11:30:58.897250 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99afcf29-8bd3-40d1-87e2-37085bd924c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011993FA36A0>]}
2021-10-06 11:30:58.898247 (Thread-1): 13:30:58 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.50s]
2021-10-06 11:30:58.899337 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-06 11:30:58.899337 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-06 11:30:58.900244 (Thread-1): 13:30:58 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-06 11:30:58.901236 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:30:58.901236 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-06 11:30:58.908367 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 11:30:58.910203 (Thread-1): finished collecting timing info
2021-10-06 11:30:58.928338 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:30:58.928338 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-06 11:30:58.928338 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:31:00.252099 (Thread-1): SQL status: SUCCESS 1 in 1.32 seconds
2021-10-06 11:31:00.258855 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:31:00.258855 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-06 11:31:00.445860 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-06 11:31:00.449843 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:31:00.449843 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 11:31:00.601683 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-06 11:31:00.604671 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:31:00.604671 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-06 11:31:00.773556 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 11:31:00.782501 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-06 11:31:00.784461 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:31:00.784461 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-06 11:31:00.966095 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-06 11:31:00.967094 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:31:00.967094 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-06 11:31:01.492148 (Thread-1): SQL status: SUCCESS 0 in 0.53 seconds
2021-10-06 11:31:01.493153 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 11:31:01.493153 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-06 11:31:01.493153 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-06 11:31:01.749670 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-06 11:31:01.750697 (Thread-1): finished collecting timing info
2021-10-06 11:31:01.750697 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-06 11:31:02.086119 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99afcf29-8bd3-40d1-87e2-37085bd924c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011993F787C0>]}
2021-10-06 11:31:02.087120 (Thread-1): 13:31:02 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.19s]
2021-10-06 11:31:02.089182 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-06 11:31:02.089418 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 11:31:02.089418 (Thread-1): 13:31:02 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-06 11:31:02.090455 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:31:02.090455 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 11:31:02.093429 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 11:31:02.096417 (Thread-1): finished collecting timing info
2021-10-06 11:31:02.098485 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-06 11:31:02.104321 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:31:02.104321 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-06 11:31:02.104321 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:31:03.392595 (Thread-1): SQL status: SUCCESS 1 in 1.29 seconds
2021-10-06 11:31:03.392595 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:31:03.392595 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-06 11:31:04.814958 (Thread-1): SQL status: SUCCESS 1 in 1.42 seconds
2021-10-06 11:31:04.816955 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 11:31:04.816955 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-06 11:31:04.816955 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-06 11:31:04.985981 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 11:31:04.986978 (Thread-1): finished collecting timing info
2021-10-06 11:31:04.986978 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-06 11:31:05.318854 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99afcf29-8bd3-40d1-87e2-37085bd924c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011993B8D4F0>]}
2021-10-06 11:31:05.319848 (Thread-1): 13:31:05 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.23s]
2021-10-06 11:31:05.320200 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-06 11:31:05.320200 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-06 11:31:05.320200 (Thread-1): 13:31:05 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-06 11:31:05.321206 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:31:05.321206 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-06 11:31:05.322243 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 11:31:05.324196 (Thread-1): finished collecting timing info
2021-10-06 11:31:05.326189 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:31:05.326189 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-06 11:31:05.326189 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 11:31:07.063394 (Thread-1): SQL status: SUCCESS 1 in 1.74 seconds
2021-10-06 11:31:07.064397 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:31:07.064397 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-06 11:31:07.288205 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-06 11:31:07.289195 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:31:07.289195 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-06 11:31:07.456427 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 11:31:07.458417 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:31:07.458417 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-06 11:31:07.624447 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-06 11:31:07.625405 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-06 11:31:07.626362 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:31:07.626362 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-06 11:31:07.815984 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-06 11:31:07.815984 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:31:07.815984 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-06 11:31:09.390921 (Thread-1): SQL status: SUCCESS 244 in 1.57 seconds
2021-10-06 11:31:09.392906 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-06 11:31:09.392906 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-06 11:31:09.392906 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-06 11:31:09.780127 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-10-06 11:31:09.782054 (Thread-1): finished collecting timing info
2021-10-06 11:31:09.782054 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-06 11:31:10.081050 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99afcf29-8bd3-40d1-87e2-37085bd924c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011993F78760>]}
2021-10-06 11:31:10.081050 (Thread-1): 13:31:10 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 244 in 4.76s]
2021-10-06 11:31:10.082624 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-06 11:31:10.082624 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 11:31:10.082624 (Thread-1): 13:31:10 | 6 of 6 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-10-06 11:31:10.083678 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-06 11:31:10.083678 (MainThread): Acquiring new snowflake connection "master".
2021-10-06 11:31:10.083678 (MainThread): Using snowflake connection "master".
2021-10-06 11:31:10.084745 (MainThread): On master: BEGIN
2021-10-06 11:31:10.084745 (MainThread): Opening a new connection, currently in state closed
2021-10-06 11:31:11.403939 (MainThread): SQL status: SUCCESS 1 in 1.32 seconds
2021-10-06 11:31:11.404938 (MainThread): On master: COMMIT
2021-10-06 11:31:11.404938 (MainThread): Using snowflake connection "master".
2021-10-06 11:31:11.404938 (MainThread): On master: COMMIT
2021-10-06 11:31:11.659122 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-06 11:31:11.659122 (MainThread): On master: Close
2021-10-06 11:31:11.982268 (MainThread): 13:31:11 | 
2021-10-06 11:31:11.983164 (MainThread): 13:31:11 | Finished running 4 table models, 2 incremental models in 22.27s.
2021-10-06 11:31:11.986167 (MainThread): Connection 'master' was properly closed.
2021-10-06 11:31:11.987305 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-06 11:31:11.987305 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-06 11:31:11.987305 (MainThread): Connection 'model.lukeclarke_learn_dbt.time' was properly closed.
2021-10-06 11:31:12.004642 (MainThread): 
2021-10-06 11:31:12.004642 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 11:31:12.006077 (MainThread): 
2021-10-06 11:31:12.007086 (MainThread): Compilation Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-06 11:31:12.008105 (MainThread):   Required var 'my_first_variable' not found in config:
2021-10-06 11:31:12.008524 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-10-06 11:31:12.009303 (MainThread):   
2021-10-06 11:31:12.009303 (MainThread):   > in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-06 11:31:12.009303 (MainThread):   > called by model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-06 11:31:12.009303 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
2021-10-06 11:31:12.010301 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011993EB2910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011993B8D4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011993BBCEB0>]}
2021-10-06 11:31:12.010301 (MainThread): Flushing usage events
2021-10-08 08:22:00.412233 (MainThread): Running with dbt=0.20.2
2021-10-08 08:22:01.665242 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 08:22:01.666244 (MainThread): Tracking: tracking
2021-10-08 08:22:01.667756 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C63CCE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C78FA5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C78FA4F0>]}
2021-10-08 08:22:01.678806 (MainThread): Partial parsing not enabled
2021-10-08 08:22:01.878338 (MainThread): Parsing macros\adapters.sql
2021-10-08 08:22:01.897729 (MainThread): Parsing macros\catalog.sql
2021-10-08 08:22:01.898790 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 08:22:01.903917 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 08:22:01.904922 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 08:22:01.907907 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 08:22:01.907907 (MainThread): Parsing macros\core.sql
2021-10-08 08:22:01.910906 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 08:22:01.944579 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 08:22:01.950782 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 08:22:01.950782 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 08:22:01.951791 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 08:22:01.953796 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 08:22:01.954782 (MainThread): Parsing macros\etc\query.sql
2021-10-08 08:22:01.954782 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 08:22:01.961520 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 08:22:01.966516 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 08:22:01.975586 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 08:22:01.976747 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 08:22:01.980767 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 08:22:01.994141 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 08:22:02.014782 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 08:22:02.015800 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 08:22:02.029020 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 08:22:02.033019 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 08:22:02.037296 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 08:22:02.041297 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 08:22:02.043294 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 08:22:02.044553 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 08:22:02.045389 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 08:22:02.177723 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:22:02.184719 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:22:02.189734 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:22:02.193028 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:22:02.193028 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:22:02.196006 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:22:02.197002 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:22:02.222526 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:22:02.223798 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:22:02.224809 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:22:02.226822 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:22:02.255610 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:22:02.259608 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:22:02.262612 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:22:02.278213 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lukeclarke_learn_dbt.example.vars

2021-10-08 08:22:02.282211 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e03082f-f8f5-4ab2-98a4-97a247ca0317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C7964D90>]}
2021-10-08 08:22:02.324951 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 08:22:02.325948 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e03082f-f8f5-4ab2-98a4-97a247ca0317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C7973670>]}
2021-10-08 08:22:02.325948 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 08:22:02.326866 (MainThread): 
2021-10-08 08:22:02.326866 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:22:02.328945 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 08:22:02.339328 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 08:22:02.339328 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 08:22:02.339328 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 08:22:04.218858 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.88 seconds
2021-10-08 08:22:04.232907 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 08:22:04.530208 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 08:22:04.534273 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 08:22:04.534273 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 08:22:04.534273 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 08:22:05.645222 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.11 seconds
2021-10-08 08:22:05.646211 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 08:22:05.971869 (MainThread): Using snowflake connection "master".
2021-10-08 08:22:05.971985 (MainThread): On master: BEGIN
2021-10-08 08:22:05.972056 (MainThread): Opening a new connection, currently in state init
2021-10-08 08:22:06.771223 (MainThread): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-08 08:22:06.771223 (MainThread): On master: COMMIT
2021-10-08 08:22:06.771223 (MainThread): Using snowflake connection "master".
2021-10-08 08:22:06.771223 (MainThread): On master: COMMIT
2021-10-08 08:22:07.033498 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-08 08:22:07.033498 (MainThread): On master: Close
2021-10-08 08:22:07.344030 (MainThread): 10:22:07 | Concurrency: 1 threads (target='dev')
2021-10-08 08:22:07.344704 (MainThread): 10:22:07 | 
2021-10-08 08:22:07.349985 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:22:07.349985 (Thread-1): 10:22:07 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 08:22:07.349985 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:22:07.351084 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:22:07.356950 (Thread-1): finished collecting timing info
2021-10-08 08:22:07.356950 (Thread-1): Compilation Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models\example\my_first_dbt_model.sql)
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 464, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 371, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\context\base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\context\base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-08 08:22:07.409041 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e03082f-f8f5-4ab2-98a4-97a247ca0317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C7CC4D30>]}
2021-10-08 08:22:07.409041 (Thread-1): 10:22:07 | 1 of 6 ERROR creating table model dbt.first_model.................... [ERROR in 0.06s]
2021-10-08 08:22:07.410470 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:22:07.411476 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:22:07.411476 (Thread-1): 10:22:07 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 08:22:07.411476 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:22:07.411476 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:22:07.413624 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:22:07.417795 (Thread-1): finished collecting timing info
2021-10-08 08:22:07.436193 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:22:07.440249 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:22:07.440249 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 08:22:07.440249 (Thread-1): Opening a new connection, currently in state init
2021-10-08 08:22:08.322277 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-10-08 08:22:08.322277 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:22:08.322277 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 08:22:11.156479 (Thread-1): SQL status: SUCCESS 1 in 2.83 seconds
2021-10-08 08:22:11.157743 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:22:11.157971 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:22:11.158009 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:22:11.332765 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:22:11.339767 (Thread-1): finished collecting timing info
2021-10-08 08:22:11.339767 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 08:22:11.653606 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e03082f-f8f5-4ab2-98a4-97a247ca0317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C7CD06D0>]}
2021-10-08 08:22:11.653606 (Thread-1): 10:22:11 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 4.24s]
2021-10-08 08:22:11.654608 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:22:11.654608 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:22:11.654608 (Thread-1): 10:22:11 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 08:22:11.655606 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:22:11.655606 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 08:22:11.658606 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:22:11.663606 (Thread-1): finished collecting timing info
2021-10-08 08:22:11.678250 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:22:11.678250 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 08:22:11.678250 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:22:13.743120 (Thread-1): SQL status: SUCCESS 1 in 2.06 seconds
2021-10-08 08:22:13.752237 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:22:13.752237 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 08:22:13.936519 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:22:13.939798 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:22:13.939798 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:22:14.128512 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 08:22:14.129529 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:22:14.129529 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:22:14.317620 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 08:22:14.328047 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:22:14.334380 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:22:14.334380 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 08:22:14.535131 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 08:22:14.535131 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:22:14.535131 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 08:22:15.880321 (Thread-1): SQL status: SUCCESS 2 in 1.35 seconds
2021-10-08 08:22:15.880321 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:22:15.881419 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:22:15.881419 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:22:16.319214 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-10-08 08:22:16.319214 (Thread-1): finished collecting timing info
2021-10-08 08:22:16.319214 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 08:22:16.648495 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e03082f-f8f5-4ab2-98a4-97a247ca0317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C78F9400>]}
2021-10-08 08:22:16.649036 (Thread-1): 10:22:16 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 2 in 4.99s]
2021-10-08 08:22:16.649771 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:22:16.649771 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:22:16.650421 (Thread-1): 10:22:16 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 08:22:16.650421 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:22:16.650421 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:22:16.653300 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:22:16.661544 (Thread-1): finished collecting timing info
2021-10-08 08:22:16.662883 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:22:16.670902 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:22:16.670902 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 08:22:16.670902 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:22:17.633485 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-10-08 08:22:17.633485 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:22:17.633485 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 08:22:19.385005 (Thread-1): SQL status: SUCCESS 1 in 1.75 seconds
2021-10-08 08:22:19.386006 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:22:19.386006 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:22:19.386006 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:22:19.538024 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-08 08:22:19.539023 (Thread-1): finished collecting timing info
2021-10-08 08:22:19.539023 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 08:22:19.836110 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e03082f-f8f5-4ab2-98a4-97a247ca0317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C78F0820>]}
2021-10-08 08:22:19.837111 (Thread-1): 10:22:19 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.19s]
2021-10-08 08:22:19.837111 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:22:19.837111 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 08:22:19.838117 (Thread-1): 10:22:19 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 08:22:19.838117 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:22:19.838117 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 08:22:19.840642 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:22:19.846001 (Thread-1): finished collecting timing info
2021-10-08 08:22:19.848185 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:22:19.848185 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 08:22:19.848185 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:22:21.566978 (Thread-1): SQL status: SUCCESS 1 in 1.72 seconds
2021-10-08 08:22:21.568506 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:22:21.568591 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 08:22:21.749135 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:22:21.750808 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:22:21.750808 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:22:21.928825 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:22:21.930825 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:22:21.930825 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:22:22.104262 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:22:22.106698 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:22:22.112324 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:22:22.112324 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 08:22:22.314347 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 08:22:22.314347 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:22:22.314347 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 08:22:22.639995 (Thread-1): SQL status: SUCCESS 0 in 0.33 seconds
2021-10-08 08:22:22.640996 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:22:22.640996 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:22:22.640996 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:22:22.908811 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 08:22:22.909811 (Thread-1): finished collecting timing info
2021-10-08 08:22:22.909811 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 08:22:23.208483 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e03082f-f8f5-4ab2-98a4-97a247ca0317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C7D33AC0>]}
2021-10-08 08:22:23.208985 (Thread-1): 10:22:23 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.37s]
2021-10-08 08:22:23.209984 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 08:22:23.210483 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:22:23.210532 (Thread-1): 10:22:23 | 6 of 6 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-10-08 08:22:23.211029 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:22:23.212626 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:22:23.212626 (MainThread): Using snowflake connection "master".
2021-10-08 08:22:23.212626 (MainThread): On master: BEGIN
2021-10-08 08:22:23.213126 (MainThread): Opening a new connection, currently in state closed
2021-10-08 08:22:24.242368 (MainThread): SQL status: SUCCESS 1 in 1.03 seconds
2021-10-08 08:22:24.242368 (MainThread): On master: COMMIT
2021-10-08 08:22:24.243379 (MainThread): Using snowflake connection "master".
2021-10-08 08:22:24.243379 (MainThread): On master: COMMIT
2021-10-08 08:22:24.556863 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-10-08 08:22:24.556863 (MainThread): On master: Close
2021-10-08 08:22:24.844374 (MainThread): 10:22:24 | 
2021-10-08 08:22:24.844374 (MainThread): 10:22:24 | Finished running 4 table models, 2 incremental models in 22.52s.
2021-10-08 08:22:24.846553 (MainThread): Connection 'master' was properly closed.
2021-10-08 08:22:24.846553 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 08:22:24.847535 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 08:22:24.847535 (MainThread): Connection 'model.lukeclarke_learn_dbt.time' was properly closed.
2021-10-08 08:22:24.862392 (MainThread): 
2021-10-08 08:22:24.862392 (MainThread): Completed with 1 error and 0 warnings:
2021-10-08 08:22:24.863396 (MainThread): 
2021-10-08 08:22:24.864398 (MainThread): Compilation Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-08 08:22:24.864398 (MainThread):   Required var 'my_first_variable' not found in config:
2021-10-08 08:22:24.864398 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-10-08 08:22:24.865394 (MainThread):   
2021-10-08 08:22:24.865394 (MainThread):   > in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-08 08:22:24.865394 (MainThread):   > called by model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-08 08:22:24.866392 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
2021-10-08 08:22:24.866392 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C78F0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C793C6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6C79C6B80>]}
2021-10-08 08:22:24.866392 (MainThread): Flushing usage events
2021-10-08 08:28:22.028075 (MainThread): Running with dbt=0.20.2
2021-10-08 08:28:22.799401 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 08:28:22.800586 (MainThread): Tracking: tracking
2021-10-08 08:28:22.801593 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127145DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212729A4460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212729A4250>]}
2021-10-08 08:28:22.808593 (MainThread): Partial parsing not enabled
2021-10-08 08:28:22.829911 (MainThread): Parsing macros\adapters.sql
2021-10-08 08:28:22.850284 (MainThread): Parsing macros\catalog.sql
2021-10-08 08:28:22.852285 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 08:28:22.859701 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 08:28:22.861302 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 08:28:22.865094 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 08:28:22.866406 (MainThread): Parsing macros\core.sql
2021-10-08 08:28:22.869974 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 08:28:22.904244 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 08:28:22.909337 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 08:28:22.910355 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 08:28:22.911335 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 08:28:22.912334 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 08:28:22.914327 (MainThread): Parsing macros\etc\query.sql
2021-10-08 08:28:22.914536 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 08:28:22.921625 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 08:28:22.926545 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 08:28:22.936334 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 08:28:22.937340 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 08:28:22.943341 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 08:28:22.958596 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 08:28:22.980117 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 08:28:22.981121 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 08:28:22.993674 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 08:28:22.998675 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 08:28:23.001676 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 08:28:23.006586 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 08:28:23.007489 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 08:28:23.008584 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 08:28:23.009584 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 08:28:23.143387 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:28:23.150376 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:28:23.155391 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:28:23.158383 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:28:23.158383 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:28:23.161571 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:28:23.162603 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:28:23.186938 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:28:23.187952 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:28:23.188954 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:28:23.191178 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:28:23.220831 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:28:23.225186 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:28:23.228234 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:28:23.262033 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84722503-d6dc-4b16-b533-a6da4d539b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127299BD60>]}
2021-10-08 08:28:23.305608 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 08:28:23.306684 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84722503-d6dc-4b16-b533-a6da4d539b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127299C220>]}
2021-10-08 08:28:23.307389 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 08:28:23.307888 (MainThread): 
2021-10-08 08:28:23.308898 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:28:23.310950 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 08:28:23.324208 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 08:28:23.325205 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 08:28:23.325205 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 08:28:25.007072 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.68 seconds
2021-10-08 08:28:25.010074 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 08:28:25.301177 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 08:28:25.307249 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 08:28:25.307249 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 08:28:25.307249 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 08:28:26.315684 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.01 seconds
2021-10-08 08:28:26.316682 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 08:28:26.620686 (MainThread): Using snowflake connection "master".
2021-10-08 08:28:26.620686 (MainThread): On master: BEGIN
2021-10-08 08:28:26.621670 (MainThread): Opening a new connection, currently in state init
2021-10-08 08:28:27.437400 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 08:28:27.438424 (MainThread): On master: COMMIT
2021-10-08 08:28:27.438424 (MainThread): Using snowflake connection "master".
2021-10-08 08:28:27.438424 (MainThread): On master: COMMIT
2021-10-08 08:28:27.687428 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 08:28:27.688471 (MainThread): On master: Close
2021-10-08 08:28:27.991506 (MainThread): 10:28:27 | Concurrency: 1 threads (target='dev')
2021-10-08 08:28:27.992515 (MainThread): 10:28:27 | 
2021-10-08 08:28:27.997500 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:28:27.997500 (Thread-1): 10:28:27 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 08:28:27.997500 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:28:27.998500 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:28:27.999596 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 08:28:28.006497 (Thread-1): finished collecting timing info
2021-10-08 08:28:28.031477 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 08:28:28.054929 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:28:28.054929 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 08:28:28.055266 (Thread-1): Opening a new connection, currently in state init
2021-10-08 08:28:28.832660 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 08:28:28.832831 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:28:28.832877 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, True as first_variable
from source_data
where id >= 1
/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 08:28:30.722585 (Thread-1): SQL status: SUCCESS 1 in 1.89 seconds
2021-10-08 08:28:30.723589 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 08:28:30.724588 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:28:30.724588 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 08:28:30.915980 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 08:28:30.923341 (Thread-1): finished collecting timing info
2021-10-08 08:28:30.923341 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 08:28:31.222034 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84722503-d6dc-4b16-b533-a6da4d539b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021272DB6430>]}
2021-10-08 08:28:31.223035 (Thread-1): 10:28:31 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 3.22s]
2021-10-08 08:28:31.223951 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:28:31.223951 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:28:31.223951 (Thread-1): 10:28:31 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 08:28:31.224968 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:28:31.224968 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:28:31.224968 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:28:31.230957 (Thread-1): finished collecting timing info
2021-10-08 08:28:31.233046 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:28:31.253042 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:28:31.254075 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 08:28:31.254075 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:28:32.084835 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-08 08:28:32.084835 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:28:32.084835 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 08:28:33.825254 (Thread-1): SQL status: SUCCESS 1 in 1.74 seconds
2021-10-08 08:28:33.826375 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:28:33.827362 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:28:33.827362 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:28:34.016047 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 08:28:34.017047 (Thread-1): finished collecting timing info
2021-10-08 08:28:34.018047 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 08:28:34.323729 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84722503-d6dc-4b16-b533-a6da4d539b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127297AFD0>]}
2021-10-08 08:28:34.323729 (Thread-1): 10:28:34 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.10s]
2021-10-08 08:28:34.324649 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:28:34.324649 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:28:34.324649 (Thread-1): 10:28:34 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 08:28:34.325652 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:28:34.325652 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 08:28:34.328736 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:28:34.333662 (Thread-1): finished collecting timing info
2021-10-08 08:28:34.356072 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:28:34.356072 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 08:28:34.357110 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:28:36.873446 (Thread-1): SQL status: SUCCESS 1 in 2.52 seconds
2021-10-08 08:28:36.879450 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:28:36.879450 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 08:28:37.053982 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:28:37.055676 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:28:37.055676 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:28:37.229990 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:28:37.231991 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:28:37.231991 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:28:37.400768 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:28:37.408945 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:28:37.414097 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:28:37.414097 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 08:28:37.591942 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:28:37.591942 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:28:37.591942 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 08:28:38.027994 (Thread-1): SQL status: SUCCESS 0 in 0.44 seconds
2021-10-08 08:28:38.028530 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:28:38.028530 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:28:38.029024 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:28:38.277096 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 08:28:38.278197 (Thread-1): finished collecting timing info
2021-10-08 08:28:38.279194 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 08:28:38.654912 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84722503-d6dc-4b16-b533-a6da4d539b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021272DE2E50>]}
2021-10-08 08:28:38.655917 (Thread-1): 10:28:38 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 4.33s]
2021-10-08 08:28:38.657916 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:28:38.657916 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:28:38.658912 (Thread-1): 10:28:38 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 08:28:38.658912 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:28:38.658912 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:28:38.660996 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:28:38.666976 (Thread-1): finished collecting timing info
2021-10-08 08:28:38.670542 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:28:38.675557 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:28:38.675557 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 08:28:38.675557 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:28:39.703030 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-10-08 08:28:39.703030 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:28:39.703030 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 08:28:41.294865 (Thread-1): SQL status: SUCCESS 1 in 1.59 seconds
2021-10-08 08:28:41.296785 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:28:41.296785 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:28:41.296785 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:28:41.466340 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:28:41.467252 (Thread-1): finished collecting timing info
2021-10-08 08:28:41.468246 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 08:28:41.774202 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84722503-d6dc-4b16-b533-a6da4d539b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021272C91AF0>]}
2021-10-08 08:28:41.775208 (Thread-1): 10:28:41 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.12s]
2021-10-08 08:28:41.776197 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:28:41.776197 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 08:28:41.776197 (Thread-1): 10:28:41 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 08:28:41.777197 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:28:41.777197 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 08:28:41.779277 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:28:41.797511 (Thread-1): finished collecting timing info
2021-10-08 08:28:41.798981 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:28:41.798981 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 08:28:41.798981 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:28:43.687956 (Thread-1): SQL status: SUCCESS 1 in 1.89 seconds
2021-10-08 08:28:43.688958 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:28:43.688958 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 08:28:43.863723 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:28:43.868027 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:28:43.868027 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:28:44.047844 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:28:44.049844 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:28:44.049844 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:28:44.221528 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:28:44.222853 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:28:44.227863 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:28:44.227863 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 08:28:44.435099 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-08 08:28:44.435099 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:28:44.436098 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 08:28:44.791553 (Thread-1): SQL status: SUCCESS 0 in 0.36 seconds
2021-10-08 08:28:44.793552 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:28:44.793552 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:28:44.793552 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:28:45.128548 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-08 08:28:45.129598 (Thread-1): finished collecting timing info
2021-10-08 08:28:45.129598 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 08:28:45.455328 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84722503-d6dc-4b16-b533-a6da4d539b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021272E487C0>]}
2021-10-08 08:28:45.456333 (Thread-1): 10:28:45 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.68s]
2021-10-08 08:28:45.457563 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 08:28:45.458580 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:28:45.459578 (Thread-1): 10:28:45 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 08:28:45.459578 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:28:45.460581 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:28:45.462813 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 08:28:45.480188 (Thread-1): finished collecting timing info
2021-10-08 08:28:45.481272 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 08:28:45.486188 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:28:45.487188 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 08:28:45.487188 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:28:46.706704 (Thread-1): SQL status: SUCCESS 1 in 1.22 seconds
2021-10-08 08:28:46.706704 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:28:46.706704 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
where id = 1
      );
2021-10-08 08:28:47.839641 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2021-10-08 08:28:47.842721 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 08:28:47.842721 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:28:47.842721 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 08:28:48.006159 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:28:48.007211 (Thread-1): finished collecting timing info
2021-10-08 08:28:48.007211 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 08:28:48.301546 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84722503-d6dc-4b16-b533-a6da4d539b2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021272E3B970>]}
2021-10-08 08:28:48.302547 (Thread-1): 10:28:48 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.84s]
2021-10-08 08:28:48.304152 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:28:48.306168 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:28:48.306168 (MainThread): Using snowflake connection "master".
2021-10-08 08:28:48.306168 (MainThread): On master: BEGIN
2021-10-08 08:28:48.307250 (MainThread): Opening a new connection, currently in state closed
2021-10-08 08:28:49.197132 (MainThread): SQL status: SUCCESS 1 in 0.89 seconds
2021-10-08 08:28:49.197132 (MainThread): On master: COMMIT
2021-10-08 08:28:49.197132 (MainThread): Using snowflake connection "master".
2021-10-08 08:28:49.197132 (MainThread): On master: COMMIT
2021-10-08 08:28:49.447916 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 08:28:49.447916 (MainThread): On master: Close
2021-10-08 08:28:49.742283 (MainThread): 10:28:49 | 
2021-10-08 08:28:49.742283 (MainThread): 10:28:49 | Finished running 4 table models, 2 incremental models in 26.43s.
2021-10-08 08:28:49.743285 (MainThread): Connection 'master' was properly closed.
2021-10-08 08:28:49.743285 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 08:28:49.743285 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 08:28:49.743285 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 08:28:49.765655 (MainThread): 
2021-10-08 08:28:49.765655 (MainThread): Completed successfully
2021-10-08 08:28:49.766612 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-08 08:28:49.766612 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021272A8F940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021272AC2D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021272C9FFA0>]}
2021-10-08 08:28:49.766612 (MainThread): Flushing usage events
2021-10-08 08:29:17.693919 (MainThread): Running with dbt=0.20.2
2021-10-08 08:29:18.265597 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 08:29:18.266598 (MainThread): Tracking: tracking
2021-10-08 08:29:18.266598 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215052ECDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150681AEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150681A4F0>]}
2021-10-08 08:29:18.271599 (MainThread): Partial parsing not enabled
2021-10-08 08:29:18.284840 (MainThread): Parsing macros\adapters.sql
2021-10-08 08:29:18.303719 (MainThread): Parsing macros\catalog.sql
2021-10-08 08:29:18.304720 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 08:29:18.311895 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 08:29:18.312885 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 08:29:18.315898 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 08:29:18.316808 (MainThread): Parsing macros\core.sql
2021-10-08 08:29:18.318898 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 08:29:18.351917 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 08:29:18.358085 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 08:29:18.358085 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 08:29:18.359086 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 08:29:18.361085 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 08:29:18.362085 (MainThread): Parsing macros\etc\query.sql
2021-10-08 08:29:18.362085 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 08:29:18.369084 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 08:29:18.374086 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 08:29:18.384087 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 08:29:18.385221 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 08:29:18.391238 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 08:29:18.405538 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 08:29:18.426679 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 08:29:18.427681 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 08:29:18.442873 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 08:29:18.448049 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 08:29:18.451048 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 08:29:18.456049 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 08:29:18.458049 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 08:29:18.459049 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 08:29:18.461142 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 08:29:18.566999 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:29:18.573210 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:29:18.577186 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:29:18.579225 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:29:18.579225 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:29:18.581196 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:29:18.582199 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:29:18.605943 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:29:18.607940 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:29:18.608947 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:29:18.609941 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:29:18.641727 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:29:18.644728 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:29:18.648039 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:29:18.665783 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74784a08-dab2-4d53-bb5e-1639f2760102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150689FC40>]}
2021-10-08 08:29:18.696657 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 08:29:18.697382 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74784a08-dab2-4d53-bb5e-1639f2760102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021506895F70>]}
2021-10-08 08:29:18.697382 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 08:29:18.698755 (MainThread): 
2021-10-08 08:29:18.698755 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:29:18.699803 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 08:29:18.714349 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 08:29:18.714349 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 08:29:18.714349 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 08:29:19.937090 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.22 seconds
2021-10-08 08:29:19.944075 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 08:29:20.282942 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 08:29:20.287676 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 08:29:20.287676 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 08:29:20.288733 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 08:29:21.051279 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.76 seconds
2021-10-08 08:29:21.052278 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 08:29:21.362000 (MainThread): Using snowflake connection "master".
2021-10-08 08:29:21.362000 (MainThread): On master: BEGIN
2021-10-08 08:29:21.362000 (MainThread): Opening a new connection, currently in state init
2021-10-08 08:29:22.362269 (MainThread): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-08 08:29:22.363267 (MainThread): On master: COMMIT
2021-10-08 08:29:22.363508 (MainThread): Using snowflake connection "master".
2021-10-08 08:29:22.363508 (MainThread): On master: COMMIT
2021-10-08 08:29:22.633394 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 08:29:22.633394 (MainThread): On master: Close
2021-10-08 08:29:22.977087 (MainThread): 10:29:22 | Concurrency: 1 threads (target='dev')
2021-10-08 08:29:22.978180 (MainThread): 10:29:22 | 
2021-10-08 08:29:22.982540 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:29:22.982540 (Thread-1): 10:29:22 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 08:29:22.983443 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:29:22.983443 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:29:23.000687 (Thread-1): finished collecting timing info
2021-10-08 08:29:23.000687 (Thread-1): Compilation Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {
      "my_first_dbt_model": {
          "my_first_variable": true,
          "my_second_variable": 2020,
          "my_third_variable": 1
      }
  }
  
  > in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models\example\my_first_dbt_model.sql)
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 464, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 371, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\context\base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\context\base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {
      "my_first_dbt_model": {
          "my_first_variable": true,
          "my_second_variable": 2020,
          "my_third_variable": 1
      }
  }
  
  > in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-08 08:29:23.010410 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74784a08-dab2-4d53-bb5e-1639f2760102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021506BE4C40>]}
2021-10-08 08:29:23.010410 (Thread-1): 10:29:23 | 1 of 6 ERROR creating table model dbt.first_model.................... [ERROR in 0.03s]
2021-10-08 08:29:23.011410 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:29:23.011410 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:29:23.011410 (Thread-1): 10:29:23 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 08:29:23.012500 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:29:23.012911 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:29:23.013996 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:29:23.019998 (Thread-1): finished collecting timing info
2021-10-08 08:29:23.039428 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:29:23.041434 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:29:23.041434 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 08:29:23.041434 (Thread-1): Opening a new connection, currently in state init
2021-10-08 08:29:23.909299 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-08 08:29:23.909299 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:29:23.909299 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 08:29:25.431647 (Thread-1): SQL status: SUCCESS 1 in 1.52 seconds
2021-10-08 08:29:25.432655 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:29:25.432655 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:29:25.432655 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:29:25.590785 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:29:25.603189 (Thread-1): finished collecting timing info
2021-10-08 08:29:25.603189 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 08:29:25.910697 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74784a08-dab2-4d53-bb5e-1639f2760102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021506C11610>]}
2021-10-08 08:29:25.910697 (Thread-1): 10:29:25 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.90s]
2021-10-08 08:29:25.911711 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:29:25.911711 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:29:25.911711 (Thread-1): 10:29:25 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 08:29:25.912789 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:29:25.912789 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 08:29:25.917751 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:29:25.919804 (Thread-1): finished collecting timing info
2021-10-08 08:29:25.937392 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:29:25.937392 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 08:29:25.937392 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:29:27.202192 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-10-08 08:29:27.213180 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:29:27.213180 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 08:29:27.403320 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 08:29:27.404973 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:29:27.404973 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:29:27.562345 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:29:27.565267 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:29:27.565267 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:29:27.737927 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:29:27.748921 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:29:27.751005 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:29:27.751005 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 08:29:27.931498 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:29:27.931498 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:29:27.931498 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 08:29:28.320681 (Thread-1): SQL status: SUCCESS 0 in 0.39 seconds
2021-10-08 08:29:28.322682 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:29:28.322682 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:29:28.323679 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:29:28.637887 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-10-08 08:29:28.638887 (Thread-1): finished collecting timing info
2021-10-08 08:29:28.639884 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 08:29:28.944773 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74784a08-dab2-4d53-bb5e-1639f2760102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021506BE8E80>]}
2021-10-08 08:29:28.944773 (Thread-1): 10:29:28 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.03s]
2021-10-08 08:29:28.946695 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:29:28.946695 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:29:28.946695 (Thread-1): 10:29:28 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 08:29:28.947787 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:29:28.947787 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:29:28.949690 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:29:28.955151 (Thread-1): finished collecting timing info
2021-10-08 08:29:28.957155 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:29:28.959079 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:29:28.959079 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 08:29:28.959079 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:29:29.708344 (Thread-1): SQL status: SUCCESS 1 in 0.75 seconds
2021-10-08 08:29:29.708344 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:29:29.708344 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 08:29:31.148558 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-10-08 08:29:31.149553 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:29:31.150548 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:29:31.150722 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:29:31.330609 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:29:31.331721 (Thread-1): finished collecting timing info
2021-10-08 08:29:31.331721 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 08:29:31.641885 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74784a08-dab2-4d53-bb5e-1639f2760102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150532E070>]}
2021-10-08 08:29:31.641885 (Thread-1): 10:29:31 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.69s]
2021-10-08 08:29:31.643870 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:29:31.643870 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 08:29:31.643870 (Thread-1): 10:29:31 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 08:29:31.644873 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:29:31.644873 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 08:29:31.648340 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:29:31.649426 (Thread-1): finished collecting timing info
2021-10-08 08:29:31.652333 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:29:31.652333 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 08:29:31.652333 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:29:33.195964 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2021-10-08 08:29:33.196961 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:29:33.197884 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 08:29:33.377930 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:29:33.379961 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:29:33.379961 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:29:33.538542 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:29:33.541541 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:29:33.541541 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:29:33.698100 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:29:33.699100 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:29:33.701103 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:29:33.701103 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 08:29:33.885874 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:29:33.885874 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:29:33.885874 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 08:29:34.228107 (Thread-1): SQL status: SUCCESS 0 in 0.34 seconds
2021-10-08 08:29:34.229114 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:29:34.229114 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:29:34.229114 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:29:34.458128 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-08 08:29:34.459128 (Thread-1): finished collecting timing info
2021-10-08 08:29:34.459128 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 08:29:34.777426 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74784a08-dab2-4d53-bb5e-1639f2760102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021506B23C10>]}
2021-10-08 08:29:34.777426 (Thread-1): 10:29:34 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.13s]
2021-10-08 08:29:34.778723 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 08:29:34.778723 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:29:34.779683 (Thread-1): 10:29:34 | 6 of 6 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-10-08 08:29:34.780691 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:29:34.781698 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:29:34.781698 (MainThread): Using snowflake connection "master".
2021-10-08 08:29:34.781698 (MainThread): On master: BEGIN
2021-10-08 08:29:34.781698 (MainThread): Opening a new connection, currently in state closed
2021-10-08 08:29:35.597528 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 08:29:35.597528 (MainThread): On master: COMMIT
2021-10-08 08:29:35.597528 (MainThread): Using snowflake connection "master".
2021-10-08 08:29:35.597528 (MainThread): On master: COMMIT
2021-10-08 08:29:35.871164 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 08:29:35.872153 (MainThread): On master: Close
2021-10-08 08:29:36.174762 (MainThread): 10:29:36 | 
2021-10-08 08:29:36.174762 (MainThread): 10:29:36 | Finished running 4 table models, 2 incremental models in 17.48s.
2021-10-08 08:29:36.175763 (MainThread): Connection 'master' was properly closed.
2021-10-08 08:29:36.175763 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 08:29:36.175763 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 08:29:36.175763 (MainThread): Connection 'model.lukeclarke_learn_dbt.time' was properly closed.
2021-10-08 08:29:36.192548 (MainThread): 
2021-10-08 08:29:36.194765 (MainThread): Completed with 1 error and 0 warnings:
2021-10-08 08:29:36.195525 (MainThread): 
2021-10-08 08:29:36.195941 (MainThread): Compilation Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-08 08:29:36.197347 (MainThread):   Required var 'my_first_variable' not found in config:
2021-10-08 08:29:36.197347 (MainThread):   Vars supplied to my_first_dbt_model = {
2021-10-08 08:29:36.197878 (MainThread):       "my_first_dbt_model": {
2021-10-08 08:29:36.197878 (MainThread):           "my_first_variable": true,
2021-10-08 08:29:36.199532 (MainThread):           "my_second_variable": 2020,
2021-10-08 08:29:36.200567 (MainThread):           "my_third_variable": 1
2021-10-08 08:29:36.200567 (MainThread):       }
2021-10-08 08:29:36.201069 (MainThread):   }
2021-10-08 08:29:36.201069 (MainThread):   
2021-10-08 08:29:36.201732 (MainThread):   > in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-08 08:29:36.201966 (MainThread):   > called by model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-08 08:29:36.201966 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
2021-10-08 08:29:36.202467 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150532EBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021503D89A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150681A2B0>]}
2021-10-08 08:29:36.202467 (MainThread): Flushing usage events
2021-10-08 08:30:06.032609 (MainThread): Running with dbt=0.20.2
2021-10-08 08:30:06.583808 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 08:30:06.584808 (MainThread): Tracking: tracking
2021-10-08 08:30:06.584808 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797D8CDE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797EDFA040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797EDFA670>]}
2021-10-08 08:30:06.591183 (MainThread): Partial parsing not enabled
2021-10-08 08:30:06.604197 (MainThread): Parsing macros\adapters.sql
2021-10-08 08:30:06.625309 (MainThread): Parsing macros\catalog.sql
2021-10-08 08:30:06.627309 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 08:30:06.633398 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 08:30:06.635398 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 08:30:06.637685 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 08:30:06.638706 (MainThread): Parsing macros\core.sql
2021-10-08 08:30:06.641705 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 08:30:06.673557 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 08:30:06.680558 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 08:30:06.680558 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 08:30:06.681471 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 08:30:06.683685 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 08:30:06.684687 (MainThread): Parsing macros\etc\query.sql
2021-10-08 08:30:06.684687 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 08:30:06.692686 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 08:30:06.696685 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 08:30:06.707292 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 08:30:06.708379 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 08:30:06.714742 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 08:30:06.730200 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 08:30:06.751415 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 08:30:06.753417 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 08:30:06.765416 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 08:30:06.770415 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 08:30:06.774416 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 08:30:06.778871 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 08:30:06.780867 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 08:30:06.780867 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 08:30:06.782854 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 08:30:06.904421 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:30:06.911407 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:30:06.917770 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:30:06.919779 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:30:06.920777 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:30:06.922772 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:30:06.924776 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:30:06.950030 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:30:06.951031 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:30:06.952031 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:30:06.954031 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:30:06.982792 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:30:06.986800 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:30:06.989790 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:30:07.004841 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bafad9f-8f79-4b72-9e44-c7f2a927993f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797EF4E0A0>]}
2021-10-08 08:30:07.029524 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 08:30:07.030189 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bafad9f-8f79-4b72-9e44-c7f2a927993f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797EF4E610>]}
2021-10-08 08:30:07.030189 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 08:30:07.031968 (MainThread): 
2021-10-08 08:30:07.032112 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:30:07.034621 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 08:30:07.045522 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 08:30:07.045922 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 08:30:07.045922 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 08:30:08.520084 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.47 seconds
2021-10-08 08:30:08.528501 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 08:30:08.906561 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 08:30:08.910651 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 08:30:08.911058 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 08:30:08.911163 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 08:30:09.803670 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.89 seconds
2021-10-08 08:30:09.805670 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 08:30:10.131588 (MainThread): Using snowflake connection "master".
2021-10-08 08:30:10.131588 (MainThread): On master: BEGIN
2021-10-08 08:30:10.132603 (MainThread): Opening a new connection, currently in state init
2021-10-08 08:30:11.297393 (MainThread): SQL status: SUCCESS 1 in 1.17 seconds
2021-10-08 08:30:11.297393 (MainThread): On master: COMMIT
2021-10-08 08:30:11.298399 (MainThread): Using snowflake connection "master".
2021-10-08 08:30:11.298399 (MainThread): On master: COMMIT
2021-10-08 08:30:11.893914 (MainThread): SQL status: SUCCESS 1 in 0.60 seconds
2021-10-08 08:30:11.894902 (MainThread): On master: Close
2021-10-08 08:30:12.216033 (MainThread): 10:30:12 | Concurrency: 1 threads (target='dev')
2021-10-08 08:30:12.216960 (MainThread): 10:30:12 | 
2021-10-08 08:30:12.222956 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:30:12.222956 (Thread-1): 10:30:12 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 08:30:12.224034 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:30:12.224034 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:30:12.230451 (Thread-1): finished collecting timing info
2021-10-08 08:30:12.230451 (Thread-1): Compilation Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {
      "first_model": {
          "my_first_variable": true,
          "my_second_variable": 2020,
          "my_third_variable": 1
      }
  }
  
  > in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models\example\my_first_dbt_model.sql)
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 464, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 371, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 18, in top-level template code
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\context\base.py", line 159, in __call__
    return self.get_missing_var(var_name)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\context\base.py", line 140, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {
      "first_model": {
          "my_first_variable": true,
          "my_second_variable": 2020,
          "my_third_variable": 1
      }
  }
  
  > in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-08 08:30:12.233461 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bafad9f-8f79-4b72-9e44-c7f2a927993f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797F1060D0>]}
2021-10-08 08:30:12.233461 (Thread-1): 10:30:12 | 1 of 6 ERROR creating table model dbt.first_model.................... [ERROR in 0.01s]
2021-10-08 08:30:12.234463 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:30:12.234463 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:30:12.235462 (Thread-1): 10:30:12 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 08:30:12.236459 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:30:12.236459 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:30:12.237459 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:30:12.242793 (Thread-1): finished collecting timing info
2021-10-08 08:30:12.262686 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:30:12.264160 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:30:12.264160 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 08:30:12.264160 (Thread-1): Opening a new connection, currently in state init
2021-10-08 08:30:13.139124 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-08 08:30:13.140120 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:30:13.140120 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 08:30:14.990060 (Thread-1): SQL status: SUCCESS 1 in 1.85 seconds
2021-10-08 08:30:14.993048 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:30:14.993048 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:30:14.993048 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:30:15.160196 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:30:15.174018 (Thread-1): finished collecting timing info
2021-10-08 08:30:15.174018 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 08:30:15.481158 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bafad9f-8f79-4b72-9e44-c7f2a927993f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797F1CEA00>]}
2021-10-08 08:30:15.482162 (Thread-1): 10:30:15 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.25s]
2021-10-08 08:30:15.483776 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:30:15.484427 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:30:15.484617 (Thread-1): 10:30:15 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 08:30:15.484617 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:30:15.485799 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 08:30:15.494891 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:30:15.497502 (Thread-1): finished collecting timing info
2021-10-08 08:30:15.515214 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:30:15.515214 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 08:30:15.515773 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:30:17.080013 (Thread-1): SQL status: SUCCESS 1 in 1.56 seconds
2021-10-08 08:30:17.093621 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:30:17.093621 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 08:30:17.283186 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 08:30:17.287566 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:30:17.288645 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:30:17.491667 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 08:30:17.496668 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:30:17.496668 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:30:17.703101 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-08 08:30:17.717113 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:30:17.720111 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:30:17.721115 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 08:30:17.932783 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-08 08:30:17.932783 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:30:17.932783 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 08:30:18.355704 (Thread-1): SQL status: SUCCESS 0 in 0.42 seconds
2021-10-08 08:30:18.358704 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:30:18.358704 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:30:18.358704 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:30:18.619564 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-08 08:30:18.621913 (Thread-1): finished collecting timing info
2021-10-08 08:30:18.621913 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 08:30:18.986573 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bafad9f-8f79-4b72-9e44-c7f2a927993f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797F104550>]}
2021-10-08 08:30:18.987509 (Thread-1): 10:30:18 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.50s]
2021-10-08 08:30:18.988767 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:30:18.989883 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:30:18.990341 (Thread-1): 10:30:18 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 08:30:18.992530 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:30:18.992530 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:30:18.997535 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:30:19.003409 (Thread-1): finished collecting timing info
2021-10-08 08:30:19.005546 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:30:19.008060 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:30:19.008060 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 08:30:19.008060 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:30:20.093719 (Thread-1): SQL status: SUCCESS 1 in 1.09 seconds
2021-10-08 08:30:20.093719 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:30:20.093719 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 08:30:21.490921 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-10-08 08:30:21.491941 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:30:21.491941 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:30:21.491941 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:30:21.659681 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:30:21.661678 (Thread-1): finished collecting timing info
2021-10-08 08:30:21.661678 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 08:30:21.969811 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bafad9f-8f79-4b72-9e44-c7f2a927993f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797F0BD790>]}
2021-10-08 08:30:21.969811 (Thread-1): 10:30:21 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.98s]
2021-10-08 08:30:21.970813 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:30:21.971814 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 08:30:21.971814 (Thread-1): 10:30:21 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 08:30:21.971814 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:30:21.971814 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 08:30:21.974812 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:30:21.975811 (Thread-1): finished collecting timing info
2021-10-08 08:30:21.977832 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:30:21.977832 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 08:30:21.977832 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:30:23.577792 (Thread-1): SQL status: SUCCESS 1 in 1.60 seconds
2021-10-08 08:30:23.579780 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:30:23.579780 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 08:30:23.767559 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 08:30:23.771063 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:30:23.771063 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:30:23.968991 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 08:30:23.972991 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:30:23.973990 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:30:24.175300 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 08:30:24.176328 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:30:24.178327 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:30:24.178327 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 08:30:24.365578 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 08:30:24.365578 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:30:24.365578 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 08:30:24.707846 (Thread-1): SQL status: SUCCESS 0 in 0.34 seconds
2021-10-08 08:30:24.708915 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:30:24.709044 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:30:24.709044 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:30:24.980847 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 08:30:24.981868 (Thread-1): finished collecting timing info
2021-10-08 08:30:24.981868 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 08:30:25.328937 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bafad9f-8f79-4b72-9e44-c7f2a927993f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797F2D3070>]}
2021-10-08 08:30:25.328937 (Thread-1): 10:30:25 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.36s]
2021-10-08 08:30:25.329867 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 08:30:25.330850 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:30:25.330850 (Thread-1): 10:30:25 | 6 of 6 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-10-08 08:30:25.330850 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:30:25.331847 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:30:25.331847 (MainThread): Using snowflake connection "master".
2021-10-08 08:30:25.331847 (MainThread): On master: BEGIN
2021-10-08 08:30:25.331847 (MainThread): Opening a new connection, currently in state closed
2021-10-08 08:30:26.497939 (MainThread): SQL status: SUCCESS 1 in 1.17 seconds
2021-10-08 08:30:26.498890 (MainThread): On master: COMMIT
2021-10-08 08:30:26.498890 (MainThread): Using snowflake connection "master".
2021-10-08 08:30:26.498890 (MainThread): On master: COMMIT
2021-10-08 08:30:26.857644 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-08 08:30:26.857644 (MainThread): On master: Close
2021-10-08 08:30:27.169985 (MainThread): 10:30:27 | 
2021-10-08 08:30:27.170984 (MainThread): 10:30:27 | Finished running 4 table models, 2 incremental models in 20.14s.
2021-10-08 08:30:27.171985 (MainThread): Connection 'master' was properly closed.
2021-10-08 08:30:27.171985 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 08:30:27.171985 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 08:30:27.171985 (MainThread): Connection 'model.lukeclarke_learn_dbt.time' was properly closed.
2021-10-08 08:30:27.188911 (MainThread): 
2021-10-08 08:30:27.189907 (MainThread): Completed with 1 error and 0 warnings:
2021-10-08 08:30:27.190870 (MainThread): 
2021-10-08 08:30:27.190870 (MainThread): Compilation Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-08 08:30:27.192562 (MainThread):   Required var 'my_first_variable' not found in config:
2021-10-08 08:30:27.193604 (MainThread):   Vars supplied to my_first_dbt_model = {
2021-10-08 08:30:27.195562 (MainThread):       "first_model": {
2021-10-08 08:30:27.195562 (MainThread):           "my_first_variable": true,
2021-10-08 08:30:27.196618 (MainThread):           "my_second_variable": 2020,
2021-10-08 08:30:27.197376 (MainThread):           "my_third_variable": 1
2021-10-08 08:30:27.197376 (MainThread):       }
2021-10-08 08:30:27.197376 (MainThread):   }
2021-10-08 08:30:27.198383 (MainThread):   
2021-10-08 08:30:27.198383 (MainThread):   > in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-08 08:30:27.198383 (MainThread):   > called by model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-08 08:30:27.199381 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
2021-10-08 08:30:27.199381 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797EEC7B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797EE61310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797EE615E0>]}
2021-10-08 08:30:27.200384 (MainThread): Flushing usage events
2021-10-08 08:31:45.047063 (MainThread): Running with dbt=0.20.2
2021-10-08 08:31:45.618768 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 08:31:45.618768 (MainThread): Tracking: tracking
2021-10-08 08:31:45.619768 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547CD7DDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547E2ABC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547E2AB670>]}
2021-10-08 08:31:45.624768 (MainThread): Partial parsing not enabled
2021-10-08 08:31:45.637669 (MainThread): Parsing macros\adapters.sql
2021-10-08 08:31:45.657668 (MainThread): Parsing macros\catalog.sql
2021-10-08 08:31:45.658706 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 08:31:45.665669 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 08:31:45.667670 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 08:31:45.670766 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 08:31:45.670766 (MainThread): Parsing macros\core.sql
2021-10-08 08:31:45.673767 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 08:31:45.706543 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 08:31:45.712533 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 08:31:45.713546 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 08:31:45.714554 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 08:31:45.715542 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 08:31:45.716534 (MainThread): Parsing macros\etc\query.sql
2021-10-08 08:31:45.717581 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 08:31:45.724535 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 08:31:45.729548 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 08:31:45.738533 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 08:31:45.739548 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 08:31:45.745549 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 08:31:45.761535 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 08:31:45.778732 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 08:31:45.779650 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 08:31:45.791649 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 08:31:45.795647 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 08:31:45.798648 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 08:31:45.802648 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 08:31:45.804139 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 08:31:45.805515 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 08:31:45.807468 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 08:31:45.935559 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:31:45.943127 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:31:45.949139 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:31:45.952137 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:31:45.953138 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:31:45.956137 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:31:45.958136 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:31:45.982795 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:31:45.983795 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:31:45.985795 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:31:45.986796 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:31:46.022445 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:31:46.026621 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:31:46.029641 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:31:46.045498 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad29371a-5570-468e-9eaf-d469aadffdae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547E3EBF40>]}
2021-10-08 08:31:46.074560 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 08:31:46.074560 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad29371a-5570-468e-9eaf-d469aadffdae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547E3EBAF0>]}
2021-10-08 08:31:46.074560 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 08:31:46.076561 (MainThread): 
2021-10-08 08:31:46.076561 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:31:46.078561 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 08:31:46.087884 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 08:31:46.087884 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 08:31:46.087884 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 08:31:47.501131 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.41 seconds
2021-10-08 08:31:47.504714 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 08:31:47.819043 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 08:31:47.826816 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 08:31:47.826816 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 08:31:47.826816 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 08:31:48.701116 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.87 seconds
2021-10-08 08:31:48.702168 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 08:31:48.997290 (MainThread): Using snowflake connection "master".
2021-10-08 08:31:48.997290 (MainThread): On master: BEGIN
2021-10-08 08:31:48.997290 (MainThread): Opening a new connection, currently in state init
2021-10-08 08:31:49.786684 (MainThread): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 08:31:49.786684 (MainThread): On master: COMMIT
2021-10-08 08:31:49.786684 (MainThread): Using snowflake connection "master".
2021-10-08 08:31:49.786684 (MainThread): On master: COMMIT
2021-10-08 08:31:50.065634 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-08 08:31:50.065748 (MainThread): On master: Close
2021-10-08 08:31:50.368845 (MainThread): 10:31:50 | Concurrency: 1 threads (target='dev')
2021-10-08 08:31:50.369851 (MainThread): 10:31:50 | 
2021-10-08 08:31:50.373248 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:31:50.374341 (Thread-1): 10:31:50 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 08:31:50.374341 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:31:50.374341 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:31:50.378325 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 08:31:50.387293 (Thread-1): finished collecting timing info
2021-10-08 08:31:50.412377 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 08:31:50.420328 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:31:50.421335 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 08:31:50.421335 (Thread-1): Opening a new connection, currently in state init
2021-10-08 08:31:51.432987 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-08 08:31:51.432987 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:31:51.432987 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, True as first_variable
from source_data
where id >= 1
/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 08:31:52.385322 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-10-08 08:31:52.385322 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 08:31:52.385322 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:31:52.385322 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 08:31:52.551444 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:31:52.559431 (Thread-1): finished collecting timing info
2021-10-08 08:31:52.559431 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 08:31:52.864211 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad29371a-5570-468e-9eaf-d469aadffdae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547E3A61F0>]}
2021-10-08 08:31:52.864211 (Thread-1): 10:31:52 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.49s]
2021-10-08 08:31:52.865210 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:31:52.865210 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:31:52.866267 (Thread-1): 10:31:52 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 08:31:52.866267 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:31:52.866267 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:31:52.867293 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:31:52.871284 (Thread-1): finished collecting timing info
2021-10-08 08:31:52.873209 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:31:52.874347 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:31:52.874347 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 08:31:52.874347 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:31:53.705694 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-08 08:31:53.705694 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:31:53.705694 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 08:31:55.135481 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2021-10-08 08:31:55.136506 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:31:55.136506 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:31:55.136506 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:31:55.291802 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:31:55.292809 (Thread-1): finished collecting timing info
2021-10-08 08:31:55.292809 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 08:31:55.602601 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad29371a-5570-468e-9eaf-d469aadffdae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254773BBB50>]}
2021-10-08 08:31:55.603597 (Thread-1): 10:31:55 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.74s]
2021-10-08 08:31:55.604910 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:31:55.604910 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:31:55.604910 (Thread-1): 10:31:55 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 08:31:55.604910 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:31:55.604910 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 08:31:55.609977 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:31:55.611980 (Thread-1): finished collecting timing info
2021-10-08 08:31:55.628712 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:31:55.628712 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 08:31:55.628712 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:31:57.024320 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-10-08 08:31:57.037482 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:31:57.038594 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 08:31:57.224349 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 08:31:57.226447 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:31:57.226447 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:31:57.395898 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:31:57.397090 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:31:57.398150 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:31:57.564754 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:31:57.587643 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:31:57.596076 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:31:57.596076 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 08:31:57.791183 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 08:31:57.791183 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:31:57.791183 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 08:31:58.165127 (Thread-1): SQL status: SUCCESS 0 in 0.37 seconds
2021-10-08 08:31:58.166120 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:31:58.167040 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:31:58.167040 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:31:58.451653 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-08 08:31:58.453154 (Thread-1): finished collecting timing info
2021-10-08 08:31:58.453154 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 08:31:58.770859 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad29371a-5570-468e-9eaf-d469aadffdae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547CD7D910>]}
2021-10-08 08:31:58.771857 (Thread-1): 10:31:58 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.17s]
2021-10-08 08:31:58.771857 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:31:58.771857 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:31:58.772840 (Thread-1): 10:31:58 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 08:31:58.772840 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:31:58.772840 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:31:58.774035 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:31:58.778254 (Thread-1): finished collecting timing info
2021-10-08 08:31:58.780278 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:31:58.785254 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:31:58.785254 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 08:31:58.786293 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:31:59.780473 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-10-08 08:31:59.780473 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:31:59.780473 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 08:32:01.249856 (Thread-1): SQL status: SUCCESS 1 in 1.47 seconds
2021-10-08 08:32:01.250880 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:32:01.251948 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:32:01.251948 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:32:01.422544 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:32:01.424789 (Thread-1): finished collecting timing info
2021-10-08 08:32:01.424789 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 08:32:01.723529 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad29371a-5570-468e-9eaf-d469aadffdae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547E6F8910>]}
2021-10-08 08:32:01.724529 (Thread-1): 10:32:01 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.95s]
2021-10-08 08:32:01.726417 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:32:01.726417 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 08:32:01.726417 (Thread-1): 10:32:01 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 08:32:01.727415 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:32:01.727415 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 08:32:01.729494 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:32:01.731231 (Thread-1): finished collecting timing info
2021-10-08 08:32:01.733250 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:32:01.733250 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 08:32:01.733250 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:32:03.169240 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-10-08 08:32:03.173641 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:32:03.174148 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 08:32:03.353451 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:32:03.357525 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:32:03.358538 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:32:03.566000 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-08 08:32:03.570985 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:32:03.570985 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:32:03.804262 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-08 08:32:03.808611 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:32:03.811582 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:32:03.811582 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 08:32:04.053436 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-08 08:32:04.053436 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:32:04.053436 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 08:32:04.370637 (Thread-1): SQL status: SUCCESS 0 in 0.32 seconds
2021-10-08 08:32:04.371677 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:32:04.371677 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:32:04.372691 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:32:04.625819 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 08:32:04.625819 (Thread-1): finished collecting timing info
2021-10-08 08:32:04.625819 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 08:32:04.950586 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad29371a-5570-468e-9eaf-d469aadffdae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547E5B7FA0>]}
2021-10-08 08:32:04.950586 (Thread-1): 10:32:04 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.22s]
2021-10-08 08:32:04.951585 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 08:32:04.951585 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:32:04.952586 (Thread-1): 10:32:04 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 08:32:04.952586 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:32:04.952586 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:32:04.956590 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 08:32:04.963671 (Thread-1): finished collecting timing info
2021-10-08 08:32:04.965964 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 08:32:04.971012 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:32:04.971012 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 08:32:04.971012 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:32:05.912903 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-10-08 08:32:05.912903 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:32:05.912903 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
where id = 1
      );
2021-10-08 08:32:06.985751 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-10-08 08:32:06.987841 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 08:32:06.988850 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:32:06.988850 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 08:32:07.153524 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:32:07.153524 (Thread-1): finished collecting timing info
2021-10-08 08:32:07.154526 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 08:32:07.460209 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad29371a-5570-468e-9eaf-d469aadffdae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547E2A3D90>]}
2021-10-08 08:32:07.461210 (Thread-1): 10:32:07 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.51s]
2021-10-08 08:32:07.462111 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:32:07.463160 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:32:07.463160 (MainThread): Using snowflake connection "master".
2021-10-08 08:32:07.463160 (MainThread): On master: BEGIN
2021-10-08 08:32:07.463160 (MainThread): Opening a new connection, currently in state closed
2021-10-08 08:32:08.766914 (MainThread): SQL status: SUCCESS 1 in 1.30 seconds
2021-10-08 08:32:08.767212 (MainThread): On master: COMMIT
2021-10-08 08:32:08.767212 (MainThread): Using snowflake connection "master".
2021-10-08 08:32:08.767212 (MainThread): On master: COMMIT
2021-10-08 08:32:09.306613 (MainThread): SQL status: SUCCESS 1 in 0.54 seconds
2021-10-08 08:32:09.306613 (MainThread): On master: Close
2021-10-08 08:32:09.847022 (MainThread): 10:32:09 | 
2021-10-08 08:32:09.847022 (MainThread): 10:32:09 | Finished running 4 table models, 2 incremental models in 23.77s.
2021-10-08 08:32:09.849135 (MainThread): Connection 'master' was properly closed.
2021-10-08 08:32:09.849135 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 08:32:09.849135 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 08:32:09.849135 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 08:32:09.863736 (MainThread): 
2021-10-08 08:32:09.864752 (MainThread): Completed successfully
2021-10-08 08:32:09.864936 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-08 08:32:09.866233 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547E2A3D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547E406CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547E677880>]}
2021-10-08 08:32:09.867234 (MainThread): Flushing usage events
2021-10-08 08:35:22.683082 (MainThread): Running with dbt=0.20.2
2021-10-08 08:35:23.284824 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 08:35:23.285396 (MainThread): Tracking: tracking
2021-10-08 08:35:23.285542 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCAB7DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCC09ABB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCC09A760>]}
2021-10-08 08:35:23.294617 (MainThread): Partial parsing not enabled
2021-10-08 08:35:23.310293 (MainThread): Parsing macros\adapters.sql
2021-10-08 08:35:23.330121 (MainThread): Parsing macros\catalog.sql
2021-10-08 08:35:23.332121 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 08:35:23.338634 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 08:35:23.340633 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 08:35:23.343633 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 08:35:23.344635 (MainThread): Parsing macros\core.sql
2021-10-08 08:35:23.346632 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 08:35:23.380793 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 08:35:23.388035 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 08:35:23.389032 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 08:35:23.390031 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 08:35:23.391015 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 08:35:23.393029 (MainThread): Parsing macros\etc\query.sql
2021-10-08 08:35:23.393029 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 08:35:23.402232 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 08:35:23.407225 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 08:35:23.417377 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 08:35:23.419393 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 08:35:23.424378 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 08:35:23.440432 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 08:35:23.459685 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 08:35:23.460766 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 08:35:23.471685 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 08:35:23.475918 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 08:35:23.478915 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 08:35:23.484915 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 08:35:23.485916 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 08:35:23.486915 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 08:35:23.488638 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 08:35:23.621590 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:35:23.628733 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:35:23.635013 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:35:23.638045 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:35:23.639046 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:35:23.641064 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:35:23.643063 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:35:23.668941 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:35:23.670924 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:35:23.672942 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:35:23.673945 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:35:23.674941 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:35:23.713329 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:35:23.716795 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:35:23.735155 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01bf1a23-715b-4883-9fb3-73bd558689a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCC0ECC10>]}
2021-10-08 08:35:23.759273 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 08:35:23.759273 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01bf1a23-715b-4883-9fb3-73bd558689a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCC107CD0>]}
2021-10-08 08:35:23.760273 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 08:35:23.761275 (MainThread): 
2021-10-08 08:35:23.763276 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:35:23.765274 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 08:35:23.777261 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 08:35:23.777261 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 08:35:23.777261 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 08:35:25.594869 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.82 seconds
2021-10-08 08:35:25.599869 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 08:35:25.909468 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 08:35:25.915059 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 08:35:25.915188 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 08:35:25.915188 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 08:35:26.918825 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.00 seconds
2021-10-08 08:35:26.919858 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 08:35:27.224062 (MainThread): Using snowflake connection "master".
2021-10-08 08:35:27.224387 (MainThread): On master: BEGIN
2021-10-08 08:35:27.224387 (MainThread): Opening a new connection, currently in state init
2021-10-08 08:35:28.010169 (MainThread): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 08:35:28.010169 (MainThread): On master: COMMIT
2021-10-08 08:35:28.010169 (MainThread): Using snowflake connection "master".
2021-10-08 08:35:28.010169 (MainThread): On master: COMMIT
2021-10-08 08:35:28.255291 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 08:35:28.255291 (MainThread): On master: Close
2021-10-08 08:35:28.551943 (MainThread): 10:35:28 | Concurrency: 1 threads (target='dev')
2021-10-08 08:35:28.552698 (MainThread): 10:35:28 | 
2021-10-08 08:35:28.555291 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:35:28.555291 (Thread-1): 10:35:28 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 08:35:28.556290 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:35:28.556290 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:35:28.558309 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 08:35:28.563292 (Thread-1): finished collecting timing info
2021-10-08 08:35:28.585755 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 08:35:28.588683 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:35:28.588683 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 08:35:28.588683 (Thread-1): Opening a new connection, currently in state init
2021-10-08 08:35:29.523793 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-10-08 08:35:29.523793 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:35:29.523793 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 08:35:30.595739 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-10-08 08:35:30.596740 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 08:35:30.596740 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:35:30.596740 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 08:35:30.758013 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:35:30.764019 (Thread-1): finished collecting timing info
2021-10-08 08:35:30.765020 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 08:35:31.056625 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01bf1a23-715b-4883-9fb3-73bd558689a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCC3CDA00>]}
2021-10-08 08:35:31.056625 (Thread-1): 10:35:31 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.50s]
2021-10-08 08:35:31.058655 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:35:31.058655 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:35:31.058655 (Thread-1): 10:35:31 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 08:35:31.058655 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:35:31.058655 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:35:31.059626 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:35:31.064973 (Thread-1): finished collecting timing info
2021-10-08 08:35:31.067826 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:35:31.070011 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:35:31.070011 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 08:35:31.070011 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:35:31.856401 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 08:35:31.856401 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:35:31.856401 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 08:35:33.291352 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2021-10-08 08:35:33.293349 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:35:33.294351 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:35:33.294351 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:35:33.469373 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:35:33.470368 (Thread-1): finished collecting timing info
2021-10-08 08:35:33.470368 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 08:35:33.768115 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01bf1a23-715b-4883-9fb3-73bd558689a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCC4D2520>]}
2021-10-08 08:35:33.769120 (Thread-1): 10:35:33 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.71s]
2021-10-08 08:35:33.770533 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:35:33.770533 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:35:33.771560 (Thread-1): 10:35:33 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 08:35:33.772560 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:35:33.772560 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 08:35:33.780677 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:35:33.783767 (Thread-1): finished collecting timing info
2021-10-08 08:35:33.803104 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:35:33.803253 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 08:35:33.803317 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:35:35.117960 (Thread-1): SQL status: SUCCESS 1 in 1.31 seconds
2021-10-08 08:35:35.124439 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:35:35.124961 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 08:35:35.308803 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:35:35.311907 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:35:35.311907 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:35:35.473460 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:35:35.476178 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:35:35.476178 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:35:35.640456 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:35:35.660125 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:35:35.662053 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:35:35.662053 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 08:35:35.875824 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-08 08:35:35.876386 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:35:35.876837 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 08:35:36.249440 (Thread-1): SQL status: SUCCESS 0 in 0.37 seconds
2021-10-08 08:35:36.252484 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:35:36.253484 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:35:36.253484 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:35:36.535724 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-08 08:35:36.536703 (Thread-1): finished collecting timing info
2021-10-08 08:35:36.536703 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 08:35:36.857596 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01bf1a23-715b-4883-9fb3-73bd558689a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCC473490>]}
2021-10-08 08:35:36.858599 (Thread-1): 10:35:36 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.09s]
2021-10-08 08:35:36.859603 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:35:36.859603 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:35:36.860597 (Thread-1): 10:35:36 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 08:35:36.861602 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:35:36.861602 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:35:36.864605 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:35:36.874099 (Thread-1): finished collecting timing info
2021-10-08 08:35:36.877092 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:35:36.882501 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:35:36.882501 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 08:35:36.882501 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:35:37.875642 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-10-08 08:35:37.876642 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:35:37.876642 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 08:35:39.232604 (Thread-1): SQL status: SUCCESS 1 in 1.36 seconds
2021-10-08 08:35:39.232604 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:35:39.233736 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:35:39.233736 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:35:39.400657 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:35:39.401679 (Thread-1): finished collecting timing info
2021-10-08 08:35:39.401679 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 08:35:39.695466 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01bf1a23-715b-4883-9fb3-73bd558689a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCC4CAFA0>]}
2021-10-08 08:35:39.695700 (Thread-1): 10:35:39 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.83s]
2021-10-08 08:35:39.696016 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:35:39.696016 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 08:35:39.696518 (Thread-1): 10:35:39 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 08:35:39.697017 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:35:39.697017 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 08:35:39.700181 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:35:39.701683 (Thread-1): finished collecting timing info
2021-10-08 08:35:39.703953 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:35:39.704061 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 08:35:39.704061 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:35:41.105751 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-10-08 08:35:41.107982 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:35:41.107982 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 08:35:41.276135 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:35:41.279551 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:35:41.279551 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:35:41.463104 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:35:41.465013 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:35:41.465013 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:35:41.625531 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:35:41.626542 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:35:41.628543 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:35:41.628543 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 08:35:41.805941 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:35:41.805941 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:35:41.805941 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 08:35:42.211736 (Thread-1): SQL status: SUCCESS 0 in 0.41 seconds
2021-10-08 08:35:42.214041 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:35:42.214629 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:35:42.214629 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:35:42.489669 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-08 08:35:42.490697 (Thread-1): finished collecting timing info
2021-10-08 08:35:42.490697 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 08:35:42.831352 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01bf1a23-715b-4883-9fb3-73bd558689a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCC162DF0>]}
2021-10-08 08:35:42.832360 (Thread-1): 10:35:42 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.13s]
2021-10-08 08:35:42.833361 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 08:35:42.834378 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:35:42.834378 (Thread-1): 10:35:42 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 08:35:42.836362 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:35:42.836362 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:35:42.838381 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 08:35:42.840378 (Thread-1): finished collecting timing info
2021-10-08 08:35:42.841443 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 08:35:42.843675 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:35:42.843675 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 08:35:42.843675 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:35:43.617590 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-08 08:35:43.617754 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:35:43.617810 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
where id = 1
      );
2021-10-08 08:35:45.567427 (Thread-1): SQL status: SUCCESS 1 in 1.95 seconds
2021-10-08 08:35:45.569472 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 08:35:45.570469 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:35:45.570469 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 08:35:45.738517 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:35:45.740555 (Thread-1): finished collecting timing info
2021-10-08 08:35:45.740555 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 08:35:46.039856 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01bf1a23-715b-4883-9fb3-73bd558689a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCC509400>]}
2021-10-08 08:35:46.039856 (Thread-1): 10:35:46 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 3.20s]
2021-10-08 08:35:46.041979 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:35:46.043986 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:35:46.043986 (MainThread): Using snowflake connection "master".
2021-10-08 08:35:46.043986 (MainThread): On master: BEGIN
2021-10-08 08:35:46.043986 (MainThread): Opening a new connection, currently in state closed
2021-10-08 08:35:46.849523 (MainThread): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-08 08:35:46.849523 (MainThread): On master: COMMIT
2021-10-08 08:35:46.849523 (MainThread): Using snowflake connection "master".
2021-10-08 08:35:46.849523 (MainThread): On master: COMMIT
2021-10-08 08:35:47.148515 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-10-08 08:35:47.148515 (MainThread): On master: Close
2021-10-08 08:35:47.457468 (MainThread): 10:35:47 | 
2021-10-08 08:35:47.457468 (MainThread): 10:35:47 | Finished running 4 table models, 2 incremental models in 23.69s.
2021-10-08 08:35:47.460465 (MainThread): Connection 'master' was properly closed.
2021-10-08 08:35:47.460465 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 08:35:47.460465 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 08:35:47.460465 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 08:35:47.479414 (MainThread): 
2021-10-08 08:35:47.479414 (MainThread): Completed successfully
2021-10-08 08:35:47.482410 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-08 08:35:47.483416 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCC09D130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCC465F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCACBB2E0>]}
2021-10-08 08:35:47.483416 (MainThread): Flushing usage events
2021-10-08 08:39:09.845109 (MainThread): Running with dbt=0.20.2
2021-10-08 08:39:10.451359 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-10-08 08:39:10.452363 (MainThread): Tracking: tracking
2021-10-08 08:39:10.452363 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D2EF2CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D3045A3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D3045A880>]}
2021-10-08 08:39:10.459344 (MainThread): Partial parsing not enabled
2021-10-08 08:39:10.473229 (MainThread): Parsing macros\adapters.sql
2021-10-08 08:39:10.491250 (MainThread): Parsing macros\catalog.sql
2021-10-08 08:39:10.492252 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 08:39:10.498831 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 08:39:10.500831 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 08:39:10.503830 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 08:39:10.503830 (MainThread): Parsing macros\core.sql
2021-10-08 08:39:10.506831 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 08:39:10.539214 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 08:39:10.546841 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 08:39:10.547836 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 08:39:10.548840 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 08:39:10.549843 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 08:39:10.550858 (MainThread): Parsing macros\etc\query.sql
2021-10-08 08:39:10.551859 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 08:39:10.558522 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 08:39:10.563021 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 08:39:10.573708 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 08:39:10.574710 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 08:39:10.579708 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 08:39:10.594812 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 08:39:10.614241 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 08:39:10.616242 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 08:39:10.628398 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 08:39:10.633399 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 08:39:10.636692 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 08:39:10.641690 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 08:39:10.642696 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 08:39:10.643686 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 08:39:10.644697 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 08:39:10.767997 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:39:10.774084 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:39:10.785470 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:39:10.787470 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:39:10.788461 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:39:10.790779 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:39:10.791919 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:39:10.814904 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:39:10.816910 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:39:10.817886 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:39:10.818916 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:39:10.820904 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:39:10.854205 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:39:10.857222 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:39:10.876575 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a3c4260-6468-4022-a4a1-8a085f5d8a50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D30568490>]}
2021-10-08 08:39:10.917644 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 08:39:10.918661 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a3c4260-6468-4022-a4a1-8a085f5d8a50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D30568BE0>]}
2021-10-08 08:39:10.918661 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 08:39:10.920258 (MainThread): 
2021-10-08 08:39:10.921238 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:39:10.923148 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 08:39:10.935034 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 08:39:10.935034 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 08:39:10.935034 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 08:39:12.906008 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.97 seconds
2021-10-08 08:39:12.912347 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 08:39:13.207311 (MainThread): 10:39:13 | Concurrency: 1 threads (target='dev')
2021-10-08 08:39:13.208307 (MainThread): 10:39:13 | 
2021-10-08 08:39:13.214459 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_cul_order_price_cul_daily_amount.6c576ebf4f
2021-10-08 08:39:13.214459 (Thread-1): 10:39:13 | 1 of 7 START test not_cul_order_price_cul_daily_amount............... [RUN]
2021-10-08 08:39:13.215461 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_cul_order_price_cul_daily_amount.6c576ebf4f".
2021-10-08 08:39:13.215461 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_cul_order_price_cul_daily_amount.6c576ebf4f
2021-10-08 08:39:13.219545 (Thread-1): finished collecting timing info
2021-10-08 08:39:13.220539 (Thread-1): Compilation Error in test not_cul_order_price_cul_daily_amount (models\example\schema.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 517, in catch_jinja
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'test_not' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 464, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 371, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 522, in catch_jinja
    raise UndefinedMacroException(str(e), node) from e
dbt.exceptions.UndefinedMacroException: Compilation Error in test not_cul_order_price_cul_daily_amount (models\example\schema.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-08 08:39:13.229076 (Thread-1): 10:39:13 | 1 of 7 ERROR not_cul_order_price_cul_daily_amount.................... [ERROR in 0.01s]
2021-10-08 08:39:13.229995 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_cul_order_price_cul_daily_amount.6c576ebf4f
2021-10-08 08:39:13.229995 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 08:39:13.229995 (Thread-1): 10:39:13 | 2 of 7 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-10-08 08:39:13.230996 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 08:39:13.230996 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 08:39:13.235075 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 08:39:13.241996 (Thread-1): finished collecting timing info
2021-10-08 08:39:13.252079 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 08:39:13.259366 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 08:39:13.259366 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: BEGIN
2021-10-08 08:39:13.259366 (Thread-1): Opening a new connection, currently in state init
2021-10-08 08:39:14.216871 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-10-08 08:39:14.217869 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 08:39:14.217869 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.first_model
where id is null



      
    ) dbt_internal_test
2021-10-08 08:39:14.502966 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-08 08:39:14.506997 (Thread-1): finished collecting timing info
2021-10-08 08:39:14.507996 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: ROLLBACK
2021-10-08 08:39:14.810230 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: Close
2021-10-08 08:39:15.107841 (Thread-1): 10:39:15 | 2 of 7 FAIL 1 not_null_my_first_dbt_model_id......................... [FAIL 1 in 1.88s]
2021-10-08 08:39:15.108755 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 08:39:15.108755 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 08:39:15.108755 (Thread-1): 10:39:15 | 3 of 7 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-10-08 08:39:15.109754 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 08:39:15.109754 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 08:39:15.112960 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 08:39:15.119505 (Thread-1): finished collecting timing info
2021-10-08 08:39:15.121583 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 08:39:15.128687 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 08:39:15.128687 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: BEGIN
2021-10-08 08:39:15.128687 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:39:15.909191 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 08:39:15.910570 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 08:39:15.910570 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
2021-10-08 08:39:16.283990 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-10-08 08:39:16.283990 (Thread-1): finished collecting timing info
2021-10-08 08:39:16.283990 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: ROLLBACK
2021-10-08 08:39:16.606520 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-10-08 08:39:16.916649 (Thread-1): 10:39:16 | 3 of 7 PASS not_null_my_second_dbt_model_id.......................... [PASS in 1.81s]
2021-10-08 08:39:16.917415 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 08:39:16.917509 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_snowflake_customer_purchases_c_custkey.f25eb372f5
2021-10-08 08:39:16.917737 (Thread-1): 10:39:16 | 4 of 7 START test not_snowflake_customer_purchases_c_custkey......... [RUN]
2021-10-08 08:39:16.918206 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_snowflake_customer_purchases_c_custkey.f25eb372f5".
2021-10-08 08:39:16.918301 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_snowflake_customer_purchases_c_custkey.f25eb372f5
2021-10-08 08:39:16.920529 (Thread-1): finished collecting timing info
2021-10-08 08:39:16.920529 (Thread-1): Compilation Error in test not_snowflake_customer_purchases_c_custkey (models\example\schema.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 517, in catch_jinja
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'test_not' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 464, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 371, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 522, in catch_jinja
    raise UndefinedMacroException(str(e), node) from e
dbt.exceptions.UndefinedMacroException: Compilation Error in test not_snowflake_customer_purchases_c_custkey (models\example\schema.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-08 08:39:16.921545 (Thread-1): 10:39:16 | 4 of 7 ERROR not_snowflake_customer_purchases_c_custkey.............. [ERROR in 0.00s]
2021-10-08 08:39:16.921545 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_snowflake_customer_purchases_c_custkey.f25eb372f5
2021-10-08 08:39:16.921545 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 08:39:16.921545 (Thread-1): 10:39:16 | 5 of 7 START test unique_my_first_dbt_model_id....................... [RUN]
2021-10-08 08:39:16.921545 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 08:39:16.921545 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 08:39:16.927553 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 08:39:16.932552 (Thread-1): finished collecting timing info
2021-10-08 08:39:16.934701 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 08:39:16.939698 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 08:39:16.939698 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: BEGIN
2021-10-08 08:39:16.939698 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:39:17.874727 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-10-08 08:39:17.874727 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 08:39:17.875723 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.first_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 08:39:18.431098 (Thread-1): SQL status: SUCCESS 1 in 0.56 seconds
2021-10-08 08:39:18.431098 (Thread-1): finished collecting timing info
2021-10-08 08:39:18.431098 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: ROLLBACK
2021-10-08 08:39:18.704986 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-08 08:39:19.064179 (Thread-1): 10:39:19 | 5 of 7 PASS unique_my_first_dbt_model_id............................. [PASS in 2.14s]
2021-10-08 08:39:19.065868 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 08:39:19.065868 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 08:39:19.066925 (Thread-1): 10:39:19 | 6 of 7 START test unique_my_second_dbt_model_id...................... [RUN]
2021-10-08 08:39:19.066925 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 08:39:19.066925 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 08:39:19.070557 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 08:39:19.076346 (Thread-1): finished collecting timing info
2021-10-08 08:39:19.077428 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 08:39:19.083439 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 08:39:19.083439 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: BEGIN
2021-10-08 08:39:19.083439 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:39:19.880614 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-08 08:39:19.880614 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 08:39:19.880614 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 08:39:20.314906 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-10-08 08:39:20.315903 (Thread-1): finished collecting timing info
2021-10-08 08:39:20.315903 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: ROLLBACK
2021-10-08 08:39:20.560117 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: Close
2021-10-08 08:39:20.847971 (Thread-1): 10:39:20 | 6 of 7 PASS unique_my_second_dbt_model_id............................ [PASS in 1.78s]
2021-10-08 08:39:20.849057 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 08:39:20.849057 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 08:39:20.849607 (Thread-1): 10:39:20 | 7 of 7 START test unique_snowflake_customer_purchases_c_custkey...... [RUN]
2021-10-08 08:39:20.849975 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 08:39:20.850130 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 08:39:20.853041 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 08:39:20.858583 (Thread-1): finished collecting timing info
2021-10-08 08:39:20.859586 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 08:39:20.864583 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 08:39:20.864583 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: BEGIN
2021-10-08 08:39:20.864583 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:39:21.655528 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 08:39:21.655528 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 08:39:21.655528 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.snowflake_customer_purchases
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 08:39:22.093145 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-10-08 08:39:22.093145 (Thread-1): finished collecting timing info
2021-10-08 08:39:22.093145 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: ROLLBACK
2021-10-08 08:39:22.374290 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: Close
2021-10-08 08:39:22.668331 (Thread-1): 10:39:22 | 7 of 7 PASS unique_snowflake_customer_purchases_c_custkey............ [PASS in 1.82s]
2021-10-08 08:39:22.669252 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 08:39:22.670251 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:39:22.671330 (MainThread): 10:39:22 | 
2021-10-08 08:39:22.671330 (MainThread): 10:39:22 | Finished running 7 tests in 11.75s.
2021-10-08 08:39:22.671330 (MainThread): Connection 'master' was properly closed.
2021-10-08 08:39:22.672248 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 08:39:22.672248 (MainThread): Connection 'test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8' was properly closed.
2021-10-08 08:39:22.688999 (MainThread): 
2021-10-08 08:39:22.688999 (MainThread): Completed with 3 errors and 0 warnings:
2021-10-08 08:39:22.689990 (MainThread): 
2021-10-08 08:39:22.691093 (MainThread): Compilation Error in test not_cul_order_price_cul_daily_amount (models\example\schema.yml)
2021-10-08 08:39:22.691093 (MainThread):   'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-08 08:39:22.691093 (MainThread): 
2021-10-08 08:39:22.694111 (MainThread): Failure in test not_null_my_first_dbt_model_id (models\example\schema.yml)
2021-10-08 08:39:22.695287 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-08 08:39:22.696285 (MainThread): 
2021-10-08 08:39:22.697286 (MainThread):   compiled SQL at target\compiled\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\not_null_my_first_dbt_model_id.sql
2021-10-08 08:39:22.697286 (MainThread): 
2021-10-08 08:39:22.697286 (MainThread): Compilation Error in test not_snowflake_customer_purchases_c_custkey (models\example\schema.yml)
2021-10-08 08:39:22.698288 (MainThread):   'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-08 08:39:22.698288 (MainThread): 
Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
2021-10-08 08:39:22.698288 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D305DC130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D305DC370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D305DCE80>]}
2021-10-08 08:39:22.698288 (MainThread): Flushing usage events
2021-10-08 08:42:20.215631 (MainThread): Running with dbt=0.20.2
2021-10-08 08:42:20.814487 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 08:42:20.815487 (MainThread): Tracking: tracking
2021-10-08 08:42:20.815487 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A38B9CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A3A0BA8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A3A0BA760>]}
2021-10-08 08:42:20.823114 (MainThread): Partial parsing not enabled
2021-10-08 08:42:20.836670 (MainThread): Parsing macros\adapters.sql
2021-10-08 08:42:20.854255 (MainThread): Parsing macros\catalog.sql
2021-10-08 08:42:20.855330 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 08:42:20.861326 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 08:42:20.862334 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 08:42:20.864638 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 08:42:20.864638 (MainThread): Parsing macros\core.sql
2021-10-08 08:42:20.867615 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 08:42:20.898224 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 08:42:20.904206 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 08:42:20.904206 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 08:42:20.905120 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 08:42:20.907203 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 08:42:20.908209 (MainThread): Parsing macros\etc\query.sql
2021-10-08 08:42:20.908209 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 08:42:20.915692 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 08:42:20.919678 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 08:42:20.929981 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 08:42:20.930954 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 08:42:20.936960 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 08:42:20.952452 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 08:42:20.970939 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 08:42:20.971629 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 08:42:20.981726 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 08:42:20.985725 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 08:42:20.989000 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 08:42:20.994313 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 08:42:20.995801 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 08:42:20.996561 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 08:42:20.997592 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 08:42:21.100690 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:42:21.105692 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:42:21.110218 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:42:21.112317 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:42:21.129728 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:42:21.132721 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '18032c6a-a5bd-46ad-9b87-e8c6dd6f262a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A3A134F70>]}
2021-10-08 08:42:21.133720 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:42:21.134807 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:42:21.158496 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:42:21.160515 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:42:21.163504 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:42:21.212180 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18032c6a-a5bd-46ad-9b87-e8c6dd6f262a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A3A1CE760>]}
2021-10-08 08:42:21.229609 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 08:42:21.230614 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18032c6a-a5bd-46ad-9b87-e8c6dd6f262a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A3A1CEA90>]}
2021-10-08 08:42:21.230614 (MainThread): Found 6 models, 3 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 08:42:21.231625 (MainThread): 
2021-10-08 08:42:21.231625 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:42:21.233529 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 08:42:21.241908 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 08:42:21.242922 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 08:42:21.242922 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 08:42:22.630528 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.39 seconds
2021-10-08 08:42:22.633840 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 08:42:22.947109 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 08:42:22.954183 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 08:42:22.954183 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 08:42:22.954183 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 08:42:23.974479 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.02 seconds
2021-10-08 08:42:23.975477 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 08:42:24.275257 (MainThread): Using snowflake connection "master".
2021-10-08 08:42:24.276211 (MainThread): On master: BEGIN
2021-10-08 08:42:24.276211 (MainThread): Opening a new connection, currently in state init
2021-10-08 08:42:25.122928 (MainThread): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-08 08:42:25.122928 (MainThread): On master: COMMIT
2021-10-08 08:42:25.123924 (MainThread): Using snowflake connection "master".
2021-10-08 08:42:25.123924 (MainThread): On master: COMMIT
2021-10-08 08:42:25.525534 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-10-08 08:42:25.525534 (MainThread): On master: Close
2021-10-08 08:42:25.834758 (MainThread): 10:42:25 | Concurrency: 1 threads (target='dev')
2021-10-08 08:42:25.834758 (MainThread): 10:42:25 | 
2021-10-08 08:42:25.838131 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:42:25.838131 (Thread-1): 10:42:25 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 08:42:25.838131 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:42:25.838131 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:42:25.840131 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 08:42:25.841131 (Thread-1): finished collecting timing info
2021-10-08 08:42:25.860230 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 08:42:25.867612 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:42:25.867612 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 08:42:25.867612 (Thread-1): Opening a new connection, currently in state init
2021-10-08 08:42:26.671959 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-08 08:42:26.671959 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:42:26.671959 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 08:42:27.704907 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-10-08 08:42:27.705918 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 08:42:27.706943 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:42:27.706943 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 08:42:27.877410 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:42:27.887868 (Thread-1): finished collecting timing info
2021-10-08 08:42:27.887868 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 08:42:28.173974 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18032c6a-a5bd-46ad-9b87-e8c6dd6f262a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A3A4D2C10>]}
2021-10-08 08:42:28.174978 (Thread-1): 10:42:28 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.34s]
2021-10-08 08:42:28.177724 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:42:28.177724 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:42:28.177724 (Thread-1): 10:42:28 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 08:42:28.179754 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:42:28.179754 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:42:28.180829 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:42:28.185751 (Thread-1): finished collecting timing info
2021-10-08 08:42:28.187750 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:42:28.188786 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:42:28.188786 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 08:42:28.188786 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:42:28.944400 (Thread-1): SQL status: SUCCESS 1 in 0.76 seconds
2021-10-08 08:42:28.944400 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:42:28.944400 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 08:42:30.348246 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-10-08 08:42:30.350245 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:42:30.350245 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:42:30.350245 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:42:30.517906 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:42:30.519903 (Thread-1): finished collecting timing info
2021-10-08 08:42:30.519903 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 08:42:30.841931 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18032c6a-a5bd-46ad-9b87-e8c6dd6f262a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A3A471F70>]}
2021-10-08 08:42:30.842933 (Thread-1): 10:42:30 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.66s]
2021-10-08 08:42:30.844467 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:42:30.844467 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:42:30.844467 (Thread-1): 10:42:30 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 08:42:30.845465 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:42:30.845465 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 08:42:30.851070 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:42:30.855068 (Thread-1): finished collecting timing info
2021-10-08 08:42:30.869623 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:42:30.869801 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 08:42:30.869801 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:42:32.127466 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-10-08 08:42:32.135525 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:42:32.135525 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 08:42:32.315165 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:42:32.318157 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:42:32.318157 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:42:32.482788 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:42:32.486785 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:42:32.486785 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:42:32.645147 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:42:32.654516 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:42:32.656420 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:42:32.656420 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 08:42:32.841594 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 08:42:32.841594 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:42:32.841594 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 08:42:33.233687 (Thread-1): SQL status: SUCCESS 0 in 0.39 seconds
2021-10-08 08:42:33.235666 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:42:33.235666 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:42:33.235666 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:42:33.522103 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-08 08:42:33.523105 (Thread-1): finished collecting timing info
2021-10-08 08:42:33.523105 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 08:42:33.822696 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18032c6a-a5bd-46ad-9b87-e8c6dd6f262a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A3A37A5B0>]}
2021-10-08 08:42:33.822696 (Thread-1): 10:42:33 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 2.98s]
2021-10-08 08:42:33.823698 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:42:33.823698 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:42:33.824694 (Thread-1): 10:42:33 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 08:42:33.824694 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:42:33.825193 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:42:33.827207 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:42:33.831289 (Thread-1): finished collecting timing info
2021-10-08 08:42:33.834379 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:42:33.836319 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:42:33.836319 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 08:42:33.836319 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:42:34.817470 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-08 08:42:34.817692 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:42:34.817741 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 08:42:36.254871 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-10-08 08:42:36.257030 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:42:36.257030 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:42:36.257030 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:42:36.431266 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:42:36.432266 (Thread-1): finished collecting timing info
2021-10-08 08:42:36.432266 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 08:42:36.719184 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18032c6a-a5bd-46ad-9b87-e8c6dd6f262a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A3A1CF160>]}
2021-10-08 08:42:36.720184 (Thread-1): 10:42:36 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.89s]
2021-10-08 08:42:36.721182 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:42:36.721182 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 08:42:36.721182 (Thread-1): 10:42:36 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 08:42:36.721182 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:42:36.721182 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 08:42:36.723371 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:42:36.724413 (Thread-1): finished collecting timing info
2021-10-08 08:42:36.726371 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:42:36.726371 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 08:42:36.726371 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:42:38.025775 (Thread-1): SQL status: SUCCESS 1 in 1.30 seconds
2021-10-08 08:42:38.026772 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:42:38.026772 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 08:42:38.210271 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:42:38.213266 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:42:38.213266 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:42:38.388462 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:42:38.390448 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:42:38.390448 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:42:38.571546 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:42:38.574412 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:42:38.577542 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:42:38.577542 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 08:42:38.769744 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 08:42:38.769886 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:42:38.769959 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 08:42:39.204497 (Thread-1): SQL status: SUCCESS 0 in 0.43 seconds
2021-10-08 08:42:39.206779 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:42:39.206779 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:42:39.206779 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:42:39.461740 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 08:42:39.462748 (Thread-1): finished collecting timing info
2021-10-08 08:42:39.462748 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 08:42:39.783817 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18032c6a-a5bd-46ad-9b87-e8c6dd6f262a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A3A531820>]}
2021-10-08 08:42:39.784836 (Thread-1): 10:42:39 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.06s]
2021-10-08 08:42:39.786390 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 08:42:39.787407 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:42:39.787407 (Thread-1): 10:42:39 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 08:42:39.788407 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:42:39.788407 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:42:39.790405 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 08:42:39.792508 (Thread-1): finished collecting timing info
2021-10-08 08:42:39.794404 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 08:42:39.795402 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:42:39.795402 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 08:42:39.795402 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:42:40.616610 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 08:42:40.616610 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:42:40.616610 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
where id = 1
      );
2021-10-08 08:42:41.621562 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-08 08:42:41.623559 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 08:42:41.624553 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:42:41.624553 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 08:42:41.790595 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:42:41.791659 (Thread-1): finished collecting timing info
2021-10-08 08:42:41.791659 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 08:42:42.084861 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18032c6a-a5bd-46ad-9b87-e8c6dd6f262a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A3A467DF0>]}
2021-10-08 08:42:42.085848 (Thread-1): 10:42:42 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.30s]
2021-10-08 08:42:42.086769 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:42:42.087760 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:42:42.087760 (MainThread): Using snowflake connection "master".
2021-10-08 08:42:42.087760 (MainThread): On master: BEGIN
2021-10-08 08:42:42.088840 (MainThread): Opening a new connection, currently in state closed
2021-10-08 08:42:43.116445 (MainThread): SQL status: SUCCESS 1 in 1.03 seconds
2021-10-08 08:42:43.116445 (MainThread): On master: COMMIT
2021-10-08 08:42:43.116445 (MainThread): Using snowflake connection "master".
2021-10-08 08:42:43.116445 (MainThread): On master: COMMIT
2021-10-08 08:42:43.356694 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-08 08:42:43.356694 (MainThread): On master: Close
2021-10-08 08:42:43.651374 (MainThread): 10:42:43 | 
2021-10-08 08:42:43.652369 (MainThread): 10:42:43 | Finished running 4 table models, 2 incremental models in 22.42s.
2021-10-08 08:42:43.652369 (MainThread): Connection 'master' was properly closed.
2021-10-08 08:42:43.652369 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 08:42:43.652369 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 08:42:43.652369 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 08:42:43.665640 (MainThread): 
2021-10-08 08:42:43.665640 (MainThread): Completed successfully
2021-10-08 08:42:43.666702 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-08 08:42:43.666702 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A3A54B280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A3A52B070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A3A52B4F0>]}
2021-10-08 08:42:43.666702 (MainThread): Flushing usage events
2021-10-08 08:42:48.902975 (MainThread): Running with dbt=0.20.2
2021-10-08 08:42:49.494937 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-10-08 08:42:49.494937 (MainThread): Tracking: tracking
2021-10-08 08:42:49.494937 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCEC19CDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCED6D4280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCED6D4760>]}
2021-10-08 08:42:49.502875 (MainThread): Partial parsing not enabled
2021-10-08 08:42:49.514929 (MainThread): Parsing macros\adapters.sql
2021-10-08 08:42:49.534646 (MainThread): Parsing macros\catalog.sql
2021-10-08 08:42:49.536652 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 08:42:49.542843 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 08:42:49.545063 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 08:42:49.548091 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 08:42:49.549065 (MainThread): Parsing macros\core.sql
2021-10-08 08:42:49.551082 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 08:42:49.582336 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 08:42:49.588241 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 08:42:49.589321 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 08:42:49.590334 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 08:42:49.591323 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 08:42:49.592321 (MainThread): Parsing macros\etc\query.sql
2021-10-08 08:42:49.593287 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 08:42:49.600325 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 08:42:49.605148 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 08:42:49.614137 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 08:42:49.616147 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 08:42:49.621088 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 08:42:49.636296 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 08:42:49.662747 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 08:42:49.663876 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 08:42:49.676020 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 08:42:49.681106 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 08:42:49.684165 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 08:42:49.689201 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 08:42:49.690184 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 08:42:49.691184 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 08:42:49.692104 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 08:42:49.818674 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:42:49.824780 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:42:49.830774 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:42:49.832779 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:42:49.832779 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:42:49.835688 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:42:49.837689 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:42:49.865188 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:42:49.868188 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:42:49.872789 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:42:49.918302 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69738161-e671-4ce5-be4b-042fa9bd0f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCED7CF460>]}
2021-10-08 08:42:49.943428 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 08:42:49.943428 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69738161-e671-4ce5-be4b-042fa9bd0f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCED7CF880>]}
2021-10-08 08:42:49.944431 (MainThread): Found 6 models, 3 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 08:42:49.944649 (MainThread): 
2021-10-08 08:42:49.944649 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:42:49.946861 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 08:42:49.959081 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 08:42:49.959081 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 08:42:49.959081 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 08:42:51.081206 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.12 seconds
2021-10-08 08:42:51.088211 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 08:42:51.377083 (MainThread): 10:42:51 | Concurrency: 1 threads (target='dev')
2021-10-08 08:42:51.378020 (MainThread): 10:42:51 | 
2021-10-08 08:42:51.380023 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_cul_order_price_cul_daily_amount.6c576ebf4f
2021-10-08 08:42:51.380023 (Thread-1): 10:42:51 | 1 of 3 START test not_cul_order_price_cul_daily_amount............... [RUN]
2021-10-08 08:42:51.381021 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_cul_order_price_cul_daily_amount.6c576ebf4f".
2021-10-08 08:42:51.381021 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_cul_order_price_cul_daily_amount.6c576ebf4f
2021-10-08 08:42:51.385083 (Thread-1): finished collecting timing info
2021-10-08 08:42:51.386271 (Thread-1): Compilation Error in test not_cul_order_price_cul_daily_amount (models\example\schema.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 517, in catch_jinja
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'test_not' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 464, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 371, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 522, in catch_jinja
    raise UndefinedMacroException(str(e), node) from e
dbt.exceptions.UndefinedMacroException: Compilation Error in test not_cul_order_price_cul_daily_amount (models\example\schema.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-08 08:42:51.388702 (Thread-1): 10:42:51 | 1 of 3 ERROR not_cul_order_price_cul_daily_amount.................... [ERROR in 0.01s]
2021-10-08 08:42:51.389770 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_cul_order_price_cul_daily_amount.6c576ebf4f
2021-10-08 08:42:51.389770 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 08:42:51.389770 (Thread-1): 10:42:51 | 2 of 3 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-10-08 08:42:51.390777 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 08:42:51.390777 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 08:42:51.394776 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 08:42:51.400873 (Thread-1): finished collecting timing info
2021-10-08 08:42:51.417223 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 08:42:51.423261 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 08:42:51.423261 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: BEGIN
2021-10-08 08:42:51.423261 (Thread-1): Opening a new connection, currently in state init
2021-10-08 08:42:52.232536 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-08 08:42:52.232536 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 08:42:52.232536 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.first_model
where id is null



      
    ) dbt_internal_test
2021-10-08 08:42:52.629728 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-10-08 08:42:52.631727 (Thread-1): finished collecting timing info
2021-10-08 08:42:52.631727 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: ROLLBACK
2021-10-08 08:42:52.951675 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: Close
2021-10-08 08:42:53.264706 (Thread-1): 10:42:53 | 2 of 3 FAIL 1 not_null_my_first_dbt_model_id......................... [FAIL 1 in 1.87s]
2021-10-08 08:42:53.266167 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 08:42:53.266167 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 08:42:53.267177 (Thread-1): 10:42:53 | 3 of 3 START test unique_my_first_dbt_model_id....................... [RUN]
2021-10-08 08:42:53.267177 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 08:42:53.267177 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 08:42:53.273176 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 08:42:53.277950 (Thread-1): finished collecting timing info
2021-10-08 08:42:53.278669 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 08:42:53.283781 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 08:42:53.283781 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: BEGIN
2021-10-08 08:42:53.283781 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:42:54.350981 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-10-08 08:42:54.350981 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 08:42:54.350981 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.first_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 08:42:54.711390 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-08 08:42:54.712389 (Thread-1): finished collecting timing info
2021-10-08 08:42:54.712389 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: ROLLBACK
2021-10-08 08:42:54.965939 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-08 08:42:55.293674 (Thread-1): 10:42:55 | 3 of 3 PASS unique_my_first_dbt_model_id............................. [PASS in 2.03s]
2021-10-08 08:42:55.295632 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 08:42:55.297597 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:42:55.297597 (MainThread): 10:42:55 | 
2021-10-08 08:42:55.298673 (MainThread): 10:42:55 | Finished running 3 tests in 5.35s.
2021-10-08 08:42:55.298673 (MainThread): Connection 'master' was properly closed.
2021-10-08 08:42:55.299595 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 08:42:55.299595 (MainThread): Connection 'test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb' was properly closed.
2021-10-08 08:42:55.320703 (MainThread): 
2021-10-08 08:42:55.320703 (MainThread): Completed with 2 errors and 0 warnings:
2021-10-08 08:42:55.321704 (MainThread): 
2021-10-08 08:42:55.322701 (MainThread): Compilation Error in test not_cul_order_price_cul_daily_amount (models\example\schema.yml)
2021-10-08 08:42:55.323700 (MainThread):   'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-08 08:42:55.324156 (MainThread): 
2021-10-08 08:42:55.324350 (MainThread): Failure in test not_null_my_first_dbt_model_id (models\example\schema.yml)
2021-10-08 08:42:55.324994 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-08 08:42:55.324994 (MainThread): 
2021-10-08 08:42:55.324994 (MainThread):   compiled SQL at target\compiled\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\not_null_my_first_dbt_model_id.sql
2021-10-08 08:42:55.326000 (MainThread): 
Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
2021-10-08 08:42:55.326000 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCED841BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCED83DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCED83D280>]}
2021-10-08 08:42:55.326000 (MainThread): Flushing usage events
2021-10-08 08:43:51.220706 (MainThread): Running with dbt=0.20.2
2021-10-08 08:43:51.856584 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-10-08 08:43:51.856584 (MainThread): Tracking: tracking
2021-10-08 08:43:51.856584 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A870CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A9C3AB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A9C3A760>]}
2021-10-08 08:43:51.863637 (MainThread): Partial parsing not enabled
2021-10-08 08:43:51.880158 (MainThread): Parsing macros\adapters.sql
2021-10-08 08:43:51.900565 (MainThread): Parsing macros\catalog.sql
2021-10-08 08:43:51.901565 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 08:43:51.910116 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 08:43:51.911120 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 08:43:51.914116 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 08:43:51.915118 (MainThread): Parsing macros\core.sql
2021-10-08 08:43:51.917800 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 08:43:51.953870 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 08:43:51.960866 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 08:43:51.960866 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 08:43:51.961866 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 08:43:51.963888 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 08:43:51.964923 (MainThread): Parsing macros\etc\query.sql
2021-10-08 08:43:51.964923 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 08:43:51.972489 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 08:43:51.976489 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 08:43:51.987937 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 08:43:51.988927 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 08:43:51.994849 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 08:43:52.011728 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 08:43:52.037144 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 08:43:52.038142 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 08:43:52.051632 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 08:43:52.056630 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 08:43:52.060860 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 08:43:52.064861 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 08:43:52.066862 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 08:43:52.067863 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 08:43:52.068870 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 08:43:52.198408 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:43:52.205409 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:43:52.210410 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:43:52.213513 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:43:52.214015 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:43:52.216025 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:43:52.218025 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:43:52.245250 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:43:52.247302 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:43:52.249302 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:43:52.250303 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:43:52.251303 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:43:52.282980 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:43:52.283981 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:43:52.285980 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:43:52.302380 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2309869b-fdb5-4ec1-8669-478bbeab4f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A9D4E490>]}
2021-10-08 08:43:52.380609 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 08:43:52.381752 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2309869b-fdb5-4ec1-8669-478bbeab4f63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A9D4EA90>]}
2021-10-08 08:43:52.382295 (MainThread): Found 6 models, 8 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 08:43:52.383406 (MainThread): 
2021-10-08 08:43:52.384651 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:43:52.385872 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 08:43:52.397559 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 08:43:52.397559 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 08:43:52.397559 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 08:43:53.823358 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.43 seconds
2021-10-08 08:43:53.826449 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 08:43:54.116121 (MainThread): 10:43:54 | Concurrency: 1 threads (target='dev')
2021-10-08 08:43:54.116121 (MainThread): 10:43:54 | 
2021-10-08 08:43:54.120353 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f
2021-10-08 08:43:54.121363 (Thread-1): 10:43:54 | 1 of 8 START test not_null_cul_order_price_cul_daily_amount.......... [RUN]
2021-10-08 08:43:54.121363 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f".
2021-10-08 08:43:54.121363 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f
2021-10-08 08:43:54.127215 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f"
2021-10-08 08:43:54.128570 (Thread-1): finished collecting timing info
2021-10-08 08:43:54.140310 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f"
2021-10-08 08:43:54.141824 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f".
2021-10-08 08:43:54.141824 (Thread-1): On test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f: BEGIN
2021-10-08 08:43:54.141824 (Thread-1): Opening a new connection, currently in state init
2021-10-08 08:43:55.137203 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-08 08:43:55.137203 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f".
2021-10-08 08:43:55.137203 (Thread-1): On test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.cul_order_price
where cul_daily_amount is null



      
    ) dbt_internal_test
2021-10-08 08:43:55.432051 (Thread-1): Snowflake query id: 019f778a-0601-3832-0000-00664703b259
2021-10-08 08:43:55.432051 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 6
invalid identifier 'CUL_DAILY_AMOUNT'
2021-10-08 08:43:55.432051 (Thread-1): finished collecting timing info
2021-10-08 08:43:55.432051 (Thread-1): On test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f: ROLLBACK
2021-10-08 08:43:55.660121 (Thread-1): On test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f: Close
2021-10-08 08:43:55.949495 (Thread-1): Database Error in test not_null_cul_order_price_cul_daily_amount (models\example\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 6
  invalid identifier 'CUL_DAILY_AMOUNT'
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\not_null_cul_order_price_cul_daily_amount.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 12 at position 6
invalid identifier 'CUL_DAILY_AMOUNT'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\test.py", line 112, in execute
    result = self.execute_test(test, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\test.py", line 82, in execute_test
    macro_func()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 132, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test not_null_cul_order_price_cul_daily_amount (models\example\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 6
  invalid identifier 'CUL_DAILY_AMOUNT'
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\not_null_cul_order_price_cul_daily_amount.sql
2021-10-08 08:43:55.950494 (Thread-1): 10:43:55 | 1 of 8 ERROR not_null_cul_order_price_cul_daily_amount............... [ERROR in 1.83s]
2021-10-08 08:43:55.951496 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f
2021-10-08 08:43:55.951496 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 08:43:55.951496 (Thread-1): 10:43:55 | 2 of 8 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-10-08 08:43:55.952495 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 08:43:55.952495 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 08:43:55.955309 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 08:43:55.957347 (Thread-1): finished collecting timing info
2021-10-08 08:43:55.958345 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 08:43:55.960342 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 08:43:55.960342 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: BEGIN
2021-10-08 08:43:55.960342 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:43:56.755552 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 08:43:56.755552 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 08:43:56.755552 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.first_model
where id is null



      
    ) dbt_internal_test
2021-10-08 08:43:56.933680 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:43:56.933680 (Thread-1): finished collecting timing info
2021-10-08 08:43:56.934766 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: ROLLBACK
2021-10-08 08:43:57.182788 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: Close
2021-10-08 08:43:57.504655 (Thread-1): 10:43:57 | 2 of 8 FAIL 1 not_null_my_first_dbt_model_id......................... [FAIL 1 in 1.55s]
2021-10-08 08:43:57.505657 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 08:43:57.505657 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 08:43:57.506660 (Thread-1): 10:43:57 | 3 of 8 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-10-08 08:43:57.506660 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 08:43:57.506660 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 08:43:57.510658 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 08:43:57.512740 (Thread-1): finished collecting timing info
2021-10-08 08:43:57.514316 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 08:43:57.517259 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 08:43:57.517774 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: BEGIN
2021-10-08 08:43:57.517774 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:43:58.353852 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-08 08:43:58.353852 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 08:43:58.353852 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
2021-10-08 08:43:58.670253 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-08 08:43:58.670253 (Thread-1): finished collecting timing info
2021-10-08 08:43:58.670253 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: ROLLBACK
2021-10-08 08:43:58.912455 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-10-08 08:43:59.214276 (Thread-1): 10:43:59 | 3 of 8 PASS not_null_my_second_dbt_model_id.......................... [PASS in 1.71s]
2021-10-08 08:43:59.215328 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 08:43:59.215328 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 08:43:59.215328 (Thread-1): 10:43:59 | 4 of 8 START test not_null_snowflake_customer_purchases_c_custkey.... [RUN]
2021-10-08 08:43:59.215328 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 08:43:59.216335 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 08:43:59.220416 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 08:43:59.221334 (Thread-1): finished collecting timing info
2021-10-08 08:43:59.222261 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 08:43:59.224274 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 08:43:59.224274 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: BEGIN
2021-10-08 08:43:59.224274 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:44:00.047323 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 08:44:00.047323 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 08:44:00.047323 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.snowflake_customer_purchases
where c_custkey is null



      
    ) dbt_internal_test
2021-10-08 08:44:00.401417 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-10-08 08:44:00.402414 (Thread-1): finished collecting timing info
2021-10-08 08:44:00.403414 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: ROLLBACK
2021-10-08 08:44:00.650896 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: Close
2021-10-08 08:44:00.938284 (Thread-1): 10:44:00 | 4 of 8 PASS not_null_snowflake_customer_purchases_c_custkey.......... [PASS in 1.72s]
2021-10-08 08:44:00.939285 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 08:44:00.939285 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53
2021-10-08 08:44:00.940283 (Thread-1): 10:44:00 | 5 of 8 START test unique_cul_order_price_cul_daily_amount............ [RUN]
2021-10-08 08:44:00.940512 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53".
2021-10-08 08:44:00.940512 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53
2021-10-08 08:44:00.945518 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53"
2021-10-08 08:44:00.946518 (Thread-1): finished collecting timing info
2021-10-08 08:44:00.947519 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53"
2021-10-08 08:44:00.948518 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53".
2021-10-08 08:44:00.948518 (Thread-1): On test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53: BEGIN
2021-10-08 08:44:00.948518 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:44:01.741106 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 08:44:01.742108 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53".
2021-10-08 08:44:01.742199 (Thread-1): On test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    cul_daily_amount as unique_field,
    count(*) as n_records

from analytics.dbt.cul_order_price
where cul_daily_amount is not null
group by cul_daily_amount
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 08:44:01.967986 (Thread-1): Snowflake query id: 019f778a-0601-381f-0000-00664703c24d
2021-10-08 08:44:01.967986 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 4
invalid identifier 'CUL_DAILY_AMOUNT'
2021-10-08 08:44:01.967986 (Thread-1): finished collecting timing info
2021-10-08 08:44:01.967986 (Thread-1): On test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53: ROLLBACK
2021-10-08 08:44:02.213390 (Thread-1): On test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53: Close
2021-10-08 08:44:02.527711 (Thread-1): Database Error in test unique_cul_order_price_cul_daily_amount (models\example\schema.yml)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'CUL_DAILY_AMOUNT'
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\unique_cul_order_price_cul_daily_amount.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 11 at position 4
invalid identifier 'CUL_DAILY_AMOUNT'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\test.py", line 112, in execute
    result = self.execute_test(test, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\test.py", line 82, in execute_test
    macro_func()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 132, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test unique_cul_order_price_cul_daily_amount (models\example\schema.yml)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'CUL_DAILY_AMOUNT'
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\unique_cul_order_price_cul_daily_amount.sql
2021-10-08 08:44:02.527711 (Thread-1): 10:44:02 | 5 of 8 ERROR unique_cul_order_price_cul_daily_amount................. [ERROR in 1.59s]
2021-10-08 08:44:02.528710 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53
2021-10-08 08:44:02.529640 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 08:44:02.529640 (Thread-1): 10:44:02 | 6 of 8 START test unique_my_first_dbt_model_id....................... [RUN]
2021-10-08 08:44:02.530705 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 08:44:02.530705 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 08:44:02.533623 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 08:44:02.535622 (Thread-1): finished collecting timing info
2021-10-08 08:44:02.536660 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 08:44:02.539718 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 08:44:02.539718 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: BEGIN
2021-10-08 08:44:02.539718 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:44:03.314910 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 08:44:03.316156 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 08:44:03.316156 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.first_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 08:44:03.515697 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 08:44:03.516675 (Thread-1): finished collecting timing info
2021-10-08 08:44:03.516675 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: ROLLBACK
2021-10-08 08:44:03.883810 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-08 08:44:04.187219 (Thread-1): 10:44:04 | 6 of 8 PASS unique_my_first_dbt_model_id............................. [PASS in 1.66s]
2021-10-08 08:44:04.188217 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 08:44:04.188217 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 08:44:04.188217 (Thread-1): 10:44:04 | 7 of 8 START test unique_my_second_dbt_model_id...................... [RUN]
2021-10-08 08:44:04.189609 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 08:44:04.189609 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 08:44:04.192509 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 08:44:04.194428 (Thread-1): finished collecting timing info
2021-10-08 08:44:04.197779 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 08:44:04.199792 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 08:44:04.199792 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: BEGIN
2021-10-08 08:44:04.199792 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:44:04.994421 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 08:44:04.994421 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 08:44:04.994421 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 08:44:05.356977 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-08 08:44:05.357976 (Thread-1): finished collecting timing info
2021-10-08 08:44:05.357976 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: ROLLBACK
2021-10-08 08:44:05.593968 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: Close
2021-10-08 08:44:05.910994 (Thread-1): 10:44:05 | 7 of 8 PASS unique_my_second_dbt_model_id............................ [PASS in 1.72s]
2021-10-08 08:44:05.912680 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 08:44:05.912680 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 08:44:05.913691 (Thread-1): 10:44:05 | 8 of 8 START test unique_snowflake_customer_purchases_c_custkey...... [RUN]
2021-10-08 08:44:05.914693 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 08:44:05.914693 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 08:44:05.918690 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 08:44:05.919688 (Thread-1): finished collecting timing info
2021-10-08 08:44:05.920689 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 08:44:05.922689 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 08:44:05.922689 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: BEGIN
2021-10-08 08:44:05.922689 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:44:06.865904 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-10-08 08:44:06.867003 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 08:44:06.867003 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.snowflake_customer_purchases
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 08:44:07.353948 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-10-08 08:44:07.354846 (Thread-1): finished collecting timing info
2021-10-08 08:44:07.355009 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: ROLLBACK
2021-10-08 08:44:07.575674 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: Close
2021-10-08 08:44:07.883441 (Thread-1): 10:44:07 | 8 of 8 PASS unique_snowflake_customer_purchases_c_custkey............ [PASS in 1.97s]
2021-10-08 08:44:07.885401 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 08:44:07.886398 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:44:07.887482 (MainThread): 10:44:07 | 
2021-10-08 08:44:07.887482 (MainThread): 10:44:07 | Finished running 8 tests in 15.50s.
2021-10-08 08:44:07.888401 (MainThread): Connection 'master' was properly closed.
2021-10-08 08:44:07.888401 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 08:44:07.888401 (MainThread): Connection 'test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8' was properly closed.
2021-10-08 08:44:07.906397 (MainThread): 
2021-10-08 08:44:07.907397 (MainThread): Completed with 3 errors and 0 warnings:
2021-10-08 08:44:07.908433 (MainThread): 
2021-10-08 08:44:07.908433 (MainThread): Database Error in test not_null_cul_order_price_cul_daily_amount (models\example\schema.yml)
2021-10-08 08:44:07.909221 (MainThread):   000904 (42000): SQL compilation error: error line 12 at position 6
2021-10-08 08:44:07.909221 (MainThread):   invalid identifier 'CUL_DAILY_AMOUNT'
2021-10-08 08:44:07.909221 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\not_null_cul_order_price_cul_daily_amount.sql
2021-10-08 08:44:07.910227 (MainThread): 
2021-10-08 08:44:07.910227 (MainThread): Failure in test not_null_my_first_dbt_model_id (models\example\schema.yml)
2021-10-08 08:44:07.913358 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-08 08:44:07.915358 (MainThread): 
2021-10-08 08:44:07.915358 (MainThread):   compiled SQL at target\compiled\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\not_null_my_first_dbt_model_id.sql
2021-10-08 08:44:07.916357 (MainThread): 
2021-10-08 08:44:07.916357 (MainThread): Database Error in test unique_cul_order_price_cul_daily_amount (models\example\schema.yml)
2021-10-08 08:44:07.916357 (MainThread):   000904 (42000): SQL compilation error: error line 11 at position 4
2021-10-08 08:44:07.917358 (MainThread):   invalid identifier 'CUL_DAILY_AMOUNT'
2021-10-08 08:44:07.919359 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\unique_cul_order_price_cul_daily_amount.sql
2021-10-08 08:44:07.919359 (MainThread): 
Done. PASS=5 WARN=0 ERROR=3 SKIP=0 TOTAL=8
2021-10-08 08:44:07.919359 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A9CDBD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A9D01FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A884B310>]}
2021-10-08 08:44:07.920359 (MainThread): Flushing usage events
2021-10-08 08:46:09.191794 (MainThread): Running with dbt=0.20.2
2021-10-08 08:46:09.802428 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 08:46:09.803424 (MainThread): Tracking: tracking
2021-10-08 08:46:09.803424 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268EABBDE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268EC104400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268EC104190>]}
2021-10-08 08:46:09.812428 (MainThread): Partial parsing not enabled
2021-10-08 08:46:09.826611 (MainThread): Parsing macros\adapters.sql
2021-10-08 08:46:09.846666 (MainThread): Parsing macros\catalog.sql
2021-10-08 08:46:09.848928 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 08:46:09.854927 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 08:46:09.856932 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 08:46:09.859937 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 08:46:09.860939 (MainThread): Parsing macros\core.sql
2021-10-08 08:46:09.863983 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 08:46:09.896533 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 08:46:09.902619 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 08:46:09.903617 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 08:46:09.904615 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 08:46:09.906619 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 08:46:09.907618 (MainThread): Parsing macros\etc\query.sql
2021-10-08 08:46:09.907618 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 08:46:09.915867 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 08:46:09.920882 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 08:46:09.931287 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 08:46:09.932298 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 08:46:09.937295 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 08:46:09.951595 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 08:46:09.972485 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 08:46:09.974474 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 08:46:09.985599 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 08:46:09.991369 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 08:46:09.995350 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 08:46:10.000262 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 08:46:10.001711 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 08:46:10.002886 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 08:46:10.003786 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 08:46:10.140616 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:46:10.147005 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:46:10.153003 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:46:10.155023 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:46:10.156176 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:46:10.158496 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:46:10.160498 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:46:10.183498 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:46:10.186641 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:46:10.188224 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:46:10.189237 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:46:10.191316 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:46:10.223308 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:46:10.224320 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:46:10.225304 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:46:10.244813 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a855537e-8088-4857-bfe3-d2cca7513296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268EC149FA0>]}
2021-10-08 08:46:10.264253 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 08:46:10.264253 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a855537e-8088-4857-bfe3-d2cca7513296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268EABBD0A0>]}
2021-10-08 08:46:10.264253 (MainThread): Found 6 models, 8 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 08:46:10.266261 (MainThread): 
2021-10-08 08:46:10.267251 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:46:10.268250 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 08:46:10.277335 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 08:46:10.277335 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 08:46:10.277335 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 08:46:11.778854 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.50 seconds
2021-10-08 08:46:11.782873 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 08:46:12.083079 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 08:46:12.091077 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 08:46:12.091077 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 08:46:12.091077 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 08:46:12.914082 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.82 seconds
2021-10-08 08:46:12.915082 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 08:46:13.215822 (MainThread): Using snowflake connection "master".
2021-10-08 08:46:13.215822 (MainThread): On master: BEGIN
2021-10-08 08:46:13.215822 (MainThread): Opening a new connection, currently in state init
2021-10-08 08:46:14.092606 (MainThread): SQL status: SUCCESS 1 in 0.88 seconds
2021-10-08 08:46:14.092606 (MainThread): On master: COMMIT
2021-10-08 08:46:14.092606 (MainThread): Using snowflake connection "master".
2021-10-08 08:46:14.092606 (MainThread): On master: COMMIT
2021-10-08 08:46:14.332886 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-08 08:46:14.332886 (MainThread): On master: Close
2021-10-08 08:46:14.633220 (MainThread): 10:46:14 | Concurrency: 1 threads (target='dev')
2021-10-08 08:46:14.634218 (MainThread): 10:46:14 | 
2021-10-08 08:46:14.635860 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:46:14.636860 (Thread-1): 10:46:14 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 08:46:14.636860 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:46:14.636860 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:46:14.638860 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 08:46:14.640859 (Thread-1): finished collecting timing info
2021-10-08 08:46:14.665337 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 08:46:14.667353 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:46:14.667353 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 08:46:14.667353 (Thread-1): Opening a new connection, currently in state init
2021-10-08 08:46:15.457375 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 08:46:15.458315 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:46:15.458315 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 08:46:16.374362 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2021-10-08 08:46:16.375326 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 08:46:16.375326 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:46:16.375326 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 08:46:16.553893 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:46:16.559893 (Thread-1): finished collecting timing info
2021-10-08 08:46:16.559893 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 08:46:16.876588 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a855537e-8088-4857-bfe3-d2cca7513296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268EC1E1E20>]}
2021-10-08 08:46:16.876588 (Thread-1): 10:46:16 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.24s]
2021-10-08 08:46:16.877589 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:46:16.877589 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:46:16.877589 (Thread-1): 10:46:16 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 08:46:16.877589 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:46:16.878587 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:46:16.879587 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:46:16.884668 (Thread-1): finished collecting timing info
2021-10-08 08:46:16.887587 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:46:16.889110 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:46:16.890219 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 08:46:16.890219 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:46:17.740250 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-08 08:46:17.740250 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:46:17.740250 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 08:46:19.080667 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-10-08 08:46:19.081667 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:46:19.081667 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:46:19.081667 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:46:19.257224 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:46:19.258315 (Thread-1): finished collecting timing info
2021-10-08 08:46:19.258315 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 08:46:19.550818 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a855537e-8088-4857-bfe3-d2cca7513296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268EC0C9BB0>]}
2021-10-08 08:46:19.550818 (Thread-1): 10:46:19 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.67s]
2021-10-08 08:46:19.551833 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:46:19.551833 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:46:19.551833 (Thread-1): 10:46:19 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 08:46:19.552858 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:46:19.552858 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 08:46:19.556866 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:46:19.558864 (Thread-1): finished collecting timing info
2021-10-08 08:46:19.580641 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:46:19.580641 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 08:46:19.581659 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:46:21.046242 (Thread-1): SQL status: SUCCESS 1 in 1.46 seconds
2021-10-08 08:46:21.053507 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:46:21.053507 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 08:46:21.225789 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:46:21.226789 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:46:21.227790 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:46:21.396285 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:46:21.399375 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:46:21.400373 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:46:21.560103 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:46:21.571307 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:46:21.573205 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:46:21.573205 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 08:46:21.783825 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-08 08:46:21.783825 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:46:21.784826 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 08:46:22.246188 (Thread-1): SQL status: SUCCESS 0 in 0.46 seconds
2021-10-08 08:46:22.247271 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:46:22.248190 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:46:22.248190 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:46:22.565595 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-08 08:46:22.566576 (Thread-1): finished collecting timing info
2021-10-08 08:46:22.566576 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 08:46:23.147425 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a855537e-8088-4857-bfe3-d2cca7513296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268EC2014C0>]}
2021-10-08 08:46:23.147927 (Thread-1): 10:46:23 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.59s]
2021-10-08 08:46:23.149247 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:46:23.149247 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:46:23.149247 (Thread-1): 10:46:23 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 08:46:23.149247 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:46:23.149247 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:46:23.151557 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:46:23.156556 (Thread-1): finished collecting timing info
2021-10-08 08:46:23.157714 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:46:23.162685 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:46:23.162685 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 08:46:23.163795 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:46:23.974589 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-08 08:46:23.975500 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:46:23.975500 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 08:46:25.677007 (Thread-1): SQL status: SUCCESS 1 in 1.70 seconds
2021-10-08 08:46:25.677838 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:46:25.677838 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:46:25.677838 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:46:25.862690 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:46:25.863690 (Thread-1): finished collecting timing info
2021-10-08 08:46:25.863690 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 08:46:26.158678 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a855537e-8088-4857-bfe3-d2cca7513296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268EC4B3970>]}
2021-10-08 08:46:26.158678 (Thread-1): 10:46:26 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.01s]
2021-10-08 08:46:26.159586 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:46:26.160591 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 08:46:26.161009 (Thread-1): 10:46:26 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 08:46:26.161009 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:46:26.161009 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 08:46:26.163085 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:46:26.165041 (Thread-1): finished collecting timing info
2021-10-08 08:46:26.167052 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:46:26.167052 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 08:46:26.167052 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:46:27.491360 (Thread-1): SQL status: SUCCESS 1 in 1.32 seconds
2021-10-08 08:46:27.495996 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:46:27.497622 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 08:46:27.710461 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-08 08:46:27.712468 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:46:27.713466 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:46:27.885256 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:46:27.889401 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:46:27.889401 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:46:28.050279 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:46:28.053270 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:46:28.055013 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:46:28.055013 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 08:46:28.244640 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 08:46:28.244640 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:46:28.244640 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 08:46:28.541920 (Thread-1): SQL status: SUCCESS 0 in 0.30 seconds
2021-10-08 08:46:28.541920 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:46:28.541920 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:46:28.541920 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:46:28.865346 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-08 08:46:28.866360 (Thread-1): finished collecting timing info
2021-10-08 08:46:28.867359 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 08:46:29.172297 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a855537e-8088-4857-bfe3-d2cca7513296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268EC51F0A0>]}
2021-10-08 08:46:29.172297 (Thread-1): 10:46:29 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.01s]
2021-10-08 08:46:29.174327 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 08:46:29.174327 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:46:29.174327 (Thread-1): 10:46:29 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 08:46:29.175388 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:46:29.175388 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:46:29.177465 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 08:46:29.179386 (Thread-1): finished collecting timing info
2021-10-08 08:46:29.181384 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 08:46:29.186247 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:46:29.186247 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 08:46:29.186247 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:46:30.335075 (Thread-1): SQL status: SUCCESS 1 in 1.15 seconds
2021-10-08 08:46:30.335075 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:46:30.335075 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
where id = 1
      );
2021-10-08 08:46:31.558284 (Thread-1): SQL status: SUCCESS 1 in 1.22 seconds
2021-10-08 08:46:31.559639 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 08:46:31.559793 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:46:31.559846 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 08:46:31.745217 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:46:31.746216 (Thread-1): finished collecting timing info
2021-10-08 08:46:31.746216 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 08:46:32.047037 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a855537e-8088-4857-bfe3-d2cca7513296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268EC3C9460>]}
2021-10-08 08:46:32.047037 (Thread-1): 10:46:32 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.87s]
2021-10-08 08:46:32.049421 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:46:32.050439 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:46:32.051470 (MainThread): Using snowflake connection "master".
2021-10-08 08:46:32.051470 (MainThread): On master: BEGIN
2021-10-08 08:46:32.051470 (MainThread): Opening a new connection, currently in state closed
2021-10-08 08:46:32.820302 (MainThread): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-08 08:46:32.820302 (MainThread): On master: COMMIT
2021-10-08 08:46:32.820302 (MainThread): Using snowflake connection "master".
2021-10-08 08:46:32.820302 (MainThread): On master: COMMIT
2021-10-08 08:46:33.078670 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-08 08:46:33.080190 (MainThread): On master: Close
2021-10-08 08:46:33.381634 (MainThread): 10:46:33 | 
2021-10-08 08:46:42.008708 (MainThread): 10:46:42 | Finished running 4 table models, 2 incremental models in 23.12s.
2021-10-08 08:46:42.009712 (MainThread): Connection 'master' was properly closed.
2021-10-08 08:46:42.009712 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 08:46:42.009712 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 08:46:42.009712 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 08:46:42.032484 (MainThread): 
2021-10-08 08:46:42.033116 (MainThread): Completed successfully
2021-10-08 08:46:42.033547 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-08 08:46:42.033717 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268EC59E1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268EABBD820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268EC264F40>]}
2021-10-08 08:46:42.033717 (MainThread): Flushing usage events
2021-10-08 08:50:27.041756 (MainThread): Running with dbt=0.20.2
2021-10-08 08:50:27.658879 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-10-08 08:50:27.659880 (MainThread): Tracking: tracking
2021-10-08 08:50:27.659880 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002752EA4CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002752FF7A190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002752FF7A400>]}
2021-10-08 08:50:27.666082 (MainThread): Partial parsing not enabled
2021-10-08 08:50:27.678081 (MainThread): Parsing macros\adapters.sql
2021-10-08 08:50:27.696082 (MainThread): Parsing macros\catalog.sql
2021-10-08 08:50:27.697085 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 08:50:27.704083 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 08:50:27.705084 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 08:50:27.708082 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 08:50:27.709084 (MainThread): Parsing macros\core.sql
2021-10-08 08:50:27.712278 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 08:50:27.746679 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 08:50:27.752835 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 08:50:27.753442 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 08:50:27.754475 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 08:50:27.755711 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 08:50:27.756897 (MainThread): Parsing macros\etc\query.sql
2021-10-08 08:50:27.757523 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 08:50:27.765308 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 08:50:27.770743 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 08:50:27.781228 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 08:50:27.782244 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 08:50:27.788243 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 08:50:27.803698 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 08:50:27.824989 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 08:50:27.825981 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 08:50:27.838973 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 08:50:27.843990 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 08:50:27.846975 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 08:50:27.852088 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 08:50:27.853230 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 08:50:27.854245 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 08:50:27.855248 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 08:50:27.976003 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:50:27.983241 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:50:27.988231 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:50:27.990226 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:50:27.991392 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:50:27.994677 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:50:27.996657 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:50:28.018893 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:50:28.020903 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:50:28.022885 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:50:28.023907 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:50:28.024902 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:50:28.055471 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:50:28.056459 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:50:28.058481 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:50:28.077212 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f86da868-50d3-4de1-a9c2-f2ef40e23d07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002753008A490>]}
2021-10-08 08:50:28.107816 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 08:50:28.107816 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f86da868-50d3-4de1-a9c2-f2ef40e23d07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002753008AF70>]}
2021-10-08 08:50:28.108720 (MainThread): Found 6 models, 8 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 08:50:28.109273 (MainThread): 
2021-10-08 08:50:28.110420 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:50:28.111452 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 08:50:28.122415 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 08:50:28.122415 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 08:50:28.122415 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 08:50:29.606473 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.48 seconds
2021-10-08 08:50:29.612316 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 08:50:29.921606 (MainThread): 10:50:29 | Concurrency: 1 threads (target='dev')
2021-10-08 08:50:29.921606 (MainThread): 10:50:29 | 
2021-10-08 08:50:29.925556 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f
2021-10-08 08:50:29.925556 (Thread-1): 10:50:29 | 1 of 8 START test not_null_cul_order_price_cul_daily_amount.......... [RUN]
2021-10-08 08:50:29.926558 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f".
2021-10-08 08:50:29.926558 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f
2021-10-08 08:50:29.934862 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f"
2021-10-08 08:50:29.942020 (Thread-1): finished collecting timing info
2021-10-08 08:50:29.955255 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f"
2021-10-08 08:50:29.961364 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f".
2021-10-08 08:50:29.962453 (Thread-1): On test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f: BEGIN
2021-10-08 08:50:29.962453 (Thread-1): Opening a new connection, currently in state init
2021-10-08 08:50:31.034696 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-10-08 08:50:31.034696 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f".
2021-10-08 08:50:31.034696 (Thread-1): On test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.cul_order_price
where cul_daily_amount is null



      
    ) dbt_internal_test
2021-10-08 08:50:31.316111 (Thread-1): Snowflake query id: 019f7791-0601-3832-0000-00664703b2c1
2021-10-08 08:50:31.316111 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 6
invalid identifier 'CUL_DAILY_AMOUNT'
2021-10-08 08:50:31.317111 (Thread-1): finished collecting timing info
2021-10-08 08:50:31.317111 (Thread-1): On test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f: ROLLBACK
2021-10-08 08:50:31.570608 (Thread-1): On test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f: Close
2021-10-08 08:50:31.868023 (Thread-1): Database Error in test not_null_cul_order_price_cul_daily_amount (models\example\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 6
  invalid identifier 'CUL_DAILY_AMOUNT'
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\not_null_cul_order_price_cul_daily_amount.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 12 at position 6
invalid identifier 'CUL_DAILY_AMOUNT'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\test.py", line 112, in execute
    result = self.execute_test(test, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\test.py", line 82, in execute_test
    macro_func()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 132, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test not_null_cul_order_price_cul_daily_amount (models\example\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 6
  invalid identifier 'CUL_DAILY_AMOUNT'
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\not_null_cul_order_price_cul_daily_amount.sql
2021-10-08 08:50:31.870305 (Thread-1): 10:50:31 | 1 of 8 ERROR not_null_cul_order_price_cul_daily_amount............... [ERROR in 1.94s]
2021-10-08 08:50:31.872227 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_cul_order_price_cul_daily_amount.172f57806f
2021-10-08 08:50:31.872227 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 08:50:31.872227 (Thread-1): 10:50:31 | 2 of 8 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-10-08 08:50:31.873283 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 08:50:31.873283 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 08:50:31.878300 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 08:50:31.880504 (Thread-1): finished collecting timing info
2021-10-08 08:50:31.882508 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 08:50:31.884668 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 08:50:31.884668 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: BEGIN
2021-10-08 08:50:31.884668 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:50:32.669297 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 08:50:32.669297 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 08:50:32.669297 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.first_model
where id is null



      
    ) dbt_internal_test
2021-10-08 08:50:33.001731 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-08 08:50:33.004727 (Thread-1): finished collecting timing info
2021-10-08 08:50:33.004727 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: ROLLBACK
2021-10-08 08:50:33.248880 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: Close
2021-10-08 08:50:33.541450 (Thread-1): 10:50:33 | 2 of 8 PASS not_null_my_first_dbt_model_id........................... [PASS in 1.67s]
2021-10-08 08:50:33.543374 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 08:50:33.543374 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 08:50:33.544170 (Thread-1): 10:50:33 | 3 of 8 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-10-08 08:50:33.544653 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 08:50:33.544653 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 08:50:33.548122 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 08:50:33.550449 (Thread-1): finished collecting timing info
2021-10-08 08:50:33.552449 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 08:50:33.554444 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 08:50:33.554444 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: BEGIN
2021-10-08 08:50:33.554444 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:50:34.334677 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 08:50:34.334677 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 08:50:34.334677 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
2021-10-08 08:50:34.667380 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-08 08:50:34.668400 (Thread-1): finished collecting timing info
2021-10-08 08:50:34.668400 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: ROLLBACK
2021-10-08 08:50:34.898242 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-10-08 08:50:35.201866 (Thread-1): 10:50:35 | 3 of 8 PASS not_null_my_second_dbt_model_id.......................... [PASS in 1.66s]
2021-10-08 08:50:35.203867 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 08:50:35.203867 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 08:50:35.203867 (Thread-1): 10:50:35 | 4 of 8 START test not_null_snowflake_customer_purchases_c_custkey.... [RUN]
2021-10-08 08:50:35.203867 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 08:50:35.203867 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 08:50:35.206864 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 08:50:35.211952 (Thread-1): finished collecting timing info
2021-10-08 08:50:35.213864 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 08:50:35.217864 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 08:50:35.217864 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: BEGIN
2021-10-08 08:50:35.217864 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:50:35.985216 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-08 08:50:35.985216 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 08:50:35.985216 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.snowflake_customer_purchases
where c_custkey is null



      
    ) dbt_internal_test
2021-10-08 08:50:36.324897 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-10-08 08:50:36.324897 (Thread-1): finished collecting timing info
2021-10-08 08:50:36.324897 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: ROLLBACK
2021-10-08 08:50:36.559223 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: Close
2021-10-08 08:50:36.859817 (Thread-1): 10:50:36 | 4 of 8 PASS not_null_snowflake_customer_purchases_c_custkey.......... [PASS in 1.66s]
2021-10-08 08:50:36.860516 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 08:50:36.860516 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53
2021-10-08 08:50:36.860516 (Thread-1): 10:50:36 | 5 of 8 START test unique_cul_order_price_cul_daily_amount............ [RUN]
2021-10-08 08:50:36.861521 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53".
2021-10-08 08:50:36.861521 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53
2021-10-08 08:50:36.867539 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53"
2021-10-08 08:50:36.872367 (Thread-1): finished collecting timing info
2021-10-08 08:50:36.874411 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53"
2021-10-08 08:50:36.879371 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53".
2021-10-08 08:50:36.879371 (Thread-1): On test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53: BEGIN
2021-10-08 08:50:36.879371 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:50:37.650202 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-08 08:50:37.650202 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53".
2021-10-08 08:50:37.650202 (Thread-1): On test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    cul_daily_amount as unique_field,
    count(*) as n_records

from analytics.dbt.cul_order_price
where cul_daily_amount is not null
group by cul_daily_amount
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 08:50:37.833567 (Thread-1): Snowflake query id: 019f7791-0601-3832-0000-00664703b2e5
2021-10-08 08:50:37.833567 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 4
invalid identifier 'CUL_DAILY_AMOUNT'
2021-10-08 08:50:37.833567 (Thread-1): finished collecting timing info
2021-10-08 08:50:37.833567 (Thread-1): On test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53: ROLLBACK
2021-10-08 08:50:38.074554 (Thread-1): On test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53: Close
2021-10-08 08:50:38.407247 (Thread-1): Database Error in test unique_cul_order_price_cul_daily_amount (models\example\schema.yml)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'CUL_DAILY_AMOUNT'
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\unique_cul_order_price_cul_daily_amount.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 11 at position 4
invalid identifier 'CUL_DAILY_AMOUNT'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\test.py", line 112, in execute
    result = self.execute_test(test, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\test.py", line 82, in execute_test
    macro_func()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 132, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test unique_cul_order_price_cul_daily_amount (models\example\schema.yml)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'CUL_DAILY_AMOUNT'
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\unique_cul_order_price_cul_daily_amount.sql
2021-10-08 08:50:38.409246 (Thread-1): 10:50:38 | 5 of 8 ERROR unique_cul_order_price_cul_daily_amount................. [ERROR in 1.55s]
2021-10-08 08:50:38.411211 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_cul_order_price_cul_daily_amount.7b4efa3b53
2021-10-08 08:50:38.411211 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 08:50:38.411211 (Thread-1): 10:50:38 | 6 of 8 START test unique_my_first_dbt_model_id....................... [RUN]
2021-10-08 08:50:38.412226 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 08:50:38.412226 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 08:50:38.416224 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 08:50:38.417220 (Thread-1): finished collecting timing info
2021-10-08 08:50:38.418092 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 08:50:38.420605 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 08:50:38.420605 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: BEGIN
2021-10-08 08:50:38.420605 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:50:39.208673 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 08:50:39.208673 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 08:50:39.208673 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.first_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 08:50:39.511961 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-10-08 08:50:39.512961 (Thread-1): finished collecting timing info
2021-10-08 08:50:39.512961 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: ROLLBACK
2021-10-08 08:50:39.747300 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-08 08:50:40.050319 (Thread-1): 10:50:40 | 6 of 8 PASS unique_my_first_dbt_model_id............................. [PASS in 1.64s]
2021-10-08 08:50:40.052393 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 08:50:40.053409 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 08:50:40.053409 (Thread-1): 10:50:40 | 7 of 8 START test unique_my_second_dbt_model_id...................... [RUN]
2021-10-08 08:50:40.054409 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 08:50:40.054409 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 08:50:40.058406 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 08:50:40.060408 (Thread-1): finished collecting timing info
2021-10-08 08:50:40.061494 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 08:50:40.062674 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 08:50:40.062674 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: BEGIN
2021-10-08 08:50:40.062674 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:50:40.851263 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 08:50:40.851263 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 08:50:40.851263 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 08:50:41.096402 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 08:50:41.097404 (Thread-1): finished collecting timing info
2021-10-08 08:50:41.097404 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: ROLLBACK
2021-10-08 08:50:41.381327 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: Close
2021-10-08 08:50:41.678890 (Thread-1): 10:50:41 | 7 of 8 PASS unique_my_second_dbt_model_id............................ [PASS in 1.63s]
2021-10-08 08:50:41.680081 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 08:50:41.680081 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 08:50:41.681117 (Thread-1): 10:50:41 | 8 of 8 START test unique_snowflake_customer_purchases_c_custkey...... [RUN]
2021-10-08 08:50:41.681117 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 08:50:41.682185 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 08:50:41.686191 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 08:50:41.690832 (Thread-1): finished collecting timing info
2021-10-08 08:50:41.691841 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 08:50:41.694329 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 08:50:41.694329 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: BEGIN
2021-10-08 08:50:41.694329 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:50:42.695212 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-08 08:50:42.695212 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 08:50:42.696209 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.snowflake_customer_purchases
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 08:50:43.156316 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-10-08 08:50:43.157922 (Thread-1): finished collecting timing info
2021-10-08 08:50:43.157922 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: ROLLBACK
2021-10-08 08:50:43.393216 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: Close
2021-10-08 08:50:43.676216 (Thread-1): 10:50:43 | 8 of 8 PASS unique_snowflake_customer_purchases_c_custkey............ [PASS in 2.00s]
2021-10-08 08:50:43.677182 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 08:50:43.678183 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:50:43.678183 (MainThread): 10:50:43 | 
2021-10-08 08:50:43.678183 (MainThread): 10:50:43 | Finished running 8 tests in 15.57s.
2021-10-08 08:50:43.679178 (MainThread): Connection 'master' was properly closed.
2021-10-08 08:50:43.679178 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 08:50:43.679178 (MainThread): Connection 'test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8' was properly closed.
2021-10-08 08:50:43.694259 (MainThread): 
2021-10-08 08:50:43.694764 (MainThread): Completed with 2 errors and 0 warnings:
2021-10-08 08:50:43.694764 (MainThread): 
2021-10-08 08:50:43.695921 (MainThread): Database Error in test not_null_cul_order_price_cul_daily_amount (models\example\schema.yml)
2021-10-08 08:50:43.696136 (MainThread):   000904 (42000): SQL compilation error: error line 12 at position 6
2021-10-08 08:50:43.696136 (MainThread):   invalid identifier 'CUL_DAILY_AMOUNT'
2021-10-08 08:50:43.696515 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\not_null_cul_order_price_cul_daily_amount.sql
2021-10-08 08:50:43.696515 (MainThread): 
2021-10-08 08:50:43.697011 (MainThread): Database Error in test unique_cul_order_price_cul_daily_amount (models\example\schema.yml)
2021-10-08 08:50:43.697360 (MainThread):   000904 (42000): SQL compilation error: error line 11 at position 4
2021-10-08 08:50:43.697360 (MainThread):   invalid identifier 'CUL_DAILY_AMOUNT'
2021-10-08 08:50:43.697769 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\unique_cul_order_price_cul_daily_amount.sql
2021-10-08 08:50:43.697887 (MainThread): 
Done. PASS=6 WARN=0 ERROR=2 SKIP=0 TOTAL=8
2021-10-08 08:50:43.697887 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275303D5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002752FF7A310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027530264DC0>]}
2021-10-08 08:50:43.698455 (MainThread): Flushing usage events
2021-10-08 08:55:38.796940 (MainThread): Running with dbt=0.20.2
2021-10-08 08:55:39.333532 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 08:55:39.333532 (MainThread): Tracking: tracking
2021-10-08 08:55:39.333532 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A0663CEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A07B398B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A07B394C0>]}
2021-10-08 08:55:39.340516 (MainThread): Partial parsing not enabled
2021-10-08 08:55:39.354531 (MainThread): Parsing macros\adapters.sql
2021-10-08 08:55:39.373805 (MainThread): Parsing macros\catalog.sql
2021-10-08 08:55:39.375800 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 08:55:39.381804 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 08:55:39.382877 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 08:55:39.385890 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 08:55:39.386875 (MainThread): Parsing macros\core.sql
2021-10-08 08:55:39.390234 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 08:55:39.422732 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 08:55:39.428659 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 08:55:39.429740 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 08:55:39.430739 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 08:55:39.431740 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 08:55:39.432739 (MainThread): Parsing macros\etc\query.sql
2021-10-08 08:55:39.433738 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 08:55:39.440737 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 08:55:39.445739 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 08:55:39.455496 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 08:55:39.456491 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 08:55:39.462491 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 08:55:39.477744 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 08:55:39.499173 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 08:55:39.500184 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 08:55:39.513169 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 08:55:39.518271 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 08:55:39.521271 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 08:55:39.525285 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 08:55:39.527275 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 08:55:39.527275 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 08:55:39.528277 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 08:55:39.651680 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:55:39.658645 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:55:39.663767 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:55:39.666108 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:55:39.666738 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:55:39.669296 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:55:39.670962 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:55:39.695487 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:55:39.697490 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:55:39.698488 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:55:39.699576 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:55:39.701618 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:55:39.729906 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:55:39.731898 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:55:39.732907 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:55:39.751518 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '215b4959-c498-4c0a-bcfc-6bff42bdc6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A0663C9D0>]}
2021-10-08 08:55:39.780684 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 08:55:39.780684 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '215b4959-c498-4c0a-bcfc-6bff42bdc6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A0663C8B0>]}
2021-10-08 08:55:39.781684 (MainThread): Found 6 models, 8 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 08:55:39.782875 (MainThread): 
2021-10-08 08:55:39.782875 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:55:39.783873 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 08:55:39.796741 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 08:55:39.796741 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 08:55:39.796741 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 08:55:42.023294 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.23 seconds
2021-10-08 08:55:42.029307 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 08:55:42.339753 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 08:55:42.344828 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 08:55:42.344828 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 08:55:42.344828 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 08:55:43.168070 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.82 seconds
2021-10-08 08:55:43.170058 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 08:55:43.481495 (MainThread): Using snowflake connection "master".
2021-10-08 08:55:43.481495 (MainThread): On master: BEGIN
2021-10-08 08:55:43.481495 (MainThread): Opening a new connection, currently in state init
2021-10-08 08:55:44.299850 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 08:55:44.299850 (MainThread): On master: COMMIT
2021-10-08 08:55:44.299850 (MainThread): Using snowflake connection "master".
2021-10-08 08:55:44.299850 (MainThread): On master: COMMIT
2021-10-08 08:55:44.602455 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-10-08 08:55:44.602455 (MainThread): On master: Close
2021-10-08 08:55:44.902016 (MainThread): 10:55:44 | Concurrency: 1 threads (target='dev')
2021-10-08 08:55:44.902016 (MainThread): 10:55:44 | 
2021-10-08 08:55:44.906016 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:55:44.906016 (Thread-1): 10:55:44 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 08:55:44.907117 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:55:44.907117 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:55:44.910096 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 08:55:44.920134 (Thread-1): finished collecting timing info
2021-10-08 08:55:44.939524 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 08:55:44.944319 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:55:44.944319 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 08:55:44.944821 (Thread-1): Opening a new connection, currently in state init
2021-10-08 08:55:45.750564 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-08 08:55:45.750564 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:55:45.750564 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 08:55:46.723193 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-08 08:55:46.724156 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 08:55:46.724156 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:55:46.724156 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 08:55:46.913505 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 08:55:46.921160 (Thread-1): finished collecting timing info
2021-10-08 08:55:46.921160 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 08:55:47.208111 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '215b4959-c498-4c0a-bcfc-6bff42bdc6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A07B49BE0>]}
2021-10-08 08:55:47.208111 (Thread-1): 10:55:47 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.30s]
2021-10-08 08:55:47.209178 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:55:47.210147 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:55:47.210147 (Thread-1): 10:55:47 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 08:55:47.210147 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:55:47.211123 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:55:47.212130 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:55:47.217463 (Thread-1): finished collecting timing info
2021-10-08 08:55:47.219310 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:55:47.220306 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:55:47.220306 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 08:55:47.220306 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:55:48.009445 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 08:55:48.009445 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:55:48.009445 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) 
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 08:55:48.277914 (Thread-1): Snowflake query id: 019f7796-0601-381f-0000-00664703c311
2021-10-08 08:55:48.278027 (Thread-1): Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
2021-10-08 08:55:48.278127 (Thread-1): finished collecting timing info
2021-10-08 08:55:48.278222 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: ROLLBACK
2021-10-08 08:55:48.518533 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 08:55:48.805553 (Thread-1): Database Error in model cul_order_price (models\example\cul_order_price.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\cul_order_price.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002022 (42601): SQL compilation error:
Missing column specification

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model cul_order_price (models\example\cul_order_price.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\cul_order_price.sql
2021-10-08 08:55:48.808552 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '215b4959-c498-4c0a-bcfc-6bff42bdc6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A07F2F490>]}
2021-10-08 08:55:48.808552 (Thread-1): 10:55:48 | 2 of 6 ERROR creating table model dbt.cul_order_price................ [ERROR in 1.60s]
2021-10-08 08:55:48.810482 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:55:48.811412 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:55:48.811927 (Thread-1): 10:55:48 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 08:55:48.812174 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:55:48.812174 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 08:55:48.816264 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:55:48.818243 (Thread-1): finished collecting timing info
2021-10-08 08:55:48.832943 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:55:48.832943 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 08:55:48.832943 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:55:50.073300 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-10-08 08:55:50.081382 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:55:50.081382 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 08:55:50.257035 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:55:50.258035 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:55:50.258035 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:55:50.421661 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:55:50.423662 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:55:50.423662 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:55:50.629943 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-08 08:55:50.643107 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:55:50.644867 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:55:50.644867 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 08:55:50.839180 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 08:55:50.839180 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:55:50.839180 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 08:55:51.241617 (Thread-1): SQL status: SUCCESS 0 in 0.40 seconds
2021-10-08 08:55:51.243618 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:55:51.244627 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:55:51.244627 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:55:51.504154 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-08 08:55:51.504848 (Thread-1): finished collecting timing info
2021-10-08 08:55:51.504848 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 08:55:51.838518 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '215b4959-c498-4c0a-bcfc-6bff42bdc6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A07F22BB0>]}
2021-10-08 08:55:51.839523 (Thread-1): 10:55:51 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.03s]
2021-10-08 08:55:51.840521 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:55:51.840521 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:55:51.841516 (Thread-1): 10:55:51 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 08:55:51.841516 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:55:51.841516 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:55:51.843515 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:55:51.848508 (Thread-1): finished collecting timing info
2021-10-08 08:55:51.850038 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:55:51.852242 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:55:51.852242 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 08:55:51.852242 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:55:52.839592 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-10-08 08:55:52.840028 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:55:52.840097 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 08:55:54.253174 (Thread-1): SQL status: SUCCESS 1 in 1.41 seconds
2021-10-08 08:55:54.255174 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:55:54.255174 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:55:54.255174 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:55:54.425982 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:55:54.427902 (Thread-1): finished collecting timing info
2021-10-08 08:55:54.427902 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 08:55:54.759571 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '215b4959-c498-4c0a-bcfc-6bff42bdc6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A07F2F220>]}
2021-10-08 08:55:54.759571 (Thread-1): 10:55:54 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.92s]
2021-10-08 08:55:54.761290 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:55:54.761290 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 08:55:54.761290 (Thread-1): 10:55:54 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 08:55:54.761290 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:55:54.762353 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 08:55:54.764372 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:55:54.768383 (Thread-1): finished collecting timing info
2021-10-08 08:55:54.770380 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:55:54.771388 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 08:55:54.771388 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:55:56.354526 (Thread-1): SQL status: SUCCESS 1 in 1.58 seconds
2021-10-08 08:55:56.356605 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:55:56.356605 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 08:55:56.533435 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:55:56.534434 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:55:56.535434 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:55:56.697084 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:55:56.698082 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:55:56.698082 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:55:56.855107 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:55:56.856107 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:55:56.858105 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:55:56.859105 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 08:55:57.102340 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-08 08:55:57.102340 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:55:57.102340 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 08:55:57.427741 (Thread-1): SQL status: SUCCESS 0 in 0.33 seconds
2021-10-08 08:55:57.429404 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:55:57.429642 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:55:57.429719 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:55:57.694993 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 08:55:57.697135 (Thread-1): finished collecting timing info
2021-10-08 08:55:57.697243 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 08:55:57.995450 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '215b4959-c498-4c0a-bcfc-6bff42bdc6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A07B49E80>]}
2021-10-08 08:55:57.996449 (Thread-1): 10:55:57 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.23s]
2021-10-08 08:55:57.996449 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 08:55:57.996449 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:55:57.996449 (Thread-1): 10:55:57 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 08:55:57.997628 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:55:57.997628 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:55:57.999636 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 08:55:58.012380 (Thread-1): finished collecting timing info
2021-10-08 08:55:58.014521 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 08:55:58.016863 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:55:58.016863 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 08:55:58.016863 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:55:58.844468 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-08 08:55:58.844468 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:55:58.844468 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
where id = 1
      );
2021-10-08 08:55:59.881352 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-10-08 08:55:59.883351 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 08:55:59.883351 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:55:59.883351 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 08:56:00.053558 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:56:00.053558 (Thread-1): finished collecting timing info
2021-10-08 08:56:00.053558 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 08:56:00.350180 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '215b4959-c498-4c0a-bcfc-6bff42bdc6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A07CA4730>]}
2021-10-08 08:56:00.351180 (Thread-1): 10:56:00 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.35s]
2021-10-08 08:56:00.352183 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:56:00.354177 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:56:00.354177 (MainThread): Using snowflake connection "master".
2021-10-08 08:56:00.354177 (MainThread): On master: BEGIN
2021-10-08 08:56:00.354177 (MainThread): Opening a new connection, currently in state closed
2021-10-08 08:56:01.176614 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 08:56:01.176614 (MainThread): On master: COMMIT
2021-10-08 08:56:01.176614 (MainThread): Using snowflake connection "master".
2021-10-08 08:56:01.176614 (MainThread): On master: COMMIT
2021-10-08 08:56:01.453898 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-08 08:56:01.453898 (MainThread): On master: Close
2021-10-08 08:56:01.755819 (MainThread): 10:56:01 | 
2021-10-08 08:56:01.756933 (MainThread): 10:56:01 | Finished running 4 table models, 2 incremental models in 21.97s.
2021-10-08 08:56:01.757820 (MainThread): Connection 'master' was properly closed.
2021-10-08 08:56:01.757820 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 08:56:01.757820 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 08:56:01.758820 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 08:56:01.775637 (MainThread): 
2021-10-08 08:56:01.776638 (MainThread): Completed with 1 error and 0 warnings:
2021-10-08 08:56:01.777034 (MainThread): 
2021-10-08 08:56:01.777034 (MainThread): Database Error in model cul_order_price (models\example\cul_order_price.sql)
2021-10-08 08:56:01.778178 (MainThread):   002022 (42601): SQL compilation error:
2021-10-08 08:56:01.778178 (MainThread):   Missing column specification
2021-10-08 08:56:01.778178 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\cul_order_price.sql
2021-10-08 08:56:01.778178 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2021-10-08 08:56:01.779178 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A07B4E490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A0663C190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A07B53E80>]}
2021-10-08 08:56:01.779178 (MainThread): Flushing usage events
2021-10-08 08:56:28.322960 (MainThread): Running with dbt=0.20.2
2021-10-08 08:56:28.964902 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 08:56:28.965989 (MainThread): Tracking: tracking
2021-10-08 08:56:28.965989 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213748FDDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021375E3A0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021375E3A670>]}
2021-10-08 08:56:28.971980 (MainThread): Partial parsing not enabled
2021-10-08 08:56:28.983122 (MainThread): Parsing macros\adapters.sql
2021-10-08 08:56:29.002535 (MainThread): Parsing macros\catalog.sql
2021-10-08 08:56:29.004619 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 08:56:29.010877 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 08:56:29.011874 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 08:56:29.014882 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 08:56:29.015877 (MainThread): Parsing macros\core.sql
2021-10-08 08:56:29.017872 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 08:56:29.050143 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 08:56:29.056161 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 08:56:29.057054 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 08:56:29.058131 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 08:56:29.059137 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 08:56:29.060138 (MainThread): Parsing macros\etc\query.sql
2021-10-08 08:56:29.060138 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 08:56:29.067138 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 08:56:29.072153 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 08:56:29.082507 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 08:56:29.083500 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 08:56:29.089445 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 08:56:29.106816 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 08:56:29.130377 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 08:56:29.131381 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 08:56:29.145018 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 08:56:29.151144 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 08:56:29.154328 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 08:56:29.159327 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 08:56:29.161328 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 08:56:29.161328 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 08:56:29.163329 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 08:56:29.288409 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:56:29.295307 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:56:29.302326 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:56:29.305294 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:56:29.305294 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:56:29.307930 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:56:29.310300 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:56:29.335414 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:56:29.337415 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:56:29.339855 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:56:29.340855 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:56:29.342854 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:56:29.381056 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:56:29.382021 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:56:29.384018 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:56:29.400769 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96e6c603-aeb9-42e7-8390-145de167277f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021375E8EC10>]}
2021-10-08 08:56:29.427714 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 08:56:29.427714 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96e6c603-aeb9-42e7-8390-145de167277f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021375E4BD60>]}
2021-10-08 08:56:29.428715 (MainThread): Found 6 models, 8 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 08:56:29.430215 (MainThread): 
2021-10-08 08:56:29.430215 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:56:29.431822 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 08:56:29.443441 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 08:56:29.443441 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 08:56:29.443441 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 08:56:30.702461 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.26 seconds
2021-10-08 08:56:30.705742 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 08:56:30.998752 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 08:56:31.002739 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 08:56:31.002739 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 08:56:31.002739 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 08:56:31.973974 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.97 seconds
2021-10-08 08:56:31.974878 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 08:56:32.306115 (MainThread): Using snowflake connection "master".
2021-10-08 08:56:32.306115 (MainThread): On master: BEGIN
2021-10-08 08:56:32.306115 (MainThread): Opening a new connection, currently in state init
2021-10-08 08:56:33.084996 (MainThread): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 08:56:33.084996 (MainThread): On master: COMMIT
2021-10-08 08:56:33.086026 (MainThread): Using snowflake connection "master".
2021-10-08 08:56:33.086026 (MainThread): On master: COMMIT
2021-10-08 08:56:33.378646 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-08 08:56:33.378646 (MainThread): On master: Close
2021-10-08 08:56:33.672390 (MainThread): 10:56:33 | Concurrency: 1 threads (target='dev')
2021-10-08 08:56:33.672390 (MainThread): 10:56:33 | 
2021-10-08 08:56:33.674389 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:56:33.674389 (Thread-1): 10:56:33 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 08:56:33.674389 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:56:33.674389 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:56:33.676408 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 08:56:33.677406 (Thread-1): finished collecting timing info
2021-10-08 08:56:33.700802 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 08:56:33.702731 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:56:33.702731 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 08:56:33.702731 (Thread-1): Opening a new connection, currently in state init
2021-10-08 08:56:34.478983 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 08:56:34.478983 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:56:34.478983 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 08:56:35.429657 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-10-08 08:56:35.430646 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 08:56:35.430646 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:56:35.430646 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 08:56:35.591155 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:56:35.598077 (Thread-1): finished collecting timing info
2021-10-08 08:56:35.598077 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 08:56:35.900502 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e6c603-aeb9-42e7-8390-145de167277f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021375E2A2E0>]}
2021-10-08 08:56:35.900502 (Thread-1): 10:56:35 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.23s]
2021-10-08 08:56:35.901380 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:56:35.901380 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:56:35.901380 (Thread-1): 10:56:35 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 08:56:35.901380 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:56:35.901380 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:56:35.902380 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:56:35.907483 (Thread-1): finished collecting timing info
2021-10-08 08:56:35.910391 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:56:35.925336 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:56:35.925738 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 08:56:35.925738 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:56:36.683846 (Thread-1): SQL status: SUCCESS 1 in 0.76 seconds
2021-10-08 08:56:36.684907 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:56:36.684907 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 08:56:37.994960 (Thread-1): SQL status: SUCCESS 1 in 1.31 seconds
2021-10-08 08:56:37.996049 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:56:37.996049 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:56:37.996049 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:56:38.159380 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:56:38.159380 (Thread-1): finished collecting timing info
2021-10-08 08:56:38.159380 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 08:56:38.453187 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e6c603-aeb9-42e7-8390-145de167277f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021376275400>]}
2021-10-08 08:56:38.454287 (Thread-1): 10:56:38 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.55s]
2021-10-08 08:56:38.454287 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:56:38.454287 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:56:38.455184 (Thread-1): 10:56:38 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 08:56:38.455184 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:56:38.455184 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 08:56:38.462189 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:56:38.464992 (Thread-1): finished collecting timing info
2021-10-08 08:56:38.480764 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:56:38.480764 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 08:56:38.480764 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:56:39.741665 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-10-08 08:56:39.749664 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:56:39.749664 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 08:56:39.929350 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:56:39.931348 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:56:39.931348 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:56:40.112786 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:56:40.115786 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:56:40.115786 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:56:40.289269 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:56:40.303935 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:56:40.306008 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:56:40.306149 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 08:56:40.496010 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 08:56:40.496010 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:56:40.497027 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 08:56:40.903879 (Thread-1): SQL status: SUCCESS 0 in 0.41 seconds
2021-10-08 08:56:40.904885 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:56:40.904885 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:56:40.904885 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:56:41.190491 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-08 08:56:41.191574 (Thread-1): finished collecting timing info
2021-10-08 08:56:41.191574 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 08:56:41.520631 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e6c603-aeb9-42e7-8390-145de167277f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213748FD130>]}
2021-10-08 08:56:41.521628 (Thread-1): 10:56:41 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.07s]
2021-10-08 08:56:41.522359 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:56:41.522359 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:56:41.522359 (Thread-1): 10:56:41 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 08:56:41.522359 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:56:41.522359 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:56:41.523365 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:56:41.525692 (Thread-1): finished collecting timing info
2021-10-08 08:56:41.526191 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:56:41.528585 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:56:41.528585 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 08:56:41.529639 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:56:42.594461 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-10-08 08:56:42.594461 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:56:42.594461 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 08:56:44.040228 (Thread-1): SQL status: SUCCESS 1 in 1.45 seconds
2021-10-08 08:56:44.041273 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:56:44.041273 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:56:44.041273 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:56:44.206453 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:56:44.207505 (Thread-1): finished collecting timing info
2021-10-08 08:56:44.207505 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 08:56:44.518207 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e6c603-aeb9-42e7-8390-145de167277f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002137629C1C0>]}
2021-10-08 08:56:44.518207 (Thread-1): 10:56:44 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.00s]
2021-10-08 08:56:44.519223 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:56:44.519223 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 08:56:44.519223 (Thread-1): 10:56:44 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 08:56:44.520206 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:56:44.520206 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 08:56:44.521298 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:56:44.524207 (Thread-1): finished collecting timing info
2021-10-08 08:56:44.526288 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:56:44.526288 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 08:56:44.526288 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:56:45.837578 (Thread-1): SQL status: SUCCESS 1 in 1.31 seconds
2021-10-08 08:56:45.839581 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:56:45.839581 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 08:56:46.022432 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:56:46.024431 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:56:46.024431 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:56:46.191034 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:56:46.193032 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:56:46.193032 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:56:46.361062 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:56:46.362059 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:56:46.364059 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:56:46.364059 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 08:56:46.561886 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 08:56:46.562900 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:56:46.562900 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 08:56:46.851512 (Thread-1): SQL status: SUCCESS 0 in 0.29 seconds
2021-10-08 08:56:46.852529 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:56:46.852529 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:56:46.852529 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:56:47.102855 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 08:56:47.102855 (Thread-1): finished collecting timing info
2021-10-08 08:56:47.102855 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 08:56:47.408736 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e6c603-aeb9-42e7-8390-145de167277f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021376266640>]}
2021-10-08 08:56:47.408736 (Thread-1): 10:56:47 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 2.89s]
2021-10-08 08:56:47.410077 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 08:56:47.410077 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:56:47.410077 (Thread-1): 10:56:47 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 08:56:47.410077 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:56:47.410077 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:56:47.413246 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 08:56:47.415248 (Thread-1): finished collecting timing info
2021-10-08 08:56:47.417335 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 08:56:47.419246 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:56:47.419246 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 08:56:47.419246 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:56:48.389350 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-08 08:56:48.389350 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:56:48.389350 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
where id = 1
      );
2021-10-08 08:56:49.464645 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-10-08 08:56:49.464645 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 08:56:49.464645 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:56:49.464645 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 08:56:49.627315 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:56:49.628146 (Thread-1): finished collecting timing info
2021-10-08 08:56:49.628146 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 08:56:49.924895 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e6c603-aeb9-42e7-8390-145de167277f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213762F34C0>]}
2021-10-08 08:56:49.924895 (Thread-1): 10:56:49 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.51s]
2021-10-08 08:56:49.925856 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:56:49.926857 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:56:49.926857 (MainThread): Using snowflake connection "master".
2021-10-08 08:56:49.926857 (MainThread): On master: BEGIN
2021-10-08 08:56:49.926857 (MainThread): Opening a new connection, currently in state closed
2021-10-08 08:56:50.703129 (MainThread): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 08:56:50.704131 (MainThread): On master: COMMIT
2021-10-08 08:56:50.704131 (MainThread): Using snowflake connection "master".
2021-10-08 08:56:50.704131 (MainThread): On master: COMMIT
2021-10-08 08:56:50.962902 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-08 08:56:50.963886 (MainThread): On master: Close
2021-10-08 08:56:51.258167 (MainThread): 10:56:51 | 
2021-10-08 08:56:51.258167 (MainThread): 10:56:51 | Finished running 4 table models, 2 incremental models in 21.83s.
2021-10-08 08:56:51.259167 (MainThread): Connection 'master' was properly closed.
2021-10-08 08:56:51.259167 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 08:56:51.259167 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 08:56:51.259167 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 08:56:51.272473 (MainThread): 
2021-10-08 08:56:51.272551 (MainThread): Completed successfully
2021-10-08 08:56:51.273117 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-08 08:56:51.273688 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021375E2A3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021375E2A610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021376266670>]}
2021-10-08 08:56:51.273688 (MainThread): Flushing usage events
2021-10-08 08:58:25.384847 (MainThread): Running with dbt=0.20.2
2021-10-08 08:58:25.981102 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 08:58:25.982103 (MainThread): Tracking: tracking
2021-10-08 08:58:25.982103 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F508C5CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50A1A43D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50A1A4EB0>]}
2021-10-08 08:58:25.990103 (MainThread): Partial parsing not enabled
2021-10-08 08:58:26.004103 (MainThread): Parsing macros\adapters.sql
2021-10-08 08:58:26.028125 (MainThread): Parsing macros\catalog.sql
2021-10-08 08:58:26.030130 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 08:58:26.038277 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 08:58:26.041268 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 08:58:26.043788 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 08:58:26.044790 (MainThread): Parsing macros\core.sql
2021-10-08 08:58:26.046788 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 08:58:26.079646 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 08:58:26.085638 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 08:58:26.086755 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 08:58:26.087834 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 08:58:26.088953 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 08:58:26.089976 (MainThread): Parsing macros\etc\query.sql
2021-10-08 08:58:26.090971 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 08:58:26.097961 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 08:58:26.102106 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 08:58:26.112194 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 08:58:26.114158 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 08:58:26.120116 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 08:58:26.134805 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 08:58:26.154924 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 08:58:26.155926 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 08:58:26.166199 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 08:58:26.171185 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 08:58:26.173194 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 08:58:26.178192 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 08:58:26.180886 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 08:58:26.181889 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 08:58:26.182835 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 08:58:26.298712 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:58:26.304937 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:58:26.310863 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:58:26.313882 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:58:26.313882 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:58:26.316862 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:58:26.319861 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:58:26.321860 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '85934eff-b187-4dd7-b22c-6e1fd2b6b171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50A2A5550>]}
2021-10-08 08:58:26.338956 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:58:26.340875 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:58:26.341803 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:58:26.342819 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:58:26.373436 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:58:26.374379 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:58:26.391492 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85934eff-b187-4dd7-b22c-6e1fd2b6b171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50A1F2FD0>]}
2021-10-08 08:58:26.410642 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 08:58:26.410642 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85934eff-b187-4dd7-b22c-6e1fd2b6b171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F508C5CD60>]}
2021-10-08 08:58:26.412252 (MainThread): Found 6 models, 6 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 08:58:26.413252 (MainThread): 
2021-10-08 08:58:26.414261 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:58:26.416042 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 08:58:26.428090 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 08:58:26.428090 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 08:58:26.428090 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 08:58:27.962893 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.53 seconds
2021-10-08 08:58:27.965931 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 08:58:28.276781 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 08:58:28.280788 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 08:58:28.280788 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 08:58:28.280788 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 08:58:29.318700 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.04 seconds
2021-10-08 08:58:29.319710 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 08:58:29.623903 (MainThread): Using snowflake connection "master".
2021-10-08 08:58:29.623903 (MainThread): On master: BEGIN
2021-10-08 08:58:29.623903 (MainThread): Opening a new connection, currently in state init
2021-10-08 08:58:30.491772 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-08 08:58:30.492276 (MainThread): On master: COMMIT
2021-10-08 08:58:30.492564 (MainThread): Using snowflake connection "master".
2021-10-08 08:58:30.492564 (MainThread): On master: COMMIT
2021-10-08 08:58:30.731013 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-08 08:58:30.731013 (MainThread): On master: Close
2021-10-08 08:58:31.026733 (MainThread): 10:58:31 | Concurrency: 1 threads (target='dev')
2021-10-08 08:58:31.026733 (MainThread): 10:58:31 | 
2021-10-08 08:58:31.031651 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:58:31.031651 (Thread-1): 10:58:31 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 08:58:31.032779 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:58:31.032779 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:58:31.035791 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 08:58:31.042680 (Thread-1): finished collecting timing info
2021-10-08 08:58:31.062862 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 08:58:31.065639 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:58:31.065639 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 08:58:31.065639 (Thread-1): Opening a new connection, currently in state init
2021-10-08 08:58:31.856278 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 08:58:31.856440 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:58:31.856498 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 08:58:33.031523 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2021-10-08 08:58:33.032760 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 08:58:33.032876 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:58:33.032876 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 08:58:33.212605 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:58:33.218603 (Thread-1): finished collecting timing info
2021-10-08 08:58:33.219604 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 08:58:33.505107 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85934eff-b187-4dd7-b22c-6e1fd2b6b171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50A17C4F0>]}
2021-10-08 08:58:33.506101 (Thread-1): 10:58:33 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.47s]
2021-10-08 08:58:33.507135 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:58:33.507135 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:58:33.507396 (Thread-1): 10:58:33 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 08:58:33.507396 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:58:33.507396 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:58:33.508445 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:58:33.514674 (Thread-1): finished collecting timing info
2021-10-08 08:58:33.517065 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:58:33.518937 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:58:33.518937 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 08:58:33.518937 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:58:34.300502 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 08:58:34.300902 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:58:34.300902 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 08:58:35.707978 (Thread-1): SQL status: SUCCESS 1 in 1.41 seconds
2021-10-08 08:58:35.708990 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:58:35.709988 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:58:35.709988 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:58:35.878294 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:58:35.878839 (Thread-1): finished collecting timing info
2021-10-08 08:58:35.878839 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 08:58:36.168672 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85934eff-b187-4dd7-b22c-6e1fd2b6b171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50A2249D0>]}
2021-10-08 08:58:36.169653 (Thread-1): 10:58:36 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.66s]
2021-10-08 08:58:36.170576 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:58:36.171576 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:58:36.171576 (Thread-1): 10:58:36 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 08:58:36.172576 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:58:36.172576 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 08:58:36.178359 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:58:36.180588 (Thread-1): finished collecting timing info
2021-10-08 08:58:36.201714 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:58:36.201714 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 08:58:36.201714 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:58:37.519361 (Thread-1): SQL status: SUCCESS 1 in 1.32 seconds
2021-10-08 08:58:37.525405 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:58:37.525405 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 08:58:37.698972 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:58:37.700983 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:58:37.700983 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:58:37.873069 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:58:37.875195 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:58:37.875195 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:58:38.038553 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:58:38.048058 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:58:38.053972 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:58:38.053972 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 08:58:38.251799 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 08:58:38.251799 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:58:38.251799 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 08:58:38.664404 (Thread-1): SQL status: SUCCESS 0 in 0.41 seconds
2021-10-08 08:58:38.665409 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:58:38.665409 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:58:38.665409 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:58:38.981975 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-08 08:58:38.983057 (Thread-1): finished collecting timing info
2021-10-08 08:58:38.983057 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 08:58:39.308006 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85934eff-b187-4dd7-b22c-6e1fd2b6b171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50A494850>]}
2021-10-08 08:58:39.309000 (Thread-1): 10:58:39 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.14s]
2021-10-08 08:58:39.310001 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:58:39.310001 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:58:39.310001 (Thread-1): 10:58:39 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 08:58:39.310001 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:58:39.310001 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:58:39.310999 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:58:39.315405 (Thread-1): finished collecting timing info
2021-10-08 08:58:39.316405 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:58:39.318822 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:58:39.318822 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 08:58:39.318822 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:58:40.352050 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-10-08 08:58:40.353065 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:58:40.353065 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 08:58:41.787850 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2021-10-08 08:58:41.788850 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:58:41.788850 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:58:41.788850 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:58:41.949689 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:58:41.950719 (Thread-1): finished collecting timing info
2021-10-08 08:58:41.950719 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 08:58:42.244821 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85934eff-b187-4dd7-b22c-6e1fd2b6b171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50A5BAB80>]}
2021-10-08 08:58:42.245323 (Thread-1): 10:58:42 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.93s]
2021-10-08 08:58:42.246207 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:58:42.246377 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 08:58:42.246621 (Thread-1): 10:58:42 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 08:58:42.246621 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:58:42.246621 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 08:58:42.249404 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:58:42.250403 (Thread-1): finished collecting timing info
2021-10-08 08:58:42.252402 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:58:42.252402 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 08:58:42.252402 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:58:43.473196 (Thread-1): SQL status: SUCCESS 1 in 1.22 seconds
2021-10-08 08:58:43.476194 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:58:43.476194 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 08:58:43.672020 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 08:58:43.673781 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:58:43.673781 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:58:43.832560 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:58:43.833649 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:58:43.834654 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:58:44.000130 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:58:44.002136 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:58:44.005057 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:58:44.006219 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 08:58:44.212215 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-08 08:58:44.213296 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:58:44.213296 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 08:58:44.602307 (Thread-1): SQL status: SUCCESS 0 in 0.39 seconds
2021-10-08 08:58:44.603306 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:58:44.603306 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:58:44.603306 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:58:44.968965 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-10-08 08:58:44.969968 (Thread-1): finished collecting timing info
2021-10-08 08:58:44.969968 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 08:58:45.277311 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85934eff-b187-4dd7-b22c-6e1fd2b6b171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50A45EDC0>]}
2021-10-08 08:58:45.277311 (Thread-1): 10:58:45 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.03s]
2021-10-08 08:58:45.279652 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 08:58:45.279652 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:58:45.279652 (Thread-1): 10:58:45 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 08:58:45.280646 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:58:45.280646 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:58:45.282720 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 08:58:45.284383 (Thread-1): finished collecting timing info
2021-10-08 08:58:45.286405 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 08:58:45.287381 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:58:45.287381 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 08:58:45.287381 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:58:46.118635 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-08 08:58:46.118635 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:58:46.119734 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
where id = 1
      );
2021-10-08 08:58:47.123371 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-08 08:58:47.124409 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 08:58:47.124409 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:58:47.124409 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 08:58:47.292525 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:58:47.293523 (Thread-1): finished collecting timing info
2021-10-08 08:58:47.293523 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 08:58:47.652931 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85934eff-b187-4dd7-b22c-6e1fd2b6b171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50A210AF0>]}
2021-10-08 08:58:47.653029 (Thread-1): 10:58:47 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.37s]
2021-10-08 08:58:47.653806 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:58:47.654649 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:58:47.654940 (MainThread): Using snowflake connection "master".
2021-10-08 08:58:47.654940 (MainThread): On master: BEGIN
2021-10-08 08:58:47.654940 (MainThread): Opening a new connection, currently in state closed
2021-10-08 08:58:48.500769 (MainThread): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-08 08:58:48.501781 (MainThread): On master: COMMIT
2021-10-08 08:58:48.501781 (MainThread): Using snowflake connection "master".
2021-10-08 08:58:48.501781 (MainThread): On master: COMMIT
2021-10-08 08:58:48.749145 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 08:58:48.749145 (MainThread): On master: Close
2021-10-08 08:58:49.048742 (MainThread): 10:58:49 | 
2021-10-08 08:58:49.048742 (MainThread): 10:58:49 | Finished running 4 table models, 2 incremental models in 22.64s.
2021-10-08 08:58:49.049667 (MainThread): Connection 'master' was properly closed.
2021-10-08 08:58:49.049667 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 08:58:49.049667 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 08:58:49.049667 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 08:58:49.063664 (MainThread): 
2021-10-08 08:58:49.063664 (MainThread): Completed successfully
2021-10-08 08:58:49.064666 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-08 08:58:49.064666 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50A2A5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50A5874F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F50A587B20>]}
2021-10-08 08:58:49.064666 (MainThread): Flushing usage events
2021-10-08 08:59:10.753090 (MainThread): Running with dbt=0.20.2
2021-10-08 08:59:11.343549 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-10-08 08:59:11.344539 (MainThread): Tracking: tracking
2021-10-08 08:59:11.344539 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A448FCCDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A44A4FA340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A44A4FA400>]}
2021-10-08 08:59:11.350536 (MainThread): Partial parsing not enabled
2021-10-08 08:59:11.367964 (MainThread): Parsing macros\adapters.sql
2021-10-08 08:59:11.392105 (MainThread): Parsing macros\catalog.sql
2021-10-08 08:59:11.394105 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 08:59:11.401330 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 08:59:11.402309 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 08:59:11.405328 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 08:59:11.406327 (MainThread): Parsing macros\core.sql
2021-10-08 08:59:11.409331 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 08:59:11.442729 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 08:59:11.450034 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 08:59:11.450034 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 08:59:11.451072 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 08:59:11.453073 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 08:59:11.454041 (MainThread): Parsing macros\etc\query.sql
2021-10-08 08:59:11.454041 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 08:59:11.461071 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 08:59:11.465070 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 08:59:11.473070 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 08:59:11.474029 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 08:59:11.480342 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 08:59:11.497028 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 08:59:11.520226 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 08:59:11.521718 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 08:59:11.535795 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 08:59:11.541715 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 08:59:11.545802 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 08:59:11.549802 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 08:59:11.551714 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 08:59:11.552804 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 08:59:11.553715 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 08:59:11.680091 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:59:11.686183 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:59:11.692174 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:59:11.694340 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:59:11.695070 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:59:11.697271 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:59:11.699353 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:59:11.722340 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:59:11.724309 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:59:11.726843 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:59:11.727344 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:59:11.729347 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:59:11.760385 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:59:11.777194 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa2fcdec-2068-4906-9e22-6c2d33ac6761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A44A617430>]}
2021-10-08 08:59:11.802282 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 08:59:11.802282 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa2fcdec-2068-4906-9e22-6c2d33ac6761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A44A617C40>]}
2021-10-08 08:59:11.803283 (MainThread): Found 6 models, 6 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 08:59:11.804183 (MainThread): 
2021-10-08 08:59:11.804183 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:59:11.806260 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 08:59:11.819464 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 08:59:11.819464 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 08:59:11.819963 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 08:59:13.094442 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.27 seconds
2021-10-08 08:59:13.097528 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 08:59:13.402309 (MainThread): 10:59:13 | Concurrency: 1 threads (target='dev')
2021-10-08 08:59:13.403313 (MainThread): 10:59:13 | 
2021-10-08 08:59:13.405283 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 08:59:13.405283 (Thread-1): 10:59:13 | 1 of 6 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-10-08 08:59:13.405283 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 08:59:13.405283 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 08:59:13.415277 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 08:59:13.417303 (Thread-1): finished collecting timing info
2021-10-08 08:59:13.431596 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 08:59:13.434761 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 08:59:13.435337 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: BEGIN
2021-10-08 08:59:13.435337 (Thread-1): Opening a new connection, currently in state init
2021-10-08 08:59:14.432327 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-08 08:59:14.432327 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 08:59:14.433328 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.first_model
where id is null



      
    ) dbt_internal_test
2021-10-08 08:59:14.828348 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-10-08 08:59:14.829452 (Thread-1): finished collecting timing info
2021-10-08 08:59:14.829452 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: ROLLBACK
2021-10-08 08:59:15.097782 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: Close
2021-10-08 08:59:15.398986 (Thread-1): 10:59:15 | 1 of 6 PASS not_null_my_first_dbt_model_id........................... [PASS in 1.99s]
2021-10-08 08:59:15.399811 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 08:59:15.399811 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 08:59:15.400276 (Thread-1): 10:59:15 | 2 of 6 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-10-08 08:59:15.400738 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 08:59:15.400738 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 08:59:15.406705 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 08:59:15.411863 (Thread-1): finished collecting timing info
2021-10-08 08:59:15.417086 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 08:59:15.434376 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 08:59:15.434376 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: BEGIN
2021-10-08 08:59:15.435395 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:59:16.214222 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 08:59:16.215224 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 08:59:16.215224 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
2021-10-08 08:59:16.535118 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-08 08:59:16.536118 (Thread-1): finished collecting timing info
2021-10-08 08:59:16.536118 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: ROLLBACK
2021-10-08 08:59:16.770827 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-10-08 08:59:17.095612 (Thread-1): 10:59:17 | 2 of 6 PASS not_null_my_second_dbt_model_id.......................... [PASS in 1.70s]
2021-10-08 08:59:17.096525 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 08:59:17.096525 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 08:59:17.096525 (Thread-1): 10:59:17 | 3 of 6 START test not_null_snowflake_customer_purchases_c_custkey.... [RUN]
2021-10-08 08:59:17.097525 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 08:59:17.097525 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 08:59:17.099526 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 08:59:17.104523 (Thread-1): finished collecting timing info
2021-10-08 08:59:17.105523 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 08:59:17.112658 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 08:59:17.113159 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: BEGIN
2021-10-08 08:59:17.113296 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:59:17.886947 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-08 08:59:17.886947 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 08:59:17.886947 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.snowflake_customer_purchases
where c_custkey is null



      
    ) dbt_internal_test
2021-10-08 08:59:18.252894 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-10-08 08:59:18.253915 (Thread-1): finished collecting timing info
2021-10-08 08:59:18.253915 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: ROLLBACK
2021-10-08 08:59:18.481865 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: Close
2021-10-08 08:59:18.825625 (Thread-1): 10:59:18 | 3 of 6 PASS not_null_snowflake_customer_purchases_c_custkey.......... [PASS in 1.73s]
2021-10-08 08:59:18.826650 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 08:59:18.826650 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 08:59:18.827623 (Thread-1): 10:59:18 | 4 of 6 START test unique_my_first_dbt_model_id....................... [RUN]
2021-10-08 08:59:18.827623 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 08:59:18.828625 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 08:59:18.833825 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 08:59:18.836600 (Thread-1): finished collecting timing info
2021-10-08 08:59:18.837657 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 08:59:18.840670 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 08:59:18.840670 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: BEGIN
2021-10-08 08:59:18.840670 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:59:19.625869 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 08:59:19.625869 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 08:59:19.625869 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.first_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 08:59:19.894461 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 08:59:19.894635 (Thread-1): finished collecting timing info
2021-10-08 08:59:19.895147 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: ROLLBACK
2021-10-08 08:59:20.200103 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-08 08:59:20.506884 (Thread-1): 10:59:20 | 4 of 6 PASS unique_my_first_dbt_model_id............................. [PASS in 1.68s]
2021-10-08 08:59:20.508519 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 08:59:20.508519 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 08:59:20.508519 (Thread-1): 10:59:20 | 5 of 6 START test unique_my_second_dbt_model_id...................... [RUN]
2021-10-08 08:59:20.508519 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 08:59:20.508519 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 08:59:20.511530 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 08:59:20.514085 (Thread-1): finished collecting timing info
2021-10-08 08:59:20.515497 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 08:59:20.518023 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 08:59:20.518140 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: BEGIN
2021-10-08 08:59:20.518229 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:59:21.280110 (Thread-1): SQL status: SUCCESS 1 in 0.76 seconds
2021-10-08 08:59:21.281110 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 08:59:21.281110 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 08:59:21.826388 (Thread-1): SQL status: SUCCESS 1 in 0.55 seconds
2021-10-08 08:59:21.827194 (Thread-1): finished collecting timing info
2021-10-08 08:59:21.827194 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: ROLLBACK
2021-10-08 08:59:22.109836 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: Close
2021-10-08 08:59:22.412801 (Thread-1): 10:59:22 | 5 of 6 PASS unique_my_second_dbt_model_id............................ [PASS in 1.90s]
2021-10-08 08:59:22.412801 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 08:59:22.413796 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 08:59:22.413796 (Thread-1): 10:59:22 | 6 of 6 START test unique_snowflake_customer_purchases_c_custkey...... [RUN]
2021-10-08 08:59:22.414802 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 08:59:22.414802 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 08:59:22.417798 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 08:59:22.423301 (Thread-1): finished collecting timing info
2021-10-08 08:59:22.424376 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 08:59:22.426101 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 08:59:22.426101 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: BEGIN
2021-10-08 08:59:22.426101 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:59:23.443881 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-08 08:59:23.443881 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 08:59:23.443881 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.snowflake_customer_purchases
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 08:59:23.808870 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-08 08:59:23.809398 (Thread-1): finished collecting timing info
2021-10-08 08:59:23.809398 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: ROLLBACK
2021-10-08 08:59:24.054593 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: Close
2021-10-08 08:59:24.343787 (Thread-1): 10:59:24 | 6 of 6 PASS unique_snowflake_customer_purchases_c_custkey............ [PASS in 1.93s]
2021-10-08 08:59:24.344830 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 08:59:24.346799 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:59:24.346799 (MainThread): 10:59:24 | 
2021-10-08 08:59:24.346799 (MainThread): 10:59:24 | Finished running 6 tests in 12.54s.
2021-10-08 08:59:24.346799 (MainThread): Connection 'master' was properly closed.
2021-10-08 08:59:24.346799 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 08:59:24.347781 (MainThread): Connection 'test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8' was properly closed.
2021-10-08 08:59:24.361893 (MainThread): 
2021-10-08 08:59:24.361893 (MainThread): Completed successfully
2021-10-08 08:59:24.363424 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-08 08:59:24.363424 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A44A97BFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A44A563F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A44A9441F0>]}
2021-10-08 08:59:24.363424 (MainThread): Flushing usage events
2021-10-08 08:59:32.236324 (MainThread): Running with dbt=0.20.2
2021-10-08 08:59:32.939617 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 08:59:32.940618 (MainThread): Tracking: tracking
2021-10-08 08:59:32.940618 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9D3E4CCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9D5395C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9D5395EB0>]}
2021-10-08 08:59:32.951448 (MainThread): Partial parsing not enabled
2021-10-08 08:59:32.967816 (MainThread): Parsing macros\adapters.sql
2021-10-08 08:59:32.990105 (MainThread): Parsing macros\catalog.sql
2021-10-08 08:59:32.992272 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 08:59:33.001770 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 08:59:33.005132 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 08:59:33.008641 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 08:59:33.010637 (MainThread): Parsing macros\core.sql
2021-10-08 08:59:33.014637 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 08:59:33.062869 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 08:59:33.071558 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 08:59:33.072559 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 08:59:33.073558 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 08:59:33.075542 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 08:59:33.077559 (MainThread): Parsing macros\etc\query.sql
2021-10-08 08:59:33.078558 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 08:59:33.087219 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 08:59:33.092222 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 08:59:33.102240 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 08:59:33.104299 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 08:59:33.109350 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 08:59:33.125486 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 08:59:33.148264 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 08:59:33.149263 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 08:59:33.162341 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 08:59:33.167356 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 08:59:33.171346 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 08:59:33.176597 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 08:59:33.177642 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 08:59:33.178596 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 08:59:33.179683 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 08:59:33.314887 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:59:33.321886 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:59:33.328247 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:59:33.330417 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:59:33.331416 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:59:33.334417 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:59:33.335417 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:59:33.359419 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:59:33.361971 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:59:33.362964 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:59:33.364964 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:59:33.365963 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:59:33.406038 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 08:59:33.421612 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0401d85e-36f1-4ca9-98c4-516380fef258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9D548E640>]}
2021-10-08 08:59:33.450131 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 08:59:33.450131 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0401d85e-36f1-4ca9-98c4-516380fef258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9D548EB20>]}
2021-10-08 08:59:33.450131 (MainThread): Found 6 models, 6 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 08:59:33.451401 (MainThread): 
2021-10-08 08:59:33.451401 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:59:33.453536 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 08:59:33.464877 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 08:59:33.464877 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 08:59:33.464877 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 08:59:34.852419 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.39 seconds
2021-10-08 08:59:34.858492 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 08:59:35.154125 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 08:59:35.160139 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 08:59:35.160139 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 08:59:35.160139 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 08:59:36.121795 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.96 seconds
2021-10-08 08:59:36.122782 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 08:59:36.532089 (MainThread): Using snowflake connection "master".
2021-10-08 08:59:36.532089 (MainThread): On master: BEGIN
2021-10-08 08:59:36.532089 (MainThread): Opening a new connection, currently in state init
2021-10-08 08:59:37.402922 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-08 08:59:37.403955 (MainThread): On master: COMMIT
2021-10-08 08:59:37.403955 (MainThread): Using snowflake connection "master".
2021-10-08 08:59:37.403955 (MainThread): On master: COMMIT
2021-10-08 08:59:37.655158 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 08:59:37.655158 (MainThread): On master: Close
2021-10-08 08:59:37.998768 (MainThread): 10:59:37 | Concurrency: 1 threads (target='dev')
2021-10-08 08:59:37.998768 (MainThread): 10:59:37 | 
2021-10-08 08:59:37.999768 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:59:38.000768 (Thread-1): 10:59:38 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 08:59:38.000768 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:59:38.000768 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:59:38.002786 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 08:59:38.004791 (Thread-1): finished collecting timing info
2021-10-08 08:59:38.027835 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 08:59:38.029583 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:59:38.030607 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 08:59:38.030607 (Thread-1): Opening a new connection, currently in state init
2021-10-08 08:59:38.976847 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-10-08 08:59:38.976847 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:59:38.976847 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null
union all
select 1 as id

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 08:59:40.084851 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2021-10-08 08:59:40.084851 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 08:59:40.086005 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 08:59:40.086005 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 08:59:40.287937 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 08:59:40.299040 (Thread-1): finished collecting timing info
2021-10-08 08:59:40.299040 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 08:59:40.589011 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0401d85e-36f1-4ca9-98c4-516380fef258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9D568C580>]}
2021-10-08 08:59:40.589989 (Thread-1): 10:59:40 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.59s]
2021-10-08 08:59:40.591050 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 08:59:40.591050 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:59:40.591050 (Thread-1): 10:59:40 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 08:59:40.591050 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:59:40.591050 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:59:40.593398 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:59:40.598696 (Thread-1): finished collecting timing info
2021-10-08 08:59:40.600696 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 08:59:40.603298 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:59:40.603298 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 08:59:40.603298 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:59:41.455132 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-08 08:59:41.455132 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:59:41.455132 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 08:59:42.957368 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-10-08 08:59:42.958369 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:59:42.958369 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 08:59:42.958369 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 08:59:43.118338 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:59:43.118338 (Thread-1): finished collecting timing info
2021-10-08 08:59:43.118338 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 08:59:43.407973 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0401d85e-36f1-4ca9-98c4-516380fef258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9D53E38E0>]}
2021-10-08 08:59:43.407973 (Thread-1): 10:59:43 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.82s]
2021-10-08 08:59:43.409685 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 08:59:43.409685 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:59:43.409685 (Thread-1): 10:59:43 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 08:59:43.410706 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:59:43.410706 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 08:59:43.414795 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:59:43.417383 (Thread-1): finished collecting timing info
2021-10-08 08:59:43.438771 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:59:43.438867 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 08:59:43.439006 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:59:44.666640 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-10-08 08:59:44.674469 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:59:44.674469 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 08:59:44.868948 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 08:59:44.872442 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:59:44.872442 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:59:45.033926 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:59:45.035946 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:59:45.035946 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 08:59:45.193443 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:59:45.202133 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 08:59:45.204251 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:59:45.204251 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 08:59:45.380369 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:59:45.380369 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:59:45.380369 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 08:59:45.736924 (Thread-1): SQL status: SUCCESS 0 in 0.36 seconds
2021-10-08 08:59:45.737866 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:59:45.738867 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 08:59:45.738867 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 08:59:45.969153 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-08 08:59:45.970181 (Thread-1): finished collecting timing info
2021-10-08 08:59:45.970181 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 08:59:46.295091 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0401d85e-36f1-4ca9-98c4-516380fef258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9D56AB4F0>]}
2021-10-08 08:59:46.295091 (Thread-1): 10:59:46 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 2.88s]
2021-10-08 08:59:46.296592 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 08:59:46.296592 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:59:46.296592 (Thread-1): 10:59:46 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 08:59:46.297624 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:59:46.297624 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:59:46.298633 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:59:46.305134 (Thread-1): finished collecting timing info
2021-10-08 08:59:46.307134 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 08:59:46.314236 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:59:46.314236 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 08:59:46.314236 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:59:47.095044 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 08:59:47.095044 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:59:47.095044 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 08:59:48.541692 (Thread-1): SQL status: SUCCESS 1 in 1.45 seconds
2021-10-08 08:59:48.542728 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:59:48.542728 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 08:59:48.542728 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 08:59:48.704857 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:59:48.705051 (Thread-1): finished collecting timing info
2021-10-08 08:59:48.706060 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 08:59:49.022011 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0401d85e-36f1-4ca9-98c4-516380fef258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9D56ABD90>]}
2021-10-08 08:59:49.022011 (Thread-1): 10:59:49 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.72s]
2021-10-08 08:59:49.023007 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 08:59:49.023007 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 08:59:49.023007 (Thread-1): 10:59:49 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 08:59:49.023565 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:59:49.024592 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 08:59:49.026592 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:59:49.028670 (Thread-1): finished collecting timing info
2021-10-08 08:59:49.032591 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:59:49.032591 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 08:59:49.032591 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:59:50.552354 (Thread-1): SQL status: SUCCESS 1 in 1.52 seconds
2021-10-08 08:59:50.554430 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:59:50.554430 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 08:59:50.720751 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 08:59:50.723087 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:59:50.724077 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:59:50.879869 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:59:50.880941 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:59:50.880941 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 08:59:51.043901 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 08:59:51.045132 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 08:59:51.047499 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:59:51.047499 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 08:59:51.232584 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 08:59:51.233578 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:59:51.233578 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 08:59:51.536379 (Thread-1): SQL status: SUCCESS 0 in 0.30 seconds
2021-10-08 08:59:51.537377 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:59:51.537377 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 08:59:51.537377 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 08:59:51.819613 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-08 08:59:51.820612 (Thread-1): finished collecting timing info
2021-10-08 08:59:51.820612 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 08:59:52.133172 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0401d85e-36f1-4ca9-98c4-516380fef258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9D547C460>]}
2021-10-08 08:59:52.133172 (Thread-1): 10:59:52 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.11s]
2021-10-08 08:59:52.134169 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 08:59:52.134169 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:59:52.134169 (Thread-1): 10:59:52 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 08:59:52.134169 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:59:52.134169 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:59:52.138172 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 08:59:52.139192 (Thread-1): finished collecting timing info
2021-10-08 08:59:52.141193 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 08:59:52.142725 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:59:52.142725 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 08:59:52.142725 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 08:59:52.924138 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 08:59:52.924138 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:59:52.924138 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
where id = 1
      );
2021-10-08 08:59:54.168072 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-10-08 08:59:54.170073 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 08:59:54.171258 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 08:59:54.171258 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 08:59:54.346636 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 08:59:54.348184 (Thread-1): finished collecting timing info
2021-10-08 08:59:54.348184 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 08:59:54.641961 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0401d85e-36f1-4ca9-98c4-516380fef258', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9D566CBB0>]}
2021-10-08 08:59:54.641961 (Thread-1): 10:59:54 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.51s]
2021-10-08 08:59:54.641961 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 08:59:54.642962 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 08:59:54.642962 (MainThread): Using snowflake connection "master".
2021-10-08 08:59:54.642962 (MainThread): On master: BEGIN
2021-10-08 08:59:54.642962 (MainThread): Opening a new connection, currently in state closed
2021-10-08 08:59:55.516235 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-08 08:59:55.516235 (MainThread): On master: COMMIT
2021-10-08 08:59:55.516235 (MainThread): Using snowflake connection "master".
2021-10-08 08:59:55.516235 (MainThread): On master: COMMIT
2021-10-08 08:59:55.806883 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-08 08:59:55.806883 (MainThread): On master: Close
2021-10-08 08:59:56.095110 (MainThread): 10:59:56 | 
2021-10-08 08:59:56.096000 (MainThread): 10:59:56 | Finished running 4 table models, 2 incremental models in 22.64s.
2021-10-08 08:59:56.096000 (MainThread): Connection 'master' was properly closed.
2021-10-08 08:59:56.096000 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 08:59:56.096000 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 08:59:56.096000 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 08:59:56.113953 (MainThread): 
2021-10-08 08:59:56.113953 (MainThread): Completed successfully
2021-10-08 08:59:56.114864 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-08 08:59:56.115902 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9D54FDD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9D54FD760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9D54FD1C0>]}
2021-10-08 08:59:56.116032 (MainThread): Flushing usage events
2021-10-08 09:00:06.775466 (MainThread): Running with dbt=0.20.2
2021-10-08 09:00:07.389505 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-10-08 09:00:07.389505 (MainThread): Tracking: tracking
2021-10-08 09:00:07.389505 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F64E9CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F663CA340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F663CA4F0>]}
2021-10-08 09:00:07.396490 (MainThread): Partial parsing not enabled
2021-10-08 09:00:07.409490 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:00:07.428808 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:00:07.430078 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:00:07.436167 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:00:07.438182 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:00:07.440179 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:00:07.441176 (MainThread): Parsing macros\core.sql
2021-10-08 09:00:07.444095 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:00:07.478423 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:00:07.486498 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:00:07.487455 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:00:07.488495 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:00:07.489497 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:00:07.490506 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:00:07.491884 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:00:07.498990 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:00:07.503985 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:00:07.514277 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:00:07.515287 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:00:07.521276 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:00:07.537302 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:00:07.559350 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:00:07.560369 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:00:07.573619 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:00:07.578618 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:00:07.581618 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:00:07.587244 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:00:07.588289 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:00:07.589326 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:00:07.590325 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:00:07.721671 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:00:07.728953 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:00:07.734015 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:00:07.736179 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:00:07.737132 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:00:07.739470 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:00:07.741472 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:00:07.765089 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:00:07.768091 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:00:07.769771 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:00:07.770865 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:00:07.771870 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:00:07.801800 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:00:07.819575 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4175e370-aaf7-47fa-a47a-ecc494b8e7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F664D8430>]}
2021-10-08 09:00:07.844855 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:00:07.844855 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4175e370-aaf7-47fa-a47a-ecc494b8e7e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F664D8E20>]}
2021-10-08 09:00:07.845882 (MainThread): Found 6 models, 6 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:00:07.847063 (MainThread): 
2021-10-08 09:00:07.847063 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:00:07.849376 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:00:07.862930 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:00:07.863045 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:00:07.863249 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:00:09.128731 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.27 seconds
2021-10-08 09:00:09.130764 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:00:09.423358 (MainThread): 11:00:09 | Concurrency: 1 threads (target='dev')
2021-10-08 09:00:09.424446 (MainThread): 11:00:09 | 
2021-10-08 09:00:09.427786 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 09:00:09.428856 (Thread-1): 11:00:09 | 1 of 6 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-10-08 09:00:09.428856 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 09:00:09.428856 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 09:00:09.435389 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 09:00:09.437313 (Thread-1): finished collecting timing info
2021-10-08 09:00:09.447714 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 09:00:09.449627 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 09:00:09.449627 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: BEGIN
2021-10-08 09:00:09.449627 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:00:10.400864 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-10-08 09:00:10.400864 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 09:00:10.400864 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.first_model
where id is null



      
    ) dbt_internal_test
2021-10-08 09:00:10.668788 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 09:00:10.671870 (Thread-1): finished collecting timing info
2021-10-08 09:00:10.671870 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: ROLLBACK
2021-10-08 09:00:10.957971 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: Close
2021-10-08 09:00:11.355438 (Thread-1): 11:00:11 | 1 of 6 PASS not_null_my_first_dbt_model_id........................... [PASS in 1.93s]
2021-10-08 09:00:11.356440 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 09:00:11.356440 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:00:11.357436 (Thread-1): 11:00:11 | 2 of 6 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-10-08 09:00:11.357436 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:00:11.357436 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:00:11.360436 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 09:00:11.362479 (Thread-1): finished collecting timing info
2021-10-08 09:00:11.363436 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 09:00:11.366477 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:00:11.366987 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: BEGIN
2021-10-08 09:00:11.366987 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:00:12.158849 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 09:00:12.158849 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:00:12.158849 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
2021-10-08 09:00:12.485140 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-08 09:00:12.485140 (Thread-1): finished collecting timing info
2021-10-08 09:00:12.485140 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: ROLLBACK
2021-10-08 09:00:12.734202 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-10-08 09:00:13.041196 (Thread-1): 11:00:13 | 2 of 6 PASS not_null_my_second_dbt_model_id.......................... [PASS in 1.68s]
2021-10-08 09:00:13.043345 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:00:13.043345 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:00:13.043345 (Thread-1): 11:00:13 | 3 of 6 START test not_null_snowflake_customer_purchases_c_custkey.... [RUN]
2021-10-08 09:00:13.044447 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:00:13.044447 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:00:13.049459 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 09:00:13.051459 (Thread-1): finished collecting timing info
2021-10-08 09:00:13.052460 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 09:00:13.054458 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:00:13.054458 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: BEGIN
2021-10-08 09:00:13.054458 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:00:13.833743 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 09:00:13.833743 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:00:13.833743 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.snowflake_customer_purchases
where c_custkey is null



      
    ) dbt_internal_test
2021-10-08 09:00:14.164990 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-08 09:00:14.165991 (Thread-1): finished collecting timing info
2021-10-08 09:00:14.165991 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: ROLLBACK
2021-10-08 09:00:14.473921 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: Close
2021-10-08 09:00:14.769225 (Thread-1): 11:00:14 | 3 of 6 PASS not_null_snowflake_customer_purchases_c_custkey.......... [PASS in 1.72s]
2021-10-08 09:00:14.770155 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:00:14.770155 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:00:14.770155 (Thread-1): 11:00:14 | 4 of 6 START test unique_my_first_dbt_model_id....................... [RUN]
2021-10-08 09:00:14.771151 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:00:14.771151 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:00:14.777255 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 09:00:14.778942 (Thread-1): finished collecting timing info
2021-10-08 09:00:14.779880 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 09:00:14.781663 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:00:14.781663 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: BEGIN
2021-10-08 09:00:14.781663 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:00:15.595173 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-08 09:00:15.595173 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:00:15.596169 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.first_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:00:15.950396 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-10-08 09:00:15.951476 (Thread-1): finished collecting timing info
2021-10-08 09:00:15.951476 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: ROLLBACK
2021-10-08 09:00:16.238701 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-08 09:00:16.536859 (Thread-1): 11:00:16 | 4 of 6 FAIL 1 unique_my_first_dbt_model_id........................... [FAIL 1 in 1.77s]
2021-10-08 09:00:16.537863 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:00:16.538857 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:00:16.538857 (Thread-1): 11:00:16 | 5 of 6 START test unique_my_second_dbt_model_id...................... [RUN]
2021-10-08 09:00:16.538857 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:00:16.538857 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:00:16.541951 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 09:00:16.544249 (Thread-1): finished collecting timing info
2021-10-08 09:00:16.545249 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 09:00:16.547249 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:00:16.547249 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: BEGIN
2021-10-08 09:00:16.547249 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:00:17.336990 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 09:00:17.337865 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:00:17.337865 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:00:17.658662 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-08 09:00:17.659652 (Thread-1): finished collecting timing info
2021-10-08 09:00:17.659652 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: ROLLBACK
2021-10-08 09:00:17.890508 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: Close
2021-10-08 09:00:18.178058 (Thread-1): 11:00:18 | 5 of 6 FAIL 1 unique_my_second_dbt_model_id.......................... [FAIL 1 in 1.64s]
2021-10-08 09:00:18.180064 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:00:18.180064 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:00:18.180064 (Thread-1): 11:00:18 | 6 of 6 START test unique_snowflake_customer_purchases_c_custkey...... [RUN]
2021-10-08 09:00:18.181038 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:00:18.181038 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:00:18.185897 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 09:00:18.190861 (Thread-1): finished collecting timing info
2021-10-08 09:00:18.191815 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 09:00:18.194222 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:00:18.194222 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: BEGIN
2021-10-08 09:00:18.194222 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:00:18.996230 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-08 09:00:18.996438 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:00:18.996510 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.snowflake_customer_purchases
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:00:19.378361 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-10-08 09:00:19.379366 (Thread-1): finished collecting timing info
2021-10-08 09:00:19.379366 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: ROLLBACK
2021-10-08 09:00:19.622062 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: Close
2021-10-08 09:00:19.942499 (Thread-1): 11:00:19 | 6 of 6 PASS unique_snowflake_customer_purchases_c_custkey............ [PASS in 1.76s]
2021-10-08 09:00:19.944500 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:00:19.945498 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:00:19.946506 (MainThread): 11:00:19 | 
2021-10-08 09:00:19.946506 (MainThread): 11:00:19 | Finished running 6 tests in 12.10s.
2021-10-08 09:00:19.946506 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:00:19.946506 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:00:19.946506 (MainThread): Connection 'test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8' was properly closed.
2021-10-08 09:00:19.975086 (MainThread): 
2021-10-08 09:00:19.975702 (MainThread): Completed with 2 errors and 0 warnings:
2021-10-08 09:00:19.976706 (MainThread): 
2021-10-08 09:00:19.976706 (MainThread): Failure in test unique_my_first_dbt_model_id (models\example\schema.yml)
2021-10-08 09:00:19.976706 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-08 09:00:19.977708 (MainThread): 
2021-10-08 09:00:19.977708 (MainThread):   compiled SQL at target\compiled\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\unique_my_first_dbt_model_id.sql
2021-10-08 09:00:19.977708 (MainThread): 
2021-10-08 09:00:19.977708 (MainThread): Failure in test unique_my_second_dbt_model_id (models\example\schema.yml)
2021-10-08 09:00:19.979336 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-08 09:00:19.979336 (MainThread): 
2021-10-08 09:00:19.979336 (MainThread):   compiled SQL at target\compiled\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\unique_my_second_dbt_model_id.sql
2021-10-08 09:00:19.980342 (MainThread): 
Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
2021-10-08 09:00:19.980557 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6643F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6643FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F666DC7C0>]}
2021-10-08 09:00:19.980557 (MainThread): Flushing usage events
2021-10-08 09:02:36.573145 (MainThread): Running with dbt=0.20.2
2021-10-08 09:02:37.134805 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 09:02:37.135728 (MainThread): Tracking: tracking
2021-10-08 09:02:37.135728 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5B0E6DE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5B23B4F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5B23B46A0>]}
2021-10-08 09:02:37.141815 (MainThread): Partial parsing not enabled
2021-10-08 09:02:37.146204 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5B23B49A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5B239AF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5B239A850>]}
2021-10-08 09:02:37.146204 (MainThread): Flushing usage events
2021-10-08 09:02:37.791722 (MainThread): Encountered an error:
2021-10-08 09:02:37.792725 (MainThread): Compilation Error
  Error reading lukeclarke_learn_dbt: example\schema.yml - Runtime Error
    Syntax error near line 21
    ------------------------------
    18 |             tests:
    19 |                 - unique
    20 |                 - not_null
    21 |                 accepted_values:
    22 |                   values: [1, 2]
    23 |                   quote: false
    24 |                   # ensures to test numbers 1 & 2 and not strings
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 19, column 17
    did not find expected '-' indicator
      in "<unicode string>", line 21, column 17
2021-10-08 09:02:37.839746 (MainThread): Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\yaml\__init__.py", line 114, in load
    return loader.get_single_data()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml\_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml\_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 853, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block collection
  in "<unicode string>", line 19, column 17
did not find expected '-' indicator
  in "<unicode string>", line 21, column 17

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 106, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 21
  ------------------------------
  18 |             tests:
  19 |                 - unique
  20 |                 - not_null
  21 |                 accepted_values:
  22 |                   values: [1, 2]
  23 |                   quote: false
  24 |                   # ensures to test numbers 1 & 2 and not strings
  
  Raw Error:
  ------------------------------
  while parsing a block collection
    in "<unicode string>", line 19, column 17
  did not find expected '-' indicator
    in "<unicode string>", line 21, column 17

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 207, in load
    read_files(project, self.manifest.files, project_parser_files)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 137, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 92, in read_files_for_parser
    source_files = get_source_files(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 83, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 23, in load_source_file
    dfy = yaml_from_file(source_file)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 109, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading lukeclarke_learn_dbt: example\schema.yml - Runtime Error
    Syntax error near line 21
    ------------------------------
    18 |             tests:
    19 |                 - unique
    20 |                 - not_null
    21 |                 accepted_values:
    22 |                   values: [1, 2]
    23 |                   quote: false
    24 |                   # ensures to test numbers 1 & 2 and not strings
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 19, column 17
    did not find expected '-' indicator
      in "<unicode string>", line 21, column 17

2021-10-08 09:03:49.914400 (MainThread): Running with dbt=0.20.2
2021-10-08 09:03:50.483109 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 09:03:50.484109 (MainThread): Tracking: tracking
2021-10-08 09:03:50.484109 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBCE94DE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBCFE7ABB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBCFE7A520>]}
2021-10-08 09:03:50.490667 (MainThread): Partial parsing not enabled
2021-10-08 09:03:50.506329 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:03:50.537182 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:03:50.538182 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:03:50.545181 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:03:50.546846 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:03:50.549878 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:03:50.550861 (MainThread): Parsing macros\core.sql
2021-10-08 09:03:50.553877 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:03:50.582131 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:03:50.589131 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:03:50.589131 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:03:50.590132 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:03:50.592131 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:03:50.593264 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:03:50.593264 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:03:50.600312 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:03:50.605312 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:03:50.616516 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:03:50.617520 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:03:50.623570 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:03:50.638078 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:03:50.659455 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:03:50.660483 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:03:50.674448 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:03:50.679373 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:03:50.682449 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:03:50.687084 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:03:50.688088 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:03:50.689088 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:03:50.689088 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:03:50.811506 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:03:50.817581 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:03:50.822591 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:03:50.825588 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:03:50.825588 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:03:50.828608 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:03:50.829592 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:03:50.852423 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:03:50.854427 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:03:50.855650 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:03:50.856742 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:03:50.891683 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:03:50.892695 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:03:50.894690 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:03:50.911683 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0e39494-d87e-464d-aeec-660546ed8d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBCE94D970>]}
2021-10-08 09:03:50.943005 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:03:50.943005 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0e39494-d87e-464d-aeec-660546ed8d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBCFFC58E0>]}
2021-10-08 09:03:50.944071 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:03:50.945542 (MainThread): 
2021-10-08 09:03:50.945542 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:03:50.947669 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 09:03:50.957026 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 09:03:50.957026 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 09:03:50.957026 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 09:03:52.792299 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.83 seconds
2021-10-08 09:03:52.797316 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 09:03:53.090536 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:03:53.097463 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:03:53.098462 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:03:53.098462 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:03:53.906474 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.81 seconds
2021-10-08 09:03:53.908472 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:03:54.238406 (MainThread): Using snowflake connection "master".
2021-10-08 09:03:54.239564 (MainThread): On master: BEGIN
2021-10-08 09:03:54.239564 (MainThread): Opening a new connection, currently in state init
2021-10-08 09:03:55.250201 (MainThread): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-08 09:03:55.251309 (MainThread): On master: COMMIT
2021-10-08 09:03:55.251309 (MainThread): Using snowflake connection "master".
2021-10-08 09:03:55.251309 (MainThread): On master: COMMIT
2021-10-08 09:03:55.494486 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-08 09:03:55.494486 (MainThread): On master: Close
2021-10-08 09:03:55.784794 (MainThread): 11:03:55 | Concurrency: 1 threads (target='dev')
2021-10-08 09:03:55.785781 (MainThread): 11:03:55 | 
2021-10-08 09:03:55.789691 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:03:55.789691 (Thread-1): 11:03:55 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 09:03:55.790694 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:03:55.790694 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:03:55.793770 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:03:55.800460 (Thread-1): finished collecting timing info
2021-10-08 09:03:55.821553 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:03:55.832856 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:03:55.832856 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 09:03:55.832856 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:03:56.609738 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 09:03:56.609738 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:03:56.609738 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null
union all
select 3 as id

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 09:03:57.639122 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-10-08 09:03:57.640122 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:03:57.640122 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:03:57.640122 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:03:57.800110 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:03:57.806105 (Thread-1): finished collecting timing info
2021-10-08 09:03:57.806105 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 09:03:58.110040 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e39494-d87e-464d-aeec-660546ed8d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBCFEEEF10>]}
2021-10-08 09:03:58.110562 (Thread-1): 11:03:58 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.32s]
2021-10-08 09:03:58.111588 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:03:58.112579 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:03:58.112579 (Thread-1): 11:03:58 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 09:03:58.112579 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:03:58.112579 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:03:58.114576 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:03:58.119177 (Thread-1): finished collecting timing info
2021-10-08 09:03:58.121088 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:03:58.123085 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:03:58.123085 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 09:03:58.123085 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:03:58.986476 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-10-08 09:03:58.987090 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:03:58.987270 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 09:04:00.530239 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2021-10-08 09:04:00.532295 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:04:00.533295 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:04:00.533295 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:04:00.690061 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:04:00.692061 (Thread-1): finished collecting timing info
2021-10-08 09:04:00.692061 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 09:04:01.006576 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e39494-d87e-464d-aeec-660546ed8d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBCFF708E0>]}
2021-10-08 09:04:01.006877 (Thread-1): 11:04:01 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.89s]
2021-10-08 09:04:01.007672 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:04:01.007849 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:04:01.008131 (Thread-1): 11:04:01 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 09:04:01.008566 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:04:01.008566 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 09:04:01.012111 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:04:01.013902 (Thread-1): finished collecting timing info
2021-10-08 09:04:01.040289 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:04:01.041292 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 09:04:01.041292 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:04:02.431887 (Thread-1): SQL status: SUCCESS 1 in 1.39 seconds
2021-10-08 09:04:02.449712 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:04:02.449712 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 09:04:02.636395 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:04:02.641390 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:04:02.641390 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:04:02.794609 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-08 09:04:02.795653 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:04:02.796679 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:04:02.964562 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:04:02.975175 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:04:02.979912 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:04:02.979912 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 09:04:03.200707 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-08 09:04:03.201726 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:04:03.201726 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 09:04:03.583492 (Thread-1): SQL status: SUCCESS 0 in 0.38 seconds
2021-10-08 09:04:03.584494 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:04:03.585493 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:04:03.585688 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:04:03.864479 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-08 09:04:03.867148 (Thread-1): finished collecting timing info
2021-10-08 09:04:03.867148 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 09:04:04.194120 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e39494-d87e-464d-aeec-660546ed8d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBCFF70970>]}
2021-10-08 09:04:04.194623 (Thread-1): 11:04:04 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.19s]
2021-10-08 09:04:04.195429 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:04:04.195429 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:04:04.195928 (Thread-1): 11:04:04 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 09:04:04.196288 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:04:04.196288 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:04:04.197374 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:04:04.201723 (Thread-1): finished collecting timing info
2021-10-08 09:04:04.203638 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:04:04.204931 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:04:04.205938 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 09:04:04.205938 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:04:05.018231 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-08 09:04:05.018231 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:04:05.019279 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 09:04:06.458092 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-10-08 09:04:06.459090 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:04:06.460094 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:04:06.460094 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:04:06.730858 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 09:04:06.730858 (Thread-1): finished collecting timing info
2021-10-08 09:04:06.731896 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 09:04:07.039985 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e39494-d87e-464d-aeec-660546ed8d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBCFF709D0>]}
2021-10-08 09:04:07.039985 (Thread-1): 11:04:07 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.84s]
2021-10-08 09:04:07.040990 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:04:07.041986 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 09:04:07.041986 (Thread-1): 11:04:07 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 09:04:07.042996 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:04:07.042996 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 09:04:07.048369 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:04:07.050279 (Thread-1): finished collecting timing info
2021-10-08 09:04:07.056361 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:04:07.056361 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 09:04:07.057364 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:04:08.707679 (Thread-1): SQL status: SUCCESS 1 in 1.65 seconds
2021-10-08 09:04:08.708679 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:04:08.708679 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 09:04:08.893521 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:04:08.895598 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:04:08.895598 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:04:09.065153 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:04:09.069155 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:04:09.069155 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:04:09.255075 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:04:09.256075 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:04:09.257099 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:04:09.257099 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 09:04:09.452675 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 09:04:09.453800 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:04:09.453800 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 09:04:09.875590 (Thread-1): SQL status: SUCCESS 0 in 0.42 seconds
2021-10-08 09:04:09.876671 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:04:09.876671 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:04:09.876671 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:04:10.119322 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-08 09:04:10.120324 (Thread-1): finished collecting timing info
2021-10-08 09:04:10.120324 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 09:04:10.455586 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e39494-d87e-464d-aeec-660546ed8d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBD014E6D0>]}
2021-10-08 09:04:10.456583 (Thread-1): 11:04:10 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.41s]
2021-10-08 09:04:10.456583 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 09:04:10.457620 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:04:10.457620 (Thread-1): 11:04:10 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 09:04:10.458183 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:04:10.458183 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:04:10.460693 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:04:10.462848 (Thread-1): finished collecting timing info
2021-10-08 09:04:10.463859 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:04:10.467890 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:04:10.467890 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 09:04:10.467890 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:04:11.275954 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-08 09:04:11.275954 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:04:11.277048 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
where id = 1
      );
2021-10-08 09:04:12.625200 (Thread-1): SQL status: SUCCESS 1 in 1.35 seconds
2021-10-08 09:04:12.625200 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:04:12.626200 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:04:12.626200 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:04:12.795738 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:04:12.798729 (Thread-1): finished collecting timing info
2021-10-08 09:04:12.798729 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 09:04:13.099417 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e39494-d87e-464d-aeec-660546ed8d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBD02B8D30>]}
2021-10-08 09:04:13.099417 (Thread-1): 11:04:13 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.64s]
2021-10-08 09:04:13.100416 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:04:13.101514 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:04:13.101514 (MainThread): Using snowflake connection "master".
2021-10-08 09:04:13.101514 (MainThread): On master: BEGIN
2021-10-08 09:04:13.101514 (MainThread): Opening a new connection, currently in state closed
2021-10-08 09:04:14.112489 (MainThread): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-08 09:04:14.112489 (MainThread): On master: COMMIT
2021-10-08 09:04:14.112489 (MainThread): Using snowflake connection "master".
2021-10-08 09:04:14.112489 (MainThread): On master: COMMIT
2021-10-08 09:04:14.435858 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-08 09:04:14.436867 (MainThread): On master: Close
2021-10-08 09:04:14.726840 (MainThread): 11:04:14 | 
2021-10-08 09:04:14.726840 (MainThread): 11:04:14 | Finished running 4 table models, 2 incremental models in 23.78s.
2021-10-08 09:04:14.726840 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:04:14.726840 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 09:04:14.726840 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:04:14.726840 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 09:04:14.740902 (MainThread): 
2021-10-08 09:04:14.741882 (MainThread): Completed successfully
2021-10-08 09:04:14.741882 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-08 09:04:14.741882 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBCFF14340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBCFF16730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBCFEE01C0>]}
2021-10-08 09:04:14.741882 (MainThread): Flushing usage events
2021-10-08 09:04:24.133116 (MainThread): Running with dbt=0.20.2
2021-10-08 09:04:24.704841 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-10-08 09:04:24.705342 (MainThread): Tracking: tracking
2021-10-08 09:04:24.705342 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF5DDE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA80B0AA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA80B0A670>]}
2021-10-08 09:04:24.713250 (MainThread): Partial parsing not enabled
2021-10-08 09:04:24.727625 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:04:24.748777 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:04:24.750778 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:04:24.757332 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:04:24.758335 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:04:24.761333 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:04:24.762335 (MainThread): Parsing macros\core.sql
2021-10-08 09:04:24.764334 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:04:24.797229 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:04:24.803843 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:04:24.803843 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:04:24.805845 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:04:24.806845 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:04:24.807845 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:04:24.808845 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:04:24.814844 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:04:24.820326 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:04:24.830327 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:04:24.831328 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:04:24.837328 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:04:24.852744 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:04:24.872745 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:04:24.873819 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:04:24.886467 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:04:24.891458 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:04:24.894607 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:04:24.898729 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:04:24.900720 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:04:24.901725 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:04:24.902675 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:04:25.032468 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:04:25.039463 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:04:25.044456 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:04:25.047479 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:04:25.047479 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:04:25.050554 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:04:25.051731 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:04:25.074738 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:04:25.076734 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:04:25.078740 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:04:25.079733 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:04:25.114927 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:04:25.115927 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:04:25.117926 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:04:25.135550 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dcbaee8-d5cd-467c-be98-c1c898f12651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF5DD970>]}
2021-10-08 09:04:25.165694 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:04:25.165694 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dcbaee8-d5cd-467c-be98-c1c898f12651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA80C558E0>]}
2021-10-08 09:04:25.165694 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:04:25.166692 (MainThread): 
2021-10-08 09:04:25.167777 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:04:25.168789 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:04:25.176603 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:04:25.176603 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:04:25.176603 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:04:26.405405 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.23 seconds
2021-10-08 09:04:26.412394 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:04:26.703699 (MainThread): 11:04:26 | Concurrency: 1 threads (target='dev')
2021-10-08 09:04:26.703699 (MainThread): 11:04:26 | 
2021-10-08 09:04:26.704700 (Thread-1): Began running node test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55
2021-10-08 09:04:26.704700 (Thread-1): 11:04:26 | 1 of 7 START test accepted_values_my_second_dbt_model_id__False__1__2 [RUN]
2021-10-08 09:04:26.705699 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55".
2021-10-08 09:04:26.705699 (Thread-1): Compiling test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55
2021-10-08 09:04:26.708111 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55"
2021-10-08 09:04:26.709139 (Thread-1): finished collecting timing info
2021-10-08 09:04:26.719135 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55"
2021-10-08 09:04:26.721136 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55".
2021-10-08 09:04:26.721136 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55: BEGIN
2021-10-08 09:04:26.721136 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:04:27.524706 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-08 09:04:27.524706 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55".
2021-10-08 09:04:27.524706 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        id as value_field,
        count(*) as n_records

    from analytics.dbt.my_second_dbt_model
    group by 1

)

select *
from all_values
where value_field not in (
    1,2
)



      
    ) dbt_internal_test
2021-10-08 09:04:27.890618 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-10-08 09:04:27.892615 (Thread-1): finished collecting timing info
2021-10-08 09:04:27.892615 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55: ROLLBACK
2021-10-08 09:04:28.142505 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55: Close
2021-10-08 09:04:28.433413 (Thread-1): 11:04:28 | 1 of 7 PASS accepted_values_my_second_dbt_model_id__False__1__2...... [PASS in 1.73s]
2021-10-08 09:04:28.435224 (Thread-1): Finished running node test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55
2021-10-08 09:04:28.435224 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 09:04:28.435224 (Thread-1): 11:04:28 | 2 of 7 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-10-08 09:04:28.436235 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 09:04:28.436235 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 09:04:28.442231 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 09:04:28.444417 (Thread-1): finished collecting timing info
2021-10-08 09:04:28.446468 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 09:04:28.448523 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 09:04:28.448523 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: BEGIN
2021-10-08 09:04:28.449451 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:04:29.443824 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-10-08 09:04:29.444833 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 09:04:29.444833 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.first_model
where id is null



      
    ) dbt_internal_test
2021-10-08 09:04:29.699746 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 09:04:29.700748 (Thread-1): finished collecting timing info
2021-10-08 09:04:29.700748 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: ROLLBACK
2021-10-08 09:04:29.943366 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: Close
2021-10-08 09:04:30.245458 (Thread-1): 11:04:30 | 2 of 7 PASS not_null_my_first_dbt_model_id........................... [PASS in 1.81s]
2021-10-08 09:04:30.246458 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 09:04:30.247461 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:04:30.247461 (Thread-1): 11:04:30 | 3 of 7 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-10-08 09:04:30.247461 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:04:30.247461 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:04:30.251453 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 09:04:30.253644 (Thread-1): finished collecting timing info
2021-10-08 09:04:30.254814 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 09:04:30.255811 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:04:30.255811 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: BEGIN
2021-10-08 09:04:30.255811 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:04:31.040073 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 09:04:31.040073 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:04:31.040073 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
2021-10-08 09:04:31.279279 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-08 09:04:31.279279 (Thread-1): finished collecting timing info
2021-10-08 09:04:31.279279 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: ROLLBACK
2021-10-08 09:04:31.551730 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-10-08 09:04:31.850952 (Thread-1): 11:04:31 | 3 of 7 PASS not_null_my_second_dbt_model_id.......................... [PASS in 1.60s]
2021-10-08 09:04:31.851962 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:04:31.851962 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:04:31.852967 (Thread-1): 11:04:31 | 4 of 7 START test not_null_snowflake_customer_purchases_c_custkey.... [RUN]
2021-10-08 09:04:31.852967 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:04:31.852967 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:04:31.856950 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 09:04:31.859344 (Thread-1): finished collecting timing info
2021-10-08 09:04:31.861435 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 09:04:31.864350 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:04:31.864350 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: BEGIN
2021-10-08 09:04:31.864350 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:04:32.697582 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-08 09:04:32.697582 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:04:32.697582 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.snowflake_customer_purchases
where c_custkey is null



      
    ) dbt_internal_test
2021-10-08 09:04:33.035694 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-10-08 09:04:33.036697 (Thread-1): finished collecting timing info
2021-10-08 09:04:33.036697 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: ROLLBACK
2021-10-08 09:04:33.266158 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: Close
2021-10-08 09:04:33.555343 (Thread-1): 11:04:33 | 4 of 7 PASS not_null_snowflake_customer_purchases_c_custkey.......... [PASS in 1.70s]
2021-10-08 09:04:33.556601 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:04:33.556601 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:04:33.556601 (Thread-1): 11:04:33 | 5 of 7 START test unique_my_first_dbt_model_id....................... [RUN]
2021-10-08 09:04:33.556601 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:04:33.556601 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:04:33.561718 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 09:04:33.563607 (Thread-1): finished collecting timing info
2021-10-08 09:04:33.564696 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 09:04:33.565609 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:04:33.565609 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: BEGIN
2021-10-08 09:04:33.565609 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:04:34.385255 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 09:04:34.385255 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:04:34.385255 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.first_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:04:34.765929 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-10-08 09:04:34.767026 (Thread-1): finished collecting timing info
2021-10-08 09:04:34.767026 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: ROLLBACK
2021-10-08 09:04:34.998092 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-08 09:04:35.302118 (Thread-1): 11:04:35 | 5 of 7 PASS unique_my_first_dbt_model_id............................. [PASS in 1.75s]
2021-10-08 09:04:35.303927 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:04:35.303927 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:04:35.304945 (Thread-1): 11:04:35 | 6 of 7 START test unique_my_second_dbt_model_id...................... [RUN]
2021-10-08 09:04:35.304945 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:04:35.305946 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:04:35.310347 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 09:04:35.312344 (Thread-1): finished collecting timing info
2021-10-08 09:04:35.313345 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 09:04:35.315344 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:04:35.315344 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: BEGIN
2021-10-08 09:04:35.315344 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:04:36.131820 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 09:04:36.131820 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:04:36.131820 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:04:36.524435 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-10-08 09:04:36.525387 (Thread-1): finished collecting timing info
2021-10-08 09:04:36.525387 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: ROLLBACK
2021-10-08 09:04:36.763494 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: Close
2021-10-08 09:04:37.048392 (Thread-1): 11:04:37 | 6 of 7 PASS unique_my_second_dbt_model_id............................ [PASS in 1.74s]
2021-10-08 09:04:37.050323 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:04:37.050323 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:04:37.050323 (Thread-1): 11:04:37 | 7 of 7 START test unique_snowflake_customer_purchases_c_custkey...... [RUN]
2021-10-08 09:04:37.051347 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:04:37.051347 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:04:37.054332 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 09:04:37.056328 (Thread-1): finished collecting timing info
2021-10-08 09:04:37.057329 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 09:04:37.058329 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:04:37.058329 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: BEGIN
2021-10-08 09:04:37.058329 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:04:37.843861 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 09:04:37.843861 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:04:37.843861 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.snowflake_customer_purchases
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:04:38.313553 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2021-10-08 09:04:38.314550 (Thread-1): finished collecting timing info
2021-10-08 09:04:38.314550 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: ROLLBACK
2021-10-08 09:04:38.549737 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: Close
2021-10-08 09:04:38.853186 (Thread-1): 11:04:38 | 7 of 7 PASS unique_snowflake_customer_purchases_c_custkey............ [PASS in 1.80s]
2021-10-08 09:04:38.854339 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:04:38.856349 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:04:38.856349 (MainThread): 11:04:38 | 
2021-10-08 09:04:38.857350 (MainThread): 11:04:38 | Finished running 7 tests in 13.69s.
2021-10-08 09:04:38.857350 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:04:38.857350 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:04:38.857350 (MainThread): Connection 'test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8' was properly closed.
2021-10-08 09:04:38.874606 (MainThread): 
2021-10-08 09:04:38.875619 (MainThread): Completed successfully
2021-10-08 09:04:38.876199 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-08 09:04:38.876199 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF71B2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA80B50760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA80F81E20>]}
2021-10-08 09:04:38.877293 (MainThread): Flushing usage events
2021-10-08 09:05:18.524231 (MainThread): Running with dbt=0.20.2
2021-10-08 09:05:19.140092 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 09:05:19.141503 (MainThread): Tracking: tracking
2021-10-08 09:05:19.141503 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF16E6DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF183B4DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF183B4730>]}
2021-10-08 09:05:19.149466 (MainThread): Partial parsing not enabled
2021-10-08 09:05:19.163742 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:05:19.183315 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:05:19.184333 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:05:19.190349 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:05:19.191372 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:05:19.194418 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:05:19.194418 (MainThread): Parsing macros\core.sql
2021-10-08 09:05:19.197426 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:05:19.229939 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:05:19.236942 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:05:19.237938 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:05:19.238921 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:05:19.239917 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:05:19.240916 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:05:19.241933 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:05:19.248934 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:05:19.253934 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:05:19.264936 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:05:19.265918 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:05:19.271455 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:05:19.287654 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:05:19.309732 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:05:19.311730 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:05:19.325696 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:05:19.330791 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:05:19.334790 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:05:19.338967 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:05:19.341042 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:05:19.342037 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:05:19.343022 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:05:19.471533 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:05:19.480710 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:05:19.486710 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:05:19.488797 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:05:19.489800 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:05:19.491806 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:05:19.494285 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:05:19.516293 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:05:19.518311 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:05:19.519311 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:05:19.520389 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:05:19.556322 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:05:19.557451 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:05:19.559452 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:05:19.578361 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e33b5663-41b6-40cf-b6ac-f4caafc0531f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF184DBCA0>]}
2021-10-08 09:05:19.635087 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:05:19.636500 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e33b5663-41b6-40cf-b6ac-f4caafc0531f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF184DB160>]}
2021-10-08 09:05:19.636500 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:05:19.637499 (MainThread): 
2021-10-08 09:05:19.638498 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:05:19.639501 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 09:05:19.652072 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 09:05:19.652314 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 09:05:19.652314 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 09:05:23.645295 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 3.99 seconds
2021-10-08 09:05:23.649147 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 09:05:24.076297 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:05:24.082725 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:05:24.082725 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:05:24.083643 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:05:26.680232 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 2.60 seconds
2021-10-08 09:05:26.681286 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:05:27.950058 (MainThread): Using snowflake connection "master".
2021-10-08 09:05:27.951150 (MainThread): On master: BEGIN
2021-10-08 09:05:27.951150 (MainThread): Opening a new connection, currently in state init
2021-10-08 09:05:28.859746 (MainThread): SQL status: SUCCESS 1 in 0.91 seconds
2021-10-08 09:05:28.859746 (MainThread): On master: COMMIT
2021-10-08 09:05:28.859746 (MainThread): Using snowflake connection "master".
2021-10-08 09:05:28.859746 (MainThread): On master: COMMIT
2021-10-08 09:05:29.221548 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-08 09:05:29.221548 (MainThread): On master: Close
2021-10-08 09:05:29.937367 (MainThread): 11:05:29 | Concurrency: 1 threads (target='dev')
2021-10-08 09:05:29.937367 (MainThread): 11:05:29 | 
2021-10-08 09:05:29.939591 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:05:29.940592 (Thread-1): 11:05:29 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 09:05:29.940592 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:05:29.940592 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:05:29.942691 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:05:29.949439 (Thread-1): finished collecting timing info
2021-10-08 09:05:29.976712 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:05:29.984452 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:05:29.984452 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 09:05:29.984953 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:05:31.879878 (Thread-1): SQL status: SUCCESS 1 in 1.90 seconds
2021-10-08 09:05:31.880301 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:05:31.880301 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null
union all
select 3 as id

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 09:05:33.044741 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2021-10-08 09:05:33.045741 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:05:33.045741 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:05:33.045741 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:05:33.203793 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:05:33.210770 (Thread-1): finished collecting timing info
2021-10-08 09:05:33.210770 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 09:05:33.515356 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e33b5663-41b6-40cf-b6ac-f4caafc0531f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF18666F40>]}
2021-10-08 09:05:33.516358 (Thread-1): 11:05:33 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 3.57s]
2021-10-08 09:05:33.517612 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:05:33.517612 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:05:33.517612 (Thread-1): 11:05:33 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 09:05:33.518681 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:05:33.518681 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:05:33.518681 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:05:33.523896 (Thread-1): finished collecting timing info
2021-10-08 09:05:33.525357 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:05:33.527376 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:05:33.527557 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 09:05:33.527557 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:05:34.545671 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-08 09:05:34.546187 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:05:34.546187 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 09:05:35.964385 (Thread-1): SQL status: SUCCESS 1 in 1.42 seconds
2021-10-08 09:05:35.964385 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:05:35.964385 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:05:35.964385 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:05:36.122347 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:05:36.123350 (Thread-1): finished collecting timing info
2021-10-08 09:05:36.123350 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 09:05:36.414425 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e33b5663-41b6-40cf-b6ac-f4caafc0531f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF1838A2B0>]}
2021-10-08 09:05:36.414425 (Thread-1): 11:05:36 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.90s]
2021-10-08 09:05:36.415489 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:05:36.415489 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:05:36.416566 (Thread-1): 11:05:36 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 09:05:36.416566 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:05:36.416566 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 09:05:36.420568 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:05:36.421927 (Thread-1): finished collecting timing info
2021-10-08 09:05:36.437143 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:05:36.437143 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 09:05:36.437143 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:05:37.876765 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-10-08 09:05:37.882808 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:05:37.882808 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 09:05:38.065206 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:05:38.068206 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:05:38.068206 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:05:38.229826 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:05:38.231858 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:05:38.231858 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:05:38.401832 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:05:38.409917 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:05:38.412035 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:05:38.412035 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 09:05:38.645991 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-08 09:05:38.645991 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:05:38.645991 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 09:05:39.090076 (Thread-1): SQL status: SUCCESS 0 in 0.44 seconds
2021-10-08 09:05:39.090076 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:05:39.091070 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:05:39.091070 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:05:39.447386 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-08 09:05:39.448463 (Thread-1): finished collecting timing info
2021-10-08 09:05:39.448463 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 09:05:39.784710 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e33b5663-41b6-40cf-b6ac-f4caafc0531f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF187F7A90>]}
2021-10-08 09:05:39.785121 (Thread-1): 11:05:39 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.37s]
2021-10-08 09:05:39.785809 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:05:39.785933 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:05:39.786189 (Thread-1): 11:05:39 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 09:05:39.786538 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:05:39.786585 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:05:39.787589 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:05:39.792612 (Thread-1): finished collecting timing info
2021-10-08 09:05:39.794150 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:05:39.795783 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:05:39.795871 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 09:05:39.795921 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:05:40.661045 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-08 09:05:40.662043 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:05:40.662043 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 09:05:42.104171 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-10-08 09:05:42.106165 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:05:42.106165 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:05:42.106165 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:05:42.260007 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-08 09:05:42.260007 (Thread-1): finished collecting timing info
2021-10-08 09:05:42.261008 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 09:05:42.603959 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e33b5663-41b6-40cf-b6ac-f4caafc0531f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF187C15E0>]}
2021-10-08 09:05:42.605067 (Thread-1): 11:05:42 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.82s]
2021-10-08 09:05:42.606068 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:05:42.606068 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 09:05:42.606068 (Thread-1): 11:05:42 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 09:05:42.607306 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:05:42.607306 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 09:05:42.610471 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:05:42.612489 (Thread-1): finished collecting timing info
2021-10-08 09:05:42.615471 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:05:42.615471 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 09:05:42.615471 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:05:43.923150 (Thread-1): SQL status: SUCCESS 1 in 1.31 seconds
2021-10-08 09:05:43.924483 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:05:43.924574 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 09:05:44.101751 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:05:44.103746 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:05:44.103746 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:05:44.264434 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:05:44.267046 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:05:44.267046 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:05:44.424681 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:05:44.425748 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:05:44.427951 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:05:44.427951 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 09:05:44.653066 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-08 09:05:44.653066 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:05:44.653066 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 09:05:45.013817 (Thread-1): SQL status: SUCCESS 0 in 0.36 seconds
2021-10-08 09:05:45.013817 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:05:45.014819 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:05:45.014819 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:05:45.268316 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 09:05:45.269342 (Thread-1): finished collecting timing info
2021-10-08 09:05:45.269342 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 09:05:45.648769 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e33b5663-41b6-40cf-b6ac-f4caafc0531f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF187F7A90>]}
2021-10-08 09:05:45.650023 (Thread-1): 11:05:45 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.04s]
2021-10-08 09:05:45.650919 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 09:05:45.650919 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:05:45.650919 (Thread-1): 11:05:45 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 09:05:45.650919 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:05:45.651956 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:05:45.653991 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:05:45.655950 (Thread-1): finished collecting timing info
2021-10-08 09:05:45.656919 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:05:45.658918 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:05:45.658918 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 09:05:45.658918 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:05:46.519624 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-10-08 09:05:46.519624 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:05:46.519624 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
where id = 1
      );
2021-10-08 09:05:47.574959 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-10-08 09:05:47.575958 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:05:47.575958 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:05:47.575958 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:05:47.764731 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:05:47.766744 (Thread-1): finished collecting timing info
2021-10-08 09:05:47.766744 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 09:05:48.062473 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e33b5663-41b6-40cf-b6ac-f4caafc0531f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF18772F40>]}
2021-10-08 09:05:48.062473 (Thread-1): 11:05:48 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.41s]
2021-10-08 09:05:48.064474 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:05:48.065476 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:05:48.065476 (MainThread): Using snowflake connection "master".
2021-10-08 09:05:48.065476 (MainThread): On master: BEGIN
2021-10-08 09:05:48.065476 (MainThread): Opening a new connection, currently in state closed
2021-10-08 09:05:49.036536 (MainThread): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-08 09:05:49.036536 (MainThread): On master: COMMIT
2021-10-08 09:05:49.036536 (MainThread): Using snowflake connection "master".
2021-10-08 09:05:49.036536 (MainThread): On master: COMMIT
2021-10-08 09:05:49.328403 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-08 09:05:49.328403 (MainThread): On master: Close
2021-10-08 09:05:49.641923 (MainThread): 11:05:49 | 
2021-10-08 09:05:49.641923 (MainThread): 11:05:49 | Finished running 4 table models, 2 incremental models in 30.00s.
2021-10-08 09:05:49.641923 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:05:49.641923 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 09:05:49.641923 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:05:49.641923 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 09:05:49.659024 (MainThread): 
2021-10-08 09:05:49.659024 (MainThread): Completed successfully
2021-10-08 09:05:49.659024 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-08 09:05:49.660026 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF15909610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF184B4D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF187DE6D0>]}
2021-10-08 09:05:49.660026 (MainThread): Flushing usage events
2021-10-08 09:05:55.878684 (MainThread): Running with dbt=0.20.2
2021-10-08 09:05:56.650779 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-10-08 09:05:56.651794 (MainThread): Tracking: tracking
2021-10-08 09:05:56.653277 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CD39CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CE8A9EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CE8A9400>]}
2021-10-08 09:05:56.661304 (MainThread): Partial parsing not enabled
2021-10-08 09:05:56.674928 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:05:56.697095 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:05:56.699352 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:05:56.708970 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:05:56.711032 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:05:56.714302 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:05:56.715281 (MainThread): Parsing macros\core.sql
2021-10-08 09:05:56.718288 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:05:56.751466 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:05:56.758544 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:05:56.759549 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:05:56.760694 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:05:56.761726 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:05:56.762726 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:05:56.763725 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:05:56.769725 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:05:56.773725 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:05:56.782625 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:05:56.783634 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:05:56.789624 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:05:56.809936 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:05:56.836988 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:05:56.841932 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:05:56.862270 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:05:56.870097 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:05:56.875592 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:05:56.880591 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:05:56.882737 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:05:56.884940 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:05:56.885939 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:05:57.042922 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:05:57.052055 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:05:57.059281 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:05:57.062278 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:05:57.062278 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:05:57.068032 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:05:57.072186 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:05:57.108445 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:05:57.112765 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:05:57.114350 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:05:57.116796 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:05:57.159882 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:05:57.162008 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:05:57.165007 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:05:57.231783 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f71cda27-d592-48ab-8b78-51599cd1ffe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CE964FD0>]}
2021-10-08 09:05:57.308198 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:05:57.308698 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f71cda27-d592-48ab-8b78-51599cd1ffe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CE928E20>]}
2021-10-08 09:05:57.309196 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:05:57.310875 (MainThread): 
2021-10-08 09:05:57.310875 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:05:57.318121 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:05:57.340904 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:05:57.341604 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:05:57.341604 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:05:58.543020 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.20 seconds
2021-10-08 09:05:58.555490 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:05:58.870692 (MainThread): 11:05:58 | Concurrency: 1 threads (target='dev')
2021-10-08 09:05:58.871677 (MainThread): 11:05:58 | 
2021-10-08 09:05:58.873677 (Thread-1): Began running node test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55
2021-10-08 09:05:58.873677 (Thread-1): 11:05:58 | 1 of 7 START test accepted_values_my_second_dbt_model_id__False__1__2 [RUN]
2021-10-08 09:05:58.873677 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55".
2021-10-08 09:05:58.874676 (Thread-1): Compiling test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55
2021-10-08 09:05:58.876677 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55"
2021-10-08 09:05:58.882716 (Thread-1): finished collecting timing info
2021-10-08 09:05:58.895473 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55"
2021-10-08 09:05:58.906236 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55".
2021-10-08 09:05:58.906236 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55: BEGIN
2021-10-08 09:05:58.906236 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:05:59.991078 (Thread-1): SQL status: SUCCESS 1 in 1.08 seconds
2021-10-08 09:05:59.991078 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55".
2021-10-08 09:05:59.991078 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        id as value_field,
        count(*) as n_records

    from analytics.dbt.my_second_dbt_model
    group by 1

)

select *
from all_values
where value_field not in (
    1,2
)



      
    ) dbt_internal_test
2021-10-08 09:06:00.342035 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-10-08 09:06:00.342035 (Thread-1): finished collecting timing info
2021-10-08 09:06:00.342035 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55: ROLLBACK
2021-10-08 09:06:00.631913 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55: Close
2021-10-08 09:06:00.921716 (Thread-1): 11:06:00 | 1 of 7 PASS accepted_values_my_second_dbt_model_id__False__1__2...... [PASS in 2.05s]
2021-10-08 09:06:00.922820 (Thread-1): Finished running node test.lukeclarke_learn_dbt.accepted_values_my_second_dbt_model_id__False__1__2.cfbf35da55
2021-10-08 09:06:00.922820 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 09:06:00.922820 (Thread-1): 11:06:00 | 2 of 7 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-10-08 09:06:00.922820 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 09:06:00.922820 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 09:06:00.926871 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 09:06:00.928892 (Thread-1): finished collecting timing info
2021-10-08 09:06:00.929965 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 09:06:00.931881 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 09:06:00.931881 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: BEGIN
2021-10-08 09:06:00.931881 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:06:02.048934 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-10-08 09:06:02.049098 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 09:06:02.049098 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.first_model
where id is null



      
    ) dbt_internal_test
2021-10-08 09:06:02.436037 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-10-08 09:06:02.436037 (Thread-1): finished collecting timing info
2021-10-08 09:06:02.437135 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: ROLLBACK
2021-10-08 09:06:02.704364 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: Close
2021-10-08 09:06:03.037424 (Thread-1): 11:06:03 | 2 of 7 PASS not_null_my_first_dbt_model_id........................... [PASS in 2.11s]
2021-10-08 09:06:03.037863 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 09:06:03.037863 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:06:03.038394 (Thread-1): 11:06:03 | 3 of 7 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-10-08 09:06:03.038476 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:06:03.038476 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:06:03.041051 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 09:06:03.042796 (Thread-1): finished collecting timing info
2021-10-08 09:06:03.044300 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 09:06:03.046008 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:06:03.046008 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: BEGIN
2021-10-08 09:06:03.046008 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:06:03.878518 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-08 09:06:03.878518 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:06:03.878518 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
2021-10-08 09:06:04.109549 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-08 09:06:04.110631 (Thread-1): finished collecting timing info
2021-10-08 09:06:04.110631 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: ROLLBACK
2021-10-08 09:06:04.460325 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-10-08 09:06:04.747111 (Thread-1): 11:06:04 | 3 of 7 PASS not_null_my_second_dbt_model_id.......................... [PASS in 1.71s]
2021-10-08 09:06:04.748112 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:06:04.748112 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:06:04.748112 (Thread-1): 11:06:04 | 4 of 7 START test not_null_snowflake_customer_purchases_c_custkey.... [RUN]
2021-10-08 09:06:04.748112 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:06:04.748112 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:06:04.751308 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 09:06:04.753290 (Thread-1): finished collecting timing info
2021-10-08 09:06:04.754288 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 09:06:04.757216 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:06:04.757216 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: BEGIN
2021-10-08 09:06:04.757216 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:06:05.573540 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 09:06:05.573540 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:06:05.573540 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.snowflake_customer_purchases
where c_custkey is null



      
    ) dbt_internal_test
2021-10-08 09:06:05.915797 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-10-08 09:06:05.917899 (Thread-1): finished collecting timing info
2021-10-08 09:06:05.917899 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: ROLLBACK
2021-10-08 09:06:06.189148 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: Close
2021-10-08 09:06:06.535352 (Thread-1): 11:06:06 | 4 of 7 PASS not_null_snowflake_customer_purchases_c_custkey.......... [PASS in 1.79s]
2021-10-08 09:06:06.536302 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:06:06.536302 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:06:06.536302 (Thread-1): 11:06:06 | 5 of 7 START test unique_my_first_dbt_model_id....................... [RUN]
2021-10-08 09:06:06.536302 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:06:06.536302 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:06:06.541303 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 09:06:06.543752 (Thread-1): finished collecting timing info
2021-10-08 09:06:06.544779 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 09:06:06.546775 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:06:06.546775 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: BEGIN
2021-10-08 09:06:06.546775 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:06:07.394515 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-08 09:06:07.394515 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:06:07.394515 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.first_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:06:07.736973 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-10-08 09:06:07.737972 (Thread-1): finished collecting timing info
2021-10-08 09:06:07.737972 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: ROLLBACK
2021-10-08 09:06:08.061996 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-08 09:06:08.420885 (Thread-1): 11:06:08 | 5 of 7 PASS unique_my_first_dbt_model_id............................. [PASS in 1.88s]
2021-10-08 09:06:08.421866 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:06:08.421866 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:06:08.422843 (Thread-1): 11:06:08 | 6 of 7 START test unique_my_second_dbt_model_id...................... [RUN]
2021-10-08 09:06:08.422843 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:06:08.422843 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:06:08.426986 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 09:06:08.430115 (Thread-1): finished collecting timing info
2021-10-08 09:06:08.432020 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 09:06:08.438019 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:06:08.438019 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: BEGIN
2021-10-08 09:06:08.438019 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:06:09.224412 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 09:06:09.224412 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:06:09.224412 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:06:09.749035 (Thread-1): SQL status: SUCCESS 1 in 0.52 seconds
2021-10-08 09:06:09.749998 (Thread-1): finished collecting timing info
2021-10-08 09:06:09.749998 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: ROLLBACK
2021-10-08 09:06:09.972265 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: Close
2021-10-08 09:06:10.307663 (Thread-1): 11:06:10 | 6 of 7 PASS unique_my_second_dbt_model_id............................ [PASS in 1.88s]
2021-10-08 09:06:10.308585 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:06:10.309585 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:06:10.309585 (Thread-1): 11:06:10 | 7 of 7 START test unique_snowflake_customer_purchases_c_custkey...... [RUN]
2021-10-08 09:06:10.310635 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:06:10.310635 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:06:10.317802 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 09:06:10.320021 (Thread-1): finished collecting timing info
2021-10-08 09:06:10.321170 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 09:06:10.323969 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:06:10.324046 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: BEGIN
2021-10-08 09:06:10.324119 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:06:11.130587 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-08 09:06:11.130587 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:06:11.130587 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.snowflake_customer_purchases
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:06:11.591759 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-10-08 09:06:11.592754 (Thread-1): finished collecting timing info
2021-10-08 09:06:11.592754 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: ROLLBACK
2021-10-08 09:06:11.850069 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: Close
2021-10-08 09:06:12.133255 (Thread-1): 11:06:12 | 7 of 7 PASS unique_snowflake_customer_purchases_c_custkey............ [PASS in 1.82s]
2021-10-08 09:06:12.134252 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:06:12.135801 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:06:12.137047 (MainThread): 11:06:12 | 
2021-10-08 09:06:12.137289 (MainThread): 11:06:12 | Finished running 7 tests in 14.82s.
2021-10-08 09:06:12.137530 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:06:12.137530 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:06:12.137530 (MainThread): Connection 'test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8' was properly closed.
2021-10-08 09:06:12.150634 (MainThread): 
2021-10-08 09:06:12.151555 (MainThread): Completed successfully
2021-10-08 09:06:12.151555 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-08 09:06:12.151555 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CED41400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CE945730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CE945580>]}
2021-10-08 09:06:12.151555 (MainThread): Flushing usage events
2021-10-08 09:08:10.485946 (MainThread): Running with dbt=0.20.2
2021-10-08 09:08:11.167935 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 09:08:11.168950 (MainThread): Tracking: tracking
2021-10-08 09:08:11.168950 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82769CEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C828BA95E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C828BA9400>]}
2021-10-08 09:08:11.175937 (MainThread): Partial parsing not enabled
2021-10-08 09:08:11.190427 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:08:11.210631 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:08:11.211729 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:08:11.220000 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:08:11.220969 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:08:11.224054 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:08:11.225042 (MainThread): Parsing macros\core.sql
2021-10-08 09:08:11.228515 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:08:11.261734 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:08:11.267733 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:08:11.268732 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:08:11.269733 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:08:11.271744 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:08:11.272804 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:08:11.273307 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:08:11.281393 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:08:11.286316 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:08:11.295678 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:08:11.297605 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:08:11.302698 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:08:11.317703 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:08:11.337651 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:08:11.339741 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:08:11.352070 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:08:11.356064 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:08:11.360062 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:08:11.364070 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:08:11.365515 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:08:11.366529 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:08:11.367565 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:08:11.489811 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:08:11.495901 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:08:11.501915 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:08:11.504931 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:08:11.505931 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:08:11.509029 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:08:11.510121 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:08:11.535051 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:08:11.537278 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:08:11.578283 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:08:11.580297 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:08:11.583282 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:08:11.584283 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:08:11.585281 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:08:11.603283 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b592037-0758-4103-8be2-acd844e49370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C828CD8430>]}
2021-10-08 09:08:11.625821 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:08:11.625821 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b592037-0758-4103-8be2-acd844e49370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C828CD8DC0>]}
2021-10-08 09:08:11.626821 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:08:11.627728 (MainThread): 
2021-10-08 09:08:11.627728 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:08:11.629539 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 09:08:11.638297 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 09:08:11.638297 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 09:08:11.638297 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 09:08:13.274472 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.64 seconds
2021-10-08 09:08:13.280479 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 09:08:13.618028 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:08:13.622942 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:08:13.622942 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:08:13.623943 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:08:14.601869 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.98 seconds
2021-10-08 09:08:14.602914 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:08:14.903285 (MainThread): Using snowflake connection "master".
2021-10-08 09:08:14.903285 (MainThread): On master: BEGIN
2021-10-08 09:08:14.903285 (MainThread): Opening a new connection, currently in state init
2021-10-08 09:08:15.700864 (MainThread): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-08 09:08:15.701366 (MainThread): On master: COMMIT
2021-10-08 09:08:15.701366 (MainThread): Using snowflake connection "master".
2021-10-08 09:08:15.701366 (MainThread): On master: COMMIT
2021-10-08 09:08:15.980637 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-08 09:08:15.980637 (MainThread): On master: Close
2021-10-08 09:08:16.310869 (MainThread): 11:08:16 | Concurrency: 1 threads (target='dev')
2021-10-08 09:08:16.310869 (MainThread): 11:08:16 | 
2021-10-08 09:08:16.313918 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:08:16.313918 (Thread-1): 11:08:16 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 09:08:16.313918 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:08:16.313918 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:08:16.315999 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:08:16.317927 (Thread-1): finished collecting timing info
2021-10-08 09:08:16.341213 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:08:16.343661 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:08:16.344204 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 09:08:16.344316 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:08:17.314502 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-08 09:08:17.314502 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:08:17.314502 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null
union all
select 3 as id

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 09:08:18.552837 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-10-08 09:08:18.555648 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:08:18.555851 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:08:18.555851 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:08:18.744060 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:08:18.752067 (Thread-1): finished collecting timing info
2021-10-08 09:08:18.752067 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 09:08:19.098683 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b592037-0758-4103-8be2-acd844e49370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C828F03070>]}
2021-10-08 09:08:19.099682 (Thread-1): 11:08:19 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.78s]
2021-10-08 09:08:19.100343 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:08:19.100343 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:08:19.100343 (Thread-1): 11:08:19 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 09:08:19.101349 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:08:19.101349 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:08:19.102350 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:08:19.107431 (Thread-1): finished collecting timing info
2021-10-08 09:08:19.110221 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:08:19.113295 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:08:19.113295 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 09:08:19.113295 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:08:20.093445 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-08 09:08:20.093445 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:08:20.093445 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 09:08:21.766100 (Thread-1): SQL status: SUCCESS 1 in 1.67 seconds
2021-10-08 09:08:21.768096 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:08:21.768096 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:08:21.768096 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:08:21.967838 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 09:08:21.968837 (Thread-1): finished collecting timing info
2021-10-08 09:08:21.969836 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 09:08:22.376847 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b592037-0758-4103-8be2-acd844e49370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C828C28970>]}
2021-10-08 09:08:22.377851 (Thread-1): 11:08:22 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.28s]
2021-10-08 09:08:22.379485 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:08:22.379485 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:08:22.380489 (Thread-1): 11:08:22 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 09:08:22.380489 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:08:22.381564 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 09:08:22.387562 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:08:22.389597 (Thread-1): finished collecting timing info
2021-10-08 09:08:22.411736 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:08:22.411736 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 09:08:22.412676 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:08:24.284851 (Thread-1): SQL status: SUCCESS 1 in 1.87 seconds
2021-10-08 09:08:24.292112 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:08:24.292112 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 09:08:24.532238 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-08 09:08:24.534246 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:08:24.534246 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:08:24.728588 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:08:24.730585 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:08:24.730585 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:08:24.909252 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:08:24.918427 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:08:24.920427 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:08:24.920427 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 09:08:25.154572 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-08 09:08:25.154572 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:08:25.154572 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 09:08:25.620618 (Thread-1): SQL status: SUCCESS 0 in 0.47 seconds
2021-10-08 09:08:25.621118 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:08:25.621653 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:08:25.621709 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:08:25.890624 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 09:08:25.890624 (Thread-1): finished collecting timing info
2021-10-08 09:08:25.890624 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 09:08:26.252751 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b592037-0758-4103-8be2-acd844e49370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C828C66490>]}
2021-10-08 09:08:26.252883 (Thread-1): 11:08:26 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.87s]
2021-10-08 09:08:26.253081 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:08:26.253583 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:08:26.253583 (Thread-1): 11:08:26 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 09:08:26.254069 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:08:26.254069 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:08:26.254557 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:08:26.270213 (Thread-1): finished collecting timing info
2021-10-08 09:08:26.271241 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:08:26.272980 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:08:26.272980 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 09:08:26.272980 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:08:27.318319 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-10-08 09:08:27.318319 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:08:27.318319 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 09:08:28.928683 (Thread-1): SQL status: SUCCESS 1 in 1.61 seconds
2021-10-08 09:08:28.928683 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:08:28.929682 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:08:28.929682 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:08:29.113053 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:08:29.114057 (Thread-1): finished collecting timing info
2021-10-08 09:08:29.114057 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 09:08:29.449016 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b592037-0758-4103-8be2-acd844e49370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C828C3E6D0>]}
2021-10-08 09:08:29.449016 (Thread-1): 11:08:29 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.19s]
2021-10-08 09:08:29.450019 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:08:29.450019 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 09:08:29.450019 (Thread-1): 11:08:29 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 09:08:29.451059 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:08:29.451059 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 09:08:29.453912 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:08:29.455831 (Thread-1): finished collecting timing info
2021-10-08 09:08:29.458213 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:08:29.458213 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 09:08:29.458213 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:08:30.885078 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2021-10-08 09:08:30.887677 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:08:30.888328 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 09:08:31.073715 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:08:31.077740 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:08:31.077740 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:08:31.249907 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:08:31.250904 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:08:31.250904 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:08:31.492282 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-08 09:08:31.495276 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:08:31.498276 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:08:31.498276 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 09:08:31.713359 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-08 09:08:31.713359 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:08:31.714372 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 09:08:32.052313 (Thread-1): SQL status: SUCCESS 0 in 0.34 seconds
2021-10-08 09:08:32.053296 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:08:32.053296 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:08:32.053296 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:08:32.368314 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-08 09:08:32.370321 (Thread-1): finished collecting timing info
2021-10-08 09:08:32.370321 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 09:08:32.752409 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b592037-0758-4103-8be2-acd844e49370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C829032220>]}
2021-10-08 09:08:32.754509 (Thread-1): 11:08:32 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.30s]
2021-10-08 09:08:32.756308 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 09:08:32.756308 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:08:32.757305 (Thread-1): 11:08:32 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 09:08:32.757801 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:08:32.757801 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:08:32.760870 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:08:32.764594 (Thread-1): finished collecting timing info
2021-10-08 09:08:32.767605 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:08:32.774400 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:08:32.774400 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 09:08:32.774400 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:08:33.892704 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-10-08 09:08:33.892704 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:08:33.893708 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
where id = 1
      );
2021-10-08 09:08:35.156242 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-10-08 09:08:35.159322 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:08:35.159322 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:08:35.159322 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:08:35.321880 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:08:35.323879 (Thread-1): finished collecting timing info
2021-10-08 09:08:35.323879 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 09:08:35.659171 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b592037-0758-4103-8be2-acd844e49370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C828C3E6D0>]}
2021-10-08 09:08:35.659171 (Thread-1): 11:08:35 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.90s]
2021-10-08 09:08:35.660617 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:08:35.663625 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:08:35.663625 (MainThread): Using snowflake connection "master".
2021-10-08 09:08:35.664619 (MainThread): On master: BEGIN
2021-10-08 09:08:35.664619 (MainThread): Opening a new connection, currently in state closed
2021-10-08 09:08:36.470050 (MainThread): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-08 09:08:36.471051 (MainThread): On master: COMMIT
2021-10-08 09:08:36.471051 (MainThread): Using snowflake connection "master".
2021-10-08 09:08:36.471051 (MainThread): On master: COMMIT
2021-10-08 09:08:36.731912 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-08 09:08:36.731912 (MainThread): On master: Close
2021-10-08 09:08:37.051163 (MainThread): 11:08:37 | 
2021-10-08 09:08:37.052162 (MainThread): 11:08:37 | Finished running 4 table models, 2 incremental models in 25.42s.
2021-10-08 09:08:37.052162 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:08:37.052162 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 09:08:37.052162 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:08:37.052162 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 09:08:37.064502 (MainThread): 
2021-10-08 09:08:37.064502 (MainThread): Completed successfully
2021-10-08 09:08:37.064981 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-08 09:08:37.064981 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C828ECF700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C828BC0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C828FA17C0>]}
2021-10-08 09:08:37.064981 (MainThread): Flushing usage events
2021-10-08 09:09:03.150340 (MainThread): Running with dbt=0.20.2
2021-10-08 09:09:03.697483 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-10-08 09:09:03.697483 (MainThread): Tracking: tracking
2021-10-08 09:09:03.697483 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024816FFDD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481852B190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481852B670>]}
2021-10-08 09:09:03.706677 (MainThread): Partial parsing not enabled
2021-10-08 09:09:03.722231 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:09:03.746447 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:09:03.747721 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:09:03.756640 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:09:03.758283 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:09:03.761118 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:09:03.762875 (MainThread): Parsing macros\core.sql
2021-10-08 09:09:03.766027 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:09:03.799113 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:09:03.804113 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:09:03.805114 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:09:03.806114 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:09:03.807114 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:09:03.808278 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:09:03.808598 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:09:03.815695 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:09:03.819779 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:09:03.830753 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:09:03.832006 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:09:03.837005 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:09:03.851346 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:09:03.873436 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:09:03.875420 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:09:03.887444 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:09:03.894585 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:09:03.898531 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:09:03.903496 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:09:03.904498 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:09:03.905497 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:09:03.906498 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:09:04.041684 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:09:04.048736 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:09:04.054698 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:09:04.057716 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:09:04.058718 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:09:04.061718 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:09:04.062715 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:09:04.091763 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:09:04.094675 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:09:04.134037 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:09:04.136101 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:09:04.137102 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:09:04.138102 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:09:04.140102 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:09:04.157760 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c3957f9-5c3c-4900-8ec5-2fe29da454dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024818687EB0>]}
2021-10-08 09:09:04.205564 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:09:04.206573 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c3957f9-5c3c-4900-8ec5-2fe29da454dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481858FD00>]}
2021-10-08 09:09:04.206573 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:09:04.207568 (MainThread): 
2021-10-08 09:09:04.207568 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:09:04.208650 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:09:04.219558 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:09:04.220404 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:09:04.220404 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:09:05.523490 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.30 seconds
2021-10-08 09:09:05.531487 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:09:05.864101 (MainThread): 11:09:05 | Concurrency: 1 threads (target='dev')
2021-10-08 09:09:05.865141 (MainThread): 11:09:05 | 
2021-10-08 09:09:05.869947 (Thread-1): Began running node test.lukeclarke_learn_dbt.accepted_values_my_first_dbt_model_id__False__1__2.3914eef0e7
2021-10-08 09:09:05.869947 (Thread-1): 11:09:05 | 1 of 7 START test accepted_values_my_first_dbt_model_id__False__1__2. [RUN]
2021-10-08 09:09:05.870948 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.accepted_values_my_first_dbt_model_id__False__1__2.3914eef0e7".
2021-10-08 09:09:05.870948 (Thread-1): Compiling test.lukeclarke_learn_dbt.accepted_values_my_first_dbt_model_id__False__1__2.3914eef0e7
2021-10-08 09:09:05.877949 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.accepted_values_my_first_dbt_model_id__False__1__2.3914eef0e7"
2021-10-08 09:09:05.878943 (Thread-1): finished collecting timing info
2021-10-08 09:09:05.891157 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.accepted_values_my_first_dbt_model_id__False__1__2.3914eef0e7"
2021-10-08 09:09:05.892157 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.accepted_values_my_first_dbt_model_id__False__1__2.3914eef0e7".
2021-10-08 09:09:05.892157 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_my_first_dbt_model_id__False__1__2.3914eef0e7: BEGIN
2021-10-08 09:09:05.892157 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:09:06.810598 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2021-10-08 09:09:06.810598 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.accepted_values_my_first_dbt_model_id__False__1__2.3914eef0e7".
2021-10-08 09:09:06.810598 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_my_first_dbt_model_id__False__1__2.3914eef0e7: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.accepted_values_my_first_dbt_model_id__False__1__2.3914eef0e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        id as value_field,
        count(*) as n_records

    from analytics.dbt.first_model
    group by 1

)

select *
from all_values
where value_field not in (
    1,2
)



      
    ) dbt_internal_test
2021-10-08 09:09:07.251654 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-10-08 09:09:07.253647 (Thread-1): finished collecting timing info
2021-10-08 09:09:07.253647 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_my_first_dbt_model_id__False__1__2.3914eef0e7: ROLLBACK
2021-10-08 09:09:07.506224 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_my_first_dbt_model_id__False__1__2.3914eef0e7: Close
2021-10-08 09:09:07.817599 (Thread-1): 11:09:07 | 1 of 7 FAIL 1 accepted_values_my_first_dbt_model_id__False__1__2..... [FAIL 1 in 1.95s]
2021-10-08 09:09:07.818599 (Thread-1): Finished running node test.lukeclarke_learn_dbt.accepted_values_my_first_dbt_model_id__False__1__2.3914eef0e7
2021-10-08 09:09:07.818599 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 09:09:07.818599 (Thread-1): 11:09:07 | 2 of 7 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-10-08 09:09:07.819607 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 09:09:07.819607 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 09:09:07.823599 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 09:09:07.825658 (Thread-1): finished collecting timing info
2021-10-08 09:09:07.826600 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 09:09:07.828600 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 09:09:07.828600 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: BEGIN
2021-10-08 09:09:07.828600 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:09:08.768044 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-10-08 09:09:08.768044 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 09:09:08.769315 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.first_model
where id is null



      
    ) dbt_internal_test
2021-10-08 09:09:09.014245 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-08 09:09:09.014749 (Thread-1): finished collecting timing info
2021-10-08 09:09:09.014749 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: ROLLBACK
2021-10-08 09:09:09.259918 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: Close
2021-10-08 09:09:09.581327 (Thread-1): 11:09:09 | 2 of 7 PASS not_null_my_first_dbt_model_id........................... [PASS in 1.76s]
2021-10-08 09:09:09.582328 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 09:09:09.582328 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:09:09.583328 (Thread-1): 11:09:09 | 3 of 7 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-10-08 09:09:09.583328 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:09:09.583328 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:09:09.587325 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 09:09:09.589437 (Thread-1): finished collecting timing info
2021-10-08 09:09:09.589873 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 09:09:09.591960 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:09:09.591960 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: BEGIN
2021-10-08 09:09:09.591960 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:09:10.374388 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 09:09:10.375499 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:09:10.375499 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
2021-10-08 09:09:10.688873 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-10-08 09:09:10.690040 (Thread-1): finished collecting timing info
2021-10-08 09:09:10.690040 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: ROLLBACK
2021-10-08 09:09:10.983915 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-10-08 09:09:11.282653 (Thread-1): 11:09:11 | 3 of 7 PASS not_null_my_second_dbt_model_id.......................... [PASS in 1.70s]
2021-10-08 09:09:11.283699 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:09:11.283699 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:09:11.283699 (Thread-1): 11:09:11 | 4 of 7 START test not_null_snowflake_customer_purchases_c_custkey.... [RUN]
2021-10-08 09:09:11.284696 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:09:11.284696 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:09:11.288697 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 09:09:11.290699 (Thread-1): finished collecting timing info
2021-10-08 09:09:11.291599 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 09:09:11.293607 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:09:11.293607 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: BEGIN
2021-10-08 09:09:11.293607 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:09:12.216794 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2021-10-08 09:09:12.217790 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:09:12.217790 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.snowflake_customer_purchases
where c_custkey is null



      
    ) dbt_internal_test
2021-10-08 09:09:12.596672 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-10-08 09:09:12.597693 (Thread-1): finished collecting timing info
2021-10-08 09:09:12.597693 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: ROLLBACK
2021-10-08 09:09:12.908480 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: Close
2021-10-08 09:09:13.198913 (Thread-1): 11:09:13 | 4 of 7 PASS not_null_snowflake_customer_purchases_c_custkey.......... [PASS in 1.91s]
2021-10-08 09:09:13.203538 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:09:13.204038 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:09:13.204401 (Thread-1): 11:09:13 | 5 of 7 START test unique_my_first_dbt_model_id....................... [RUN]
2021-10-08 09:09:13.204401 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:09:13.204901 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:09:13.217730 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 09:09:13.226533 (Thread-1): finished collecting timing info
2021-10-08 09:09:13.228653 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 09:09:13.231139 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:09:13.231139 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: BEGIN
2021-10-08 09:09:13.231139 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:09:14.415399 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-10-08 09:09:14.415399 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:09:14.415399 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.first_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:09:14.785920 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-10-08 09:09:14.785920 (Thread-1): finished collecting timing info
2021-10-08 09:09:14.786931 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: ROLLBACK
2021-10-08 09:09:15.001411 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-08 09:09:15.314604 (Thread-1): 11:09:15 | 5 of 7 PASS unique_my_first_dbt_model_id............................. [PASS in 2.11s]
2021-10-08 09:09:15.316530 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:09:15.316689 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:09:15.316689 (Thread-1): 11:09:15 | 6 of 7 START test unique_my_second_dbt_model_id...................... [RUN]
2021-10-08 09:09:15.318054 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:09:15.318054 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:09:15.327064 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 09:09:15.330055 (Thread-1): finished collecting timing info
2021-10-08 09:09:15.331100 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 09:09:15.333913 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:09:15.333913 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: BEGIN
2021-10-08 09:09:15.333913 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:09:16.397675 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-10-08 09:09:16.398699 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:09:16.398699 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:09:16.854167 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-10-08 09:09:16.855174 (Thread-1): finished collecting timing info
2021-10-08 09:09:16.855174 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: ROLLBACK
2021-10-08 09:09:17.108530 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: Close
2021-10-08 09:09:17.498446 (Thread-1): 11:09:17 | 6 of 7 PASS unique_my_second_dbt_model_id............................ [PASS in 2.18s]
2021-10-08 09:09:17.499807 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:09:17.500022 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:09:17.500022 (Thread-1): 11:09:17 | 7 of 7 START test unique_snowflake_customer_purchases_c_custkey...... [RUN]
2021-10-08 09:09:17.500424 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:09:17.500424 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:09:17.503434 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 09:09:17.507519 (Thread-1): finished collecting timing info
2021-10-08 09:09:17.508520 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 09:09:17.510521 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:09:17.511521 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: BEGIN
2021-10-08 09:09:17.511521 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:09:18.516121 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-08 09:09:18.516121 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:09:18.516624 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.snowflake_customer_purchases
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:09:18.816552 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-10-08 09:09:18.816552 (Thread-1): finished collecting timing info
2021-10-08 09:09:18.817555 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: ROLLBACK
2021-10-08 09:09:19.061042 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: Close
2021-10-08 09:09:19.363854 (Thread-1): 11:09:19 | 7 of 7 PASS unique_snowflake_customer_purchases_c_custkey............ [PASS in 1.86s]
2021-10-08 09:09:19.364838 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:09:19.365820 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:09:19.365820 (MainThread): 11:09:19 | 
2021-10-08 09:09:19.365820 (MainThread): 11:09:19 | Finished running 7 tests in 15.16s.
2021-10-08 09:09:19.365820 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:09:19.365820 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:09:19.365820 (MainThread): Connection 'test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8' was properly closed.
2021-10-08 09:09:19.392213 (MainThread): 
2021-10-08 09:09:19.392369 (MainThread): Completed with 1 error and 0 warnings:
2021-10-08 09:09:19.392369 (MainThread): 
2021-10-08 09:09:19.392369 (MainThread): Failure in test accepted_values_my_first_dbt_model_id__False__1__2 (models\example\schema.yml)
2021-10-08 09:09:19.392369 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-08 09:09:19.392369 (MainThread): 
2021-10-08 09:09:19.392369 (MainThread):   compiled SQL at target\compiled\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\accepted_values_my_first_dbt_model_id__False__1__2.sql
2021-10-08 09:09:19.392369 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-10-08 09:09:19.392369 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248185706A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024818570790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481713B370>]}
2021-10-08 09:09:19.393790 (MainThread): Flushing usage events
2021-10-08 09:13:00.546676 (MainThread): Running with dbt=0.20.2
2021-10-08 09:13:01.164954 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 09:13:01.165957 (MainThread): Tracking: tracking
2021-10-08 09:13:01.165957 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E50AEEDE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E50C444E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E50C444730>]}
2021-10-08 09:13:01.174502 (MainThread): Partial parsing not enabled
2021-10-08 09:13:01.179281 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E50C4449A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E50C42AF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E50C42A640>]}
2021-10-08 09:13:01.179281 (MainThread): Flushing usage events
2021-10-08 09:13:01.731179 (MainThread): Encountered an error:
2021-10-08 09:13:01.731179 (MainThread): Compilation Error
  Error reading lukeclarke_learn_dbt: example\schema.yml - Runtime Error
    Syntax error near line 26
    ------------------------------
    23 |                 - unique
    24 |                 - not_null
    25 |                 - relationships
    26 |                 to: ref("my_first_dbt_model")
    27 |                 field: id 
    28 | 
    29 | 
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 23, column 17
    did not find expected '-' indicator
      in "<unicode string>", line 26, column 17
2021-10-08 09:13:01.733192 (MainThread): Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\yaml\__init__.py", line 114, in load
    return loader.get_single_data()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml\_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml\_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 853, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block collection
  in "<unicode string>", line 23, column 17
did not find expected '-' indicator
  in "<unicode string>", line 26, column 17

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 106, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 26
  ------------------------------
  23 |                 - unique
  24 |                 - not_null
  25 |                 - relationships
  26 |                 to: ref("my_first_dbt_model")
  27 |                 field: id 
  28 | 
  29 | 
  
  Raw Error:
  ------------------------------
  while parsing a block collection
    in "<unicode string>", line 23, column 17
  did not find expected '-' indicator
    in "<unicode string>", line 26, column 17

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 207, in load
    read_files(project, self.manifest.files, project_parser_files)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 137, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 92, in read_files_for_parser
    source_files = get_source_files(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 83, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 23, in load_source_file
    dfy = yaml_from_file(source_file)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 109, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading lukeclarke_learn_dbt: example\schema.yml - Runtime Error
    Syntax error near line 26
    ------------------------------
    23 |                 - unique
    24 |                 - not_null
    25 |                 - relationships
    26 |                 to: ref("my_first_dbt_model")
    27 |                 field: id 
    28 | 
    29 | 
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 23, column 17
    did not find expected '-' indicator
      in "<unicode string>", line 26, column 17

2021-10-08 09:13:35.300839 (MainThread): Running with dbt=0.20.2
2021-10-08 09:13:35.906424 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 09:13:35.906424 (MainThread): Tracking: tracking
2021-10-08 09:13:35.906424 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056938DDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056A8BA4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056A8BA520>]}
2021-10-08 09:13:35.914438 (MainThread): Partial parsing not enabled
2021-10-08 09:13:35.917436 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056A8BA4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056A8D2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056A8D2C70>]}
2021-10-08 09:13:35.917436 (MainThread): Flushing usage events
2021-10-08 09:13:36.400900 (MainThread): Encountered an error:
2021-10-08 09:13:36.401903 (MainThread): Compilation Error
  Error reading lukeclarke_learn_dbt: example\schema.yml - Runtime Error
    Syntax error near line 26
    ------------------------------
    23 |                 - unique
    24 |                 - not_null
    25 |                 - relationships
    26 |                   to: ref("my_first_dbt_model")
    27 |                   field: id
    28 | 
    29 | 
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 26, column 21
2021-10-08 09:13:36.405898 (MainThread): Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\yaml\__init__.py", line 114, in load
    return loader.get_single_data()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml\_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml\_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 853, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.scanner.ScannerError: mapping values are not allowed in this context
  in "<unicode string>", line 26, column 21

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 106, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 26
  ------------------------------
  23 |                 - unique
  24 |                 - not_null
  25 |                 - relationships
  26 |                   to: ref("my_first_dbt_model")
  27 |                   field: id
  28 | 
  29 | 
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 26, column 21

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 207, in load
    read_files(project, self.manifest.files, project_parser_files)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 137, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 92, in read_files_for_parser
    source_files = get_source_files(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 83, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 23, in load_source_file
    dfy = yaml_from_file(source_file)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 109, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading lukeclarke_learn_dbt: example\schema.yml - Runtime Error
    Syntax error near line 26
    ------------------------------
    23 |                 - unique
    24 |                 - not_null
    25 |                 - relationships
    26 |                   to: ref("my_first_dbt_model")
    27 |                   field: id
    28 | 
    29 | 
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 26, column 21

2021-10-08 09:13:55.736460 (MainThread): Running with dbt=0.20.2
2021-10-08 09:13:56.325074 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 09:13:56.326073 (MainThread): Tracking: tracking
2021-10-08 09:13:56.326073 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002570BEEDE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002570D41ACA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002570D41A760>]}
2021-10-08 09:13:56.333074 (MainThread): Partial parsing not enabled
2021-10-08 09:13:56.346558 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:13:56.366718 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:13:56.368925 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:13:56.375835 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:13:56.376829 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:13:56.379833 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:13:56.380828 (MainThread): Parsing macros\core.sql
2021-10-08 09:13:56.383745 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:13:56.417035 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:13:56.424135 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:13:56.425126 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:13:56.426121 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:13:56.427088 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:13:56.428142 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:13:56.429129 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:13:56.436383 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:13:56.440381 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:13:56.451237 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:13:56.452244 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:13:56.459204 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:13:56.475659 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:13:56.500185 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:13:56.501184 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:13:56.515344 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:13:56.520345 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:13:56.524584 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:13:56.528348 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:13:56.530033 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:13:56.530981 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:13:56.531968 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:13:56.658103 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:13:56.664707 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:13:56.670706 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:13:56.672705 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:13:56.673705 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:13:56.675705 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:13:56.677860 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:13:56.699150 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:13:56.700150 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:13:56.701150 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:13:56.703150 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:13:56.703150 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002570D576F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002570D5A2700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002570D595400>]}
2021-10-08 09:13:56.703150 (MainThread): Flushing usage events
2021-10-08 09:13:57.228810 (MainThread): Connection 'model.lukeclarke_learn_dbt.time' was properly closed.
2021-10-08 09:13:57.228810 (MainThread): Encountered an error:
2021-10-08 09:13:57.229816 (MainThread): Compilation Error
  Invalid test config given in models\example\schema.yml:
  	test definition dictionary must have exactly one key, got [('relationships', None), ('to', 'ref("my_first_dbt_model")'), ('field', 'id')] instead (3 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)
2021-10-08 09:13:57.252453 (MainThread): Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 291, in _parse_generic_test
    builder = TestBuilder(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schema_test_builders.py", line 206, in __init__
    test_name, test_args = self.extract_test_args(test, column_name)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schema_test_builders.py", line 260, in extract_test_args
    raise_compiler_error(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  test definition dictionary must have exactly one key, got [('relationships', None), ('to', 'ref("my_first_dbt_model")'), ('field', 'id')] instead (3 keys)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 316, in load
    self.parse_project(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 405, in parse_project
    parser.parse_file(block, dct=dct)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 518, in parse_file
    self.parse_tests(test_block)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 485, in parse_tests
    self.parse_column_tests(block, column)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 214, in parse_column_tests
    self.parse_test(block, test, column)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 481, in parse_test
    self.parse_node(block)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 420, in parse_node
    node = self._parse_generic_test(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 305, in _parse_generic_test
    raise CompilationException(msg) from exc
dbt.exceptions.CompilationException: Compilation Error
  Invalid test config given in models\example\schema.yml:
  	test definition dictionary must have exactly one key, got [('relationships', None), ('to', 'ref("my_first_dbt_model")'), ('field', 'id')] instead (3 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)

2021-10-08 09:14:55.474720 (MainThread): Running with dbt=0.20.2
2021-10-08 09:14:56.104130 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 09:14:56.112913 (MainThread): Tracking: tracking
2021-10-08 09:14:56.113446 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446902DDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446A54BCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446A54B670>]}
2021-10-08 09:14:56.125017 (MainThread): Partial parsing not enabled
2021-10-08 09:14:56.143454 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:14:56.173031 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:14:56.174948 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:14:56.182367 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:14:56.183362 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:14:56.186359 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:14:56.187360 (MainThread): Parsing macros\core.sql
2021-10-08 09:14:56.189363 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:14:56.224755 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:14:56.230772 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:14:56.231759 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:14:56.232752 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:14:56.233752 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:14:56.234757 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:14:56.235765 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:14:56.244974 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:14:56.249967 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:14:56.259587 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:14:56.260587 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:14:56.265586 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:14:56.281781 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:14:56.306165 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:14:56.307166 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:14:56.317165 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:14:56.322094 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:14:56.326094 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:14:56.330094 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:14:56.332095 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:14:56.333096 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:14:56.334096 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:14:56.464599 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:14:56.471609 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:14:56.476786 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:14:56.478796 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:14:56.479792 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:14:56.481783 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:14:56.483791 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:14:56.509404 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:14:56.511403 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:14:56.512396 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:14:56.514404 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:14:56.552692 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:14:56.552692 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:14:56.553686 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:14:56.555750 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:14:56.575150 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a451b501-2284-453b-a4cf-bf96c92f7782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446A682A90>]}
2021-10-08 09:14:56.592456 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:14:56.593408 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a451b501-2284-453b-a4cf-bf96c92f7782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446A682A30>]}
2021-10-08 09:14:56.593408 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:14:56.594485 (MainThread): 
2021-10-08 09:14:56.595405 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:14:56.596403 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 09:14:56.604806 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 09:14:56.604806 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 09:14:56.604806 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 09:14:58.743491 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.14 seconds
2021-10-08 09:14:58.747343 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 09:14:59.099978 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:14:59.110975 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:14:59.110975 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:14:59.110975 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:15:00.013413 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.90 seconds
2021-10-08 09:15:00.016434 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:15:00.397382 (MainThread): Using snowflake connection "master".
2021-10-08 09:15:00.397382 (MainThread): On master: BEGIN
2021-10-08 09:15:00.397382 (MainThread): Opening a new connection, currently in state init
2021-10-08 09:15:01.501360 (MainThread): SQL status: SUCCESS 1 in 1.10 seconds
2021-10-08 09:15:01.501360 (MainThread): On master: COMMIT
2021-10-08 09:15:01.501360 (MainThread): Using snowflake connection "master".
2021-10-08 09:15:01.501360 (MainThread): On master: COMMIT
2021-10-08 09:15:01.785734 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-08 09:15:01.785734 (MainThread): On master: Close
2021-10-08 09:15:02.148133 (MainThread): 11:15:02 | Concurrency: 1 threads (target='dev')
2021-10-08 09:15:02.148133 (MainThread): 11:15:02 | 
2021-10-08 09:15:02.150132 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:15:02.150132 (Thread-1): 11:15:02 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 09:15:02.150132 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:15:02.150132 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:15:02.152134 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:15:02.155137 (Thread-1): finished collecting timing info
2021-10-08 09:15:02.202953 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:15:02.208901 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:15:02.210934 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 09:15:02.210934 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:15:03.052720 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-08 09:15:03.052720 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:15:03.052720 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null
union all
select 3 as id

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 09:15:05.205764 (Thread-1): SQL status: SUCCESS 1 in 2.15 seconds
2021-10-08 09:15:05.207790 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:15:05.208320 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:15:05.208320 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:15:05.529460 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-08 09:15:05.536534 (Thread-1): finished collecting timing info
2021-10-08 09:15:05.536534 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 09:15:05.964409 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a451b501-2284-453b-a4cf-bf96c92f7782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446A9852E0>]}
2021-10-08 09:15:05.964409 (Thread-1): 11:15:05 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 3.81s]
2021-10-08 09:15:05.965426 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:15:05.965426 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:15:05.966424 (Thread-1): 11:15:05 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 09:15:05.966424 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:15:05.966424 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:15:05.967405 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:15:05.972219 (Thread-1): finished collecting timing info
2021-10-08 09:15:05.974242 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:15:05.976649 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:15:05.976649 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 09:15:05.976649 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:15:06.824698 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-08 09:15:06.824698 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:15:06.825698 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 09:15:10.335257 (Thread-1): SQL status: SUCCESS 1 in 3.51 seconds
2021-10-08 09:15:10.336295 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:15:10.336295 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:15:10.336295 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:15:10.506016 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:15:10.506016 (Thread-1): finished collecting timing info
2021-10-08 09:15:10.506016 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 09:15:10.832557 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a451b501-2284-453b-a4cf-bf96c92f7782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446A85AAC0>]}
2021-10-08 09:15:10.832557 (Thread-1): 11:15:10 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 4.87s]
2021-10-08 09:15:10.834294 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:15:10.834294 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:15:10.834451 (Thread-1): 11:15:10 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 09:15:10.834451 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:15:10.834451 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 09:15:10.838386 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:15:10.840558 (Thread-1): finished collecting timing info
2021-10-08 09:15:10.853575 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:15:10.854561 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 09:15:10.854561 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:15:12.713945 (Thread-1): SQL status: SUCCESS 1 in 1.86 seconds
2021-10-08 09:15:12.720820 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:15:12.720820 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 09:15:12.898611 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:15:12.901097 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:15:12.901097 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:15:13.148229 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 09:15:13.150711 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:15:13.150711 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:15:13.442142 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-08 09:15:13.452156 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:15:13.454140 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:15:13.454140 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 09:15:13.650996 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 09:15:13.650996 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:15:13.650996 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 09:15:13.928814 (Thread-1): SQL status: SUCCESS 0 in 0.28 seconds
2021-10-08 09:15:13.929813 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:15:13.929813 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:15:13.929813 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:15:14.203659 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 09:15:14.203659 (Thread-1): finished collecting timing info
2021-10-08 09:15:14.203659 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 09:15:14.518989 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a451b501-2284-453b-a4cf-bf96c92f7782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446A9C6BB0>]}
2021-10-08 09:15:14.518989 (Thread-1): 11:15:14 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.68s]
2021-10-08 09:15:14.519949 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:15:14.520006 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:15:14.520264 (Thread-1): 11:15:14 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 09:15:14.520452 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:15:14.520452 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:15:14.521277 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:15:14.525716 (Thread-1): finished collecting timing info
2021-10-08 09:15:14.527405 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:15:14.528931 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:15:14.528931 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 09:15:14.528931 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:15:15.353829 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 09:15:15.353829 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:15:15.355047 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 09:15:17.176126 (Thread-1): SQL status: SUCCESS 1 in 1.82 seconds
2021-10-08 09:15:17.176126 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:15:17.176126 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:15:17.177126 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:15:17.350038 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:15:17.350038 (Thread-1): finished collecting timing info
2021-10-08 09:15:17.350038 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 09:15:17.654852 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a451b501-2284-453b-a4cf-bf96c92f7782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446A9733D0>]}
2021-10-08 09:15:17.654852 (Thread-1): 11:15:17 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.13s]
2021-10-08 09:15:17.656139 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:15:17.656171 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 09:15:17.656171 (Thread-1): 11:15:17 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 09:15:17.657417 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:15:17.657417 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 09:15:17.660070 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:15:17.663067 (Thread-1): finished collecting timing info
2021-10-08 09:15:17.665068 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:15:17.665068 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 09:15:17.665068 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:15:19.151910 (Thread-1): SQL status: SUCCESS 1 in 1.49 seconds
2021-10-08 09:15:19.154922 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:15:19.154922 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 09:15:19.359325 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 09:15:19.361524 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:15:19.361524 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:15:19.523318 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:15:19.527406 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:15:19.527406 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:15:19.715765 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:15:19.716758 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:15:19.719954 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:15:19.719954 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 09:15:19.932207 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-08 09:15:19.933137 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:15:19.933137 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 09:15:20.301934 (Thread-1): SQL status: SUCCESS 0 in 0.37 seconds
2021-10-08 09:15:20.303909 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:15:20.303909 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:15:20.303909 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:15:20.593946 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-08 09:15:20.593946 (Thread-1): finished collecting timing info
2021-10-08 09:15:20.593946 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 09:15:21.103585 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a451b501-2284-453b-a4cf-bf96c92f7782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446A991910>]}
2021-10-08 09:15:21.103585 (Thread-1): 11:15:21 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.45s]
2021-10-08 09:15:21.104585 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 09:15:21.104585 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:15:21.104585 (Thread-1): 11:15:21 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 09:15:21.105585 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:15:21.105585 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:15:21.107605 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:15:21.109584 (Thread-1): finished collecting timing info
2021-10-08 09:15:21.110607 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:15:21.112605 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:15:21.113585 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 09:15:21.113585 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:15:22.166072 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-10-08 09:15:22.166072 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:15:22.166072 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
where id = 1
      );
2021-10-08 09:15:23.259633 (Thread-1): SQL status: SUCCESS 1 in 1.09 seconds
2021-10-08 09:15:23.260734 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:15:23.261730 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:15:23.261730 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:15:23.446615 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:15:23.447692 (Thread-1): finished collecting timing info
2021-10-08 09:15:23.447692 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 09:15:23.773294 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a451b501-2284-453b-a4cf-bf96c92f7782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446AA0CE20>]}
2021-10-08 09:15:23.774292 (Thread-1): 11:15:23 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.67s]
2021-10-08 09:15:23.775289 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:15:23.776579 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:15:23.776579 (MainThread): Using snowflake connection "master".
2021-10-08 09:15:23.776579 (MainThread): On master: BEGIN
2021-10-08 09:15:23.776579 (MainThread): Opening a new connection, currently in state closed
2021-10-08 09:15:24.597869 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 09:15:24.597869 (MainThread): On master: COMMIT
2021-10-08 09:15:24.597869 (MainThread): Using snowflake connection "master".
2021-10-08 09:15:24.597869 (MainThread): On master: COMMIT
2021-10-08 09:15:24.833639 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-08 09:15:24.833639 (MainThread): On master: Close
2021-10-08 09:15:25.139862 (MainThread): 11:15:25 | 
2021-10-08 09:15:25.139862 (MainThread): 11:15:25 | Finished running 4 table models, 2 incremental models in 28.54s.
2021-10-08 09:15:25.139862 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:15:25.139862 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 09:15:25.140846 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:15:25.140846 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 09:15:25.152099 (MainThread): 
2021-10-08 09:15:25.152099 (MainThread): Completed successfully
2021-10-08 09:15:25.153070 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-08 09:15:25.153070 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446A8578E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446AA0ECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446A9852E0>]}
2021-10-08 09:15:25.153070 (MainThread): Flushing usage events
2021-10-08 09:15:48.297971 (MainThread): Running with dbt=0.20.2
2021-10-08 09:15:48.860811 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-10-08 09:15:48.860811 (MainThread): Tracking: tracking
2021-10-08 09:15:48.860811 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208ED77DE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208EECC4B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208EECC4190>]}
2021-10-08 09:15:48.868231 (MainThread): Partial parsing not enabled
2021-10-08 09:15:48.881524 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:15:48.902780 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:15:48.903781 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:15:48.910766 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:15:48.912845 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:15:48.915857 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:15:48.916843 (MainThread): Parsing macros\core.sql
2021-10-08 09:15:48.918846 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:15:48.950184 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:15:48.955874 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:15:48.955874 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:15:48.956879 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:15:48.957874 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:15:48.958884 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:15:48.959874 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:15:48.966880 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:15:48.971087 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:15:48.980097 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:15:48.982102 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:15:48.987321 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:15:49.001591 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:15:49.021849 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:15:49.022830 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:15:49.036228 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:15:49.040125 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:15:49.044212 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:15:49.048494 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:15:49.049504 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:15:49.050511 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:15:49.051495 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:15:49.176009 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:15:49.182691 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:15:49.188501 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:15:49.191505 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:15:49.191505 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:15:49.194462 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:15:49.196421 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:15:49.218955 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:15:49.221948 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:15:49.222946 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:15:49.224953 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:15:49.263067 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:15:49.263588 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:15:49.265355 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:15:49.266900 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:15:49.283007 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7589e4e8-7004-4d7d-8227-44c2ff4f1515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208EEDEAC10>]}
2021-10-08 09:15:49.300383 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:15:49.300383 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7589e4e8-7004-4d7d-8227-44c2ff4f1515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208EEDEAD60>]}
2021-10-08 09:15:49.300383 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:15:49.301403 (MainThread): 
2021-10-08 09:15:49.302402 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:15:49.303402 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:15:49.312238 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:15:49.313239 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:15:49.313239 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:15:50.567861 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.25 seconds
2021-10-08 09:15:50.572531 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:15:50.862054 (MainThread): 11:15:50 | Concurrency: 1 threads (target='dev')
2021-10-08 09:15:50.862054 (MainThread): 11:15:50 | 
2021-10-08 09:15:50.864457 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 09:15:50.864457 (Thread-1): 11:15:50 | 1 of 7 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-10-08 09:15:50.865464 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 09:15:50.865464 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 09:15:50.869541 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 09:15:50.871465 (Thread-1): finished collecting timing info
2021-10-08 09:15:50.881916 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"
2021-10-08 09:15:50.884837 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 09:15:50.884837 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: BEGIN
2021-10-08 09:15:50.884837 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:15:51.726074 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-08 09:15:51.726074 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44".
2021-10-08 09:15:51.726074 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.first_model
where id is null



      
    ) dbt_internal_test
2021-10-08 09:15:52.046073 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-08 09:15:52.047140 (Thread-1): finished collecting timing info
2021-10-08 09:15:52.048244 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: ROLLBACK
2021-10-08 09:15:52.297076 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44: Close
2021-10-08 09:15:52.595680 (Thread-1): 11:15:52 | 1 of 7 PASS not_null_my_first_dbt_model_id........................... [PASS in 1.73s]
2021-10-08 09:15:52.596679 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_first_dbt_model_id.f479667b44
2021-10-08 09:15:52.596679 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:15:52.596679 (Thread-1): 11:15:52 | 2 of 7 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-10-08 09:15:52.596679 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:15:52.596679 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:15:52.599681 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 09:15:52.601703 (Thread-1): finished collecting timing info
2021-10-08 09:15:52.603682 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 09:15:52.605686 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:15:52.605686 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: BEGIN
2021-10-08 09:15:52.605686 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:15:53.433297 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-08 09:15:53.433799 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:15:53.433799 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
2021-10-08 09:15:53.812952 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-10-08 09:15:53.812952 (Thread-1): finished collecting timing info
2021-10-08 09:15:53.813937 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: ROLLBACK
2021-10-08 09:15:54.079212 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-10-08 09:15:54.412112 (Thread-1): 11:15:54 | 2 of 7 PASS not_null_my_second_dbt_model_id.......................... [PASS in 1.81s]
2021-10-08 09:15:54.413733 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:15:54.413733 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:15:54.413733 (Thread-1): 11:15:54 | 3 of 7 START test not_null_snowflake_customer_purchases_c_custkey.... [RUN]
2021-10-08 09:15:54.414776 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:15:54.414776 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:15:54.421815 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 09:15:54.424727 (Thread-1): finished collecting timing info
2021-10-08 09:15:54.425834 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 09:15:54.428122 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:15:54.428122 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: BEGIN
2021-10-08 09:15:54.428122 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:15:55.602278 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2021-10-08 09:15:55.603362 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:15:55.603362 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.snowflake_customer_purchases
where c_custkey is null



      
    ) dbt_internal_test
2021-10-08 09:15:55.971187 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-10-08 09:15:55.972171 (Thread-1): finished collecting timing info
2021-10-08 09:15:55.972171 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: ROLLBACK
2021-10-08 09:15:56.228894 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: Close
2021-10-08 09:15:56.521072 (Thread-1): 11:15:56 | 3 of 7 PASS not_null_snowflake_customer_purchases_c_custkey.......... [PASS in 2.11s]
2021-10-08 09:15:56.522313 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:15:56.523263 (Thread-1): Began running node test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 09:15:56.523263 (Thread-1): 11:15:56 | 4 of 7 START test relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_ [RUN]
2021-10-08 09:15:56.523263 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 09:15:56.523263 (Thread-1): Compiling test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 09:15:56.529683 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"
2021-10-08 09:15:56.530646 (Thread-1): finished collecting timing info
2021-10-08 09:15:56.532591 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"
2021-10-08 09:15:56.534591 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 09:15:56.534591 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: BEGIN
2021-10-08 09:15:56.534591 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:15:57.479565 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-10-08 09:15:57.479565 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 09:15:57.479565 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select id as from_field
    from analytics.dbt.my_second_dbt_model
    where id is not null
),

parent as (
    select id as to_field
    from analytics.dbt.first_model
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
2021-10-08 09:15:57.848749 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-10-08 09:15:57.848749 (Thread-1): finished collecting timing info
2021-10-08 09:15:57.849750 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: ROLLBACK
2021-10-08 09:15:58.132896 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: Close
2021-10-08 09:15:58.446599 (Thread-1): 11:15:58 | 4 of 7 PASS relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_ [PASS in 1.92s]
2021-10-08 09:15:58.447599 (Thread-1): Finished running node test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 09:15:58.447599 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:15:58.447599 (Thread-1): 11:15:58 | 5 of 7 START test unique_my_first_dbt_model_id....................... [RUN]
2021-10-08 09:15:58.447599 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:15:58.447599 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:15:58.452880 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 09:15:58.455095 (Thread-1): finished collecting timing info
2021-10-08 09:15:58.457094 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 09:15:58.459517 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:15:58.459517 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: BEGIN
2021-10-08 09:15:58.460055 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:15:59.389442 (Thread-1): SQL status: SUCCESS 1 in 0.93 seconds
2021-10-08 09:15:59.390423 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:15:59.390423 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.first_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:15:59.732244 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-10-08 09:15:59.733246 (Thread-1): finished collecting timing info
2021-10-08 09:15:59.733246 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: ROLLBACK
2021-10-08 09:15:59.988832 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-08 09:16:00.284272 (Thread-1): 11:16:00 | 5 of 7 PASS unique_my_first_dbt_model_id............................. [PASS in 1.84s]
2021-10-08 09:16:00.286196 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:16:00.286196 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:16:00.287199 (Thread-1): 11:16:00 | 6 of 7 START test unique_my_second_dbt_model_id...................... [RUN]
2021-10-08 09:16:00.287199 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:16:00.287199 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:16:00.294292 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 09:16:00.296257 (Thread-1): finished collecting timing info
2021-10-08 09:16:00.297193 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 09:16:00.303190 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:16:00.303190 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: BEGIN
2021-10-08 09:16:00.303190 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:16:01.243794 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-10-08 09:16:01.243794 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:16:01.243794 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:16:01.523385 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-08 09:16:01.524476 (Thread-1): finished collecting timing info
2021-10-08 09:16:01.524476 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: ROLLBACK
2021-10-08 09:16:01.793781 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: Close
2021-10-08 09:16:02.122634 (Thread-1): 11:16:02 | 6 of 7 PASS unique_my_second_dbt_model_id............................ [PASS in 1.84s]
2021-10-08 09:16:02.123632 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:16:02.123632 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:16:02.123632 (Thread-1): 11:16:02 | 7 of 7 START test unique_snowflake_customer_purchases_c_custkey...... [RUN]
2021-10-08 09:16:02.124966 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:16:02.124966 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:16:02.126971 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 09:16:02.130862 (Thread-1): finished collecting timing info
2021-10-08 09:16:02.131905 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 09:16:02.133891 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:16:02.133891 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: BEGIN
2021-10-08 09:16:02.133891 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:16:03.168044 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-10-08 09:16:03.169061 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:16:03.169093 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.snowflake_customer_purchases
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:16:03.664371 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-10-08 09:16:03.665371 (Thread-1): finished collecting timing info
2021-10-08 09:16:03.665371 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: ROLLBACK
2021-10-08 09:16:03.925970 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: Close
2021-10-08 09:16:04.291222 (Thread-1): 11:16:04 | 7 of 7 PASS unique_snowflake_customer_purchases_c_custkey............ [PASS in 2.17s]
2021-10-08 09:16:04.292148 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:16:04.294147 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:16:04.294147 (MainThread): 11:16:04 | 
2021-10-08 09:16:04.294147 (MainThread): 11:16:04 | Finished running 7 tests in 14.99s.
2021-10-08 09:16:04.294147 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:16:04.294147 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:16:04.294147 (MainThread): Connection 'test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8' was properly closed.
2021-10-08 09:16:04.315971 (MainThread): 
2021-10-08 09:16:04.315971 (MainThread): Completed successfully
2021-10-08 09:16:04.317485 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-08 09:16:04.317485 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208EEDB8DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208EF127EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208EEF7C8B0>]}
2021-10-08 09:16:04.317485 (MainThread): Flushing usage events
2021-10-08 09:42:15.192836 (MainThread): Running with dbt=0.20.2
2021-10-08 09:42:15.925579 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 09:42:15.925579 (MainThread): Tracking: tracking
2021-10-08 09:42:15.926509 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230014CCDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002B4AA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002B4A880>]}
2021-10-08 09:42:15.933757 (MainThread): Partial parsing not enabled
2021-10-08 09:42:15.960147 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:42:15.987197 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:42:15.989213 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:42:15.998138 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:42:16.000127 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:42:16.003151 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:42:16.005130 (MainThread): Parsing macros\core.sql
2021-10-08 09:42:16.008015 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:42:16.042036 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:42:16.048053 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:42:16.049041 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:42:16.049957 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:42:16.052043 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:42:16.052957 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:42:16.054598 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:42:16.061988 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:42:16.066906 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:42:16.075991 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:42:16.077998 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:42:16.082992 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:42:16.098490 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:42:16.120559 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:42:16.121542 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:42:16.134699 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:42:16.139783 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:42:16.142785 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:42:16.147975 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:42:16.149129 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:42:16.150146 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:42:16.151171 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:42:16.282788 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:42:16.290363 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:42:16.296363 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:42:16.298454 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:42:16.299462 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:42:16.304105 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:42:16.306245 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:42:16.314160 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:42:16.316162 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:42:16.370974 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:42:16.371980 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:42:16.373981 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:42:16.381106 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:42:16.381106 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:42:16.383107 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:42:16.384088 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:42:16.404459 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '509f926c-5139-440c-b40d-f77b764d7f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002C61850>]}
2021-10-08 09:42:16.432859 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:42:16.433428 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '509f926c-5139-440c-b40d-f77b764d7f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002C61BB0>]}
2021-10-08 09:42:16.433973 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:42:16.435429 (MainThread): 
2021-10-08 09:42:16.435816 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:42:16.437765 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 09:42:16.452705 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 09:42:16.453292 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 09:42:16.453292 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 09:42:17.976040 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.52 seconds
2021-10-08 09:42:17.978469 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 09:42:18.270545 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:42:18.274538 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:42:18.274538 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:42:18.274538 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:42:19.048617 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.77 seconds
2021-10-08 09:42:19.049618 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:42:19.340207 (MainThread): Using snowflake connection "master".
2021-10-08 09:42:19.340207 (MainThread): On master: BEGIN
2021-10-08 09:42:19.340207 (MainThread): Opening a new connection, currently in state init
2021-10-08 09:42:20.125413 (MainThread): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 09:42:20.125413 (MainThread): On master: COMMIT
2021-10-08 09:42:20.126423 (MainThread): Using snowflake connection "master".
2021-10-08 09:42:20.126423 (MainThread): On master: COMMIT
2021-10-08 09:42:20.367158 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-08 09:42:20.367477 (MainThread): On master: Close
2021-10-08 09:42:20.671873 (MainThread): 11:42:20 | Concurrency: 1 threads (target='dev')
2021-10-08 09:42:20.671873 (MainThread): 11:42:20 | 
2021-10-08 09:42:20.674287 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:42:20.674287 (Thread-1): 11:42:20 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 09:42:20.675290 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:42:20.675290 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:42:20.677289 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:42:20.679287 (Thread-1): finished collecting timing info
2021-10-08 09:42:20.705168 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:42:20.710920 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:42:20.710920 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 09:42:20.710920 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:42:21.760973 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-10-08 09:42:21.760973 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:42:21.760973 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 09:42:23.344587 (Thread-1): SQL status: SUCCESS 1 in 1.58 seconds
2021-10-08 09:42:23.345590 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:42:23.345590 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:42:23.345590 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:42:23.513414 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:42:23.526520 (Thread-1): finished collecting timing info
2021-10-08 09:42:23.526690 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 09:42:23.827553 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '509f926c-5139-440c-b40d-f77b764d7f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002C616A0>]}
2021-10-08 09:42:23.827553 (Thread-1): 11:42:23 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 3.15s]
2021-10-08 09:42:23.829493 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:42:23.829493 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:42:23.829493 (Thread-1): 11:42:23 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 09:42:23.829493 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:42:23.830458 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:42:23.830458 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:42:23.836956 (Thread-1): finished collecting timing info
2021-10-08 09:42:23.839042 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:42:23.856109 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:42:23.856109 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 09:42:23.856109 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:42:24.675297 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 09:42:24.675297 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:42:24.675297 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 09:42:26.380655 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2021-10-08 09:42:26.381816 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:42:26.381816 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:42:26.381816 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:42:26.542008 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:42:26.543012 (Thread-1): finished collecting timing info
2021-10-08 09:42:26.543012 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 09:42:26.835814 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '509f926c-5139-440c-b40d-f77b764d7f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002E26C70>]}
2021-10-08 09:42:26.836815 (Thread-1): 11:42:26 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.01s]
2021-10-08 09:42:26.837816 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:42:26.838816 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:42:26.838816 (Thread-1): 11:42:26 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 09:42:26.838816 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:42:26.839813 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 09:42:26.843814 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:42:26.848482 (Thread-1): finished collecting timing info
2021-10-08 09:42:26.869782 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:42:26.869782 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 09:42:26.869782 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:42:28.311418 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-10-08 09:42:28.317433 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:42:28.317433 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 09:42:28.508154 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:42:28.511194 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:42:28.511194 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:42:28.676293 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:42:28.679302 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:42:28.679302 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:42:28.854361 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:42:28.879754 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:42:28.887753 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:42:28.887753 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 09:42:29.081349 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:42:29.082348 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:42:29.082348 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 09:42:29.753952 (Thread-1): SQL status: SUCCESS 0 in 0.67 seconds
2021-10-08 09:42:29.755949 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:42:29.755949 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:42:29.755949 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:42:30.027596 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 09:42:30.028603 (Thread-1): finished collecting timing info
2021-10-08 09:42:30.028603 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 09:42:30.334853 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '509f926c-5139-440c-b40d-f77b764d7f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002FC3DC0>]}
2021-10-08 09:42:30.335315 (Thread-1): 11:42:30 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.50s]
2021-10-08 09:42:30.336892 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:42:30.336892 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:42:30.336892 (Thread-1): 11:42:30 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 09:42:30.337904 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:42:30.337904 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:42:30.339907 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:42:30.345151 (Thread-1): finished collecting timing info
2021-10-08 09:42:30.347127 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:42:30.353661 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:42:30.353661 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 09:42:30.353661 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:42:31.171591 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 09:42:31.171591 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:42:31.172659 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 09:42:33.036531 (Thread-1): SQL status: SUCCESS 1 in 1.86 seconds
2021-10-08 09:42:33.038718 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:42:33.038718 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:42:33.039710 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:42:33.198849 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:42:33.199848 (Thread-1): finished collecting timing info
2021-10-08 09:42:33.199848 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 09:42:33.523148 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '509f926c-5139-440c-b40d-f77b764d7f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002F797F0>]}
2021-10-08 09:42:33.523148 (Thread-1): 11:42:33 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.19s]
2021-10-08 09:42:33.524072 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:42:33.524072 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 09:42:33.525078 (Thread-1): 11:42:33 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 09:42:33.525078 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:42:33.525078 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 09:42:33.528297 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:42:33.529647 (Thread-1): finished collecting timing info
2021-10-08 09:42:33.532135 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:42:33.532222 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 09:42:33.532278 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:42:35.136002 (Thread-1): SQL status: SUCCESS 1 in 1.60 seconds
2021-10-08 09:42:35.137048 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:42:35.138093 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 09:42:35.330549 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:42:35.334556 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:42:35.334556 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:42:35.508683 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:42:35.510551 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:42:35.510651 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:42:35.672779 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:42:35.674773 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:42:35.676779 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:42:35.676779 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 09:42:35.863447 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:42:35.864415 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:42:35.864415 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 09:42:36.235781 (Thread-1): SQL status: SUCCESS 0 in 0.37 seconds
2021-10-08 09:42:36.235781 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:42:36.235781 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:42:36.235781 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:42:36.540160 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-10-08 09:42:36.541384 (Thread-1): finished collecting timing info
2021-10-08 09:42:36.541384 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 09:42:36.856424 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '509f926c-5139-440c-b40d-f77b764d7f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023003006910>]}
2021-10-08 09:42:36.856424 (Thread-1): 11:42:36 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.33s]
2021-10-08 09:42:36.857420 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 09:42:36.857420 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:42:36.857420 (Thread-1): 11:42:36 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 09:42:36.857420 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:42:36.857420 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:42:36.859422 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:42:36.860446 (Thread-1): finished collecting timing info
2021-10-08 09:42:36.861422 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:42:36.867235 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:42:36.867235 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 09:42:36.867235 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:42:37.675806 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-08 09:42:37.675806 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:42:37.675806 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-08 09:42:38.821310 (Thread-1): SQL status: SUCCESS 1 in 1.15 seconds
2021-10-08 09:42:38.822847 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:42:38.823028 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:42:38.823028 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:42:38.986121 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:42:38.987131 (Thread-1): finished collecting timing info
2021-10-08 09:42:38.987131 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 09:42:39.292074 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '509f926c-5139-440c-b40d-f77b764d7f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002B4DFA0>]}
2021-10-08 09:42:39.293146 (Thread-1): 11:42:39 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.43s]
2021-10-08 09:42:39.294105 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:42:39.294105 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:42:39.295100 (MainThread): Using snowflake connection "master".
2021-10-08 09:42:39.295100 (MainThread): On master: BEGIN
2021-10-08 09:42:39.295100 (MainThread): Opening a new connection, currently in state closed
2021-10-08 09:42:40.154414 (MainThread): SQL status: SUCCESS 1 in 0.86 seconds
2021-10-08 09:42:40.155144 (MainThread): On master: COMMIT
2021-10-08 09:42:40.155334 (MainThread): Using snowflake connection "master".
2021-10-08 09:42:40.155393 (MainThread): On master: COMMIT
2021-10-08 09:42:40.405509 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 09:42:40.406510 (MainThread): On master: Close
2021-10-08 09:42:40.800456 (MainThread): 11:42:40 | 
2021-10-08 09:42:40.800784 (MainThread): 11:42:40 | Finished running 4 table models, 2 incremental models in 24.36s.
2021-10-08 09:42:40.800784 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:42:40.800784 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 09:42:40.800784 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:42:40.800784 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 09:42:40.816851 (MainThread): 
2021-10-08 09:42:40.816851 (MainThread): Completed successfully
2021-10-08 09:42:40.817351 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-08 09:42:40.817894 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002C11AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023002B4DFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002300302AA90>]}
2021-10-08 09:42:40.817894 (MainThread): Flushing usage events
2021-10-08 09:44:04.371677 (MainThread): Running with dbt=0.20.2
2021-10-08 09:44:04.938546 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 09:44:04.939546 (MainThread): Tracking: tracking
2021-10-08 09:44:04.939546 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FAE9CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FC3E42B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FC3E4700>]}
2021-10-08 09:44:04.945546 (MainThread): Partial parsing not enabled
2021-10-08 09:44:04.962112 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:44:04.985849 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:44:04.986850 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:44:04.993848 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:44:04.994850 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:44:04.998850 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:44:04.999849 (MainThread): Parsing macros\core.sql
2021-10-08 09:44:05.003848 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:44:05.038187 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:44:05.043311 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:44:05.043893 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:44:05.044983 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:44:05.046903 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:44:05.047998 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:44:05.048995 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:44:05.055987 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:44:05.061431 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:44:05.070432 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:44:05.072436 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:44:05.078064 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:44:05.092349 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:44:05.113195 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:44:05.114195 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:44:05.126488 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:44:05.130488 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:44:05.134477 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:44:05.138226 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:44:05.140233 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:44:05.140233 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:44:05.141249 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:44:05.263967 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:44:05.270966 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:44:05.276210 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:44:05.278206 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:44:05.278206 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:44:05.281212 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:44:05.282208 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:44:05.292663 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:44:05.294666 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:44:05.345017 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:44:05.346019 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:44:05.348019 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:44:05.354506 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:44:05.354506 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:44:05.356576 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:44:05.357564 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:44:05.372867 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f80e8c84-d204-439f-a66d-71c589703680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FC450790>]}
2021-10-08 09:44:05.398420 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:44:05.399565 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f80e8c84-d204-439f-a66d-71c589703680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FC459550>]}
2021-10-08 09:44:05.399749 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:44:05.400321 (MainThread): 
2021-10-08 09:44:05.401543 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:44:05.403542 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 09:44:05.416010 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 09:44:05.416010 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 09:44:05.416010 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 09:44:06.968369 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.55 seconds
2021-10-08 09:44:06.974710 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 09:44:07.317832 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:44:07.322807 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:44:07.322807 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:44:07.322807 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:44:08.594073 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.27 seconds
2021-10-08 09:44:08.595093 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:44:08.943578 (MainThread): Using snowflake connection "master".
2021-10-08 09:44:08.943578 (MainThread): On master: BEGIN
2021-10-08 09:44:08.943578 (MainThread): Opening a new connection, currently in state init
2021-10-08 09:44:09.875647 (MainThread): SQL status: SUCCESS 1 in 0.93 seconds
2021-10-08 09:44:09.875647 (MainThread): On master: COMMIT
2021-10-08 09:44:09.875647 (MainThread): Using snowflake connection "master".
2021-10-08 09:44:09.876645 (MainThread): On master: COMMIT
2021-10-08 09:44:10.220249 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-10-08 09:44:10.221259 (MainThread): On master: Close
2021-10-08 09:44:10.525848 (MainThread): 11:44:10 | Concurrency: 1 threads (target='dev')
2021-10-08 09:44:10.526666 (MainThread): 11:44:10 | 
2021-10-08 09:44:10.529163 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:44:10.529163 (Thread-1): 11:44:10 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 09:44:10.530243 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:44:10.530243 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:44:10.534244 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:44:10.543224 (Thread-1): finished collecting timing info
2021-10-08 09:44:10.561813 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:44:10.569957 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:44:10.569957 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 09:44:10.569957 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:44:11.575364 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-08 09:44:11.576365 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:44:11.576365 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all 
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 09:44:12.788349 (Thread-1): SQL status: SUCCESS 1 in 1.21 seconds
2021-10-08 09:44:12.788349 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:44:12.789338 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:44:12.789338 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:44:12.953907 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:44:12.965388 (Thread-1): finished collecting timing info
2021-10-08 09:44:12.965388 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 09:44:13.257981 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f80e8c84-d204-439f-a66d-71c589703680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FC3E43D0>]}
2021-10-08 09:44:13.257981 (Thread-1): 11:44:13 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.73s]
2021-10-08 09:44:13.258960 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:44:13.258960 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:44:13.258960 (Thread-1): 11:44:13 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 09:44:13.259974 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:44:13.259974 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:44:13.259974 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:44:13.264981 (Thread-1): finished collecting timing info
2021-10-08 09:44:13.267476 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:44:13.268882 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:44:13.268882 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 09:44:13.268882 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:44:14.142670 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-08 09:44:14.142670 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:44:14.142670 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 09:44:16.177898 (Thread-1): SQL status: SUCCESS 1 in 2.04 seconds
2021-10-08 09:44:16.179784 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:44:16.179784 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:44:16.179784 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:44:16.354448 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:44:16.355519 (Thread-1): finished collecting timing info
2021-10-08 09:44:16.355519 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 09:44:16.648158 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f80e8c84-d204-439f-a66d-71c589703680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FAE9C040>]}
2021-10-08 09:44:16.649163 (Thread-1): 11:44:16 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.39s]
2021-10-08 09:44:16.651489 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:44:16.651489 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:44:16.651489 (Thread-1): 11:44:16 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 09:44:16.652591 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:44:16.652591 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 09:44:16.657590 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:44:16.659513 (Thread-1): finished collecting timing info
2021-10-08 09:44:16.673506 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:44:16.673506 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 09:44:16.673506 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:44:18.153758 (Thread-1): SQL status: SUCCESS 1 in 1.48 seconds
2021-10-08 09:44:18.159056 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:44:18.159056 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 09:44:18.341970 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:44:18.343852 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:44:18.343852 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:44:18.502640 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:44:18.504636 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:44:18.504636 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:44:18.672795 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:44:18.682023 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:44:18.683032 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:44:18.684034 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 09:44:18.869815 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:44:18.869815 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:44:18.869815 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 09:44:19.252656 (Thread-1): SQL status: SUCCESS 0 in 0.38 seconds
2021-10-08 09:44:19.254582 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:44:19.254582 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:44:19.254582 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:44:19.535309 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-08 09:44:19.537306 (Thread-1): finished collecting timing info
2021-10-08 09:44:19.537306 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 09:44:19.846208 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f80e8c84-d204-439f-a66d-71c589703680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FAE9C040>]}
2021-10-08 09:44:19.846208 (Thread-1): 11:44:19 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.19s]
2021-10-08 09:44:19.849208 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:44:19.849208 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:44:19.849208 (Thread-1): 11:44:19 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 09:44:19.849208 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:44:19.850202 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:44:19.850202 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:44:19.856203 (Thread-1): finished collecting timing info
2021-10-08 09:44:19.858202 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:44:19.860202 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:44:19.860202 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 09:44:19.860202 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:44:20.867287 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-08 09:44:20.867287 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:44:20.867287 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 09:44:22.386563 (Thread-1): SQL status: SUCCESS 1 in 1.52 seconds
2021-10-08 09:44:22.387688 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:44:22.387688 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:44:22.387688 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:44:22.551153 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:44:22.553149 (Thread-1): finished collecting timing info
2021-10-08 09:44:22.553149 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 09:44:22.846953 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f80e8c84-d204-439f-a66d-71c589703680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FC48EBB0>]}
2021-10-08 09:44:22.847989 (Thread-1): 11:44:22 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.00s]
2021-10-08 09:44:22.849769 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:44:22.849769 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 09:44:22.850862 (Thread-1): 11:44:22 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 09:44:22.850862 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:44:22.850862 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 09:44:22.854035 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:44:22.856140 (Thread-1): finished collecting timing info
2021-10-08 09:44:22.858140 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:44:22.858140 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 09:44:22.858140 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:44:24.093785 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-10-08 09:44:24.098375 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:44:24.098375 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 09:44:24.279965 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:44:24.282738 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:44:24.282738 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:44:24.451079 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:44:24.454386 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:44:24.454386 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:44:24.689156 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-08 09:44:24.691112 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:44:24.693114 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:44:24.693114 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 09:44:24.898562 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-08 09:44:24.898562 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:44:24.899569 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 09:44:25.239553 (Thread-1): SQL status: SUCCESS 0 in 0.34 seconds
2021-10-08 09:44:25.241549 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:44:25.241549 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:44:25.241549 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:44:25.489239 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 09:44:25.490217 (Thread-1): finished collecting timing info
2021-10-08 09:44:25.490217 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 09:44:25.791720 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f80e8c84-d204-439f-a66d-71c589703680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FAE9C040>]}
2021-10-08 09:44:25.792721 (Thread-1): 11:44:25 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 2.94s]
2021-10-08 09:44:25.794315 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 09:44:25.794315 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:44:25.795345 (Thread-1): 11:44:25 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 09:44:25.795345 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:44:25.796410 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:44:25.799404 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:44:25.805131 (Thread-1): finished collecting timing info
2021-10-08 09:44:25.807132 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:44:25.810882 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:44:25.810882 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 09:44:25.810882 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:44:26.598871 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 09:44:26.598871 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:44:26.598871 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-08 09:44:27.790523 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2021-10-08 09:44:27.792518 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:44:27.792518 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:44:27.793518 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:44:27.951107 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:44:27.952110 (Thread-1): finished collecting timing info
2021-10-08 09:44:27.952110 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 09:44:28.275063 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f80e8c84-d204-439f-a66d-71c589703680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FC4CE910>]}
2021-10-08 09:44:28.275489 (Thread-1): 11:44:28 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.48s]
2021-10-08 09:44:28.276000 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:44:28.277102 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:44:28.277102 (MainThread): Using snowflake connection "master".
2021-10-08 09:44:28.277102 (MainThread): On master: BEGIN
2021-10-08 09:44:28.277102 (MainThread): Opening a new connection, currently in state closed
2021-10-08 09:44:29.083149 (MainThread): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-08 09:44:29.083149 (MainThread): On master: COMMIT
2021-10-08 09:44:29.083149 (MainThread): Using snowflake connection "master".
2021-10-08 09:44:29.083149 (MainThread): On master: COMMIT
2021-10-08 09:44:29.358564 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 09:44:29.358564 (MainThread): On master: Close
2021-10-08 09:44:29.673727 (MainThread): 11:44:29 | 
2021-10-08 09:44:29.674731 (MainThread): 11:44:29 | Finished running 4 table models, 2 incremental models in 24.27s.
2021-10-08 09:44:29.675667 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:44:29.675667 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 09:44:29.675667 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:44:29.675667 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 09:44:29.691551 (MainThread): 
2021-10-08 09:44:29.691551 (MainThread): Completed successfully
2021-10-08 09:44:29.692557 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-08 09:44:29.692557 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FC827550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FC48EBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FC838580>]}
2021-10-08 09:44:29.692557 (MainThread): Flushing usage events
2021-10-08 09:45:00.196778 (MainThread): Running with dbt=0.20.2
2021-10-08 09:45:00.807955 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 09:45:00.808957 (MainThread): Tracking: tracking
2021-10-08 09:45:00.808957 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001896135CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001896288AA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001896288A400>]}
2021-10-08 09:45:00.814957 (MainThread): Partial parsing not enabled
2021-10-08 09:45:00.828972 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:45:00.847336 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:45:00.848331 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:45:00.853331 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:45:00.854331 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:45:00.856331 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:45:00.857333 (MainThread): Parsing macros\core.sql
2021-10-08 09:45:00.859331 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:45:00.888160 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:45:00.895159 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:45:00.896159 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:45:00.897162 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:45:00.898164 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:45:00.899162 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:45:00.900162 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:45:00.907160 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:45:00.912178 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:45:00.921179 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:45:00.923180 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:45:00.928178 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:45:00.943179 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:45:00.964131 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:45:00.965134 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:45:00.978132 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:45:00.984202 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:45:00.988086 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:45:00.994185 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:45:00.996228 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:45:00.997205 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:45:00.998591 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:45:01.141322 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:45:01.148325 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:45:01.153326 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:45:01.155326 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:45:01.156326 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:45:01.158326 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:45:01.161428 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:45:01.172430 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:45:01.173417 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:45:01.225191 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:45:01.226201 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:45:01.228186 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:45:01.236116 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:45:01.236617 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:45:01.237623 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:45:01.239623 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:45:01.256509 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd43a4b8d-1711-4e4f-923a-8430b2110f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189629021F0>]}
2021-10-08 09:45:01.288865 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:45:01.289965 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd43a4b8d-1711-4e4f-923a-8430b2110f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018962902DF0>]}
2021-10-08 09:45:01.289965 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:45:01.290904 (MainThread): 
2021-10-08 09:45:01.290904 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:45:01.292867 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 09:45:01.304256 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 09:45:01.304256 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 09:45:01.305255 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 09:45:02.969351 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.67 seconds
2021-10-08 09:45:02.972368 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 09:45:03.323302 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:45:03.328310 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:45:03.328310 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:45:03.328310 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:45:04.331497 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.00 seconds
2021-10-08 09:45:04.332498 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:45:04.624040 (MainThread): Using snowflake connection "master".
2021-10-08 09:45:04.624134 (MainThread): On master: BEGIN
2021-10-08 09:45:04.624134 (MainThread): Opening a new connection, currently in state init
2021-10-08 09:45:05.394240 (MainThread): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-08 09:45:05.394240 (MainThread): On master: COMMIT
2021-10-08 09:45:05.394240 (MainThread): Using snowflake connection "master".
2021-10-08 09:45:05.394240 (MainThread): On master: COMMIT
2021-10-08 09:45:05.652805 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-08 09:45:05.652805 (MainThread): On master: Close
2021-10-08 09:45:05.943528 (MainThread): 11:45:05 | Concurrency: 1 threads (target='dev')
2021-10-08 09:45:05.943528 (MainThread): 11:45:05 | 
2021-10-08 09:45:05.948268 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:45:05.948268 (Thread-1): 11:45:05 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 09:45:05.949285 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:45:05.949285 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:45:05.953366 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:45:05.963684 (Thread-1): finished collecting timing info
2021-10-08 09:45:05.983008 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:45:05.989553 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:45:05.989553 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 09:45:05.989553 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:45:06.854000 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-10-08 09:45:06.854141 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:45:06.854188 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all 
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 09:45:07.827149 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-08 09:45:07.828139 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:45:07.828139 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:45:07.828139 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:45:07.988526 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:45:07.995601 (Thread-1): finished collecting timing info
2021-10-08 09:45:07.995601 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 09:45:08.282862 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43a4b8d-1711-4e4f-923a-8430b2110f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018962B66BE0>]}
2021-10-08 09:45:08.283862 (Thread-1): 11:45:08 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.33s]
2021-10-08 09:45:08.284862 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:45:08.284862 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:45:08.285865 (Thread-1): 11:45:08 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 09:45:08.286864 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:45:08.286864 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:45:08.287862 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:45:08.294077 (Thread-1): finished collecting timing info
2021-10-08 09:45:08.296100 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:45:08.297863 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:45:08.297863 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 09:45:08.297863 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:45:09.184421 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-10-08 09:45:09.184421 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:45:09.185466 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 09:45:10.588618 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-10-08 09:45:10.589657 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:45:10.589657 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:45:10.589657 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:45:10.756953 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:45:10.759027 (Thread-1): finished collecting timing info
2021-10-08 09:45:10.759027 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 09:45:11.063960 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43a4b8d-1711-4e4f-923a-8430b2110f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018962BC7EB0>]}
2021-10-08 09:45:11.063960 (Thread-1): 11:45:11 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.78s]
2021-10-08 09:45:11.065958 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:45:11.065958 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:45:11.065958 (Thread-1): 11:45:11 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 09:45:11.066958 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:45:11.066958 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 09:45:11.071955 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:45:11.076295 (Thread-1): finished collecting timing info
2021-10-08 09:45:11.089297 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:45:11.089297 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 09:45:11.089297 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:45:12.371982 (Thread-1): SQL status: SUCCESS 1 in 1.28 seconds
2021-10-08 09:45:12.378981 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:45:12.378981 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 09:45:12.560229 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:45:12.563605 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:45:12.563605 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:45:12.741473 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:45:12.744850 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:45:12.745117 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:45:12.925812 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:45:12.934810 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:45:12.938642 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:45:12.938642 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 09:45:13.123004 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:45:13.123004 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:45:13.123004 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 09:45:13.516289 (Thread-1): SQL status: SUCCESS 0 in 0.39 seconds
2021-10-08 09:45:13.517288 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:45:13.517288 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:45:13.517288 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:45:13.792637 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-08 09:45:13.793637 (Thread-1): finished collecting timing info
2021-10-08 09:45:13.794639 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 09:45:14.140023 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43a4b8d-1711-4e4f-923a-8430b2110f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018962927E20>]}
2021-10-08 09:45:14.140023 (Thread-1): 11:45:14 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.07s]
2021-10-08 09:45:14.141104 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:45:14.141104 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:45:14.142105 (Thread-1): 11:45:14 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 09:45:14.142105 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:45:14.142105 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:45:14.143104 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:45:14.148023 (Thread-1): finished collecting timing info
2021-10-08 09:45:14.148986 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:45:14.151007 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:45:14.151007 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 09:45:14.151007 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:45:15.149178 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-08 09:45:15.150295 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:45:15.150349 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 09:45:16.523107 (Thread-1): SQL status: SUCCESS 1 in 1.37 seconds
2021-10-08 09:45:16.523107 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:45:16.523107 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:45:16.524137 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:45:16.688499 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:45:16.688499 (Thread-1): finished collecting timing info
2021-10-08 09:45:16.688499 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 09:45:16.980953 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43a4b8d-1711-4e4f-923a-8430b2110f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001896289CC70>]}
2021-10-08 09:45:16.982041 (Thread-1): 11:45:16 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.84s]
2021-10-08 09:45:16.983487 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:45:16.984551 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 09:45:16.984551 (Thread-1): 11:45:16 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 09:45:16.984551 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:45:16.984551 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 09:45:16.987479 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:45:16.989478 (Thread-1): finished collecting timing info
2021-10-08 09:45:16.990478 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:45:16.990478 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 09:45:16.990478 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:45:18.320020 (Thread-1): SQL status: SUCCESS 1 in 1.33 seconds
2021-10-08 09:45:18.321508 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:45:18.321508 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 09:45:18.537164 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-08 09:45:18.540263 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:45:18.540263 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:45:18.704932 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:45:18.706458 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:45:18.706458 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:45:18.861773 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:45:18.862789 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:45:18.864975 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:45:18.864975 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 09:45:19.048009 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:45:19.049008 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:45:19.049008 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 09:45:19.340447 (Thread-1): SQL status: SUCCESS 0 in 0.29 seconds
2021-10-08 09:45:19.342034 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:45:19.342034 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:45:19.342034 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:45:19.666435 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-08 09:45:19.666435 (Thread-1): finished collecting timing info
2021-10-08 09:45:19.667473 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 09:45:20.046282 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43a4b8d-1711-4e4f-923a-8430b2110f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001896298D280>]}
2021-10-08 09:45:20.047389 (Thread-1): 11:45:20 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.06s]
2021-10-08 09:45:20.048389 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 09:45:20.049392 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:45:20.050418 (Thread-1): 11:45:20 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 09:45:20.050418 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:45:20.050418 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:45:20.052522 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:45:20.059202 (Thread-1): finished collecting timing info
2021-10-08 09:45:20.061395 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:45:20.064433 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:45:20.064433 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 09:45:20.064433 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:45:20.952119 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-10-08 09:45:20.953121 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:45:20.953121 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-08 09:45:22.060190 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2021-10-08 09:45:22.061190 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:45:22.061190 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:45:22.061190 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:45:22.286155 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-08 09:45:22.287097 (Thread-1): finished collecting timing info
2021-10-08 09:45:22.287097 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 09:45:22.582928 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43a4b8d-1711-4e4f-923a-8430b2110f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018962B52610>]}
2021-10-08 09:45:22.584032 (Thread-1): 11:45:22 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.53s]
2021-10-08 09:45:22.584966 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:45:22.585926 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:45:22.585926 (MainThread): Using snowflake connection "master".
2021-10-08 09:45:22.585926 (MainThread): On master: BEGIN
2021-10-08 09:45:22.585926 (MainThread): Opening a new connection, currently in state closed
2021-10-08 09:45:23.354574 (MainThread): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-08 09:45:23.354574 (MainThread): On master: COMMIT
2021-10-08 09:45:23.354574 (MainThread): Using snowflake connection "master".
2021-10-08 09:45:23.354574 (MainThread): On master: COMMIT
2021-10-08 09:45:23.635648 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-08 09:45:23.635648 (MainThread): On master: Close
2021-10-08 09:45:23.932162 (MainThread): 11:45:23 | 
2021-10-08 09:45:23.932337 (MainThread): 11:45:23 | Finished running 4 table models, 2 incremental models in 22.64s.
2021-10-08 09:45:23.932337 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:45:23.932622 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 09:45:23.932622 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:45:23.932778 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 09:45:23.947976 (MainThread): 
2021-10-08 09:45:23.947976 (MainThread): Completed successfully
2021-10-08 09:45:23.948479 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-08 09:45:23.948881 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018962B52610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018962CBC670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018962958C70>]}
2021-10-08 09:45:23.948881 (MainThread): Flushing usage events
2021-10-08 09:45:36.203586 (MainThread): Running with dbt=0.20.2
2021-10-08 09:45:36.807118 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-10-08 09:45:36.808118 (MainThread): Tracking: tracking
2021-10-08 09:45:36.808118 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B93CACDE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B93DFFA850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B93DFFA880>]}
2021-10-08 09:45:36.815677 (MainThread): Partial parsing not enabled
2021-10-08 09:45:36.829662 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:45:36.853127 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:45:36.855127 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:45:36.861126 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:45:36.863251 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:45:36.867258 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:45:36.868259 (MainThread): Parsing macros\core.sql
2021-10-08 09:45:36.871258 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:45:36.906407 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:45:36.913107 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:45:36.914107 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:45:36.915107 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:45:36.917107 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:45:36.919106 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:45:36.919106 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:45:36.927754 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:45:36.932764 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:45:36.943328 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:45:36.944329 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:45:36.950328 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:45:36.965494 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:45:36.987159 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:45:36.988181 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:45:37.002870 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:45:37.008300 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:45:37.012363 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:45:37.017493 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:45:37.019343 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:45:37.020103 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:45:37.021478 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:45:37.158124 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:45:37.165099 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:45:37.170274 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:45:37.172270 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:45:37.173288 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:45:37.175267 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:45:37.177286 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:45:37.188482 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:45:37.190493 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:45:37.241434 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:45:37.242354 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:45:37.244454 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:45:37.252438 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:45:37.252438 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:45:37.253436 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:45:37.255442 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:45:37.273143 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37c40a31-a2b6-4810-b9f9-902aa44e8e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B93E10A190>]}
2021-10-08 09:45:37.297431 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:45:37.297931 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37c40a31-a2b6-4810-b9f9-902aa44e8e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B93E10A790>]}
2021-10-08 09:45:37.297931 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:45:37.298940 (MainThread): 
2021-10-08 09:45:37.299940 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:45:37.300940 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:45:37.310018 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:45:37.310018 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:45:37.310018 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:45:38.690760 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.38 seconds
2021-10-08 09:45:38.692815 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:45:39.011309 (MainThread): 11:45:39 | Concurrency: 1 threads (target='dev')
2021-10-08 09:45:39.011309 (MainThread): 11:45:39 | 
2021-10-08 09:45:39.013310 (Thread-1): Began running node test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-08 09:45:39.013310 (Thread-1): 11:45:39 | 1 of 7 START test assert_under_ten_percent_not_null.................. [RUN]
2021-10-08 09:45:39.013310 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:45:39.013310 (Thread-1): Compiling test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-08 09:45:39.017358 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"
2021-10-08 09:45:39.019854 (Thread-1): finished collecting timing info
2021-10-08 09:45:39.030905 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"
2021-10-08 09:45:39.034557 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:45:39.034557 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: BEGIN
2021-10-08 09:45:39.034557 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:45:39.898285 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-10-08 09:45:39.899280 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:45:39.899280 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
  SUM(CASE WHEN id IS NULL THEN 1 ELSE 0 END)/COUNT(*) AS total_nulls
FROM analytics.dbt.first_model
HAVING  SUM(CASE WHEN id IS NULL THEN 1 ELSE 0 END)/COUNT(*) < .1
      
    ) dbt_internal_test
2021-10-08 09:45:40.468770 (Thread-1): SQL status: SUCCESS 1 in 0.57 seconds
2021-10-08 09:45:40.469807 (Thread-1): finished collecting timing info
2021-10-08 09:45:40.469807 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: ROLLBACK
2021-10-08 09:45:40.710101 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: Close
2021-10-08 09:45:41.015106 (Thread-1): 11:45:41 | 1 of 7 PASS assert_under_ten_percent_not_null........................ [PASS in 2.00s]
2021-10-08 09:45:41.016105 (Thread-1): Finished running node test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-08 09:45:41.016105 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:45:41.016105 (Thread-1): 11:45:41 | 2 of 7 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-10-08 09:45:41.016503 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:45:41.016503 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:45:41.021539 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 09:45:41.023538 (Thread-1): finished collecting timing info
2021-10-08 09:45:41.024539 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 09:45:41.026511 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:45:41.026511 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: BEGIN
2021-10-08 09:45:41.026511 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:45:41.849803 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 09:45:41.851043 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:45:41.851043 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
2021-10-08 09:45:42.276880 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-10-08 09:45:42.277461 (Thread-1): finished collecting timing info
2021-10-08 09:45:42.277582 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: ROLLBACK
2021-10-08 09:45:42.566391 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-10-08 09:45:42.905861 (Thread-1): 11:45:42 | 2 of 7 FAIL 1 not_null_my_second_dbt_model_id........................ [FAIL 1 in 1.89s]
2021-10-08 09:45:42.906858 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:45:42.906858 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:45:42.906858 (Thread-1): 11:45:42 | 3 of 7 START test not_null_snowflake_customer_purchases_c_custkey.... [RUN]
2021-10-08 09:45:42.906858 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:45:42.907859 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:45:42.910857 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 09:45:42.912858 (Thread-1): finished collecting timing info
2021-10-08 09:45:42.915469 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 09:45:42.918874 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:45:42.918874 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: BEGIN
2021-10-08 09:45:42.918874 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:45:43.753444 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-08 09:45:43.753444 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:45:43.753444 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.snowflake_customer_purchases
where c_custkey is null



      
    ) dbt_internal_test
2021-10-08 09:45:44.091561 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-10-08 09:45:44.091561 (Thread-1): finished collecting timing info
2021-10-08 09:45:44.091561 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: ROLLBACK
2021-10-08 09:45:44.333974 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: Close
2021-10-08 09:45:44.642934 (Thread-1): 11:45:44 | 3 of 7 PASS not_null_snowflake_customer_purchases_c_custkey.......... [PASS in 1.74s]
2021-10-08 09:45:44.642934 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:45:44.643972 (Thread-1): Began running node test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 09:45:44.643972 (Thread-1): 11:45:44 | 4 of 7 START test relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_ [RUN]
2021-10-08 09:45:44.643972 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 09:45:44.643972 (Thread-1): Compiling test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 09:45:44.648970 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"
2021-10-08 09:45:44.654055 (Thread-1): finished collecting timing info
2021-10-08 09:45:44.655971 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"
2021-10-08 09:45:44.664904 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 09:45:44.664904 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: BEGIN
2021-10-08 09:45:44.664904 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:45:45.619976 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-10-08 09:45:45.619976 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 09:45:45.619976 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select id as from_field
    from analytics.dbt.my_second_dbt_model
    where id is not null
),

parent as (
    select id as to_field
    from analytics.dbt.first_model
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
2021-10-08 09:45:45.991142 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-10-08 09:45:45.991142 (Thread-1): finished collecting timing info
2021-10-08 09:45:45.991142 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: ROLLBACK
2021-10-08 09:45:46.262528 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: Close
2021-10-08 09:45:46.563091 (Thread-1): 11:45:46 | 4 of 7 PASS relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_ [PASS in 1.92s]
2021-10-08 09:45:46.564166 (Thread-1): Finished running node test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 09:45:46.564166 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:45:46.564166 (Thread-1): 11:45:46 | 5 of 7 START test unique_my_first_dbt_model_id....................... [RUN]
2021-10-08 09:45:46.564166 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:45:46.565212 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:45:46.568261 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 09:45:46.571175 (Thread-1): finished collecting timing info
2021-10-08 09:45:46.572175 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 09:45:46.574174 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:45:46.574174 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: BEGIN
2021-10-08 09:45:46.574174 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:45:47.420195 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-08 09:45:47.420195 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:45:47.420195 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.first_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:45:47.749798 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-08 09:45:47.750866 (Thread-1): finished collecting timing info
2021-10-08 09:45:47.750866 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: ROLLBACK
2021-10-08 09:45:47.985180 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-08 09:45:48.281779 (Thread-1): 11:45:48 | 5 of 7 PASS unique_my_first_dbt_model_id............................. [PASS in 1.72s]
2021-10-08 09:45:48.283366 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:45:48.283366 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:45:48.283366 (Thread-1): 11:45:48 | 6 of 7 START test unique_my_second_dbt_model_id...................... [RUN]
2021-10-08 09:45:48.284379 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:45:48.284379 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:45:48.288451 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 09:45:48.290382 (Thread-1): finished collecting timing info
2021-10-08 09:45:48.291377 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 09:45:48.293379 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:45:48.293379 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: BEGIN
2021-10-08 09:45:48.293379 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:45:49.280216 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-10-08 09:45:49.280216 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:45:49.280216 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:45:49.515221 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-08 09:45:49.515782 (Thread-1): finished collecting timing info
2021-10-08 09:45:49.515922 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: ROLLBACK
2021-10-08 09:45:49.784407 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: Close
2021-10-08 09:45:50.089168 (Thread-1): 11:45:50 | 6 of 7 PASS unique_my_second_dbt_model_id............................ [PASS in 1.80s]
2021-10-08 09:45:50.091019 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:45:50.092086 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:45:50.092086 (Thread-1): 11:45:50 | 7 of 7 START test unique_snowflake_customer_purchases_c_custkey...... [RUN]
2021-10-08 09:45:50.093046 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:45:50.093046 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:45:50.098067 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 09:45:50.102758 (Thread-1): finished collecting timing info
2021-10-08 09:45:50.104659 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 09:45:50.108661 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:45:50.108661 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: BEGIN
2021-10-08 09:45:50.108661 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:45:50.926367 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 09:45:50.926367 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:45:50.926367 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.snowflake_customer_purchases
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:45:51.267066 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-10-08 09:45:51.268139 (Thread-1): finished collecting timing info
2021-10-08 09:45:51.268139 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: ROLLBACK
2021-10-08 09:45:51.528806 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: Close
2021-10-08 09:45:51.823507 (Thread-1): 11:45:51 | 7 of 7 PASS unique_snowflake_customer_purchases_c_custkey............ [PASS in 1.73s]
2021-10-08 09:45:51.825507 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:45:51.827639 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:45:51.827639 (MainThread): 11:45:51 | 
2021-10-08 09:45:51.828137 (MainThread): 11:45:51 | Finished running 7 tests in 14.53s.
2021-10-08 09:45:51.828137 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:45:51.828137 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:45:51.828137 (MainThread): Connection 'test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8' was properly closed.
2021-10-08 09:45:51.840490 (MainThread): 
2021-10-08 09:45:51.840490 (MainThread): Completed with 1 error and 0 warnings:
2021-10-08 09:45:51.841360 (MainThread): 
2021-10-08 09:45:51.841360 (MainThread): Failure in test not_null_my_second_dbt_model_id (models\example\schema.yml)
2021-10-08 09:45:51.841360 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-08 09:45:51.842366 (MainThread): 
2021-10-08 09:45:51.842366 (MainThread):   compiled SQL at target\compiled\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\not_null_my_second_dbt_model_id.sql
2021-10-08 09:45:51.842366 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-10-08 09:45:51.842366 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B93DFFA520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B93E10A400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B93E10ACA0>]}
2021-10-08 09:45:51.842366 (MainThread): Flushing usage events
2021-10-08 09:48:03.059944 (MainThread): Running with dbt=0.20.2
2021-10-08 09:48:03.650726 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 09:48:03.651228 (MainThread): Tracking: tracking
2021-10-08 09:48:03.651228 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B32C7CDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B341C4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B341C4280>]}
2021-10-08 09:48:03.658234 (MainThread): Partial parsing not enabled
2021-10-08 09:48:03.672367 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:48:03.691485 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:48:03.692486 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:48:03.698651 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:48:03.699653 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:48:03.701652 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:48:03.702652 (MainThread): Parsing macros\core.sql
2021-10-08 09:48:03.704652 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:48:03.737527 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:48:03.744725 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:48:03.744725 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:48:03.745818 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:48:03.747812 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:48:03.748804 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:48:03.749517 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:48:03.756207 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:48:03.761117 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:48:03.770117 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:48:03.771119 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:48:03.777408 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:48:03.792841 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:48:03.813842 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:48:03.815847 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:48:03.825021 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:48:03.828998 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:48:03.832021 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:48:03.835020 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:48:03.836021 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:48:03.837021 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:48:03.838020 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:48:03.936518 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:48:03.943066 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:48:03.947967 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:48:03.950020 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:48:03.950647 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:48:03.952792 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:48:03.954293 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:48:03.964338 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:48:03.966084 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:48:04.015496 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:48:04.016475 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:48:04.018484 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:48:04.026041 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:48:04.026041 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:48:04.028044 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:48:04.029631 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:48:04.045661 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8283d6d-0728-4a11-be93-a284409b630f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B341BC790>]}
2021-10-08 09:48:04.070015 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:48:04.070468 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8283d6d-0728-4a11-be93-a284409b630f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B341BCB20>]}
2021-10-08 09:48:04.070468 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:48:04.071481 (MainThread): 
2021-10-08 09:48:04.071481 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:48:04.073399 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 09:48:04.085850 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 09:48:04.085850 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 09:48:04.086306 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 09:48:06.077103 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.99 seconds
2021-10-08 09:48:06.080135 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 09:48:06.386820 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:48:06.392811 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:48:06.393973 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:48:06.393973 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:48:07.188327 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.79 seconds
2021-10-08 09:48:07.190301 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:48:07.491197 (MainThread): Using snowflake connection "master".
2021-10-08 09:48:07.491197 (MainThread): On master: BEGIN
2021-10-08 09:48:07.491197 (MainThread): Opening a new connection, currently in state init
2021-10-08 09:48:08.469474 (MainThread): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-08 09:48:08.469474 (MainThread): On master: COMMIT
2021-10-08 09:48:08.469474 (MainThread): Using snowflake connection "master".
2021-10-08 09:48:08.469474 (MainThread): On master: COMMIT
2021-10-08 09:48:08.798536 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-08 09:48:08.798536 (MainThread): On master: Close
2021-10-08 09:48:09.158824 (MainThread): 11:48:09 | Concurrency: 1 threads (target='dev')
2021-10-08 09:48:09.158824 (MainThread): 11:48:09 | 
2021-10-08 09:48:09.160005 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:48:09.161007 (Thread-1): 11:48:09 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 09:48:09.161421 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:48:09.161421 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:48:09.164927 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:48:09.166927 (Thread-1): finished collecting timing info
2021-10-08 09:48:09.192140 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:48:09.194488 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:48:09.194990 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 09:48:09.194990 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:48:10.058007 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-10-08 09:48:10.058007 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:48:10.058007 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all   
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 09:48:11.175292 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-10-08 09:48:11.176353 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:48:11.176353 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:48:11.176353 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:48:11.359987 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:48:11.373031 (Thread-1): finished collecting timing info
2021-10-08 09:48:11.374048 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 09:48:11.663805 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8283d6d-0728-4a11-be93-a284409b630f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B344B56A0>]}
2021-10-08 09:48:11.664268 (Thread-1): 11:48:11 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.50s]
2021-10-08 09:48:11.665292 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:48:11.665292 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:48:11.666783 (Thread-1): 11:48:11 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 09:48:11.667794 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:48:11.667947 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:48:11.669000 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:48:11.675323 (Thread-1): finished collecting timing info
2021-10-08 09:48:11.678161 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:48:11.680684 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:48:11.681822 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 09:48:11.682724 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:48:12.473595 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 09:48:12.473766 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:48:12.473829 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 09:48:13.972238 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-10-08 09:48:13.973213 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:48:13.974255 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:48:13.974255 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:48:14.133187 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:48:14.135187 (Thread-1): finished collecting timing info
2021-10-08 09:48:14.135187 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 09:48:14.429094 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8283d6d-0728-4a11-be93-a284409b630f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B341BC2E0>]}
2021-10-08 09:48:14.430094 (Thread-1): 11:48:14 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.76s]
2021-10-08 09:48:14.432064 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:48:14.432564 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:48:14.432584 (Thread-1): 11:48:14 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 09:48:14.433085 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:48:14.433085 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 09:48:14.438617 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:48:14.442835 (Thread-1): finished collecting timing info
2021-10-08 09:48:14.461877 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:48:14.461877 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 09:48:14.461877 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:48:15.759744 (Thread-1): SQL status: SUCCESS 1 in 1.30 seconds
2021-10-08 09:48:15.765760 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:48:15.765760 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 09:48:15.955727 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:48:15.958725 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:48:15.958725 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:48:16.126550 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:48:16.130156 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:48:16.130156 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:48:16.320757 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:48:16.336712 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:48:16.338712 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:48:16.338712 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 09:48:16.520387 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:48:16.520886 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:48:16.520886 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 09:48:16.887001 (Thread-1): SQL status: SUCCESS 0 in 0.37 seconds
2021-10-08 09:48:16.889001 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:48:16.889001 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:48:16.889001 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:48:17.162119 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 09:48:17.164117 (Thread-1): finished collecting timing info
2021-10-08 09:48:17.164117 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 09:48:17.538411 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8283d6d-0728-4a11-be93-a284409b630f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B344AC670>]}
2021-10-08 09:48:17.538411 (Thread-1): 11:48:17 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.11s]
2021-10-08 09:48:17.539411 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:48:17.539411 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:48:17.540431 (Thread-1): 11:48:17 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 09:48:17.540431 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:48:17.541382 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:48:17.542408 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:48:17.549135 (Thread-1): finished collecting timing info
2021-10-08 09:48:17.551141 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:48:17.553889 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:48:17.553889 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 09:48:17.553889 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:48:18.559719 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-08 09:48:18.559719 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:48:18.559719 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 09:48:19.962070 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-10-08 09:48:19.964064 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:48:19.965065 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:48:19.965065 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:48:20.142977 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:48:20.142977 (Thread-1): finished collecting timing info
2021-10-08 09:48:20.143985 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 09:48:20.444132 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8283d6d-0728-4a11-be93-a284409b630f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B34578E50>]}
2021-10-08 09:48:20.444132 (Thread-1): 11:48:20 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.90s]
2021-10-08 09:48:20.445330 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:48:20.445330 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 09:48:20.445330 (Thread-1): 11:48:20 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 09:48:20.446342 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:48:20.446342 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 09:48:20.447342 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:48:20.449367 (Thread-1): finished collecting timing info
2021-10-08 09:48:20.451343 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:48:20.451343 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 09:48:20.452342 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:48:21.966741 (Thread-1): SQL status: SUCCESS 1 in 1.52 seconds
2021-10-08 09:48:21.971003 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:48:21.971003 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 09:48:22.156865 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:48:22.159812 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:48:22.159812 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:48:22.321491 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:48:22.324322 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:48:22.324322 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:48:22.484094 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:48:22.485569 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:48:22.490416 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:48:22.490416 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 09:48:22.708680 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-08 09:48:22.709863 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:48:22.709863 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 09:48:23.007563 (Thread-1): SQL status: SUCCESS 0 in 0.30 seconds
2021-10-08 09:48:23.009614 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:48:23.009614 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:48:23.009614 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:48:23.252689 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-08 09:48:23.253769 (Thread-1): finished collecting timing info
2021-10-08 09:48:23.253769 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 09:48:23.547417 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8283d6d-0728-4a11-be93-a284409b630f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B34634B50>]}
2021-10-08 09:48:23.547417 (Thread-1): 11:48:23 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.10s]
2021-10-08 09:48:23.549173 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 09:48:23.549173 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:48:23.550188 (Thread-1): 11:48:23 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 09:48:23.550188 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:48:23.550188 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:48:23.553189 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:48:23.560652 (Thread-1): finished collecting timing info
2021-10-08 09:48:23.562395 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:48:23.565530 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:48:23.565530 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 09:48:23.565530 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:48:24.356762 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 09:48:24.357817 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:48:24.357817 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-08 09:48:25.342804 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-08 09:48:25.343846 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:48:25.343846 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:48:25.344854 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:48:25.501331 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:48:25.502331 (Thread-1): finished collecting timing info
2021-10-08 09:48:25.502331 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 09:48:25.805202 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8283d6d-0728-4a11-be93-a284409b630f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B346189D0>]}
2021-10-08 09:48:25.805202 (Thread-1): 11:48:25 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.25s]
2021-10-08 09:48:25.808118 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:48:25.808794 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:48:25.808794 (MainThread): Using snowflake connection "master".
2021-10-08 09:48:25.808794 (MainThread): On master: BEGIN
2021-10-08 09:48:25.809804 (MainThread): Opening a new connection, currently in state closed
2021-10-08 09:48:26.612161 (MainThread): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-08 09:48:26.612161 (MainThread): On master: COMMIT
2021-10-08 09:48:26.612161 (MainThread): Using snowflake connection "master".
2021-10-08 09:48:26.612161 (MainThread): On master: COMMIT
2021-10-08 09:48:27.017203 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-10-08 09:48:27.017203 (MainThread): On master: Close
2021-10-08 09:48:27.328107 (MainThread): 11:48:27 | 
2021-10-08 09:48:27.329108 (MainThread): 11:48:27 | Finished running 4 table models, 2 incremental models in 23.26s.
2021-10-08 09:48:27.329108 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:48:27.329108 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 09:48:27.329108 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:48:27.329108 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 09:48:27.345654 (MainThread): 
2021-10-08 09:48:27.346591 (MainThread): Completed successfully
2021-10-08 09:48:27.346591 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-08 09:48:27.346591 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B3463F8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B34619AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B344B5F10>]}
2021-10-08 09:48:27.347594 (MainThread): Flushing usage events
2021-10-08 09:48:37.258167 (MainThread): Running with dbt=0.20.2
2021-10-08 09:48:37.847809 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-10-08 09:48:37.848802 (MainThread): Tracking: tracking
2021-10-08 09:48:37.848802 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D58508CEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D586599F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5865994C0>]}
2021-10-08 09:48:37.856334 (MainThread): Partial parsing not enabled
2021-10-08 09:48:37.869167 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:48:37.887670 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:48:37.888671 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:48:37.895672 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:48:37.896674 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:48:37.899672 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:48:37.900674 (MainThread): Parsing macros\core.sql
2021-10-08 09:48:37.903674 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:48:37.937642 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:48:37.943754 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:48:37.943754 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:48:37.944754 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:48:37.946753 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:48:37.947413 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:48:37.948446 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:48:37.956591 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:48:37.962591 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:48:37.972576 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:48:37.973577 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:48:37.981792 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:48:37.998760 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:48:38.019966 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:48:38.020964 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:48:38.032631 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:48:38.037614 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:48:38.040629 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:48:38.045631 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:48:38.046631 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:48:38.047630 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:48:38.049615 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:48:38.171287 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:48:38.178294 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:48:38.183293 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:48:38.185450 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:48:38.186545 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:48:38.188547 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:48:38.190554 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:48:38.200561 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:48:38.202516 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:48:38.249752 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:48:38.251765 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:48:38.252759 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:48:38.259770 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:48:38.259770 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:48:38.260681 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:48:38.262713 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:48:38.283238 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f22ae2d-97cc-41c0-b8fb-f82e7d08ab05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5866AC910>]}
2021-10-08 09:48:38.303145 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:48:38.304142 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f22ae2d-97cc-41c0-b8fb-f82e7d08ab05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5866ACA00>]}
2021-10-08 09:48:38.304566 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:48:38.305567 (MainThread): 
2021-10-08 09:48:38.305567 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:48:38.306675 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:48:38.321596 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:48:38.321596 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:48:38.321596 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:48:39.591442 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.27 seconds
2021-10-08 09:48:39.596727 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:48:39.900164 (MainThread): 11:48:39 | Concurrency: 1 threads (target='dev')
2021-10-08 09:48:39.901118 (MainThread): 11:48:39 | 
2021-10-08 09:48:39.904080 (Thread-1): Began running node test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-08 09:48:39.904080 (Thread-1): 11:48:39 | 1 of 7 START test assert_under_ten_percent_not_null.................. [RUN]
2021-10-08 09:48:39.905080 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:48:39.905080 (Thread-1): Compiling test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-08 09:48:39.909086 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"
2021-10-08 09:48:39.916072 (Thread-1): finished collecting timing info
2021-10-08 09:48:39.933977 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"
2021-10-08 09:48:39.940027 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:48:39.940027 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: BEGIN
2021-10-08 09:48:39.940027 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:48:40.958219 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-08 09:48:40.958219 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:48:40.958219 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
  SUM(CASE WHEN id IS NULL THEN 1 ELSE 0 END)/COUNT(*) AS total_nulls
FROM analytics.dbt.first_model
HAVING  SUM(CASE WHEN id IS NULL THEN 1 ELSE 0 END)/COUNT(*) <= .1
      
    ) dbt_internal_test
2021-10-08 09:48:41.424499 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2021-10-08 09:48:41.425516 (Thread-1): finished collecting timing info
2021-10-08 09:48:41.425516 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: ROLLBACK
2021-10-08 09:48:41.855515 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: Close
2021-10-08 09:48:42.506102 (Thread-1): 11:48:42 | 1 of 7 PASS assert_under_ten_percent_not_null........................ [PASS in 2.60s]
2021-10-08 09:48:42.506102 (Thread-1): Finished running node test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-08 09:48:42.506102 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:48:42.506102 (Thread-1): 11:48:42 | 2 of 7 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-10-08 09:48:42.507021 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:48:42.507021 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:48:42.513118 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 09:48:42.515106 (Thread-1): finished collecting timing info
2021-10-08 09:48:42.516021 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 09:48:42.519843 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:48:42.521053 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: BEGIN
2021-10-08 09:48:42.521053 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:48:43.817432 (Thread-1): SQL status: SUCCESS 1 in 1.30 seconds
2021-10-08 09:48:43.817432 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:48:43.817432 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
2021-10-08 09:48:44.796336 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-08 09:48:44.797335 (Thread-1): finished collecting timing info
2021-10-08 09:48:44.797335 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: ROLLBACK
2021-10-08 09:48:45.128899 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-10-08 09:48:45.436944 (Thread-1): 11:48:45 | 2 of 7 FAIL 1 not_null_my_second_dbt_model_id........................ [FAIL 1 in 2.93s]
2021-10-08 09:50:04.488885 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:50:04.488885 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:50:04.488885 (Thread-1): 11:50:04 | 3 of 7 START test not_null_snowflake_customer_purchases_c_custkey.... [RUN]
2021-10-08 09:50:04.489989 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:50:04.489989 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:50:04.495050 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 09:50:04.497052 (Thread-1): finished collecting timing info
2021-10-08 09:50:04.498050 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 09:50:04.503125 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:50:04.503125 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: BEGIN
2021-10-08 09:50:04.503125 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:50:05.796039 (Thread-1): SQL status: SUCCESS 1 in 1.29 seconds
2021-10-08 09:50:05.796039 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:50:05.796039 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.snowflake_customer_purchases
where c_custkey is null



      
    ) dbt_internal_test
2021-10-08 09:50:06.152409 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-08 09:50:06.152409 (Thread-1): finished collecting timing info
2021-10-08 09:50:06.153427 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: ROLLBACK
2021-10-08 09:50:06.605877 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: Close
2021-10-08 09:50:07.093333 (Thread-1): 11:50:07 | 3 of 7 PASS not_null_snowflake_customer_purchases_c_custkey.......... [PASS in 2.60s]
2021-10-08 09:50:07.094333 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:50:07.094333 (Thread-1): Began running node test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 09:50:07.094333 (Thread-1): 11:50:07 | 4 of 7 START test relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_ [RUN]
2021-10-08 09:50:07.094333 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 09:50:07.094333 (Thread-1): Compiling test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 09:50:07.098333 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"
2021-10-08 09:50:07.104224 (Thread-1): finished collecting timing info
2021-10-08 09:50:07.104726 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"
2021-10-08 09:50:07.107735 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 09:50:07.107735 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: BEGIN
2021-10-08 09:50:07.107735 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:50:08.107895 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-08 09:50:08.107895 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 09:50:08.107895 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select id as from_field
    from analytics.dbt.my_second_dbt_model
    where id is not null
),

parent as (
    select id as to_field
    from analytics.dbt.first_model
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
2021-10-08 09:50:08.541362 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-10-08 09:50:08.543014 (Thread-1): finished collecting timing info
2021-10-08 09:50:08.543014 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: ROLLBACK
2021-10-08 09:50:08.832123 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: Close
2021-10-08 09:50:09.131430 (Thread-1): 11:50:09 | 4 of 7 PASS relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_ [PASS in 2.04s]
2021-10-08 09:50:18.031932 (Thread-1): Finished running node test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 09:50:18.031932 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:50:18.031932 (Thread-1): 11:50:18 | 5 of 7 START test unique_my_first_dbt_model_id....................... [RUN]
2021-10-08 09:50:18.032936 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:50:18.032936 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:50:18.036933 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 09:50:18.042920 (Thread-1): finished collecting timing info
2021-10-08 09:50:18.044954 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 09:50:18.050920 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:50:18.050920 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: BEGIN
2021-10-08 09:50:18.050920 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:50:19.092188 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-10-08 09:50:19.092415 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:50:19.092473 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.first_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:50:19.473984 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-10-08 09:50:19.474606 (Thread-1): finished collecting timing info
2021-10-08 09:50:19.474606 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: ROLLBACK
2021-10-08 09:50:19.799618 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-08 09:50:20.097210 (Thread-1): 11:50:20 | 5 of 7 PASS unique_my_first_dbt_model_id............................. [PASS in 2.06s]
2021-10-08 09:50:20.098200 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:50:20.098200 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:50:20.098200 (Thread-1): 11:50:20 | 6 of 7 START test unique_my_second_dbt_model_id...................... [RUN]
2021-10-08 09:50:20.099168 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:50:20.099168 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:50:20.103247 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 09:50:20.104168 (Thread-1): finished collecting timing info
2021-10-08 09:50:20.106168 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 09:50:20.108018 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:50:20.108018 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: BEGIN
2021-10-08 09:50:20.108018 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:50:20.887625 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 09:50:20.887625 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:50:20.887625 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:50:21.377612 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-10-08 09:50:21.378610 (Thread-1): finished collecting timing info
2021-10-08 09:50:21.378610 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: ROLLBACK
2021-10-08 09:50:21.609477 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: Close
2021-10-08 09:50:21.908628 (Thread-1): 11:50:21 | 6 of 7 PASS unique_my_second_dbt_model_id............................ [PASS in 1.81s]
2021-10-08 09:50:21.909627 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:50:21.909627 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:50:21.909627 (Thread-1): 11:50:21 | 7 of 7 START test unique_snowflake_customer_purchases_c_custkey...... [RUN]
2021-10-08 09:50:21.910628 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:50:21.910628 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:50:21.912963 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 09:50:21.914969 (Thread-1): finished collecting timing info
2021-10-08 09:50:21.915881 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 09:50:21.917881 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:50:21.917881 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: BEGIN
2021-10-08 09:50:21.917881 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:50:22.764481 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-08 09:50:22.764481 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:50:22.764481 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.snowflake_customer_purchases
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:50:23.247401 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2021-10-08 09:50:23.247401 (Thread-1): finished collecting timing info
2021-10-08 09:50:23.248400 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: ROLLBACK
2021-10-08 09:50:23.465204 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: Close
2021-10-08 09:50:23.760878 (Thread-1): 11:50:23 | 7 of 7 PASS unique_snowflake_customer_purchases_c_custkey............ [PASS in 1.85s]
2021-10-08 09:50:23.762879 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:50:23.763876 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:50:23.763876 (MainThread): 11:50:23 | 
2021-10-08 09:50:23.763876 (MainThread): 11:50:23 | Finished running 7 tests in 105.46s.
2021-10-08 09:50:23.763876 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:50:23.763876 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:50:23.763876 (MainThread): Connection 'test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8' was properly closed.
2021-10-08 09:50:23.785472 (MainThread): 
2021-10-08 09:50:23.786390 (MainThread): Completed with 1 error and 0 warnings:
2021-10-08 09:50:23.786390 (MainThread): 
2021-10-08 09:50:23.787391 (MainThread): Failure in test not_null_my_second_dbt_model_id (models\example\schema.yml)
2021-10-08 09:50:23.787391 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-08 09:50:23.787391 (MainThread): 
2021-10-08 09:50:23.787391 (MainThread):   compiled SQL at target\compiled\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\not_null_my_second_dbt_model_id.sql
2021-10-08 09:50:23.788390 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-10-08 09:50:23.788390 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D586614A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5866D4A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D586A2F580>]}
2021-10-08 09:50:23.788390 (MainThread): Flushing usage events
2021-10-08 09:50:26.574379 (MainThread): Running with dbt=0.20.2
2021-10-08 09:50:27.160272 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 09:50:27.161239 (MainThread): Tracking: tracking
2021-10-08 09:50:27.161239 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242198DDC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002421AE0A610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002421AE0A670>]}
2021-10-08 09:50:27.168451 (MainThread): Partial parsing not enabled
2021-10-08 09:50:27.183091 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:50:27.202584 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:50:27.203641 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:50:27.210641 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:50:27.211636 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:50:27.214635 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:50:27.215629 (MainThread): Parsing macros\core.sql
2021-10-08 09:50:27.218632 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:50:27.253618 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:50:27.259634 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:50:27.260613 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:50:27.261624 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:50:27.263611 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:50:27.264726 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:50:27.265821 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:50:27.272822 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:50:27.277816 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:50:27.289058 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:50:27.289979 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:50:27.296520 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:50:27.313530 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:50:27.336738 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:50:27.337745 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:50:27.350962 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:50:27.356079 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:50:27.360090 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:50:27.365169 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:50:27.367173 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:50:27.367173 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:50:27.369176 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:50:27.503559 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:50:27.510497 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:50:27.516642 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:50:27.518723 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:50:27.519734 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:50:27.522729 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:50:27.524721 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:50:27.534653 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:50:27.536752 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:50:27.588524 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:50:27.590260 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:50:27.591770 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:50:27.599047 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:50:27.599047 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:50:27.600559 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:50:27.602115 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:50:27.618007 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60ab7e03-b700-4c66-9783-0f2380040b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002421AE9B6A0>]}
2021-10-08 09:50:27.640423 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:50:27.641597 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60ab7e03-b700-4c66-9783-0f2380040b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002421AE9F9D0>]}
2021-10-08 09:50:27.641597 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:50:27.643300 (MainThread): 
2021-10-08 09:50:27.643682 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:50:27.645119 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 09:50:27.658290 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 09:50:27.658290 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 09:50:27.658290 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 09:50:28.920080 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.26 seconds
2021-10-08 09:50:28.922847 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 09:50:29.224924 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:50:29.228925 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:50:29.228925 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:50:29.228925 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:50:30.303695 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.07 seconds
2021-10-08 09:50:30.305841 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:50:30.640380 (MainThread): Using snowflake connection "master".
2021-10-08 09:50:30.640380 (MainThread): On master: BEGIN
2021-10-08 09:50:30.640380 (MainThread): Opening a new connection, currently in state init
2021-10-08 09:50:31.639528 (MainThread): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-08 09:50:31.639528 (MainThread): On master: COMMIT
2021-10-08 09:50:31.639528 (MainThread): Using snowflake connection "master".
2021-10-08 09:50:31.639528 (MainThread): On master: COMMIT
2021-10-08 09:50:31.950417 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-10-08 09:50:31.950417 (MainThread): On master: Close
2021-10-08 09:50:32.256694 (MainThread): 11:50:32 | Concurrency: 1 threads (target='dev')
2021-10-08 09:50:32.257848 (MainThread): 11:50:32 | 
2021-10-08 09:50:32.260021 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:50:32.260021 (Thread-1): 11:50:32 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 09:50:32.260552 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:50:32.260685 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:50:32.262461 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:50:32.267618 (Thread-1): finished collecting timing info
2021-10-08 09:50:32.287334 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:50:32.296556 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:50:32.296556 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 09:50:32.296556 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:50:33.073735 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 09:50:33.074012 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:50:33.074012 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all   
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 09:50:34.663320 (Thread-1): SQL status: SUCCESS 1 in 1.59 seconds
2021-10-08 09:50:34.664318 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:50:34.664318 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:50:34.664318 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:50:34.849896 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:50:34.857932 (Thread-1): finished collecting timing info
2021-10-08 09:50:34.857932 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 09:50:35.149763 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60ab7e03-b700-4c66-9783-0f2380040b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002421B2413A0>]}
2021-10-08 09:50:35.150772 (Thread-1): 11:50:35 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.89s]
2021-10-08 09:50:35.151679 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:50:35.151679 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:50:35.152728 (Thread-1): 11:50:35 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 09:50:35.152728 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:50:35.152728 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:50:35.153676 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:50:35.171732 (Thread-1): finished collecting timing info
2021-10-08 09:50:35.174245 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:50:35.179575 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:50:35.179575 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 09:50:35.180582 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:50:36.134231 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-10-08 09:50:36.135252 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:50:36.135252 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 09:50:37.659505 (Thread-1): SQL status: SUCCESS 1 in 1.52 seconds
2021-10-08 09:50:37.660508 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:50:37.660508 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:50:37.660508 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:50:37.817443 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:50:37.818451 (Thread-1): finished collecting timing info
2021-10-08 09:50:37.818451 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 09:50:38.112640 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60ab7e03-b700-4c66-9783-0f2380040b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002421B140AF0>]}
2021-10-08 09:50:38.113625 (Thread-1): 11:50:38 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.96s]
2021-10-08 09:50:38.114544 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:50:38.115640 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:50:38.115640 (Thread-1): 11:50:38 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 09:50:38.115640 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:50:38.116625 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 09:50:38.120618 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:50:38.126615 (Thread-1): finished collecting timing info
2021-10-08 09:50:38.147196 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:50:38.147196 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 09:50:38.147196 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:50:39.547187 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-10-08 09:50:39.556343 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:50:39.556343 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 09:50:39.742110 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:50:39.743106 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:50:39.743106 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:50:39.908952 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:50:39.911952 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:50:39.911952 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:50:40.073959 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:50:40.083394 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:50:40.085265 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:50:40.085265 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 09:50:40.301816 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-08 09:50:40.301816 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:50:40.301816 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 09:50:40.726271 (Thread-1): SQL status: SUCCESS 0 in 0.42 seconds
2021-10-08 09:50:40.727181 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:50:40.727181 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:50:40.728180 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:50:41.034218 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-10-08 09:50:41.035613 (Thread-1): finished collecting timing info
2021-10-08 09:50:41.036611 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 09:50:41.366438 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60ab7e03-b700-4c66-9783-0f2380040b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002421B277AC0>]}
2021-10-08 09:50:41.367438 (Thread-1): 11:50:41 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.25s]
2021-10-08 09:50:41.367438 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:50:41.368437 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:50:41.368437 (Thread-1): 11:50:41 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 09:50:41.368437 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:50:41.368437 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:50:41.369438 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:50:41.373441 (Thread-1): finished collecting timing info
2021-10-08 09:50:41.375440 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:50:41.376439 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:50:41.376439 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 09:50:41.376439 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:50:42.617771 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-10-08 09:50:42.618774 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:50:42.618774 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 09:50:43.910880 (Thread-1): SQL status: SUCCESS 1 in 1.29 seconds
2021-10-08 09:50:43.912887 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:50:43.912887 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:50:43.912887 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:50:44.080454 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:50:44.081453 (Thread-1): finished collecting timing info
2021-10-08 09:50:44.081453 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 09:50:44.381789 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60ab7e03-b700-4c66-9783-0f2380040b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002421AE09C40>]}
2021-10-08 09:50:44.381789 (Thread-1): 11:50:44 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.01s]
2021-10-08 09:50:44.383912 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:50:44.383912 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 09:50:44.384978 (Thread-1): 11:50:44 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 09:50:44.384978 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:50:44.384978 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 09:50:44.388003 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:50:44.391906 (Thread-1): finished collecting timing info
2021-10-08 09:50:44.393998 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:50:44.393998 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 09:50:44.393998 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:50:45.894460 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-10-08 09:50:45.897533 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:50:45.897533 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 09:50:46.088331 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:50:46.092391 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:50:46.092391 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:50:46.279599 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:50:46.283121 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:50:46.283121 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:50:46.474073 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:50:46.476036 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:50:46.478325 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:50:46.478889 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 09:50:46.658419 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:50:46.658419 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:50:46.658419 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 09:50:47.073221 (Thread-1): SQL status: SUCCESS 0 in 0.41 seconds
2021-10-08 09:50:47.074230 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:50:47.074230 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:50:47.074230 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:50:47.331059 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-08 09:50:47.332060 (Thread-1): finished collecting timing info
2021-10-08 09:50:47.333059 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 09:50:47.636560 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60ab7e03-b700-4c66-9783-0f2380040b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002421B0E6D00>]}
2021-10-08 09:50:47.637561 (Thread-1): 11:50:47 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.25s]
2021-10-08 09:50:47.638560 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 09:50:47.639629 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:50:47.639629 (Thread-1): 11:50:47 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 09:50:47.640559 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:50:47.640559 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:50:47.642557 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:50:47.646644 (Thread-1): finished collecting timing info
2021-10-08 09:50:47.648557 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:50:47.653556 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:50:47.653556 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 09:50:47.653556 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:50:48.448747 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-08 09:50:48.449830 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:50:48.449830 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-08 09:50:49.625246 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-10-08 09:50:49.626250 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:50:49.627574 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:50:49.627574 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:50:49.801035 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:50:49.802031 (Thread-1): finished collecting timing info
2021-10-08 09:50:49.802031 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 09:50:50.111938 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60ab7e03-b700-4c66-9783-0f2380040b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002421AF01EB0>]}
2021-10-08 09:50:50.111938 (Thread-1): 11:50:50 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.47s]
2021-10-08 09:50:50.113842 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:50:50.114842 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:50:50.115919 (MainThread): Using snowflake connection "master".
2021-10-08 09:50:50.115919 (MainThread): On master: BEGIN
2021-10-08 09:50:50.115919 (MainThread): Opening a new connection, currently in state closed
2021-10-08 09:50:50.946414 (MainThread): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-08 09:50:50.946414 (MainThread): On master: COMMIT
2021-10-08 09:50:50.946414 (MainThread): Using snowflake connection "master".
2021-10-08 09:50:50.946414 (MainThread): On master: COMMIT
2021-10-08 09:50:51.187973 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-08 09:50:51.189002 (MainThread): On master: Close
2021-10-08 09:50:51.501756 (MainThread): 11:50:51 | 
2021-10-08 09:50:51.501756 (MainThread): 11:50:51 | Finished running 4 table models, 2 incremental models in 23.86s.
2021-10-08 09:50:51.501756 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:50:51.502676 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 09:50:51.502676 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:50:51.502676 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 09:50:51.516092 (MainThread): 
2021-10-08 09:50:51.516092 (MainThread): Completed successfully
2021-10-08 09:50:51.517033 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-08 09:50:51.517033 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002421AE86190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002421B10E2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002421AF01EB0>]}
2021-10-08 09:50:51.517033 (MainThread): Flushing usage events
2021-10-08 09:51:01.123503 (MainThread): Running with dbt=0.20.2
2021-10-08 09:51:01.697067 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-10-08 09:51:01.697067 (MainThread): Tracking: tracking
2021-10-08 09:51:01.697067 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BBEFFDE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BC052ACA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BC052A760>]}
2021-10-08 09:51:01.705065 (MainThread): Partial parsing not enabled
2021-10-08 09:51:01.721189 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:51:01.742113 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:51:01.744015 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:51:01.750015 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:51:01.752096 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:51:01.754017 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:51:01.755098 (MainThread): Parsing macros\core.sql
2021-10-08 09:51:01.758905 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:51:01.792250 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:51:01.799250 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:51:01.799250 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:51:01.801243 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:51:01.802243 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:51:01.803814 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:51:01.803814 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:51:01.810999 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:51:01.815996 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:51:01.826836 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:51:01.827835 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:51:01.833825 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:51:01.849131 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:51:01.871441 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:51:01.873040 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:51:01.885435 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:51:01.890425 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:51:01.894174 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:51:01.898592 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:51:01.900586 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:51:01.900586 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:51:01.901594 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:51:02.030991 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:51:02.037853 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:51:02.044016 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:51:02.046037 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:51:02.047040 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:51:02.049034 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:51:02.051033 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:51:02.060829 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:51:02.062820 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:51:02.110212 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:51:02.112291 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:51:02.113296 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:51:02.121307 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:51:02.121307 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:51:02.122295 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:51:02.124212 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:51:02.141035 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4611dd50-ff4b-4cc9-8b78-e3d97993d159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BC06411F0>]}
2021-10-08 09:51:02.158959 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:51:02.159864 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4611dd50-ff4b-4cc9-8b78-e3d97993d159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BC06417F0>]}
2021-10-08 09:51:02.159864 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:51:02.161376 (MainThread): 
2021-10-08 09:51:02.161875 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:51:02.163090 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:51:02.175489 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:51:02.175489 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:51:02.175489 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:51:03.551463 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.38 seconds
2021-10-08 09:51:03.555456 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:51:03.858395 (MainThread): 11:51:03 | Concurrency: 1 threads (target='dev')
2021-10-08 09:51:03.859742 (MainThread): 11:51:03 | 
2021-10-08 09:51:03.862334 (Thread-1): Began running node test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-08 09:51:03.862334 (Thread-1): 11:51:03 | 1 of 7 START test assert_under_ten_percent_not_null.................. [RUN]
2021-10-08 09:51:03.863391 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:51:03.863391 (Thread-1): Compiling test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-08 09:51:03.866411 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"
2021-10-08 09:51:03.875765 (Thread-1): finished collecting timing info
2021-10-08 09:51:03.890030 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"
2021-10-08 09:51:03.895946 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:51:03.895946 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: BEGIN
2021-10-08 09:51:03.895946 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:51:04.763316 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-08 09:51:04.763316 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:51:04.764325 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
  SUM(CASE WHEN id IS NULL THEN 1 ELSE 0 END)/COUNT(*) AS total_nulls
FROM analytics.dbt.first_model
HAVING  SUM(CASE WHEN id IS NULL THEN 1 ELSE 0 END)/COUNT(*) > .1
      
    ) dbt_internal_test
2021-10-08 09:51:05.115162 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-10-08 09:51:05.118769 (Thread-1): finished collecting timing info
2021-10-08 09:51:05.118769 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: ROLLBACK
2021-10-08 09:51:05.341243 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: Close
2021-10-08 09:51:05.656349 (Thread-1): 11:51:05 | 1 of 7 FAIL 1 assert_under_ten_percent_not_null...................... [FAIL 1 in 1.79s]
2021-10-08 09:51:05.658270 (Thread-1): Finished running node test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-08 09:51:05.658270 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:51:05.658270 (Thread-1): 11:51:05 | 2 of 7 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-10-08 09:51:05.659393 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:51:05.659894 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:51:05.665901 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 09:51:05.667980 (Thread-1): finished collecting timing info
2021-10-08 09:51:05.668994 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 09:51:05.670992 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:51:05.670992 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: BEGIN
2021-10-08 09:51:05.670992 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:51:06.743410 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-10-08 09:51:06.744411 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:51:06.744411 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
2021-10-08 09:51:07.073354 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-08 09:51:07.074456 (Thread-1): finished collecting timing info
2021-10-08 09:51:07.075458 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: ROLLBACK
2021-10-08 09:51:07.315079 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-10-08 09:51:07.607580 (Thread-1): 11:51:07 | 2 of 7 FAIL 1 not_null_my_second_dbt_model_id........................ [FAIL 1 in 1.95s]
2021-10-08 09:51:07.608579 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:51:07.608579 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:51:07.608579 (Thread-1): 11:51:07 | 3 of 7 START test not_null_snowflake_customer_purchases_c_custkey.... [RUN]
2021-10-08 09:51:07.608579 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:51:07.608579 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:51:07.611658 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 09:51:07.616579 (Thread-1): finished collecting timing info
2021-10-08 09:51:07.617544 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 09:51:07.619560 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:51:07.619560 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: BEGIN
2021-10-08 09:51:07.619560 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:51:08.413133 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 09:51:08.413133 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:51:08.413133 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.snowflake_customer_purchases
where c_custkey is null



      
    ) dbt_internal_test
2021-10-08 09:51:08.759890 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-10-08 09:51:08.760978 (Thread-1): finished collecting timing info
2021-10-08 09:51:08.760978 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: ROLLBACK
2021-10-08 09:51:09.001875 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: Close
2021-10-08 09:51:09.326420 (Thread-1): 11:51:09 | 3 of 7 PASS not_null_snowflake_customer_purchases_c_custkey.......... [PASS in 1.72s]
2021-10-08 09:51:09.328388 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:51:09.328388 (Thread-1): Began running node test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 09:51:09.328388 (Thread-1): 11:51:09 | 4 of 7 START test relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_ [RUN]
2021-10-08 09:51:09.329518 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 09:51:09.329518 (Thread-1): Compiling test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 09:51:09.333526 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"
2021-10-08 09:51:09.335559 (Thread-1): finished collecting timing info
2021-10-08 09:51:09.336611 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"
2021-10-08 09:51:09.338672 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 09:51:09.338672 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: BEGIN
2021-10-08 09:51:09.338672 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:51:10.205947 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-08 09:51:10.205947 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 09:51:10.205947 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select id as from_field
    from analytics.dbt.my_second_dbt_model
    where id is not null
),

parent as (
    select id as to_field
    from analytics.dbt.first_model
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
2021-10-08 09:51:10.560619 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-10-08 09:51:10.561619 (Thread-1): finished collecting timing info
2021-10-08 09:51:10.561619 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: ROLLBACK
2021-10-08 09:51:10.870078 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: Close
2021-10-08 09:51:11.173415 (Thread-1): 11:51:11 | 4 of 7 PASS relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_ [PASS in 1.84s]
2021-10-08 09:51:11.174336 (Thread-1): Finished running node test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 09:51:11.174336 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:51:11.175401 (Thread-1): 11:51:11 | 5 of 7 START test unique_my_first_dbt_model_id....................... [RUN]
2021-10-08 09:51:11.175401 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:51:11.175401 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:51:11.182419 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 09:51:11.184376 (Thread-1): finished collecting timing info
2021-10-08 09:51:11.185411 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 09:51:11.187045 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:51:11.187045 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: BEGIN
2021-10-08 09:51:11.187045 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:51:12.024431 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-08 09:51:12.024431 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:51:12.024431 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.first_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:51:12.350501 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-08 09:51:12.350501 (Thread-1): finished collecting timing info
2021-10-08 09:51:12.350501 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: ROLLBACK
2021-10-08 09:51:12.585066 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-08 09:51:12.941905 (Thread-1): 11:51:12 | 5 of 7 PASS unique_my_first_dbt_model_id............................. [PASS in 1.77s]
2021-10-08 09:51:12.942927 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:51:12.942927 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:51:12.942927 (Thread-1): 11:51:12 | 6 of 7 START test unique_my_second_dbt_model_id...................... [RUN]
2021-10-08 09:51:12.943930 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:51:12.943930 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:51:12.946932 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 09:51:12.949938 (Thread-1): finished collecting timing info
2021-10-08 09:51:12.952506 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 09:51:12.955359 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:51:12.955359 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: BEGIN
2021-10-08 09:51:12.955359 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:51:13.777399 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 09:51:13.777399 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:51:13.777399 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:51:14.211117 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-10-08 09:51:14.212115 (Thread-1): finished collecting timing info
2021-10-08 09:51:14.212115 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: ROLLBACK
2021-10-08 09:51:14.492270 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: Close
2021-10-08 09:51:14.794072 (Thread-1): 11:51:14 | 6 of 7 PASS unique_my_second_dbt_model_id............................ [PASS in 1.85s]
2021-10-08 09:51:14.795656 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:51:14.795656 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:51:14.795656 (Thread-1): 11:51:14 | 7 of 7 START test unique_snowflake_customer_purchases_c_custkey...... [RUN]
2021-10-08 09:51:14.796565 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:51:14.796565 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:51:14.800575 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 09:51:14.802575 (Thread-1): finished collecting timing info
2021-10-08 09:51:14.803576 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 09:51:14.805574 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:51:14.805574 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: BEGIN
2021-10-08 09:51:14.805574 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:51:15.602256 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-08 09:51:15.603331 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:51:15.603331 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.snowflake_customer_purchases
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:51:15.989289 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-10-08 09:51:15.990298 (Thread-1): finished collecting timing info
2021-10-08 09:51:15.990298 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: ROLLBACK
2021-10-08 09:51:16.219996 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: Close
2021-10-08 09:51:16.532563 (Thread-1): 11:51:16 | 7 of 7 PASS unique_snowflake_customer_purchases_c_custkey............ [PASS in 1.74s]
2021-10-08 09:51:16.533562 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:51:16.535564 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:51:16.535564 (MainThread): 11:51:16 | 
2021-10-08 09:51:16.535564 (MainThread): 11:51:16 | Finished running 7 tests in 14.37s.
2021-10-08 09:51:16.535564 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:51:16.535564 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:51:16.535564 (MainThread): Connection 'test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8' was properly closed.
2021-10-08 09:51:16.549815 (MainThread): 
2021-10-08 09:51:16.549815 (MainThread): Completed with 2 errors and 0 warnings:
2021-10-08 09:51:16.549815 (MainThread): 
2021-10-08 09:51:16.550812 (MainThread): Failure in test assert_under_ten_percent_not_null (tests\assert_under_ten_percent_not_null.sql)
2021-10-08 09:51:16.550812 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-08 09:51:16.550812 (MainThread): 
2021-10-08 09:51:16.550812 (MainThread):   compiled SQL at target\compiled\lukeclarke_learn_dbt\tests\assert_under_ten_percent_not_null.sql
2021-10-08 09:51:16.550812 (MainThread): 
2021-10-08 09:51:16.550812 (MainThread): Failure in test not_null_my_second_dbt_model_id (models\example\schema.yml)
2021-10-08 09:51:16.550812 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-08 09:51:16.550812 (MainThread): 
2021-10-08 09:51:16.550812 (MainThread):   compiled SQL at target\compiled\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\not_null_my_second_dbt_model_id.sql
2021-10-08 09:51:16.551812 (MainThread): 
Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
2021-10-08 09:51:16.551812 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BC05C8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BBF13C2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BC0625AF0>]}
2021-10-08 09:51:16.551812 (MainThread): Flushing usage events
2021-10-08 09:51:25.928566 (MainThread): Running with dbt=0.20.2
2021-10-08 09:51:26.593802 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 09:51:26.594724 (MainThread): Tracking: tracking
2021-10-08 09:51:26.594724 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD7C6CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD919A5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD919A760>]}
2021-10-08 09:51:26.601633 (MainThread): Partial parsing not enabled
2021-10-08 09:51:26.617134 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:51:26.639021 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:51:26.640022 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:51:26.650499 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:51:26.651481 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:51:26.654437 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:51:26.655488 (MainThread): Parsing macros\core.sql
2021-10-08 09:51:26.658495 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:51:26.694223 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:51:26.700234 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:51:26.701141 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:51:26.702223 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:51:26.703215 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:51:26.704229 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:51:26.705224 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:51:26.712403 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:51:26.717395 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:51:26.727844 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:51:26.729848 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:51:26.734844 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:51:26.751287 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:51:26.774688 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:51:26.776691 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:51:26.789025 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:51:26.795008 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:51:26.798024 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:51:26.802835 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:51:26.803834 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:51:26.804750 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:51:26.805787 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:51:26.940747 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:51:26.949520 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:51:26.955672 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:51:26.957760 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:51:26.958769 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:51:26.961760 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:51:26.963774 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:51:26.974681 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:51:26.976763 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:51:27.036134 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:51:27.037135 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:51:27.039135 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:51:27.052489 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:51:27.052489 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:51:27.054399 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:51:27.056397 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:51:27.070891 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f63080c-979e-4b9d-b902-c6228f76976a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD92161F0>]}
2021-10-08 09:51:27.090907 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:51:27.091907 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f63080c-979e-4b9d-b902-c6228f76976a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD9216D60>]}
2021-10-08 09:51:27.091907 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:51:27.094018 (MainThread): 
2021-10-08 09:51:27.095017 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:51:27.098106 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 09:51:27.113583 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 09:51:27.113583 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 09:51:27.113583 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 09:51:28.434493 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.32 seconds
2021-10-08 09:51:28.439490 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 09:51:28.730950 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:51:28.744326 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:51:28.744326 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:51:28.745331 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:51:29.813312 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.07 seconds
2021-10-08 09:51:29.813312 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:51:30.137648 (MainThread): Using snowflake connection "master".
2021-10-08 09:51:30.137648 (MainThread): On master: BEGIN
2021-10-08 09:51:30.137648 (MainThread): Opening a new connection, currently in state init
2021-10-08 09:51:30.990625 (MainThread): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-08 09:51:30.991624 (MainThread): On master: COMMIT
2021-10-08 09:51:30.991624 (MainThread): Using snowflake connection "master".
2021-10-08 09:51:30.991624 (MainThread): On master: COMMIT
2021-10-08 09:51:31.264836 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 09:51:31.265923 (MainThread): On master: Close
2021-10-08 09:51:31.581711 (MainThread): 11:51:31 | Concurrency: 1 threads (target='dev')
2021-10-08 09:51:31.581711 (MainThread): 11:51:31 | 
2021-10-08 09:51:31.583710 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:51:31.583710 (Thread-1): 11:51:31 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-08 09:51:31.583710 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:51:31.583710 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:51:31.586810 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:51:31.588685 (Thread-1): finished collecting timing info
2021-10-08 09:51:31.628981 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:51:31.631001 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:51:31.631001 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 09:51:31.631001 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:51:32.483109 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-08 09:51:32.483109 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:51:32.483109 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all   
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 09:51:33.754753 (Thread-1): SQL status: SUCCESS 1 in 1.27 seconds
2021-10-08 09:51:33.756873 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:51:33.757063 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:51:33.757117 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:51:33.918356 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:51:33.925501 (Thread-1): finished collecting timing info
2021-10-08 09:51:33.925501 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 09:51:34.233705 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f63080c-979e-4b9d-b902-c6228f76976a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD9182790>]}
2021-10-08 09:51:34.233705 (Thread-1): 11:51:34 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.65s]
2021-10-08 09:51:34.235457 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:51:34.235457 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:51:34.235457 (Thread-1): 11:51:34 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 09:51:34.236469 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:51:34.236469 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:51:34.237569 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:51:34.242893 (Thread-1): finished collecting timing info
2021-10-08 09:51:34.247190 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:51:34.250205 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:51:34.250205 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 09:51:34.250205 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:51:35.133289 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-10-08 09:51:35.133289 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:51:35.133289 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 09:51:36.610021 (Thread-1): SQL status: SUCCESS 1 in 1.48 seconds
2021-10-08 09:51:36.611109 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:51:36.611109 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:51:36.611109 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:51:36.776074 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:51:36.777073 (Thread-1): finished collecting timing info
2021-10-08 09:51:36.777073 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 09:51:37.077412 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f63080c-979e-4b9d-b902-c6228f76976a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD94A5970>]}
2021-10-08 09:51:37.077412 (Thread-1): 11:51:37 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.84s]
2021-10-08 09:51:37.078182 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:51:37.078182 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:51:37.078182 (Thread-1): 11:51:37 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-08 09:51:37.079190 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:51:37.079190 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 09:51:37.084189 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:51:37.088693 (Thread-1): finished collecting timing info
2021-10-08 09:51:37.106031 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:51:37.106031 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 09:51:37.106031 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:51:38.484109 (Thread-1): SQL status: SUCCESS 1 in 1.38 seconds
2021-10-08 09:51:38.494660 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:51:38.494660 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 09:51:38.672918 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:51:38.675836 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:51:38.676856 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:51:38.830393 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-08 09:51:38.831477 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:51:38.831477 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:51:38.990098 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:51:39.003997 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:51:39.006952 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:51:39.007452 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 09:51:39.194122 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:51:39.195123 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:51:39.195123 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 09:51:39.572681 (Thread-1): SQL status: SUCCESS 0 in 0.38 seconds
2021-10-08 09:51:39.574688 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:51:39.575686 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:51:39.575686 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:51:39.893571 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-08 09:51:39.895578 (Thread-1): finished collecting timing info
2021-10-08 09:51:39.895578 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 09:51:40.222930 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f63080c-979e-4b9d-b902-c6228f76976a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD95C6790>]}
2021-10-08 09:51:40.223929 (Thread-1): 11:51:40 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.14s]
2021-10-08 09:51:40.223929 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:51:40.223929 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:51:40.224926 (Thread-1): 11:51:40 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 09:51:40.224926 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:51:40.224926 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:51:40.225927 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:51:40.232022 (Thread-1): finished collecting timing info
2021-10-08 09:51:40.234818 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:51:40.238148 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:51:40.238148 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 09:51:40.238148 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:51:41.204539 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-08 09:51:41.204957 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:51:41.204957 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 09:51:42.727272 (Thread-1): SQL status: SUCCESS 1 in 1.52 seconds
2021-10-08 09:51:42.728287 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:51:42.728287 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:51:42.728287 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:51:42.907043 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:51:42.908057 (Thread-1): finished collecting timing info
2021-10-08 09:51:42.908057 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 09:51:43.189123 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f63080c-979e-4b9d-b902-c6228f76976a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD94D76A0>]}
2021-10-08 09:51:43.190190 (Thread-1): 11:51:43 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.96s]
2021-10-08 09:51:43.191037 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:51:43.191037 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 09:51:43.191450 (Thread-1): 11:51:43 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-08 09:51:43.191535 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:51:43.191535 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 09:51:43.194610 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:51:43.196617 (Thread-1): finished collecting timing info
2021-10-08 09:51:43.198689 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:51:43.198689 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 09:51:43.198689 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:51:44.803878 (Thread-1): SQL status: SUCCESS 1 in 1.61 seconds
2021-10-08 09:51:44.804876 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:51:44.804876 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 09:51:45.009797 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 09:51:45.013910 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:51:45.014910 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:51:45.172278 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:51:45.176133 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:51:45.176133 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:51:45.329232 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-08 09:51:45.331240 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:51:45.333166 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:51:45.333166 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 09:51:45.562838 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-08 09:51:45.563859 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:51:45.563859 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 09:51:45.914281 (Thread-1): SQL status: SUCCESS 0 in 0.35 seconds
2021-10-08 09:51:45.916340 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:51:45.916340 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:51:45.916340 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:51:46.183664 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 09:51:46.184676 (Thread-1): finished collecting timing info
2021-10-08 09:51:46.184676 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 09:51:46.486601 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f63080c-979e-4b9d-b902-c6228f76976a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD95C2FD0>]}
2021-10-08 09:51:46.486601 (Thread-1): 11:51:46 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.30s]
2021-10-08 09:51:46.488517 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 09:51:46.488517 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:51:46.489594 (Thread-1): 11:51:46 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 09:51:46.490620 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:51:46.490620 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:51:46.491983 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:51:46.498515 (Thread-1): finished collecting timing info
2021-10-08 09:51:46.500523 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:51:46.502522 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:51:46.502522 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 09:51:46.502522 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:51:47.304658 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-08 09:51:47.304658 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:51:47.304658 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-08 09:51:48.440615 (Thread-1): SQL status: SUCCESS 1 in 1.14 seconds
2021-10-08 09:51:48.440615 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:51:48.441640 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:51:48.441640 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:51:48.626111 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:51:48.628091 (Thread-1): finished collecting timing info
2021-10-08 09:51:48.628091 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 09:51:48.917431 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f63080c-979e-4b9d-b902-c6228f76976a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD9656850>]}
2021-10-08 09:51:48.918439 (Thread-1): 11:51:48 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.43s]
2021-10-08 09:51:48.919506 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:51:48.921655 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:51:48.921655 (MainThread): Using snowflake connection "master".
2021-10-08 09:51:48.921655 (MainThread): On master: BEGIN
2021-10-08 09:51:48.921655 (MainThread): Opening a new connection, currently in state closed
2021-10-08 09:51:49.691937 (MainThread): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-08 09:51:49.691937 (MainThread): On master: COMMIT
2021-10-08 09:51:49.691937 (MainThread): Using snowflake connection "master".
2021-10-08 09:51:49.691937 (MainThread): On master: COMMIT
2021-10-08 09:51:49.934617 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-08 09:51:49.934617 (MainThread): On master: Close
2021-10-08 09:51:50.229788 (MainThread): 11:51:50 | 
2021-10-08 09:51:50.230743 (MainThread): 11:51:50 | Finished running 4 table models, 2 incremental models in 23.14s.
2021-10-08 09:51:50.230743 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:51:50.230743 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 09:51:50.230743 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:51:50.230743 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 09:51:50.254051 (MainThread): 
2021-10-08 09:51:50.254051 (MainThread): Completed successfully
2021-10-08 09:51:50.255228 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-08 09:51:50.255228 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD95C2FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD95C6790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFD9182400>]}
2021-10-08 09:51:50.256326 (MainThread): Flushing usage events
2021-10-08 09:52:10.909298 (MainThread): Running with dbt=0.20.2
2021-10-08 09:52:11.456963 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-10-08 09:52:11.457965 (MainThread): Tracking: tracking
2021-10-08 09:52:11.457965 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFE02CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF55A5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF55A400>]}
2021-10-08 09:52:11.465217 (MainThread): Partial parsing not enabled
2021-10-08 09:52:11.478795 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:52:11.498535 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:52:11.500538 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:52:11.507448 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:52:11.508628 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:52:11.511722 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:52:11.511722 (MainThread): Parsing macros\core.sql
2021-10-08 09:52:11.514730 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:52:11.548907 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:52:11.555023 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:52:11.556058 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:52:11.557057 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:52:11.558057 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:52:11.559057 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:52:11.560057 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:52:11.567056 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:52:11.572188 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:52:11.582187 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:52:11.583188 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:52:11.589346 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:52:11.605492 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:52:11.626129 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:52:11.628130 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:52:11.640393 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:52:11.644383 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:52:11.648700 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:52:11.652727 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:52:11.654706 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:52:11.654706 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:52:11.656625 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:52:11.794884 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:52:11.800872 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:52:11.806881 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:52:11.808886 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:52:11.808886 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:52:11.811878 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:52:11.813879 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:52:11.823119 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:52:11.825119 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:52:11.872133 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:52:11.873116 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:52:11.875117 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:52:11.881316 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:52:11.881316 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:52:11.882318 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:52:11.884253 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:52:11.899998 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '518bf9d3-53d1-48d4-9a66-42eb0312a376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF5D21F0>]}
2021-10-08 09:52:11.922251 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:52:11.923252 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '518bf9d3-53d1-48d4-9a66-42eb0312a376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF5D28B0>]}
2021-10-08 09:52:11.923252 (MainThread): Found 6 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:52:11.924695 (MainThread): 
2021-10-08 09:52:11.924695 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:52:11.926400 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:52:11.938383 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:52:11.938736 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:52:11.938928 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:52:13.381620 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.44 seconds
2021-10-08 09:52:13.389011 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:52:13.688128 (MainThread): 11:52:13 | Concurrency: 1 threads (target='dev')
2021-10-08 09:52:13.688373 (MainThread): 11:52:13 | 
2021-10-08 09:52:13.690191 (Thread-1): Began running node test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-08 09:52:13.690315 (Thread-1): 11:52:13 | 1 of 7 START test assert_under_ten_percent_not_null.................. [RUN]
2021-10-08 09:52:13.690816 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:52:13.690816 (Thread-1): Compiling test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-08 09:52:13.694484 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"
2021-10-08 09:52:13.700508 (Thread-1): finished collecting timing info
2021-10-08 09:52:13.713772 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"
2021-10-08 09:52:13.719771 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:52:13.720771 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: BEGIN
2021-10-08 09:52:13.720771 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:52:14.479997 (Thread-1): SQL status: SUCCESS 1 in 0.76 seconds
2021-10-08 09:52:14.480996 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:52:14.480996 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
  SUM(CASE WHEN id IS NULL THEN 1 ELSE 0 END)/COUNT(*) AS total_nulls
FROM analytics.dbt.first_model
HAVING  SUM(CASE WHEN id IS NULL THEN 1 ELSE 0 END)/COUNT(*) > .4
      
    ) dbt_internal_test
2021-10-08 09:52:14.925418 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-10-08 09:52:14.927496 (Thread-1): finished collecting timing info
2021-10-08 09:52:14.927496 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: ROLLBACK
2021-10-08 09:52:15.156437 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: Close
2021-10-08 09:52:15.468635 (Thread-1): 11:52:15 | 1 of 7 PASS assert_under_ten_percent_not_null........................ [PASS in 1.78s]
2021-10-08 09:52:15.469635 (Thread-1): Finished running node test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-08 09:52:15.469635 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:52:15.469635 (Thread-1): 11:52:15 | 2 of 7 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-10-08 09:52:15.470635 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:52:15.470635 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:52:15.475634 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 09:52:15.477808 (Thread-1): finished collecting timing info
2021-10-08 09:52:15.478767 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 09:52:15.479771 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:52:15.480769 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: BEGIN
2021-10-08 09:52:15.480769 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:52:16.256567 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 09:52:16.256567 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 09:52:16.256567 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
2021-10-08 09:52:16.608169 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-10-08 09:52:16.609188 (Thread-1): finished collecting timing info
2021-10-08 09:52:16.609188 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: ROLLBACK
2021-10-08 09:52:16.894819 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-10-08 09:52:17.201667 (Thread-1): 11:52:17 | 2 of 7 FAIL 1 not_null_my_second_dbt_model_id........................ [FAIL 1 in 1.73s]
2021-10-08 09:52:17.204076 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 09:52:17.204076 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:52:17.204076 (Thread-1): 11:52:17 | 3 of 7 START test not_null_snowflake_customer_purchases_c_custkey.... [RUN]
2021-10-08 09:52:17.205496 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:52:17.205496 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:52:17.211492 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 09:52:17.213493 (Thread-1): finished collecting timing info
2021-10-08 09:52:17.214493 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 09:52:17.216490 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:52:17.216490 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: BEGIN
2021-10-08 09:52:17.216490 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:52:18.016081 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-08 09:52:18.017104 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 09:52:18.017104 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.snowflake_customer_purchases
where c_custkey is null



      
    ) dbt_internal_test
2021-10-08 09:52:18.346154 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-08 09:52:18.346154 (Thread-1): finished collecting timing info
2021-10-08 09:52:18.347155 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: ROLLBACK
2021-10-08 09:52:18.616061 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: Close
2021-10-08 09:52:18.901448 (Thread-1): 11:52:18 | 3 of 7 PASS not_null_snowflake_customer_purchases_c_custkey.......... [PASS in 1.70s]
2021-10-08 09:52:18.903770 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 09:52:18.903770 (Thread-1): Began running node test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 09:52:18.904272 (Thread-1): 11:52:18 | 4 of 7 START test relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_ [RUN]
2021-10-08 09:52:18.904272 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 09:52:18.904272 (Thread-1): Compiling test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 09:52:18.911815 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"
2021-10-08 09:52:18.914010 (Thread-1): finished collecting timing info
2021-10-08 09:52:18.916798 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"
2021-10-08 09:52:18.919625 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 09:52:18.919625 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: BEGIN
2021-10-08 09:52:18.919625 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:52:19.913294 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-10-08 09:52:19.913538 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 09:52:19.913538 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select id as from_field
    from analytics.dbt.my_second_dbt_model
    where id is not null
),

parent as (
    select id as to_field
    from analytics.dbt.first_model
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
2021-10-08 09:52:20.405672 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-10-08 09:52:20.406673 (Thread-1): finished collecting timing info
2021-10-08 09:52:20.406673 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: ROLLBACK
2021-10-08 09:52:20.714202 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: Close
2021-10-08 09:52:21.008893 (Thread-1): 11:52:21 | 4 of 7 PASS relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_ [PASS in 2.10s]
2021-10-08 09:52:21.009985 (Thread-1): Finished running node test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 09:52:21.009985 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:52:21.009985 (Thread-1): 11:52:21 | 5 of 7 START test unique_my_first_dbt_model_id....................... [RUN]
2021-10-08 09:52:21.011045 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:52:21.011045 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:52:21.021084 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 09:52:21.022418 (Thread-1): finished collecting timing info
2021-10-08 09:52:21.024491 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 09:52:21.025422 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:52:21.025422 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: BEGIN
2021-10-08 09:52:21.025422 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:52:21.896359 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-08 09:52:21.897400 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 09:52:21.897400 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.first_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:52:22.280595 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-10-08 09:52:22.280595 (Thread-1): finished collecting timing info
2021-10-08 09:52:22.280595 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: ROLLBACK
2021-10-08 09:52:22.556914 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-08 09:52:22.865991 (Thread-1): 11:52:22 | 5 of 7 PASS unique_my_first_dbt_model_id............................. [PASS in 1.86s]
2021-10-08 09:52:22.866865 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 09:52:22.866865 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:52:22.866865 (Thread-1): 11:52:22 | 6 of 7 START test unique_my_second_dbt_model_id...................... [RUN]
2021-10-08 09:52:22.867444 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:52:22.867444 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:52:22.870600 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 09:52:22.872563 (Thread-1): finished collecting timing info
2021-10-08 09:52:22.873489 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 09:52:22.875371 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:52:22.875371 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: BEGIN
2021-10-08 09:52:22.875371 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:52:23.936857 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-10-08 09:52:23.936857 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 09:52:23.936857 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:52:24.168356 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-08 09:52:24.169476 (Thread-1): finished collecting timing info
2021-10-08 09:52:24.169607 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: ROLLBACK
2021-10-08 09:52:24.430386 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: Close
2021-10-08 09:52:24.748493 (Thread-1): 11:52:24 | 6 of 7 PASS unique_my_second_dbt_model_id............................ [PASS in 1.88s]
2021-10-08 09:52:24.749492 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 09:52:24.749492 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:52:24.749492 (Thread-1): 11:52:24 | 7 of 7 START test unique_snowflake_customer_purchases_c_custkey...... [RUN]
2021-10-08 09:52:24.750494 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:52:24.750494 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:52:24.753510 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 09:52:24.755513 (Thread-1): finished collecting timing info
2021-10-08 09:52:24.757514 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 09:52:24.759182 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:52:24.759182 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: BEGIN
2021-10-08 09:52:24.759182 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:52:25.585858 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-08 09:52:25.585858 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 09:52:25.585858 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.snowflake_customer_purchases
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 09:52:25.851458 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 09:52:25.851458 (Thread-1): finished collecting timing info
2021-10-08 09:52:25.852366 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: ROLLBACK
2021-10-08 09:52:26.145119 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: Close
2021-10-08 09:52:26.594312 (Thread-1): 11:52:26 | 7 of 7 PASS unique_snowflake_customer_purchases_c_custkey............ [PASS in 1.84s]
2021-10-08 09:52:26.595317 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 09:52:26.597248 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:52:26.597752 (MainThread): 11:52:26 | 
2021-10-08 09:52:26.597752 (MainThread): 11:52:26 | Finished running 7 tests in 14.67s.
2021-10-08 09:52:26.597752 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:52:26.597752 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:52:26.597752 (MainThread): Connection 'test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8' was properly closed.
2021-10-08 09:52:26.614231 (MainThread): 
2021-10-08 09:52:26.614231 (MainThread): Completed with 1 error and 0 warnings:
2021-10-08 09:52:26.614950 (MainThread): 
2021-10-08 09:52:26.614950 (MainThread): Failure in test not_null_my_second_dbt_model_id (models\example\schema.yml)
2021-10-08 09:52:26.615939 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-08 09:52:26.615939 (MainThread): 
2021-10-08 09:52:26.615939 (MainThread):   compiled SQL at target\compiled\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\not_null_my_second_dbt_model_id.sql
2021-10-08 09:52:26.615939 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-10-08 09:52:26.617012 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF4C6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF5B46D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAFF9BB460>]}
2021-10-08 09:52:26.617012 (MainThread): Flushing usage events
2021-10-08 09:55:01.962074 (MainThread): Running with dbt=0.20.2
2021-10-08 09:55:02.588351 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 09:55:02.589353 (MainThread): Tracking: tracking
2021-10-08 09:55:02.589353 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACE0ADE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACF5DAA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACF5DA670>]}
2021-10-08 09:55:02.597353 (MainThread): Partial parsing not enabled
2021-10-08 09:55:02.612509 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:55:02.634105 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:55:02.636106 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:55:02.643165 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:55:02.645162 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:55:02.648145 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:55:02.648145 (MainThread): Parsing macros\core.sql
2021-10-08 09:55:02.651165 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:55:02.684501 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:55:02.691638 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:55:02.692622 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:55:02.693624 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:55:02.694623 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:55:02.695623 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:55:02.696636 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:55:02.704304 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:55:02.709303 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:55:02.720290 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:55:02.721311 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:55:02.727309 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:55:02.742772 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:55:02.764460 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:55:02.766536 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:55:02.779432 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:55:02.785415 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:55:02.788504 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:55:02.793493 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:55:02.794432 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:55:02.795517 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:55:02.796489 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:55:02.928599 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 09:55:02.935951 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:55:02.937957 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:55:02.942953 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:55:02.944953 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:55:02.945950 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:55:02.948158 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:55:02.950160 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:55:02.962867 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:55:02.965954 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:55:03.015734 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:55:03.016734 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:55:03.017735 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:55:03.024860 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:55:03.024860 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:55:03.025877 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:55:03.026878 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:55:03.041605 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fe926d1-5e27-4afb-b809-a2dcd97272b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACF5EB040>]}
2021-10-08 09:55:03.064761 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:55:03.064761 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fe926d1-5e27-4afb-b809-a2dcd97272b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACF5C9FD0>]}
2021-10-08 09:55:03.065786 (MainThread): Found 7 models, 7 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:55:03.066782 (MainThread): 
2021-10-08 09:55:03.067068 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:55:03.068954 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 09:55:03.080877 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 09:55:03.080877 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 09:55:03.080877 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 09:55:04.504436 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.42 seconds
2021-10-08 09:55:04.506526 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 09:55:04.842847 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:55:04.847842 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:55:04.847842 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:55:04.847842 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:55:05.889109 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.04 seconds
2021-10-08 09:55:05.890109 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:55:06.182120 (MainThread): Using snowflake connection "master".
2021-10-08 09:55:06.182120 (MainThread): On master: BEGIN
2021-10-08 09:55:06.182120 (MainThread): Opening a new connection, currently in state init
2021-10-08 09:55:06.987857 (MainThread): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-08 09:55:06.987857 (MainThread): On master: COMMIT
2021-10-08 09:55:06.988855 (MainThread): Using snowflake connection "master".
2021-10-08 09:55:06.988855 (MainThread): On master: COMMIT
2021-10-08 09:55:07.215620 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-08 09:55:07.215620 (MainThread): On master: Close
2021-10-08 09:55:07.523410 (MainThread): 11:55:07 | Concurrency: 1 threads (target='dev')
2021-10-08 09:55:07.523410 (MainThread): 11:55:07 | 
2021-10-08 09:55:07.525310 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:55:07.526310 (Thread-1): 11:55:07 | 1 of 7 START table model dbt.first_model............................. [RUN]
2021-10-08 09:55:07.526310 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:55:07.526310 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:55:07.527395 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:55:07.529313 (Thread-1): finished collecting timing info
2021-10-08 09:55:07.551981 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:55:07.554945 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:55:07.554945 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 09:55:07.554945 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:55:08.344225 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 09:55:08.344225 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:55:08.344225 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all   
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 09:55:09.295926 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-10-08 09:55:09.297012 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:55:09.297012 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:55:09.297012 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:55:09.455847 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:55:09.465054 (Thread-1): finished collecting timing info
2021-10-08 09:55:09.465054 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 09:55:09.804013 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe926d1-5e27-4afb-b809-a2dcd97272b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACF8FB130>]}
2021-10-08 09:55:09.805058 (Thread-1): 11:55:09 | 1 of 7 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.28s]
2021-10-08 09:55:09.806053 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:55:09.806053 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:55:09.806053 (Thread-1): 11:55:09 | 2 of 7 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 09:55:09.806053 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:55:09.806053 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:55:09.809144 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:55:09.813107 (Thread-1): finished collecting timing info
2021-10-08 09:55:09.816160 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:55:09.818703 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:55:09.818703 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 09:55:09.818703 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:55:10.606890 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 09:55:10.606890 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:55:10.606890 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 09:55:12.608941 (Thread-1): SQL status: SUCCESS 1 in 2.00 seconds
2021-10-08 09:55:12.611125 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:55:12.611125 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:55:12.611125 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:55:12.802422 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:55:12.804420 (Thread-1): finished collecting timing info
2021-10-08 09:55:12.805423 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 09:55:13.130972 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe926d1-5e27-4afb-b809-a2dcd97272b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACF8AEA90>]}
2021-10-08 09:55:13.130972 (Thread-1): 11:55:13 | 2 of 7 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.32s]
2021-10-08 09:55:13.132536 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:55:13.132536 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:55:13.132536 (Thread-1): 11:55:13 | 3 of 7 START incremental model dbt.dates............................. [RUN]
2021-10-08 09:55:13.133574 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:55:13.133574 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 09:55:13.138651 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:55:13.143767 (Thread-1): finished collecting timing info
2021-10-08 09:55:13.159550 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:55:13.160561 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 09:55:13.160561 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:55:14.506457 (Thread-1): SQL status: SUCCESS 1 in 1.35 seconds
2021-10-08 09:55:14.515456 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:55:14.515456 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 09:55:14.709485 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:55:14.713058 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:55:14.713559 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:55:14.873342 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:55:14.875345 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:55:14.875345 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:55:15.045392 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:55:15.068461 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:55:15.070380 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:55:15.070380 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 09:55:15.272437 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 09:55:15.272437 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:55:15.272437 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 09:55:15.917717 (Thread-1): SQL status: SUCCESS 0 in 0.65 seconds
2021-10-08 09:55:15.918800 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:55:15.918800 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:55:15.918800 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:55:16.232979 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-10-08 09:55:16.233982 (Thread-1): finished collecting timing info
2021-10-08 09:55:16.233982 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 09:55:16.542982 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe926d1-5e27-4afb-b809-a2dcd97272b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACF69A3A0>]}
2021-10-08 09:55:16.543980 (Thread-1): 11:55:16 | 3 of 7 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.41s]
2021-10-08 09:55:16.544583 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:55:16.544583 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-08 09:55:16.544583 (Thread-1): 11:55:16 | 4 of 7 START view model dbt.playing_with_tests....................... [RUN]
2021-10-08 09:55:16.545490 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 09:55:16.545490 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-08 09:55:16.546491 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-08 09:55:16.547490 (Thread-1): finished collecting timing info
2021-10-08 09:55:16.559763 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-08 09:55:16.561250 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 09:55:16.561250 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-08 09:55:16.561250 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:55:17.510864 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-10-08 09:55:17.510864 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 09:55:17.510864 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */

  create or replace  view analytics.dbt.playing_with_tests  as (
    SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF001"."CUSTOMER"
  );
2021-10-08 09:55:17.934572 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-10-08 09:55:17.935582 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-08 09:55:17.935582 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 09:55:17.935582 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-08 09:55:18.109049 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:55:18.110049 (Thread-1): finished collecting timing info
2021-10-08 09:55:18.111049 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-08 09:55:18.401665 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe926d1-5e27-4afb-b809-a2dcd97272b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACF9DCC40>]}
2021-10-08 09:55:18.402662 (Thread-1): 11:55:18 | 4 of 7 OK created view model dbt.playing_with_tests.................. [SUCCESS 1 in 1.86s]
2021-10-08 09:55:18.402662 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-08 09:55:18.402662 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:55:18.403796 (Thread-1): 11:55:18 | 5 of 7 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 09:55:18.403796 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:55:18.403796 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:55:18.404806 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:55:18.409927 (Thread-1): finished collecting timing info
2021-10-08 09:55:18.411067 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:55:18.412984 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:55:18.412984 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 09:55:18.412984 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:55:19.256191 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-08 09:55:19.256191 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:55:19.256191 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 09:55:20.776153 (Thread-1): SQL status: SUCCESS 1 in 1.52 seconds
2021-10-08 09:55:20.777298 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:55:20.777700 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:55:20.777700 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:55:20.942396 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:55:20.943479 (Thread-1): finished collecting timing info
2021-10-08 09:55:20.944479 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 09:55:21.258671 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe926d1-5e27-4afb-b809-a2dcd97272b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACF9CB5B0>]}
2021-10-08 09:55:21.259703 (Thread-1): 11:55:21 | 5 of 7 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.85s]
2021-10-08 09:55:21.261452 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:55:21.261452 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 09:55:21.261452 (Thread-1): 11:55:21 | 6 of 7 START incremental model dbt.time.............................. [RUN]
2021-10-08 09:55:21.262476 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:55:21.262476 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 09:55:21.265465 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:55:21.266652 (Thread-1): finished collecting timing info
2021-10-08 09:55:21.269173 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:55:21.269173 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 09:55:21.269173 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:55:22.803429 (Thread-1): SQL status: SUCCESS 1 in 1.53 seconds
2021-10-08 09:55:22.804584 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:55:22.804584 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 09:55:22.980101 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:55:22.983118 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:55:22.983118 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:55:23.142755 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:55:23.145756 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:55:23.145756 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:55:23.302748 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:55:23.303746 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:55:23.306695 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:55:23.306695 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 09:55:23.501464 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:55:23.501464 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:55:23.501464 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 09:55:23.807170 (Thread-1): SQL status: SUCCESS 0 in 0.31 seconds
2021-10-08 09:55:23.808169 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:55:23.809185 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:55:23.809185 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:55:24.094169 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-08 09:55:24.094689 (Thread-1): finished collecting timing info
2021-10-08 09:55:24.095191 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 09:55:24.403574 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe926d1-5e27-4afb-b809-a2dcd97272b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACFA311C0>]}
2021-10-08 09:55:24.403574 (Thread-1): 11:55:24 | 6 of 7 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.14s]
2021-10-08 09:55:24.404571 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 09:55:24.404571 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:55:24.404571 (Thread-1): 11:55:24 | 7 of 7 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 09:55:24.405572 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:55:24.405572 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:55:24.407656 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:55:24.412571 (Thread-1): finished collecting timing info
2021-10-08 09:55:24.413659 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:55:24.414571 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:55:24.415572 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 09:55:24.415572 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:55:25.224811 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-08 09:55:25.224811 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:55:25.224811 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-08 09:55:26.383541 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2021-10-08 09:55:26.384540 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:55:26.384540 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:55:26.384540 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:55:26.554698 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:55:26.555698 (Thread-1): finished collecting timing info
2021-10-08 09:55:26.555698 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 09:55:26.865139 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe926d1-5e27-4afb-b809-a2dcd97272b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACFA9AC10>]}
2021-10-08 09:55:26.866363 (Thread-1): 11:55:26 | 7 of 7 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.46s]
2021-10-08 09:55:26.868284 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:55:26.869280 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:55:26.870277 (MainThread): Using snowflake connection "master".
2021-10-08 09:55:26.870277 (MainThread): On master: BEGIN
2021-10-08 09:55:26.870277 (MainThread): Opening a new connection, currently in state closed
2021-10-08 09:55:27.656778 (MainThread): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 09:55:27.656778 (MainThread): On master: COMMIT
2021-10-08 09:55:27.656778 (MainThread): Using snowflake connection "master".
2021-10-08 09:55:27.656778 (MainThread): On master: COMMIT
2021-10-08 09:55:27.925186 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 09:55:27.925186 (MainThread): On master: Close
2021-10-08 09:55:28.215734 (MainThread): 11:55:28 | 
2021-10-08 09:55:28.215734 (MainThread): 11:55:28 | Finished running 4 table models, 2 incremental models, 1 view model in 25.15s.
2021-10-08 09:55:28.215734 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:55:28.215734 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 09:55:28.216770 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:55:28.216770 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 09:55:28.227748 (MainThread): 
2021-10-08 09:55:28.227748 (MainThread): Completed successfully
2021-10-08 09:55:28.228852 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-08 09:55:28.228852 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACF5CA850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACF5CA2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACF87CEE0>]}
2021-10-08 09:55:28.228852 (MainThread): Flushing usage events
2021-10-08 09:56:35.265197 (MainThread): Running with dbt=0.20.2
2021-10-08 09:56:35.895077 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 09:56:35.895077 (MainThread): Tracking: tracking
2021-10-08 09:56:35.895077 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A518DDDDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51A30A610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51A30AC40>]}
2021-10-08 09:56:35.901259 (MainThread): Partial parsing not enabled
2021-10-08 09:56:35.913902 (MainThread): Parsing macros\adapters.sql
2021-10-08 09:56:35.942444 (MainThread): Parsing macros\catalog.sql
2021-10-08 09:56:35.943599 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 09:56:35.951469 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 09:56:35.953575 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 09:56:35.956690 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 09:56:35.958153 (MainThread): Parsing macros\core.sql
2021-10-08 09:56:35.961692 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 09:56:35.995681 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 09:56:36.001682 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 09:56:36.002682 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 09:56:36.003762 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 09:56:36.004929 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 09:56:36.005925 (MainThread): Parsing macros\etc\query.sql
2021-10-08 09:56:36.006925 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 09:56:36.013925 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 09:56:36.019031 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 09:56:36.028066 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 09:56:36.030132 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 09:56:36.035351 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 09:56:36.050619 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 09:56:36.069796 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 09:56:36.070798 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 09:56:36.083306 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 09:56:36.088306 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 09:56:36.091306 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 09:56:36.096435 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 09:56:36.097436 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 09:56:36.098436 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 09:56:36.099436 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 09:56:36.224527 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 09:56:36.231534 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:56:36.232540 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:56:36.238824 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:56:36.240818 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:56:36.240818 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:56:36.242807 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:56:36.244734 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:56:36.254821 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 09:56:36.255811 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:56:36.353516 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:56:36.356520 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:56:36.357805 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:56:36.369907 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:56:36.370891 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:56:36.373502 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:56:36.374509 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:56:36.376509 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:56:36.377509 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 09:56:36.404139 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11264859-3456-42da-8d84-d49f4f856071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51A41F250>]}
2021-10-08 09:56:36.436272 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 09:56:36.437238 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11264859-3456-42da-8d84-d49f4f856071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A517879940>]}
2021-10-08 09:56:36.437238 (MainThread): Found 7 models, 9 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 09:56:36.439088 (MainThread): 
2021-10-08 09:56:36.439881 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:56:36.440837 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 09:56:36.454528 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 09:56:36.454528 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 09:56:36.454528 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 09:56:37.987724 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.53 seconds
2021-10-08 09:56:37.990723 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 09:56:38.304480 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 09:56:38.308500 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 09:56:38.308500 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 09:56:38.308500 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 09:56:39.448091 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.14 seconds
2021-10-08 09:56:39.449708 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 09:56:39.741456 (MainThread): Using snowflake connection "master".
2021-10-08 09:56:39.741456 (MainThread): On master: BEGIN
2021-10-08 09:56:39.741456 (MainThread): Opening a new connection, currently in state init
2021-10-08 09:56:40.573237 (MainThread): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-08 09:56:40.573237 (MainThread): On master: COMMIT
2021-10-08 09:56:40.573501 (MainThread): Using snowflake connection "master".
2021-10-08 09:56:40.573586 (MainThread): On master: COMMIT
2021-10-08 09:56:40.834951 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-08 09:56:40.834951 (MainThread): On master: Close
2021-10-08 09:56:41.130105 (MainThread): 11:56:41 | Concurrency: 1 threads (target='dev')
2021-10-08 09:56:41.130105 (MainThread): 11:56:41 | 
2021-10-08 09:56:41.132228 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:56:41.132228 (Thread-1): 11:56:41 | 1 of 7 START table model dbt.first_model............................. [RUN]
2021-10-08 09:56:41.133310 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:56:41.133310 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:56:41.137230 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:56:41.138307 (Thread-1): finished collecting timing info
2021-10-08 09:56:41.163453 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 09:56:41.165679 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:56:41.166010 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 09:56:41.166010 (Thread-1): Opening a new connection, currently in state init
2021-10-08 09:56:41.982313 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 09:56:41.983311 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:56:41.983311 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all   
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 09:56:43.357827 (Thread-1): SQL status: SUCCESS 1 in 1.37 seconds
2021-10-08 09:56:43.359104 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:56:43.359104 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 09:56:43.359104 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 09:56:43.528852 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 09:56:43.539573 (Thread-1): finished collecting timing info
2021-10-08 09:56:43.539573 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 09:56:43.842850 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11264859-3456-42da-8d84-d49f4f856071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51A73B910>]}
2021-10-08 09:56:43.843848 (Thread-1): 11:56:43 | 1 of 7 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.71s]
2021-10-08 09:56:43.843848 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 09:56:43.843848 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:56:43.844850 (Thread-1): 11:56:43 | 2 of 7 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 09:56:43.844850 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:56:43.844850 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:56:43.845852 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:56:43.851848 (Thread-1): finished collecting timing info
2021-10-08 09:56:43.854700 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 09:56:43.864550 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:56:43.864550 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 09:56:43.864550 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:56:44.808167 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-10-08 09:56:44.808167 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:56:44.808167 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 09:56:46.677346 (Thread-1): SQL status: SUCCESS 1 in 1.87 seconds
2021-10-08 09:56:46.679414 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:56:46.679414 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 09:56:46.679414 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 09:56:46.902643 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-08 09:56:46.902643 (Thread-1): finished collecting timing info
2021-10-08 09:56:46.902643 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 09:56:47.209574 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11264859-3456-42da-8d84-d49f4f856071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51A64AD90>]}
2021-10-08 09:56:47.209574 (Thread-1): 11:56:47 | 2 of 7 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.36s]
2021-10-08 09:56:47.210587 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 09:56:47.210587 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:56:47.210587 (Thread-1): 11:56:47 | 3 of 7 START incremental model dbt.dates............................. [RUN]
2021-10-08 09:56:47.210587 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:56:47.211575 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 09:56:47.216576 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:56:47.221940 (Thread-1): finished collecting timing info
2021-10-08 09:56:47.235516 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:56:47.235516 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 09:56:47.235516 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:56:49.042708 (Thread-1): SQL status: SUCCESS 1 in 1.81 seconds
2021-10-08 09:56:49.047703 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:56:49.048704 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 09:56:49.229602 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:56:49.230620 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:56:49.230620 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:56:49.406225 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:56:49.408212 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:56:49.408212 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 09:56:49.607053 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 09:56:49.617141 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 09:56:49.619082 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:56:49.619082 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 09:56:49.819559 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 09:56:49.820069 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:56:49.820069 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 09:56:50.284814 (Thread-1): SQL status: SUCCESS 0 in 0.46 seconds
2021-10-08 09:56:50.285811 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:56:50.285811 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 09:56:50.285811 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 09:56:50.558700 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 09:56:50.559616 (Thread-1): finished collecting timing info
2021-10-08 09:56:50.559616 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 09:56:50.974667 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11264859-3456-42da-8d84-d49f4f856071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51A788820>]}
2021-10-08 09:56:50.975575 (Thread-1): 11:56:50 | 3 of 7 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.76s]
2021-10-08 09:56:50.976957 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 09:56:50.976957 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-08 09:56:50.976957 (Thread-1): 11:56:50 | 4 of 7 START view model dbt.playing_with_tests....................... [RUN]
2021-10-08 09:56:50.976957 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 09:56:50.976957 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-08 09:56:50.978042 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-08 09:56:50.982060 (Thread-1): finished collecting timing info
2021-10-08 09:56:50.997253 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-08 09:56:51.004515 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 09:56:51.004515 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-08 09:56:51.004515 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:56:51.921170 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2021-10-08 09:56:51.922181 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 09:56:51.922181 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */

  create or replace  view analytics.dbt.playing_with_tests  as (
    SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF001"."CUSTOMER"
  );
2021-10-08 09:56:52.472108 (Thread-1): SQL status: SUCCESS 1 in 0.55 seconds
2021-10-08 09:56:52.474246 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-08 09:56:52.474246 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 09:56:52.474246 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-08 09:56:52.639070 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:56:52.640077 (Thread-1): finished collecting timing info
2021-10-08 09:56:52.640077 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-08 09:56:52.939364 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11264859-3456-42da-8d84-d49f4f856071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51A788820>]}
2021-10-08 09:56:52.940438 (Thread-1): 11:56:52 | 4 of 7 OK created view model dbt.playing_with_tests.................. [SUCCESS 1 in 1.96s]
2021-10-08 09:56:52.940438 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-08 09:56:52.941365 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:56:52.941365 (Thread-1): 11:56:52 | 5 of 7 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 09:56:52.941365 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:56:52.941365 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:56:52.944398 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:56:52.949421 (Thread-1): finished collecting timing info
2021-10-08 09:56:52.951363 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 09:56:52.953482 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:56:52.953899 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 09:56:52.953930 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:56:53.970308 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-08 09:56:53.971310 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:56:53.971310 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 09:56:55.580259 (Thread-1): SQL status: SUCCESS 1 in 1.61 seconds
2021-10-08 09:56:55.582938 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:56:55.582938 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 09:56:55.582938 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 09:56:55.764262 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:56:55.765255 (Thread-1): finished collecting timing info
2021-10-08 09:56:55.766255 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 09:56:56.095128 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11264859-3456-42da-8d84-d49f4f856071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51A7ECAF0>]}
2021-10-08 09:56:56.096136 (Thread-1): 11:56:56 | 5 of 7 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.15s]
2021-10-08 09:56:56.097126 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 09:56:56.097126 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 09:56:56.098129 (Thread-1): 11:56:56 | 6 of 7 START incremental model dbt.time.............................. [RUN]
2021-10-08 09:56:56.099128 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:56:56.099128 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 09:56:56.104262 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:56:56.106689 (Thread-1): finished collecting timing info
2021-10-08 09:56:56.108137 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:56:56.108137 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 09:56:56.109137 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:56:57.450484 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-10-08 09:56:57.452485 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:56:57.452485 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 09:56:57.638507 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 09:56:57.644296 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:56:57.644659 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:56:57.804956 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 09:56:57.807016 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:56:57.807016 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 09:56:57.995534 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:56:57.997533 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 09:56:58.000996 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:56:58.000996 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 09:56:58.186066 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:56:58.186066 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:56:58.186066 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 09:56:58.491737 (Thread-1): SQL status: SUCCESS 0 in 0.30 seconds
2021-10-08 09:56:58.493731 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:56:58.493731 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 09:56:58.493731 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 09:56:58.746819 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 09:56:58.747819 (Thread-1): finished collecting timing info
2021-10-08 09:56:58.748854 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 09:56:59.050547 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11264859-3456-42da-8d84-d49f4f856071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51A79CA90>]}
2021-10-08 09:56:59.050547 (Thread-1): 11:56:59 | 6 of 7 OK created incremental model dbt.time......................... [SUCCESS 0 in 2.95s]
2021-10-08 09:56:59.051550 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 09:56:59.052171 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:56:59.052263 (Thread-1): 11:56:59 | 7 of 7 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 09:56:59.052263 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:56:59.052263 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:56:59.054424 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:56:59.059420 (Thread-1): finished collecting timing info
2021-10-08 09:56:59.060911 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 09:56:59.063087 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:56:59.063087 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 09:56:59.063087 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 09:56:59.866048 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-08 09:56:59.866548 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:56:59.866548 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-08 09:57:00.991065 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-10-08 09:57:00.993055 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:57:00.993055 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 09:57:00.993055 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 09:57:01.180706 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 09:57:01.182957 (Thread-1): finished collecting timing info
2021-10-08 09:57:01.182957 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 09:57:01.487826 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11264859-3456-42da-8d84-d49f4f856071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51A7E21F0>]}
2021-10-08 09:57:01.488834 (Thread-1): 11:57:01 | 7 of 7 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.44s]
2021-10-08 09:57:01.489819 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 09:57:01.490902 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 09:57:01.490902 (MainThread): Using snowflake connection "master".
2021-10-08 09:57:01.490902 (MainThread): On master: BEGIN
2021-10-08 09:57:01.490902 (MainThread): Opening a new connection, currently in state closed
2021-10-08 09:57:02.530801 (MainThread): SQL status: SUCCESS 1 in 1.04 seconds
2021-10-08 09:57:02.531721 (MainThread): On master: COMMIT
2021-10-08 09:57:02.531721 (MainThread): Using snowflake connection "master".
2021-10-08 09:57:02.531721 (MainThread): On master: COMMIT
2021-10-08 09:57:02.780855 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 09:57:02.781953 (MainThread): On master: Close
2021-10-08 09:57:03.085862 (MainThread): 11:57:03 | 
2021-10-08 09:57:03.086877 (MainThread): 11:57:03 | Finished running 4 table models, 2 incremental models, 1 view model in 26.65s.
2021-10-08 09:57:03.087018 (MainThread): Connection 'master' was properly closed.
2021-10-08 09:57:03.087018 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 09:57:03.087018 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 09:57:03.087018 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 09:57:03.110545 (MainThread): 
2021-10-08 09:57:03.110545 (MainThread): Completed successfully
2021-10-08 09:57:03.110545 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-08 09:57:03.110545 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51A43C850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5178795E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51A6D3EB0>]}
2021-10-08 09:57:03.111546 (MainThread): Flushing usage events
2021-10-08 10:07:15.272736 (MainThread): Running with dbt=0.20.2
2021-10-08 10:07:15.838104 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 10:07:15.839105 (MainThread): Tracking: tracking
2021-10-08 10:07:15.839105 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF22FCE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF382AC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF382A400>]}
2021-10-08 10:07:15.845097 (MainThread): Partial parsing not enabled
2021-10-08 10:07:15.857101 (MainThread): Parsing macros\adapters.sql
2021-10-08 10:07:15.878317 (MainThread): Parsing macros\catalog.sql
2021-10-08 10:07:15.879231 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 10:07:15.886336 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 10:07:15.887318 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 10:07:15.890311 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 10:07:15.891322 (MainThread): Parsing macros\core.sql
2021-10-08 10:07:15.894311 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 10:07:15.929834 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 10:07:15.936932 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 10:07:15.936932 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 10:07:15.937942 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 10:07:15.939940 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 10:07:15.940954 (MainThread): Parsing macros\etc\query.sql
2021-10-08 10:07:15.941855 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 10:07:15.949512 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 10:07:15.954237 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 10:07:15.963175 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 10:07:15.964175 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 10:07:15.969195 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 10:07:15.984446 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 10:07:16.004796 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 10:07:16.005802 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 10:07:16.018201 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 10:07:16.023120 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 10:07:16.026118 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 10:07:16.031118 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 10:07:16.032120 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 10:07:16.033120 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 10:07:16.034120 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 10:07:16.153208 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:07:16.159211 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:07:16.161726 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:07:16.167699 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:07:16.168706 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:16.169727 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:07:16.171707 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:07:16.173710 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:07:16.183375 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 10:07:16.185376 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:16.234496 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:16.235496 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:16.236415 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:16.243492 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:16.243492 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:16.244495 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:16.246419 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:16.247495 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:16.248493 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:16.249505 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF382DF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF3820A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF3820850>]}
2021-10-08 10:07:16.249505 (MainThread): Flushing usage events
2021-10-08 10:07:16.815739 (MainThread): Connection 'test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null' was properly closed.
2021-10-08 10:07:16.815739 (MainThread): Encountered an error:
2021-10-08 10:07:16.816660 (MainThread): Compilation Error
  Invalid test config given in models\example\schema.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('c_mktsegment', ['AUTOMOBILE', 'MACHINERY', 'HOUSEHOLD', 'FURNITURE'])] instead (2 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)
2021-10-08 10:07:16.820646 (MainThread): Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 291, in _parse_generic_test
    builder = TestBuilder(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schema_test_builders.py", line 206, in __init__
    test_name, test_args = self.extract_test_args(test, column_name)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schema_test_builders.py", line 260, in extract_test_args
    raise_compiler_error(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  test definition dictionary must have exactly one key, got [('accepted_values', None), ('c_mktsegment', ['AUTOMOBILE', 'MACHINERY', 'HOUSEHOLD', 'FURNITURE'])] instead (2 keys)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 316, in load
    self.parse_project(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 405, in parse_project
    parser.parse_file(block, dct=dct)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 518, in parse_file
    self.parse_tests(test_block)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 485, in parse_tests
    self.parse_column_tests(block, column)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 214, in parse_column_tests
    self.parse_test(block, test, column)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 481, in parse_test
    self.parse_node(block)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 420, in parse_node
    node = self._parse_generic_test(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 305, in _parse_generic_test
    raise CompilationException(msg) from exc
dbt.exceptions.CompilationException: Compilation Error
  Invalid test config given in models\example\schema.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('c_mktsegment', ['AUTOMOBILE', 'MACHINERY', 'HOUSEHOLD', 'FURNITURE'])] instead (2 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)

2021-10-08 10:07:41.307294 (MainThread): Running with dbt=0.20.2
2021-10-08 10:07:41.848931 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 10:07:41.848931 (MainThread): Tracking: tracking
2021-10-08 10:07:41.849933 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6972DDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6AC5A5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6AC5AEB0>]}
2021-10-08 10:07:41.857655 (MainThread): Partial parsing not enabled
2021-10-08 10:07:41.871851 (MainThread): Parsing macros\adapters.sql
2021-10-08 10:07:41.893850 (MainThread): Parsing macros\catalog.sql
2021-10-08 10:07:41.894852 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 10:07:41.901715 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 10:07:41.903793 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 10:07:41.905795 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 10:07:41.906779 (MainThread): Parsing macros\core.sql
2021-10-08 10:07:41.909701 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 10:07:41.943073 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 10:07:41.949189 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 10:07:41.950271 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 10:07:41.951278 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 10:07:41.952266 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 10:07:41.953188 (MainThread): Parsing macros\etc\query.sql
2021-10-08 10:07:41.954273 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 10:07:41.961264 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 10:07:41.966187 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 10:07:41.975188 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 10:07:41.976189 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 10:07:41.982802 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 10:07:41.996799 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 10:07:42.018064 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 10:07:42.019064 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 10:07:42.031892 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 10:07:42.036892 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 10:07:42.041044 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 10:07:42.045043 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 10:07:42.047044 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 10:07:42.047044 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 10:07:42.049045 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 10:07:42.182854 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:07:42.190869 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:07:42.192870 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:07:42.198869 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:07:42.200869 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:42.201869 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:07:42.203869 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:07:42.205929 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:07:42.222746 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 10:07:42.224760 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:42.272949 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:42.274929 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:42.275940 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:42.282941 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:42.282941 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:42.283931 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:42.286068 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:42.287161 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:42.288165 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:07:42.295123 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6AC6C910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6AC6C970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6AC6C6D0>]}
2021-10-08 10:07:42.295123 (MainThread): Flushing usage events
2021-10-08 10:07:42.779190 (MainThread): Connection 'test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null' was properly closed.
2021-10-08 10:07:42.779190 (MainThread): Encountered an error:
2021-10-08 10:07:42.780188 (MainThread): Compilation Error in test accepted_values_playing_with_tests_AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__c_custkey (models\example\schema.yml)
  macro 'dbt_macro__test_accepted_values' takes no keyword argument 'c_mktsegment'
  
  > in macro test_accepted_values (macros\schema_tests\accepted_values.sql)
  > called by test accepted_values_playing_with_tests_AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__c_custkey (models\example\schema.yml)
2021-10-08 10:07:42.786420 (MainThread): Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 305, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 663, in __call__
    raise TypeError(
TypeError: macro 'dbt_macro__test_accepted_values' takes no keyword argument 'c_mktsegment'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 316, in load
    self.parse_project(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 405, in parse_project
    parser.parse_file(block, dct=dct)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 518, in parse_file
    self.parse_tests(test_block)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 485, in parse_tests
    self.parse_column_tests(block, column)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 214, in parse_column_tests
    self.parse_test(block, test, column)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 481, in parse_test
    self.parse_node(block)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 420, in parse_node
    node = self._parse_generic_test(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 340, in _parse_generic_test
    self.render_test_update(node, config, builder)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 406, in render_test_update
    get_rendered(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 262, in call_macro
    return e.value
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 307, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in test accepted_values_playing_with_tests_AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__c_custkey (models\example\schema.yml)
  macro 'dbt_macro__test_accepted_values' takes no keyword argument 'c_mktsegment'
  
  > in macro test_accepted_values (macros\schema_tests\accepted_values.sql)
  > called by test accepted_values_playing_with_tests_AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__c_custkey (models\example\schema.yml)

2021-10-08 10:09:47.716572 (MainThread): Running with dbt=0.20.2
2021-10-08 10:09:48.343511 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 10:09:48.344513 (MainThread): Tracking: tracking
2021-10-08 10:09:48.344513 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A46995DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A46AEB4460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A46AEB4250>]}
2021-10-08 10:09:48.351513 (MainThread): Partial parsing not enabled
2021-10-08 10:09:48.365519 (MainThread): Parsing macros\adapters.sql
2021-10-08 10:09:48.384159 (MainThread): Parsing macros\catalog.sql
2021-10-08 10:09:48.385160 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 10:09:48.391440 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 10:09:48.393430 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 10:09:48.395437 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 10:09:48.396439 (MainThread): Parsing macros\core.sql
2021-10-08 10:09:48.399436 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 10:09:48.431241 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 10:09:48.438401 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 10:09:48.438401 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 10:09:48.439402 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 10:09:48.440402 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 10:09:48.442402 (MainThread): Parsing macros\etc\query.sql
2021-10-08 10:09:48.442402 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 10:09:48.449585 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 10:09:48.454687 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 10:09:48.463700 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 10:09:48.464775 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 10:09:48.469908 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 10:09:48.485146 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 10:09:48.505135 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 10:09:48.506142 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 10:09:48.517935 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 10:09:48.522348 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 10:09:48.525957 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 10:09:48.530750 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 10:09:48.532751 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 10:09:48.532751 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 10:09:48.533751 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 10:09:48.658982 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:09:48.665122 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:09:48.666638 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:09:48.672638 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:09:48.674638 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:09:48.675638 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:09:48.677638 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:09:48.679637 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:09:48.689843 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 10:09:48.690845 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:09:48.739935 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:09:48.740936 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:09:48.743124 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:09:48.750238 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:09:48.750238 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:09:48.751238 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:09:48.753238 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:09:48.754238 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:09:48.756237 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:09:48.763468 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:09:48.763468 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:09:48.781181 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5b39a4b-2329-4277-9cf5-5a59b5a608eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A46AF168E0>]}
2021-10-08 10:09:48.799369 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 10:09:48.799369 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5b39a4b-2329-4277-9cf5-5a59b5a608eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A46AFBA940>]}
2021-10-08 10:09:48.800370 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 10:09:48.801369 (MainThread): 
2021-10-08 10:09:48.801369 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 10:09:48.803368 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 10:09:48.813443 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 10:09:48.813443 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 10:09:48.813443 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 10:09:50.293940 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.48 seconds
2021-10-08 10:09:50.298935 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 10:09:50.599843 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 10:09:50.609107 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 10:09:50.609107 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 10:09:50.609107 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 10:09:51.417145 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.81 seconds
2021-10-08 10:09:51.418169 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 10:09:51.707891 (MainThread): Using snowflake connection "master".
2021-10-08 10:09:51.707891 (MainThread): On master: BEGIN
2021-10-08 10:09:51.707891 (MainThread): Opening a new connection, currently in state init
2021-10-08 10:09:52.490706 (MainThread): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 10:09:52.490706 (MainThread): On master: COMMIT
2021-10-08 10:09:52.490706 (MainThread): Using snowflake connection "master".
2021-10-08 10:09:52.490706 (MainThread): On master: COMMIT
2021-10-08 10:09:52.746834 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-08 10:09:52.746834 (MainThread): On master: Close
2021-10-08 10:09:53.049633 (MainThread): 12:09:53 | Concurrency: 1 threads (target='dev')
2021-10-08 10:09:53.050414 (MainThread): 12:09:53 | 
2021-10-08 10:09:53.054122 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 10:09:53.054122 (Thread-1): 12:09:53 | 1 of 7 START table model dbt.first_model............................. [RUN]
2021-10-08 10:09:53.055127 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:09:53.055127 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 10:09:53.058207 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 10:09:53.060436 (Thread-1): finished collecting timing info
2021-10-08 10:09:53.085046 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 10:09:53.086809 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:09:53.086809 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 10:09:53.086809 (Thread-1): Opening a new connection, currently in state init
2021-10-08 10:09:54.045627 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-10-08 10:09:54.045627 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:09:54.045627 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all   
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 10:09:55.564523 (Thread-1): SQL status: SUCCESS 1 in 1.52 seconds
2021-10-08 10:09:55.566522 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 10:09:55.566522 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:09:55.566522 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 10:09:55.742810 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 10:09:55.749832 (Thread-1): finished collecting timing info
2021-10-08 10:09:55.749832 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 10:09:56.053570 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b39a4b-2329-4277-9cf5-5a59b5a608eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A46B2DFB20>]}
2021-10-08 10:09:56.054565 (Thread-1): 12:09:56 | 1 of 7 OK created table model dbt.first_model........................ [SUCCESS 1 in 3.00s]
2021-10-08 10:09:56.057911 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 10:09:56.057911 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 10:09:56.058957 (Thread-1): 12:09:56 | 2 of 7 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 10:09:56.059306 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:09:56.059306 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 10:09:56.060316 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 10:09:56.065089 (Thread-1): finished collecting timing info
2021-10-08 10:09:56.067087 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 10:09:56.069087 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:09:56.069087 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 10:09:56.069087 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:09:56.876143 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-08 10:09:56.877136 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:09:56.877136 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 10:09:58.364649 (Thread-1): SQL status: SUCCESS 1 in 1.49 seconds
2021-10-08 10:09:58.366646 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 10:09:58.366646 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:09:58.366646 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 10:09:58.527730 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 10:09:58.528736 (Thread-1): finished collecting timing info
2021-10-08 10:09:58.528736 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 10:09:58.828009 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b39a4b-2329-4277-9cf5-5a59b5a608eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A46B1D5970>]}
2021-10-08 10:09:58.829087 (Thread-1): 12:09:58 | 2 of 7 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.77s]
2021-10-08 10:09:58.829087 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 10:09:58.830011 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 10:09:58.830378 (Thread-1): 12:09:58 | 3 of 7 START incremental model dbt.dates............................. [RUN]
2021-10-08 10:09:58.830765 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:09:58.830765 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 10:09:58.836776 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 10:09:58.841775 (Thread-1): finished collecting timing info
2021-10-08 10:09:58.862222 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:09:58.862222 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 10:09:58.862222 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:10:00.217811 (Thread-1): SQL status: SUCCESS 1 in 1.36 seconds
2021-10-08 10:10:00.222811 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:10:00.222811 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 10:10:00.419952 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 10:10:00.421759 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:10:00.421850 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 10:10:00.585494 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 10:10:00.589465 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:10:00.589465 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 10:10:00.768980 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 10:10:00.781539 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 10:10:00.783538 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:10:00.783538 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 10:10:01.023830 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-08 10:10:01.023830 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:10:01.023830 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 10:10:01.633077 (Thread-1): SQL status: SUCCESS 0 in 0.61 seconds
2021-10-08 10:10:01.634050 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 10:10:01.635091 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:10:01.635091 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 10:10:01.904971 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 10:10:01.906088 (Thread-1): finished collecting timing info
2021-10-08 10:10:01.906278 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 10:10:02.218338 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b39a4b-2329-4277-9cf5-5a59b5a608eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A46B1D55B0>]}
2021-10-08 10:10:02.218338 (Thread-1): 12:10:02 | 3 of 7 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.39s]
2021-10-08 10:10:02.219488 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 10:10:02.219488 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-08 10:10:02.219488 (Thread-1): 12:10:02 | 4 of 7 START view model dbt.playing_with_tests....................... [RUN]
2021-10-08 10:10:02.220529 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:10:02.220529 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-08 10:10:02.221568 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-08 10:10:02.225483 (Thread-1): finished collecting timing info
2021-10-08 10:10:02.236415 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-08 10:10:02.238764 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:10:02.239247 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-08 10:10:02.239435 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:10:03.033163 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 10:10:03.033163 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:10:03.033163 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */

  create or replace  view analytics.dbt.playing_with_tests  as (
    SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF001"."CUSTOMER"
  );
2021-10-08 10:10:03.444166 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-10-08 10:10:03.446337 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-08 10:10:03.447296 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:10:03.447296 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-08 10:10:03.611280 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 10:10:03.611280 (Thread-1): finished collecting timing info
2021-10-08 10:10:03.611280 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-08 10:10:03.933444 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b39a4b-2329-4277-9cf5-5a59b5a608eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A46B1E83D0>]}
2021-10-08 10:10:03.933444 (Thread-1): 12:10:03 | 4 of 7 OK created view model dbt.playing_with_tests.................. [SUCCESS 1 in 1.71s]
2021-10-08 10:10:03.935389 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-08 10:10:03.935389 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 10:10:03.935389 (Thread-1): 12:10:03 | 5 of 7 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 10:10:03.936403 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:10:03.936403 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 10:10:03.938881 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 10:10:03.945347 (Thread-1): finished collecting timing info
2021-10-08 10:10:03.947347 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 10:10:03.952314 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:10:03.952314 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 10:10:03.952314 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:10:04.988944 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-10-08 10:10:04.989937 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:10:04.989937 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 10:10:06.716579 (Thread-1): SQL status: SUCCESS 1 in 1.73 seconds
2021-10-08 10:10:06.718656 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 10:10:06.719654 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:10:06.719654 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 10:10:06.892447 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 10:10:06.893746 (Thread-1): finished collecting timing info
2021-10-08 10:10:06.893746 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 10:10:07.227519 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b39a4b-2329-4277-9cf5-5a59b5a608eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A46B360850>]}
2021-10-08 10:10:07.227519 (Thread-1): 12:10:07 | 5 of 7 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.29s]
2021-10-08 10:10:07.228517 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 10:10:07.228517 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 10:10:07.228517 (Thread-1): 12:10:07 | 6 of 7 START incremental model dbt.time.............................. [RUN]
2021-10-08 10:10:07.229518 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:10:07.229518 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 10:10:07.233636 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 10:10:07.240233 (Thread-1): finished collecting timing info
2021-10-08 10:10:07.244069 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:10:07.244567 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 10:10:07.244567 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:10:08.671432 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2021-10-08 10:10:08.673430 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:10:08.673430 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 10:10:08.851089 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 10:10:08.852099 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:10:08.852099 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 10:10:09.077017 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-08 10:10:09.079207 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:10:09.079207 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 10:10:09.252102 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 10:10:09.254106 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 10:10:09.256270 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:10:09.256270 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 10:10:09.480223 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-08 10:10:09.480223 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:10:09.480223 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 10:10:09.928003 (Thread-1): SQL status: SUCCESS 0 in 0.45 seconds
2021-10-08 10:10:09.930047 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 10:10:09.931073 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:10:09.931073 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 10:10:10.196632 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 10:10:10.197641 (Thread-1): finished collecting timing info
2021-10-08 10:10:10.197641 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 10:10:10.526817 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b39a4b-2329-4277-9cf5-5a59b5a608eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A46B379C70>]}
2021-10-08 10:10:10.527816 (Thread-1): 12:10:10 | 6 of 7 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.30s]
2021-10-08 10:10:10.528822 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 10:10:10.528822 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 10:10:10.529845 (Thread-1): 12:10:10 | 7 of 7 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 10:10:10.529845 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:10:10.529845 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 10:10:10.532349 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 10:10:10.536520 (Thread-1): finished collecting timing info
2021-10-08 10:10:10.538428 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 10:10:10.540733 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:10:10.540733 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 10:10:10.540733 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:10:11.361530 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 10:10:11.361530 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:10:11.361530 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-08 10:10:12.578509 (Thread-1): SQL status: SUCCESS 1 in 1.22 seconds
2021-10-08 10:10:12.579937 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 10:10:12.579937 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:10:12.580093 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 10:10:12.751010 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 10:10:12.751905 (Thread-1): finished collecting timing info
2021-10-08 10:10:12.751905 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 10:10:13.096473 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b39a4b-2329-4277-9cf5-5a59b5a608eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A46B179670>]}
2021-10-08 10:10:13.097500 (Thread-1): 12:10:13 | 7 of 7 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.57s]
2021-10-08 10:10:13.098550 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 10:10:13.098819 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 10:10:13.098819 (MainThread): Using snowflake connection "master".
2021-10-08 10:10:13.098819 (MainThread): On master: BEGIN
2021-10-08 10:10:13.099835 (MainThread): Opening a new connection, currently in state closed
2021-10-08 10:10:14.078505 (MainThread): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-08 10:10:14.078505 (MainThread): On master: COMMIT
2021-10-08 10:10:14.078505 (MainThread): Using snowflake connection "master".
2021-10-08 10:10:14.078505 (MainThread): On master: COMMIT
2021-10-08 10:10:14.376681 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-10-08 10:10:14.376681 (MainThread): On master: Close
2021-10-08 10:10:14.700745 (MainThread): 12:10:14 | 
2021-10-08 10:10:14.701804 (MainThread): 12:10:14 | Finished running 4 table models, 2 incremental models, 1 view model in 25.90s.
2021-10-08 10:10:14.702712 (MainThread): Connection 'master' was properly closed.
2021-10-08 10:10:14.702712 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 10:10:14.702712 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 10:10:14.702712 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 10:10:14.719106 (MainThread): 
2021-10-08 10:10:14.719282 (MainThread): Completed successfully
2021-10-08 10:10:14.719697 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-08 10:10:14.719697 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A46B2E5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A46B2E5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A46B31B250>]}
2021-10-08 10:10:14.719697 (MainThread): Flushing usage events
2021-10-08 10:10:42.025664 (MainThread): Running with dbt=0.20.2
2021-10-08 10:10:42.639570 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-10-08 10:10:42.640572 (MainThread): Tracking: tracking
2021-10-08 10:10:42.640572 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051FDFCE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052132AB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052132ACA0>]}
2021-10-08 10:10:42.647646 (MainThread): Partial parsing not enabled
2021-10-08 10:10:42.662872 (MainThread): Parsing macros\adapters.sql
2021-10-08 10:10:42.681262 (MainThread): Parsing macros\catalog.sql
2021-10-08 10:10:42.683263 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 10:10:42.691036 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 10:10:42.692996 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 10:10:42.696236 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 10:10:42.697329 (MainThread): Parsing macros\core.sql
2021-10-08 10:10:42.700701 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 10:10:42.737969 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 10:10:42.742890 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 10:10:42.743965 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 10:10:42.744970 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 10:10:42.745973 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 10:10:42.747009 (MainThread): Parsing macros\etc\query.sql
2021-10-08 10:10:42.748028 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 10:10:42.754007 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 10:10:42.759008 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 10:10:42.769930 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 10:10:42.770923 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 10:10:42.777508 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 10:10:42.795019 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 10:10:42.817238 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 10:10:42.818260 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 10:10:42.831499 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 10:10:42.836494 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 10:10:42.840447 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 10:10:42.845513 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 10:10:42.847415 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 10:10:42.847415 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 10:10:42.849435 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 10:10:42.974095 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:10:42.981389 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:10:42.983334 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:10:42.989297 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:10:42.991385 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:10:42.991385 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:10:42.994298 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:10:42.996297 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:10:43.006296 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 10:10:43.008309 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:10:43.009477 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-08 10:10:43.010595 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:10:43.063481 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:10:43.064482 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:10:43.066824 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:10:43.073838 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:10:43.073838 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:10:43.074886 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:10:43.076893 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:10:43.077893 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:10:43.078893 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:10:43.087155 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:10:43.087155 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:10:43.104042 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd421941a-7629-4fe6-9310-25e7bcf9ad35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205213C7CA0>]}
2021-10-08 10:10:43.118870 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 10:10:43.118870 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd421941a-7629-4fe6-9310-25e7bcf9ad35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205214AC400>]}
2021-10-08 10:10:43.118870 (MainThread): Found 7 models, 11 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 10:10:43.120170 (MainThread): 
2021-10-08 10:10:43.121178 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 10:10:43.122447 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 10:10:43.131682 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 10:10:43.131682 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 10:10:43.131682 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 10:10:44.379699 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.25 seconds
2021-10-08 10:10:44.385692 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 10:10:44.702257 (MainThread): 12:10:44 | Concurrency: 1 threads (target='dev')
2021-10-08 10:10:44.702411 (MainThread): 12:10:44 | 
2021-10-08 10:10:44.704093 (Thread-1): Began running node test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE.2f33992a36
2021-10-08 10:10:44.704278 (Thread-1): 12:10:44 | 1 of 10 START test accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE [RUN]
2021-10-08 10:10:44.704561 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE.2f33992a36".
2021-10-08 10:10:44.704662 (Thread-1): Compiling test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE.2f33992a36
2021-10-08 10:10:44.708904 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE.2f33992a36"
2021-10-08 10:10:44.709650 (Thread-1): finished collecting timing info
2021-10-08 10:10:44.720448 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE.2f33992a36"
2021-10-08 10:10:44.721448 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE.2f33992a36".
2021-10-08 10:10:44.721448 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE.2f33992a36: BEGIN
2021-10-08 10:10:44.721448 (Thread-1): Opening a new connection, currently in state init
2021-10-08 10:10:45.705821 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-08 10:10:45.705821 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE.2f33992a36".
2021-10-08 10:10:45.705821 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE.2f33992a36: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE.2f33992a36"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        c_mktsegment as value_field,
        count(*) as n_records

    from analytics.dbt.playing_with_tests
    group by 1

)

select *
from all_values
where value_field not in (
    'AUTOMOBILE','MACHINERY','HOUSEHOLD','FURNITURE'
)



      
    ) dbt_internal_test
2021-10-08 10:10:46.107635 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-10-08 10:10:46.108627 (Thread-1): finished collecting timing info
2021-10-08 10:10:46.108748 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE.2f33992a36: ROLLBACK
2021-10-08 10:10:46.357802 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE.2f33992a36: Close
2021-10-08 10:10:46.665620 (Thread-1): 12:10:46 | 1 of 10 FAIL 1 accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE [FAIL 1 in 1.96s]
2021-10-08 10:10:46.667615 (Thread-1): Finished running node test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE.2f33992a36
2021-10-08 10:10:46.667615 (Thread-1): Began running node test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-08 10:10:46.668686 (Thread-1): 12:10:46 | 2 of 10 START test assert_under_ten_percent_not_null................. [RUN]
2021-10-08 10:10:46.669688 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 10:10:46.669688 (Thread-1): Compiling test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-08 10:10:46.672698 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"
2021-10-08 10:10:46.679123 (Thread-1): finished collecting timing info
2021-10-08 10:10:46.680042 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"
2021-10-08 10:10:46.685025 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 10:10:46.685025 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: BEGIN
2021-10-08 10:10:46.686032 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:10:47.473845 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-08 10:10:47.473845 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 10:10:47.473845 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
  SUM(CASE WHEN id IS NULL THEN 1 ELSE 0 END)/COUNT(*) AS total_nulls
FROM analytics.dbt.first_model
HAVING  SUM(CASE WHEN id IS NULL THEN 1 ELSE 0 END)/COUNT(*) > .4
      
    ) dbt_internal_test
2021-10-08 10:10:47.809548 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-10-08 10:10:47.810547 (Thread-1): finished collecting timing info
2021-10-08 10:10:47.811547 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: ROLLBACK
2021-10-08 10:10:48.070106 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: Close
2021-10-08 10:10:48.399194 (Thread-1): 12:10:48 | 2 of 10 PASS assert_under_ten_percent_not_null....................... [PASS in 1.73s]
2021-10-08 10:10:48.400190 (Thread-1): Finished running node test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-08 10:10:48.400190 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 10:10:48.401191 (Thread-1): 12:10:48 | 3 of 10 START test not_null_my_second_dbt_model_id................... [RUN]
2021-10-08 10:10:48.401191 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 10:10:48.401191 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 10:10:48.409184 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 10:10:48.413181 (Thread-1): finished collecting timing info
2021-10-08 10:10:48.415269 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 10:10:48.417494 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 10:10:48.417994 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: BEGIN
2021-10-08 10:10:48.417994 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:10:49.458316 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-10-08 10:10:49.458316 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 10:10:49.458316 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
2021-10-08 10:10:49.855217 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-10-08 10:10:49.855717 (Thread-1): finished collecting timing info
2021-10-08 10:10:49.856327 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: ROLLBACK
2021-10-08 10:10:50.103891 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-10-08 10:10:50.412251 (Thread-1): 12:10:50 | 3 of 10 FAIL 1 not_null_my_second_dbt_model_id....................... [FAIL 1 in 2.01s]
2021-10-08 10:10:50.413202 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 10:10:50.413202 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172
2021-10-08 10:10:50.414260 (Thread-1): 12:10:50 | 4 of 10 START test not_null_playing_with_tests_c_custkey............. [RUN]
2021-10-08 10:10:50.415165 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172".
2021-10-08 10:10:50.415165 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172
2021-10-08 10:10:50.423681 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172"
2021-10-08 10:10:50.425651 (Thread-1): finished collecting timing info
2021-10-08 10:10:50.428659 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172"
2021-10-08 10:10:50.430490 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172".
2021-10-08 10:10:50.430490 (Thread-1): On test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172: BEGIN
2021-10-08 10:10:50.431081 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:10:51.257628 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-08 10:10:51.257628 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172".
2021-10-08 10:10:51.257628 (Thread-1): On test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.playing_with_tests
where c_custkey is null



      
    ) dbt_internal_test
2021-10-08 10:10:51.686943 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-10-08 10:10:51.688002 (Thread-1): finished collecting timing info
2021-10-08 10:10:51.688002 (Thread-1): On test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172: ROLLBACK
2021-10-08 10:10:51.927925 (Thread-1): On test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172: Close
2021-10-08 10:10:52.235108 (Thread-1): 12:10:52 | 4 of 10 PASS not_null_playing_with_tests_c_custkey................... [PASS in 1.82s]
2021-10-08 10:10:52.235108 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172
2021-10-08 10:10:52.235108 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 10:10:52.236126 (Thread-1): 12:10:52 | 5 of 10 START test not_null_snowflake_customer_purchases_c_custkey... [RUN]
2021-10-08 10:10:52.236126 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 10:10:52.236126 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 10:10:52.240410 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 10:10:52.242447 (Thread-1): finished collecting timing info
2021-10-08 10:10:52.244704 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 10:10:52.246648 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 10:10:52.247150 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: BEGIN
2021-10-08 10:10:52.247150 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:10:53.192362 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-10-08 10:10:53.193412 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 10:10:53.193412 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.snowflake_customer_purchases
where c_custkey is null



      
    ) dbt_internal_test
2021-10-08 10:10:53.536991 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-10-08 10:10:53.537985 (Thread-1): finished collecting timing info
2021-10-08 10:10:53.537985 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: ROLLBACK
2021-10-08 10:10:53.853094 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: Close
2021-10-08 10:10:54.171845 (Thread-1): 12:10:54 | 5 of 10 PASS not_null_snowflake_customer_purchases_c_custkey......... [PASS in 1.94s]
2021-10-08 10:10:54.173734 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 10:10:54.173734 (Thread-1): Began running node test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 10:10:54.173734 (Thread-1): 12:10:54 | 6 of 10 START test relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_ [RUN]
2021-10-08 10:10:54.173734 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 10:10:54.173734 (Thread-1): Compiling test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 10:10:54.179405 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"
2021-10-08 10:10:54.181313 (Thread-1): finished collecting timing info
2021-10-08 10:10:54.182393 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"
2021-10-08 10:10:54.183503 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 10:10:54.184509 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: BEGIN
2021-10-08 10:10:54.184509 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:10:55.004672 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 10:10:55.005748 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 10:10:55.005748 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select id as from_field
    from analytics.dbt.my_second_dbt_model
    where id is not null
),

parent as (
    select id as to_field
    from analytics.dbt.first_model
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
2021-10-08 10:10:55.352272 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-10-08 10:10:55.353260 (Thread-1): finished collecting timing info
2021-10-08 10:10:55.353260 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: ROLLBACK
2021-10-08 10:10:55.630275 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: Close
2021-10-08 10:10:55.930183 (Thread-1): 12:10:55 | 6 of 10 PASS relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_ [PASS in 1.76s]
2021-10-08 10:10:55.931104 (Thread-1): Finished running node test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 10:10:55.932101 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 10:10:55.932101 (Thread-1): 12:10:55 | 7 of 10 START test unique_my_first_dbt_model_id...................... [RUN]
2021-10-08 10:10:55.932101 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 10:10:55.932101 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 10:10:55.942100 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 10:10:55.944101 (Thread-1): finished collecting timing info
2021-10-08 10:10:55.944280 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 10:10:55.946305 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 10:10:55.946305 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: BEGIN
2021-10-08 10:10:55.946305 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:10:56.943220 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-08 10:10:56.943220 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 10:10:56.944310 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.first_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 10:10:57.321057 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-10-08 10:10:57.321620 (Thread-1): finished collecting timing info
2021-10-08 10:10:57.322120 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: ROLLBACK
2021-10-08 10:10:57.547016 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-08 10:10:57.852322 (Thread-1): 12:10:57 | 7 of 10 PASS unique_my_first_dbt_model_id............................ [PASS in 1.92s]
2021-10-08 10:10:57.853405 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 10:10:57.853405 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 10:10:57.854399 (Thread-1): 12:10:57 | 8 of 10 START test unique_my_second_dbt_model_id..................... [RUN]
2021-10-08 10:10:57.854399 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 10:10:57.854399 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 10:10:57.859357 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 10:10:57.860877 (Thread-1): finished collecting timing info
2021-10-08 10:10:57.862903 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 10:10:57.865904 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 10:10:57.865904 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: BEGIN
2021-10-08 10:10:57.865904 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:10:58.819040 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-10-08 10:10:58.819040 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 10:10:58.819040 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 10:10:59.137105 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-08 10:10:59.138122 (Thread-1): finished collecting timing info
2021-10-08 10:10:59.138122 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: ROLLBACK
2021-10-08 10:10:59.382740 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: Close
2021-10-08 10:10:59.693934 (Thread-1): 12:10:59 | 8 of 10 PASS unique_my_second_dbt_model_id........................... [PASS in 1.84s]
2021-10-08 10:10:59.694933 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 10:10:59.694933 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c
2021-10-08 10:10:59.694933 (Thread-1): 12:10:59 | 9 of 10 START test unique_playing_with_tests_c_custkey............... [RUN]
2021-10-08 10:10:59.695930 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c".
2021-10-08 10:10:59.695930 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c
2021-10-08 10:10:59.703028 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c"
2021-10-08 10:10:59.705043 (Thread-1): finished collecting timing info
2021-10-08 10:10:59.707263 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c"
2021-10-08 10:10:59.708770 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c".
2021-10-08 10:10:59.708770 (Thread-1): On test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c: BEGIN
2021-10-08 10:10:59.708770 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:11:00.506017 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-08 10:11:00.506017 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c".
2021-10-08 10:11:00.506017 (Thread-1): On test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.playing_with_tests
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 10:11:00.894659 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-10-08 10:11:00.894659 (Thread-1): finished collecting timing info
2021-10-08 10:11:00.895665 (Thread-1): On test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c: ROLLBACK
2021-10-08 10:11:01.136923 (Thread-1): On test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c: Close
2021-10-08 10:11:01.435262 (Thread-1): 12:11:01 | 9 of 10 PASS unique_playing_with_tests_c_custkey..................... [PASS in 1.74s]
2021-10-08 10:11:01.435262 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c
2021-10-08 10:11:01.436204 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 10:11:01.436204 (Thread-1): 12:11:01 | 10 of 10 START test unique_snowflake_customer_purchases_c_custkey.... [RUN]
2021-10-08 10:11:01.436204 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 10:11:01.436204 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 10:11:01.438197 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 10:11:01.440278 (Thread-1): finished collecting timing info
2021-10-08 10:11:01.441198 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 10:11:01.443197 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 10:11:01.443197 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: BEGIN
2021-10-08 10:11:01.443197 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:11:02.291973 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-08 10:11:02.291973 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 10:11:02.291973 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.snowflake_customer_purchases
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 10:11:02.681861 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-10-08 10:11:02.683862 (Thread-1): finished collecting timing info
2021-10-08 10:11:02.683862 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: ROLLBACK
2021-10-08 10:11:02.939094 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: Close
2021-10-08 10:11:03.236226 (Thread-1): 12:11:03 | 10 of 10 PASS unique_snowflake_customer_purchases_c_custkey.......... [PASS in 1.80s]
2021-10-08 10:11:03.237215 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 10:11:03.239219 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 10:11:03.239219 (MainThread): 12:11:03 | 
2021-10-08 10:11:03.239219 (MainThread): 12:11:03 | Finished running 10 tests in 20.12s.
2021-10-08 10:11:03.240214 (MainThread): Connection 'master' was properly closed.
2021-10-08 10:11:03.240214 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 10:11:03.240214 (MainThread): Connection 'test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8' was properly closed.
2021-10-08 10:11:03.261311 (MainThread): 
2021-10-08 10:11:03.261505 (MainThread): Completed with 2 errors and 0 warnings:
2021-10-08 10:11:03.261672 (MainThread): 
2021-10-08 10:11:03.261672 (MainThread): Failure in test accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE (models\example\schema.yml)
2021-10-08 10:11:03.261672 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-08 10:11:03.261672 (MainThread): 
2021-10-08 10:11:03.261672 (MainThread):   compiled SQL at target\compiled\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\accepted_values_playing_with_t_5902e7c80e9e0927554ea079385f645e.sql
2021-10-08 10:11:03.261672 (MainThread): 
2021-10-08 10:11:03.262700 (MainThread): Failure in test not_null_my_second_dbt_model_id (models\example\schema.yml)
2021-10-08 10:11:03.263892 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-08 10:11:03.264600 (MainThread): 
2021-10-08 10:11:03.265270 (MainThread):   compiled SQL at target\compiled\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\not_null_my_second_dbt_model_id.sql
2021-10-08 10:11:03.266826 (MainThread): 
Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
2021-10-08 10:11:03.267488 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205213C7F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205213A0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052147B670>]}
2021-10-08 10:11:03.267488 (MainThread): Flushing usage events
2021-10-08 10:13:23.703296 (MainThread): Running with dbt=0.20.2
2021-10-08 10:13:24.334067 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 10:13:24.335504 (MainThread): Tracking: tracking
2021-10-08 10:13:24.335504 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A62897CDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A629E9AA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A629E9ACA0>]}
2021-10-08 10:13:24.345523 (MainThread): Partial parsing not enabled
2021-10-08 10:13:24.361520 (MainThread): Parsing macros\adapters.sql
2021-10-08 10:13:24.384922 (MainThread): Parsing macros\catalog.sql
2021-10-08 10:13:24.385917 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 10:13:24.394166 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 10:13:24.396090 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 10:13:24.399179 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 10:13:24.400183 (MainThread): Parsing macros\core.sql
2021-10-08 10:13:24.402172 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 10:13:24.445941 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 10:13:24.453900 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 10:13:24.453900 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 10:13:24.455882 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 10:13:24.456882 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 10:13:24.457900 (MainThread): Parsing macros\etc\query.sql
2021-10-08 10:13:24.458900 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 10:13:24.467701 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 10:13:24.474693 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 10:13:24.487407 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 10:13:24.488322 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 10:13:24.495319 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 10:13:24.512079 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 10:13:24.537294 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 10:13:24.538278 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 10:13:24.553880 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 10:13:24.558900 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 10:13:24.563056 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 10:13:24.568055 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 10:13:24.570056 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 10:13:24.571058 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 10:13:24.572056 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 10:13:24.696185 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:13:24.703287 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:13:24.704361 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:13:24.710286 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:13:24.712375 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:13:24.713371 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:13:24.715620 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:13:24.717713 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:13:24.726636 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 10:13:24.728702 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:13:24.729623 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-08 10:13:24.731709 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:13:24.822931 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:13:24.826936 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:13:24.832933 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:13:24.852008 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:13:24.852008 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:13:24.855025 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:13:24.857021 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:13:24.858021 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:13:24.860005 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:13:24.873733 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:13:24.875726 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:13:24.936220 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a922092c-3ef7-402b-828d-e4ac8fcd4b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A629E95A30>]}
2021-10-08 10:13:24.985524 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 10:13:24.986478 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a922092c-3ef7-402b-828d-e4ac8fcd4b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A62A0272E0>]}
2021-10-08 10:13:24.986478 (MainThread): Found 7 models, 11 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 10:13:24.988050 (MainThread): 
2021-10-08 10:13:24.988937 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 10:13:24.990035 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 10:13:25.004269 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 10:13:25.004444 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 10:13:25.004529 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 10:13:26.412190 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.41 seconds
2021-10-08 10:13:26.415185 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 10:13:26.715538 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 10:13:26.722102 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 10:13:26.722102 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 10:13:26.722102 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 10:13:27.551233 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.83 seconds
2021-10-08 10:13:27.553233 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 10:13:27.898404 (MainThread): Using snowflake connection "master".
2021-10-08 10:13:27.899405 (MainThread): On master: BEGIN
2021-10-08 10:13:27.899405 (MainThread): Opening a new connection, currently in state init
2021-10-08 10:13:28.909439 (MainThread): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-08 10:13:28.909439 (MainThread): On master: COMMIT
2021-10-08 10:13:28.909439 (MainThread): Using snowflake connection "master".
2021-10-08 10:13:28.909439 (MainThread): On master: COMMIT
2021-10-08 10:13:29.175480 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 10:13:29.175480 (MainThread): On master: Close
2021-10-08 10:13:29.474563 (MainThread): 12:13:29 | Concurrency: 1 threads (target='dev')
2021-10-08 10:13:29.475559 (MainThread): 12:13:29 | 
2021-10-08 10:13:29.477558 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 10:13:29.477558 (Thread-1): 12:13:29 | 1 of 7 START table model dbt.first_model............................. [RUN]
2021-10-08 10:13:29.478559 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:13:29.478559 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 10:13:29.480642 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 10:13:29.482666 (Thread-1): finished collecting timing info
2021-10-08 10:13:29.501409 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 10:13:29.503387 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:13:29.503387 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 10:13:29.504394 (Thread-1): Opening a new connection, currently in state init
2021-10-08 10:13:30.305857 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-08 10:13:30.305857 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:13:30.305857 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all   
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 10:13:31.406902 (Thread-1): SQL status: SUCCESS 1 in 1.10 seconds
2021-10-08 10:13:31.408932 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 10:13:31.408932 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:13:31.408932 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 10:13:31.572125 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 10:13:31.583472 (Thread-1): finished collecting timing info
2021-10-08 10:13:31.584472 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 10:13:31.884279 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a922092c-3ef7-402b-828d-e4ac8fcd4b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A629F21F70>]}
2021-10-08 10:13:31.884879 (Thread-1): 12:13:31 | 1 of 7 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.41s]
2021-10-08 10:13:31.885996 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 10:13:31.885996 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 10:13:31.885996 (Thread-1): 12:13:31 | 2 of 7 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 10:13:31.885996 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:13:31.885996 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 10:13:31.887978 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 10:13:31.891967 (Thread-1): finished collecting timing info
2021-10-08 10:13:31.897998 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 10:13:31.900396 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:13:31.900396 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 10:13:31.900396 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:13:32.751511 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-08 10:13:32.751511 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:13:32.751511 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 10:13:34.182309 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2021-10-08 10:13:34.183400 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 10:13:34.183400 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:13:34.183400 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 10:13:34.418373 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-08 10:13:34.419368 (Thread-1): finished collecting timing info
2021-10-08 10:13:34.420374 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 10:13:34.716023 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a922092c-3ef7-402b-828d-e4ac8fcd4b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A62A2C4460>]}
2021-10-08 10:13:34.717022 (Thread-1): 12:13:34 | 2 of 7 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.83s]
2021-10-08 10:13:34.718020 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 10:13:34.718020 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 10:13:34.718020 (Thread-1): 12:13:34 | 3 of 7 START incremental model dbt.dates............................. [RUN]
2021-10-08 10:13:34.718020 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:13:34.718020 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 10:13:34.724035 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 10:13:34.728114 (Thread-1): finished collecting timing info
2021-10-08 10:13:34.752331 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:13:34.752331 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 10:13:34.752331 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:13:36.166696 (Thread-1): SQL status: SUCCESS 1 in 1.41 seconds
2021-10-08 10:13:36.182005 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:13:36.182005 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 10:13:36.381164 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 10:13:36.387710 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:13:36.388793 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 10:13:36.552327 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 10:13:36.556118 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:13:36.556197 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 10:13:36.732380 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 10:13:36.750376 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 10:13:36.752798 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:13:36.752798 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 10:13:36.966475 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-08 10:13:36.966475 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:13:36.966475 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 10:13:37.356222 (Thread-1): SQL status: SUCCESS 0 in 0.39 seconds
2021-10-08 10:13:37.358212 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 10:13:37.359222 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:13:37.359222 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 10:13:37.628886 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 10:13:37.629890 (Thread-1): finished collecting timing info
2021-10-08 10:13:37.629890 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 10:13:37.954780 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a922092c-3ef7-402b-828d-e4ac8fcd4b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A62A272970>]}
2021-10-08 10:13:37.955876 (Thread-1): 12:13:37 | 3 of 7 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.24s]
2021-10-08 10:13:37.955876 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 10:13:37.955876 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-08 10:13:37.956777 (Thread-1): 12:13:37 | 4 of 7 START view model dbt.playing_with_tests....................... [RUN]
2021-10-08 10:13:37.956777 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:13:37.956777 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-08 10:13:37.957778 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-08 10:13:37.962811 (Thread-1): finished collecting timing info
2021-10-08 10:13:37.976010 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-08 10:13:37.978004 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:13:37.978004 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-08 10:13:37.978004 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:13:38.790460 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-08 10:13:38.790460 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:13:38.791461 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */

  create or replace  view analytics.dbt.playing_with_tests  as (
    SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF001"."CUSTOMER"
  );
2021-10-08 10:13:39.197082 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-10-08 10:13:39.197082 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-08 10:13:39.198084 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:13:39.198084 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-08 10:13:39.357588 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 10:13:39.357588 (Thread-1): finished collecting timing info
2021-10-08 10:13:39.357588 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-08 10:13:39.661321 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a922092c-3ef7-402b-828d-e4ac8fcd4b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A62A26D250>]}
2021-10-08 10:13:39.661321 (Thread-1): 12:13:39 | 4 of 7 OK created view model dbt.playing_with_tests.................. [SUCCESS 1 in 1.70s]
2021-10-08 10:13:39.662656 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-08 10:13:39.662656 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 10:13:39.663714 (Thread-1): 12:13:39 | 5 of 7 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 10:13:39.663714 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:13:39.663714 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 10:13:39.664798 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 10:13:39.669743 (Thread-1): finished collecting timing info
2021-10-08 10:13:39.671788 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 10:13:39.674672 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:13:39.674672 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 10:13:39.674672 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:13:40.684636 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-08 10:13:40.684636 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:13:40.684636 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 10:13:42.154913 (Thread-1): SQL status: SUCCESS 1 in 1.47 seconds
2021-10-08 10:13:42.154913 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 10:13:42.155826 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:13:42.155826 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 10:13:42.349025 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 10:13:42.350047 (Thread-1): finished collecting timing info
2021-10-08 10:13:42.350047 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 10:13:42.650252 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a922092c-3ef7-402b-828d-e4ac8fcd4b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A62A2C8DF0>]}
2021-10-08 10:13:42.650701 (Thread-1): 12:13:42 | 5 of 7 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.99s]
2021-10-08 10:13:42.651905 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 10:13:42.651905 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 10:13:42.651905 (Thread-1): 12:13:42 | 6 of 7 START incremental model dbt.time.............................. [RUN]
2021-10-08 10:13:42.652430 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:13:42.652430 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 10:13:42.654437 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 10:13:42.655526 (Thread-1): finished collecting timing info
2021-10-08 10:13:42.657437 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:13:42.657437 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 10:13:42.657437 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:13:44.694881 (Thread-1): SQL status: SUCCESS 1 in 2.04 seconds
2021-10-08 10:13:44.698386 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:13:44.698907 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 10:13:44.927038 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-08 10:13:44.931036 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:13:44.931036 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 10:13:45.110576 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 10:13:45.113572 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:13:45.113572 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 10:13:45.277056 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 10:13:45.278221 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 10:13:45.280172 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:13:45.280172 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 10:13:45.484259 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 10:13:45.484462 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:13:45.484462 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 10:13:45.937900 (Thread-1): SQL status: SUCCESS 0 in 0.45 seconds
2021-10-08 10:13:45.940013 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 10:13:45.940902 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:13:45.940902 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 10:13:46.195660 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 10:13:46.196913 (Thread-1): finished collecting timing info
2021-10-08 10:13:46.197059 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 10:13:46.501656 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a922092c-3ef7-402b-828d-e4ac8fcd4b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A62A339F70>]}
2021-10-08 10:13:46.502657 (Thread-1): 12:13:46 | 6 of 7 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.85s]
2021-10-08 10:13:46.502657 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 10:13:46.503622 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 10:13:46.503622 (Thread-1): 12:13:46 | 7 of 7 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 10:13:46.504616 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:13:46.504811 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 10:13:46.506168 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 10:13:46.511168 (Thread-1): finished collecting timing info
2021-10-08 10:13:46.513174 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 10:13:46.515167 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:13:46.515167 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 10:13:46.516173 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:13:47.523833 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-08 10:13:47.524335 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:13:47.524335 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-08 10:13:48.949998 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2021-10-08 10:13:48.951034 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 10:13:48.952028 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:13:48.952028 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 10:13:49.118243 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 10:13:49.120244 (Thread-1): finished collecting timing info
2021-10-08 10:13:49.120244 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 10:13:49.423592 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a922092c-3ef7-402b-828d-e4ac8fcd4b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A629E8AD30>]}
2021-10-08 10:13:49.424611 (Thread-1): 12:13:49 | 7 of 7 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.92s]
2021-10-08 10:13:49.425593 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 10:13:49.427000 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 10:13:49.427000 (MainThread): Using snowflake connection "master".
2021-10-08 10:13:49.427000 (MainThread): On master: BEGIN
2021-10-08 10:13:49.427000 (MainThread): Opening a new connection, currently in state closed
2021-10-08 10:13:50.238621 (MainThread): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-08 10:13:50.238621 (MainThread): On master: COMMIT
2021-10-08 10:13:50.239643 (MainThread): Using snowflake connection "master".
2021-10-08 10:13:50.239643 (MainThread): On master: COMMIT
2021-10-08 10:13:50.512930 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-08 10:13:50.512930 (MainThread): On master: Close
2021-10-08 10:13:50.832271 (MainThread): 12:13:50 | 
2021-10-08 10:13:50.832271 (MainThread): 12:13:50 | Finished running 4 table models, 2 incremental models, 1 view model in 25.84s.
2021-10-08 10:13:50.832271 (MainThread): Connection 'master' was properly closed.
2021-10-08 10:13:50.832271 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 10:13:50.832271 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 10:13:50.833272 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 10:13:50.856620 (MainThread): 
2021-10-08 10:13:50.857663 (MainThread): Completed successfully
2021-10-08 10:13:50.867239 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-08 10:13:50.868427 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A629EE00D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A62A2CA580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A62A2CACA0>]}
2021-10-08 10:13:50.869473 (MainThread): Flushing usage events
2021-10-08 10:17:15.293528 (MainThread): Running with dbt=0.20.2
2021-10-08 10:17:15.882522 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 10:17:15.882522 (MainThread): Tracking: tracking
2021-10-08 10:17:15.882522 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F125CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F27A4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F27A4280>]}
2021-10-08 10:17:15.889529 (MainThread): Partial parsing not enabled
2021-10-08 10:17:15.903775 (MainThread): Parsing macros\adapters.sql
2021-10-08 10:17:15.923389 (MainThread): Parsing macros\catalog.sql
2021-10-08 10:17:15.924423 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 10:17:15.930397 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 10:17:15.932413 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 10:17:15.934399 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 10:17:15.935388 (MainThread): Parsing macros\core.sql
2021-10-08 10:17:15.938595 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 10:17:15.971467 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 10:17:15.977881 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 10:17:15.978390 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 10:17:15.979388 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 10:17:15.980388 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 10:17:15.981388 (MainThread): Parsing macros\etc\query.sql
2021-10-08 10:17:15.982388 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 10:17:15.989582 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 10:17:15.994581 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 10:17:16.003806 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 10:17:16.005808 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 10:17:16.010816 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 10:17:16.025104 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 10:17:16.044562 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 10:17:16.045624 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 10:17:16.057622 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 10:17:16.063707 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 10:17:16.066711 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 10:17:16.070695 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 10:17:16.072712 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 10:17:16.072712 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 10:17:16.074778 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 10:17:16.195857 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:17:16.203221 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:17:16.205223 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:17:16.211579 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:17:16.213769 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:16.214702 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:17:16.217398 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:17:16.219221 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:17:16.230673 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 10:17:16.232710 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:16.233612 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-08 10:17:16.235728 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:16.286837 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:16.287841 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:16.289849 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:16.296195 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:16.296195 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:16.297179 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:16.299130 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:16.300182 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:16.301176 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:16.309416 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:16.309416 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:16.327624 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cedf123-6d36-4178-9df3-5b2f9c85738c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F279B8B0>]}
2021-10-08 10:17:16.353484 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 10:17:16.354484 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cedf123-6d36-4178-9df3-5b2f9c85738c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F290DAF0>]}
2021-10-08 10:17:16.354790 (MainThread): Found 7 models, 11 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 10:17:16.355858 (MainThread): 
2021-10-08 10:17:16.356859 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 10:17:16.358255 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 10:17:16.369359 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 10:17:16.370355 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 10:17:16.370355 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 10:17:17.767830 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.40 seconds
2021-10-08 10:17:17.770501 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 10:17:18.063503 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 10:17:18.068774 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 10:17:18.068774 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 10:17:18.068774 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 10:17:19.048781 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.98 seconds
2021-10-08 10:17:19.049766 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 10:17:19.355594 (MainThread): Using snowflake connection "master".
2021-10-08 10:17:19.356495 (MainThread): On master: BEGIN
2021-10-08 10:17:19.356495 (MainThread): Opening a new connection, currently in state init
2021-10-08 10:17:20.167582 (MainThread): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-08 10:17:20.167582 (MainThread): On master: COMMIT
2021-10-08 10:17:20.167582 (MainThread): Using snowflake connection "master".
2021-10-08 10:17:20.167582 (MainThread): On master: COMMIT
2021-10-08 10:17:20.429534 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-08 10:17:20.429534 (MainThread): On master: Close
2021-10-08 10:17:20.731230 (MainThread): 12:17:20 | Concurrency: 1 threads (target='dev')
2021-10-08 10:17:20.732227 (MainThread): 12:17:20 | 
2021-10-08 10:17:20.736245 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 10:17:20.736245 (Thread-1): 12:17:20 | 1 of 7 START table model dbt.first_model............................. [RUN]
2021-10-08 10:17:20.737641 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:17:20.737641 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 10:17:20.741786 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 10:17:20.743750 (Thread-1): finished collecting timing info
2021-10-08 10:17:20.765746 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 10:17:20.767989 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:17:20.767989 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 10:17:20.767989 (Thread-1): Opening a new connection, currently in state init
2021-10-08 10:17:21.534713 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-08 10:17:21.534899 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:17:21.534966 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all   
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 10:17:22.505208 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-08 10:17:22.506207 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 10:17:22.506207 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:17:22.507207 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 10:17:22.677503 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 10:17:22.684828 (Thread-1): finished collecting timing info
2021-10-08 10:17:22.684828 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 10:17:22.988045 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cedf123-6d36-4178-9df3-5b2f9c85738c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F2769340>]}
2021-10-08 10:17:22.989585 (Thread-1): 12:17:22 | 1 of 7 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.25s]
2021-10-08 10:17:22.990544 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 10:17:22.991537 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 10:17:22.991537 (Thread-1): 12:17:22 | 2 of 7 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 10:17:22.992504 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:17:22.992504 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 10:17:22.994571 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 10:17:22.999492 (Thread-1): finished collecting timing info
2021-10-08 10:17:23.000492 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 10:17:23.003193 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:17:23.003193 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 10:17:23.003193 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:17:23.813571 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-08 10:17:23.813571 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:17:23.813571 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 10:17:25.260217 (Thread-1): SQL status: SUCCESS 1 in 1.45 seconds
2021-10-08 10:17:25.262137 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 10:17:25.262137 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:17:25.262137 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 10:17:25.425299 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 10:17:25.426228 (Thread-1): finished collecting timing info
2021-10-08 10:17:25.427298 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 10:17:25.720247 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cedf123-6d36-4178-9df3-5b2f9c85738c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F2C02DC0>]}
2021-10-08 10:17:25.721256 (Thread-1): 12:17:25 | 2 of 7 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.73s]
2021-10-08 10:17:25.723184 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 10:17:25.723184 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 10:17:25.723184 (Thread-1): 12:17:25 | 3 of 7 START incremental model dbt.dates............................. [RUN]
2021-10-08 10:17:25.724213 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:17:25.724213 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 10:17:25.729383 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 10:17:25.733691 (Thread-1): finished collecting timing info
2021-10-08 10:17:25.747442 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:17:25.747442 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 10:17:25.747442 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:17:27.044841 (Thread-1): SQL status: SUCCESS 1 in 1.30 seconds
2021-10-08 10:17:27.053831 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:17:27.053831 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 10:17:27.302946 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 10:17:27.305943 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:17:27.305943 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 10:17:27.503229 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 10:17:27.504708 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:17:27.504794 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 10:17:27.667276 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 10:17:27.676371 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 10:17:27.678564 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:17:27.678564 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 10:17:27.871457 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 10:17:27.871457 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:17:27.871457 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 10:17:28.274661 (Thread-1): SQL status: SUCCESS 0 in 0.40 seconds
2021-10-08 10:17:28.276655 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 10:17:28.276655 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:17:28.276655 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 10:17:28.556056 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-08 10:17:28.557151 (Thread-1): finished collecting timing info
2021-10-08 10:17:28.557151 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 10:17:28.873294 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cedf123-6d36-4178-9df3-5b2f9c85738c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F2BFB340>]}
2021-10-08 10:17:28.873294 (Thread-1): 12:17:28 | 3 of 7 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.15s]
2021-10-08 10:17:28.874992 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 10:17:28.874992 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-08 10:17:28.874992 (Thread-1): 12:17:28 | 4 of 7 START view model dbt.playing_with_tests....................... [RUN]
2021-10-08 10:17:28.874992 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:17:28.874992 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-08 10:17:28.876024 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-08 10:17:28.880026 (Thread-1): finished collecting timing info
2021-10-08 10:17:28.892760 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-08 10:17:28.894761 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:17:28.894761 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-08 10:17:28.894761 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:17:29.868342 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-08 10:17:29.868342 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:17:29.868342 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */

  create or replace  view analytics.dbt.playing_with_tests  as (
    SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF001"."CUSTOMER"
  );
2021-10-08 10:17:30.241715 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-10-08 10:17:30.242717 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-08 10:17:30.242717 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:17:30.242717 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-08 10:17:30.405611 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 10:17:30.407696 (Thread-1): finished collecting timing info
2021-10-08 10:17:30.407696 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-08 10:17:30.708838 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cedf123-6d36-4178-9df3-5b2f9c85738c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F2BFB8B0>]}
2021-10-08 10:17:30.708838 (Thread-1): 12:17:30 | 4 of 7 OK created view model dbt.playing_with_tests.................. [SUCCESS 1 in 1.83s]
2021-10-08 10:17:30.709848 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-08 10:17:30.709848 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 10:17:30.709848 (Thread-1): 12:17:30 | 5 of 7 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 10:17:30.710838 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:17:30.710838 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 10:17:30.710838 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 10:17:30.715837 (Thread-1): finished collecting timing info
2021-10-08 10:17:30.717838 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 10:17:30.719885 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:17:30.719885 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 10:17:30.719885 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:17:31.532230 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-08 10:17:31.532729 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:17:31.532729 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 10:17:33.047687 (Thread-1): SQL status: SUCCESS 1 in 1.51 seconds
2021-10-08 10:17:33.049656 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 10:17:33.049656 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:17:33.050687 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 10:17:33.226075 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 10:17:33.226075 (Thread-1): finished collecting timing info
2021-10-08 10:17:33.226075 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 10:17:33.532707 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cedf123-6d36-4178-9df3-5b2f9c85738c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F2C48E20>]}
2021-10-08 10:17:33.533701 (Thread-1): 12:17:33 | 5 of 7 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.82s]
2021-10-08 10:17:33.535571 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 10:17:33.536591 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 10:17:33.536591 (Thread-1): 12:17:33 | 6 of 7 START incremental model dbt.time.............................. [RUN]
2021-10-08 10:17:33.537588 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:17:33.537588 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 10:17:33.540724 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 10:17:33.542586 (Thread-1): finished collecting timing info
2021-10-08 10:17:33.543685 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:17:33.543685 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 10:17:33.544620 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:17:34.843191 (Thread-1): SQL status: SUCCESS 1 in 1.30 seconds
2021-10-08 10:17:34.846188 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:17:34.846188 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 10:17:35.030869 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 10:17:35.036069 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:17:35.036315 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 10:17:35.206796 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 10:17:35.209886 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:17:35.209886 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 10:17:35.375755 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 10:17:35.378804 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 10:17:35.380789 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:17:35.380789 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 10:17:35.565498 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 10:17:35.565498 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:17:35.565498 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 10:17:35.920870 (Thread-1): SQL status: SUCCESS 0 in 0.36 seconds
2021-10-08 10:17:35.922010 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 10:17:35.922010 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:17:35.922010 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 10:17:36.170756 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 10:17:36.171755 (Thread-1): finished collecting timing info
2021-10-08 10:17:36.172754 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 10:17:36.506719 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cedf123-6d36-4178-9df3-5b2f9c85738c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F2C1A5B0>]}
2021-10-08 10:17:36.506719 (Thread-1): 12:17:36 | 6 of 7 OK created incremental model dbt.time......................... [SUCCESS 0 in 2.97s]
2021-10-08 10:17:36.507572 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 10:17:36.507572 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 10:17:36.507572 (Thread-1): 12:17:36 | 7 of 7 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 10:17:36.507572 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:17:36.507572 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 10:17:36.509579 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 10:17:36.514580 (Thread-1): finished collecting timing info
2021-10-08 10:17:36.515664 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 10:17:36.517626 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:17:36.517626 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 10:17:36.517626 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:17:37.578588 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-10-08 10:17:37.578588 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:17:37.578588 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-08 10:17:38.646144 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-10-08 10:17:38.648402 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 10:17:38.648402 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:17:38.648402 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 10:17:38.817981 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 10:17:38.817981 (Thread-1): finished collecting timing info
2021-10-08 10:17:38.817981 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 10:17:39.111756 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cedf123-6d36-4178-9df3-5b2f9c85738c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F2C09520>]}
2021-10-08 10:17:39.111756 (Thread-1): 12:17:39 | 7 of 7 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.60s]
2021-10-08 10:17:39.114124 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 10:17:39.116092 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 10:17:39.116092 (MainThread): Using snowflake connection "master".
2021-10-08 10:17:39.117090 (MainThread): On master: BEGIN
2021-10-08 10:17:39.117090 (MainThread): Opening a new connection, currently in state closed
2021-10-08 10:17:39.938379 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 10:17:39.938379 (MainThread): On master: COMMIT
2021-10-08 10:17:39.939382 (MainThread): Using snowflake connection "master".
2021-10-08 10:17:39.939382 (MainThread): On master: COMMIT
2021-10-08 10:17:40.242490 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-10-08 10:17:40.242490 (MainThread): On master: Close
2021-10-08 10:17:40.552658 (MainThread): 12:17:40 | 
2021-10-08 10:17:40.552658 (MainThread): 12:17:40 | Finished running 4 table models, 2 incremental models, 1 view model in 24.20s.
2021-10-08 10:17:40.553565 (MainThread): Connection 'master' was properly closed.
2021-10-08 10:17:40.553565 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 10:17:40.553565 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 10:17:40.553565 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 10:17:40.567908 (MainThread): 
2021-10-08 10:17:40.568407 (MainThread): Completed successfully
2021-10-08 10:17:40.569435 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-08 10:17:40.569435 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F27CF070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F2BB4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260F2BB4FA0>]}
2021-10-08 10:17:40.569435 (MainThread): Flushing usage events
2021-10-08 10:17:45.492253 (MainThread): Running with dbt=0.20.2
2021-10-08 10:17:46.078195 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-10-08 10:17:46.078195 (MainThread): Tracking: tracking
2021-10-08 10:17:46.079174 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E3617DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E376C4DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E376C4760>]}
2021-10-08 10:17:46.085427 (MainThread): Partial parsing not enabled
2021-10-08 10:17:46.099419 (MainThread): Parsing macros\adapters.sql
2021-10-08 10:17:46.118466 (MainThread): Parsing macros\catalog.sql
2021-10-08 10:17:46.119467 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 10:17:46.124466 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 10:17:46.125467 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 10:17:46.127466 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 10:17:46.129377 (MainThread): Parsing macros\core.sql
2021-10-08 10:17:46.131411 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 10:17:46.163392 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 10:17:46.170392 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 10:17:46.170392 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 10:17:46.171394 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 10:17:46.173392 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 10:17:46.174393 (MainThread): Parsing macros\etc\query.sql
2021-10-08 10:17:46.174393 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 10:17:46.183389 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 10:17:46.188389 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 10:17:46.198389 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 10:17:46.199390 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 10:17:46.205389 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 10:17:46.220009 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 10:17:46.242592 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 10:17:46.244518 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 10:17:46.256729 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 10:17:46.260722 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 10:17:46.264721 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 10:17:46.269606 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 10:17:46.270729 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 10:17:46.271738 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 10:17:46.272759 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 10:17:46.399212 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:17:46.405196 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:17:46.407208 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:17:46.413198 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:17:46.415194 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:46.416199 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:17:46.418113 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:17:46.420189 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:17:46.429702 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 10:17:46.431717 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:46.432708 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-08 10:17:46.434660 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:46.483106 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:46.484106 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:46.486248 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:46.492341 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:46.492341 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:46.494346 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:46.495368 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:46.497353 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:46.498338 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:46.506344 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:46.506344 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:17:46.524257 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d68628f-cc1e-4bd2-9208-49ecb53d8048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E377313A0>]}
2021-10-08 10:17:46.575883 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 10:17:46.575883 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d68628f-cc1e-4bd2-9208-49ecb53d8048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E37731F10>]}
2021-10-08 10:17:46.576894 (MainThread): Found 7 models, 11 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 10:17:46.578616 (MainThread): 
2021-10-08 10:17:46.578616 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 10:17:46.579992 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 10:17:46.590720 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 10:17:46.590720 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 10:17:46.591721 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 10:17:47.872710 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.28 seconds
2021-10-08 10:17:47.879768 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 10:17:48.186353 (MainThread): 12:17:48 | Concurrency: 1 threads (target='dev')
2021-10-08 10:17:48.187432 (MainThread): 12:17:48 | 
2021-10-08 10:17:48.188594 (Thread-1): Began running node test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2
2021-10-08 10:17:48.188594 (Thread-1): 12:17:48 | 1 of 11 START test accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING [RUN]
2021-10-08 10:17:48.188594 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2".
2021-10-08 10:17:48.188594 (Thread-1): Compiling test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2
2021-10-08 10:17:48.193603 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2"
2021-10-08 10:17:48.194600 (Thread-1): finished collecting timing info
2021-10-08 10:17:48.210784 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2"
2021-10-08 10:17:48.211478 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2".
2021-10-08 10:17:48.211478 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2: BEGIN
2021-10-08 10:17:48.211478 (Thread-1): Opening a new connection, currently in state init
2021-10-08 10:17:49.016373 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-08 10:17:49.016373 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2".
2021-10-08 10:17:49.016373 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        c_mktsegment as value_field,
        count(*) as n_records

    from analytics.dbt.playing_with_tests
    group by 1

)

select *
from all_values
where value_field not in (
    'AUTOMOBILE','MACHINERY','HOUSEHOLD','FURNITURE','BUILDING'
)



      
    ) dbt_internal_test
2021-10-08 10:17:49.439465 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-10-08 10:17:49.441462 (Thread-1): finished collecting timing info
2021-10-08 10:17:49.442460 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2: ROLLBACK
2021-10-08 10:17:49.762102 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2: Close
2021-10-08 10:17:50.070331 (Thread-1): 12:17:50 | 1 of 11 PASS accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING [PASS in 1.88s]
2021-10-08 10:17:50.072255 (Thread-1): Finished running node test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2
2021-10-08 10:17:50.072255 (Thread-1): Began running node test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-08 10:17:50.073341 (Thread-1): 12:17:50 | 2 of 11 START test assert_under_ten_percent_not_null................. [RUN]
2021-10-08 10:17:50.074260 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 10:17:50.074260 (Thread-1): Compiling test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-08 10:17:50.077255 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"
2021-10-08 10:17:50.079862 (Thread-1): finished collecting timing info
2021-10-08 10:17:50.082856 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"
2021-10-08 10:17:50.084856 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 10:17:50.084856 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: BEGIN
2021-10-08 10:17:50.084856 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:17:51.034558 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-10-08 10:17:51.034558 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 10:17:51.034558 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
  SUM(CASE WHEN id IS NULL THEN 1 ELSE 0 END)/COUNT(*) AS total_nulls
FROM analytics.dbt.first_model
HAVING  SUM(CASE WHEN id IS NULL THEN 1 ELSE 0 END)/COUNT(*) > .4
      
    ) dbt_internal_test
2021-10-08 10:17:51.469200 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-10-08 10:17:51.470201 (Thread-1): finished collecting timing info
2021-10-08 10:17:51.471203 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: ROLLBACK
2021-10-08 10:17:51.742791 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: Close
2021-10-08 10:17:52.045100 (Thread-1): 12:17:52 | 2 of 11 PASS assert_under_ten_percent_not_null....................... [PASS in 1.97s]
2021-10-08 10:17:52.045870 (Thread-1): Finished running node test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-08 10:17:52.045870 (Thread-1): Began running node test.lukeclarke_learn_dbt.mkt_segment_test
2021-10-08 10:17:52.045870 (Thread-1): 12:17:52 | 3 of 11 START test mkt_segment_test.................................. [RUN]
2021-10-08 10:17:52.046876 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-08 10:17:52.046876 (Thread-1): Compiling test.lukeclarke_learn_dbt.mkt_segment_test
2021-10-08 10:17:52.047877 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.mkt_segment_test"
2021-10-08 10:17:52.048994 (Thread-1): finished collecting timing info
2021-10-08 10:17:52.051094 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.mkt_segment_test"
2021-10-08 10:17:52.052093 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-08 10:17:52.052093 (Thread-1): On test.lukeclarke_learn_dbt.mkt_segment_test: BEGIN
2021-10-08 10:17:52.052093 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:17:52.872552 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 10:17:52.872552 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-08 10:17:52.872552 (Thread-1): On test.lukeclarke_learn_dbt.mkt_segment_test: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.mkt_segment_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT SUM(c_acctbal)
FROM analytics.dbt.playing_with_tests
HAVING SUM(c_acctbal) < 100000000
      
    ) dbt_internal_test
2021-10-08 10:17:53.248542 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-10-08 10:17:53.249009 (Thread-1): finished collecting timing info
2021-10-08 10:17:53.249009 (Thread-1): On test.lukeclarke_learn_dbt.mkt_segment_test: ROLLBACK
2021-10-08 10:17:53.492860 (Thread-1): On test.lukeclarke_learn_dbt.mkt_segment_test: Close
2021-10-08 10:17:53.791558 (Thread-1): 12:17:53 | 3 of 11 FAIL 1 mkt_segment_test...................................... [FAIL 1 in 1.74s]
2021-10-08 10:17:53.793469 (Thread-1): Finished running node test.lukeclarke_learn_dbt.mkt_segment_test
2021-10-08 10:17:53.793469 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 10:17:53.793469 (Thread-1): 12:17:53 | 4 of 11 START test not_null_my_second_dbt_model_id................... [RUN]
2021-10-08 10:17:53.794469 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 10:17:53.794469 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 10:17:53.800062 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 10:17:53.802043 (Thread-1): finished collecting timing info
2021-10-08 10:17:53.802043 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"
2021-10-08 10:17:53.804043 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 10:17:53.804043 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: BEGIN
2021-10-08 10:17:53.804043 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:17:54.560581 (Thread-1): SQL status: SUCCESS 1 in 0.76 seconds
2021-10-08 10:17:54.560716 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d".
2021-10-08 10:17:54.560799 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
2021-10-08 10:17:54.988259 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-10-08 10:17:54.989349 (Thread-1): finished collecting timing info
2021-10-08 10:17:54.989349 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: ROLLBACK
2021-10-08 10:17:55.218546 (Thread-1): On test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d: Close
2021-10-08 10:17:55.521789 (Thread-1): 12:17:55 | 4 of 11 FAIL 1 not_null_my_second_dbt_model_id....................... [FAIL 1 in 1.73s]
2021-10-08 10:17:55.521789 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_my_second_dbt_model_id.dc1d13aa6d
2021-10-08 10:17:55.521789 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172
2021-10-08 10:17:55.522789 (Thread-1): 12:17:55 | 5 of 11 START test not_null_playing_with_tests_c_custkey............. [RUN]
2021-10-08 10:17:55.522789 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172".
2021-10-08 10:17:55.522789 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172
2021-10-08 10:17:55.525788 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172"
2021-10-08 10:17:55.530815 (Thread-1): finished collecting timing info
2021-10-08 10:17:55.531875 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172"
2021-10-08 10:17:55.536671 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172".
2021-10-08 10:17:55.536671 (Thread-1): On test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172: BEGIN
2021-10-08 10:17:55.536671 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:17:56.308854 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-08 10:17:56.308854 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172".
2021-10-08 10:17:56.308854 (Thread-1): On test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.playing_with_tests
where c_custkey is null



      
    ) dbt_internal_test
2021-10-08 10:17:56.626506 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-08 10:17:56.628434 (Thread-1): finished collecting timing info
2021-10-08 10:17:56.628434 (Thread-1): On test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172: ROLLBACK
2021-10-08 10:17:56.937187 (Thread-1): On test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172: Close
2021-10-08 10:17:57.237332 (Thread-1): 12:17:57 | 5 of 11 PASS not_null_playing_with_tests_c_custkey................... [PASS in 1.71s]
2021-10-08 10:17:57.237332 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172
2021-10-08 10:17:57.237332 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 10:17:57.237332 (Thread-1): 12:17:57 | 6 of 11 START test not_null_snowflake_customer_purchases_c_custkey... [RUN]
2021-10-08 10:17:57.238331 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 10:17:57.238331 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 10:17:57.240331 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 10:17:57.243060 (Thread-1): finished collecting timing info
2021-10-08 10:17:57.244077 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-08 10:17:57.246094 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 10:17:57.246094 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: BEGIN
2021-10-08 10:17:57.246094 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:17:58.252455 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-08 10:17:58.252455 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-08 10:17:58.252455 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.snowflake_customer_purchases
where c_custkey is null



      
    ) dbt_internal_test
2021-10-08 10:17:58.592574 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-10-08 10:17:58.593672 (Thread-1): finished collecting timing info
2021-10-08 10:17:58.593672 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: ROLLBACK
2021-10-08 10:17:58.839314 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: Close
2021-10-08 10:17:59.143736 (Thread-1): 12:17:59 | 6 of 11 PASS not_null_snowflake_customer_purchases_c_custkey......... [PASS in 1.91s]
2021-10-08 10:17:59.144811 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-08 10:17:59.144811 (Thread-1): Began running node test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 10:17:59.145743 (Thread-1): 12:17:59 | 7 of 11 START test relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_ [RUN]
2021-10-08 10:17:59.145743 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 10:17:59.145743 (Thread-1): Compiling test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 10:17:59.149731 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"
2021-10-08 10:17:59.155268 (Thread-1): finished collecting timing info
2021-10-08 10:17:59.155935 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"
2021-10-08 10:17:59.158949 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 10:17:59.158949 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: BEGIN
2021-10-08 10:17:59.158949 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:17:59.999570 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-08 10:17:59.999570 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-08 10:18:00.000565 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select id as from_field
    from analytics.dbt.my_second_dbt_model
    where id is not null
),

parent as (
    select id as to_field
    from analytics.dbt.first_model
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
2021-10-08 10:18:00.435333 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-10-08 10:18:00.436395 (Thread-1): finished collecting timing info
2021-10-08 10:18:00.436395 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: ROLLBACK
2021-10-08 10:18:00.680094 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: Close
2021-10-08 10:18:00.963913 (Thread-1): 12:18:00 | 7 of 11 PASS relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_ [PASS in 1.82s]
2021-10-08 10:18:00.964844 (Thread-1): Finished running node test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-08 10:18:00.964844 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 10:18:00.964844 (Thread-1): 12:18:00 | 8 of 11 START test unique_my_first_dbt_model_id...................... [RUN]
2021-10-08 10:18:00.964844 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 10:18:00.964844 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 10:18:00.969382 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 10:18:00.971332 (Thread-1): finished collecting timing info
2021-10-08 10:18:00.972384 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-08 10:18:00.974331 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 10:18:00.974331 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: BEGIN
2021-10-08 10:18:00.974331 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:18:01.968577 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-10-08 10:18:01.968577 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-08 10:18:01.968577 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.first_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 10:18:02.217289 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 10:18:02.218288 (Thread-1): finished collecting timing info
2021-10-08 10:18:02.218288 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: ROLLBACK
2021-10-08 10:18:02.452694 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-08 10:18:02.760840 (Thread-1): 12:18:02 | 8 of 11 PASS unique_my_first_dbt_model_id............................ [PASS in 1.80s]
2021-10-08 10:18:02.761840 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-08 10:18:02.761840 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 10:18:02.761840 (Thread-1): 12:18:02 | 9 of 11 START test unique_my_second_dbt_model_id..................... [RUN]
2021-10-08 10:18:02.762842 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 10:18:02.762842 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 10:18:02.765838 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 10:18:02.767838 (Thread-1): finished collecting timing info
2021-10-08 10:18:02.769313 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-08 10:18:02.770855 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 10:18:02.770855 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: BEGIN
2021-10-08 10:18:02.770855 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:18:03.569754 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-08 10:18:03.570269 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-08 10:18:03.570269 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 10:18:03.847026 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-08 10:18:03.847026 (Thread-1): finished collecting timing info
2021-10-08 10:18:03.847026 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: ROLLBACK
2021-10-08 10:18:04.141352 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: Close
2021-10-08 10:18:04.464198 (Thread-1): 12:18:04 | 9 of 11 PASS unique_my_second_dbt_model_id........................... [PASS in 1.70s]
2021-10-08 10:18:04.464776 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-08 10:18:04.464776 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c
2021-10-08 10:18:04.465034 (Thread-1): 12:18:04 | 10 of 11 START test unique_playing_with_tests_c_custkey.............. [RUN]
2021-10-08 10:18:04.465315 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c".
2021-10-08 10:18:04.465315 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c
2021-10-08 10:18:04.468388 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c"
2021-10-08 10:18:04.473050 (Thread-1): finished collecting timing info
2021-10-08 10:18:04.474462 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c"
2021-10-08 10:18:04.479958 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c".
2021-10-08 10:18:04.480266 (Thread-1): On test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c: BEGIN
2021-10-08 10:18:04.480451 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:18:05.303040 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 10:18:05.303040 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c".
2021-10-08 10:18:05.303613 (Thread-1): On test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.playing_with_tests
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 10:18:05.605839 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-10-08 10:18:05.607836 (Thread-1): finished collecting timing info
2021-10-08 10:18:05.607836 (Thread-1): On test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c: ROLLBACK
2021-10-08 10:18:05.871706 (Thread-1): On test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c: Close
2021-10-08 10:18:06.220812 (Thread-1): 12:18:06 | 10 of 11 PASS unique_playing_with_tests_c_custkey.................... [PASS in 1.76s]
2021-10-08 10:18:06.221308 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c
2021-10-08 10:18:06.221308 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 10:18:06.221308 (Thread-1): 12:18:06 | 11 of 11 START test unique_snowflake_customer_purchases_c_custkey.... [RUN]
2021-10-08 10:18:06.222326 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 10:18:06.222326 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 10:18:06.224364 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 10:18:06.226597 (Thread-1): finished collecting timing info
2021-10-08 10:18:06.227604 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-08 10:18:06.229412 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 10:18:06.229412 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: BEGIN
2021-10-08 10:18:06.229412 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:18:07.006012 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 10:18:07.006012 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-08 10:18:07.006012 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.snowflake_customer_purchases
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-08 10:18:07.304910 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-10-08 10:18:07.305917 (Thread-1): finished collecting timing info
2021-10-08 10:18:07.305917 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: ROLLBACK
2021-10-08 10:18:07.554001 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: Close
2021-10-08 10:18:07.861868 (Thread-1): 12:18:07 | 11 of 11 PASS unique_snowflake_customer_purchases_c_custkey.......... [PASS in 1.64s]
2021-10-08 10:18:07.862867 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-08 10:18:07.863866 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 10:18:07.863866 (MainThread): 12:18:07 | 
2021-10-08 10:18:07.863866 (MainThread): 12:18:07 | Finished running 11 tests in 21.29s.
2021-10-08 10:18:07.864866 (MainThread): Connection 'master' was properly closed.
2021-10-08 10:18:07.864866 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 10:18:07.864866 (MainThread): Connection 'test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8' was properly closed.
2021-10-08 10:18:07.880199 (MainThread): 
2021-10-08 10:18:07.880199 (MainThread): Completed with 2 errors and 0 warnings:
2021-10-08 10:18:07.881198 (MainThread): 
2021-10-08 10:18:07.881198 (MainThread): Failure in test mkt_segment_test (tests\mkt_segment_test.sql)
2021-10-08 10:18:07.882199 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-08 10:18:07.882199 (MainThread): 
2021-10-08 10:18:07.882199 (MainThread):   compiled SQL at target\compiled\lukeclarke_learn_dbt\tests\mkt_segment_test.sql
2021-10-08 10:18:07.882199 (MainThread): 
2021-10-08 10:18:07.882199 (MainThread): Failure in test not_null_my_second_dbt_model_id (models\example\schema.yml)
2021-10-08 10:18:07.883201 (MainThread):   Got 1 result, configured to fail if != 0
2021-10-08 10:18:07.883201 (MainThread): 
2021-10-08 10:18:07.883201 (MainThread):   compiled SQL at target\compiled\lukeclarke_learn_dbt\models\example\schema.yml\schema_test\not_null_my_second_dbt_model_id.sql
2021-10-08 10:18:07.884199 (MainThread): 
Done. PASS=9 WARN=0 ERROR=2 SKIP=0 TOTAL=11
2021-10-08 10:18:07.884199 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E37731280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E377DFBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E377DFD30>]}
2021-10-08 10:18:07.884199 (MainThread): Flushing usage events
2021-10-08 10:20:17.329369 (MainThread): Running with dbt=0.20.2
2021-10-08 10:20:17.918461 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-08 10:20:17.918461 (MainThread): Tracking: tracking
2021-10-08 10:20:17.918461 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016687BDDE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166890FA4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166890FA760>]}
2021-10-08 10:20:17.927195 (MainThread): Partial parsing not enabled
2021-10-08 10:20:17.944247 (MainThread): Parsing macros\adapters.sql
2021-10-08 10:20:17.964748 (MainThread): Parsing macros\catalog.sql
2021-10-08 10:20:17.965767 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-08 10:20:17.971766 (MainThread): Parsing macros\materializations\merge.sql
2021-10-08 10:20:17.972751 (MainThread): Parsing macros\materializations\table.sql
2021-10-08 10:20:17.975748 (MainThread): Parsing macros\materializations\view.sql
2021-10-08 10:20:17.975748 (MainThread): Parsing macros\core.sql
2021-10-08 10:20:17.978748 (MainThread): Parsing macros\adapters\common.sql
2021-10-08 10:20:18.007988 (MainThread): Parsing macros\etc\datetime.sql
2021-10-08 10:20:18.013987 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-08 10:20:18.014989 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-08 10:20:18.015989 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-08 10:20:18.016989 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-08 10:20:18.017989 (MainThread): Parsing macros\etc\query.sql
2021-10-08 10:20:18.019090 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-08 10:20:18.024296 (MainThread): Parsing macros\materializations\test.sql
2021-10-08 10:20:18.028316 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-08 10:20:18.037380 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-08 10:20:18.038381 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-08 10:20:18.044380 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-08 10:20:18.059550 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-08 10:20:18.081071 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-08 10:20:18.082070 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-08 10:20:18.094147 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-08 10:20:18.099333 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-08 10:20:18.103332 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-08 10:20:18.108332 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-08 10:20:18.109334 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-08 10:20:18.110334 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-08 10:20:18.111334 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-08 10:20:18.247943 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:20:18.255034 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:20:18.257040 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:20:18.262942 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:20:18.265030 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:20:18.265030 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:20:18.267568 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:20:18.268568 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:20:18.276566 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-08 10:20:18.277567 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:20:18.278568 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-08 10:20:18.279567 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:20:18.334472 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:20:18.337416 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:20:18.341539 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:20:18.366048 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:20:18.368470 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:20:18.372483 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:20:18.380644 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:20:18.384779 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:20:18.387003 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:20:18.398013 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:20:18.399016 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-08 10:20:18.419603 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81ea8542-e45f-42cd-966f-4798c521785a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668922E790>]}
2021-10-08 10:20:18.446580 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-08 10:20:18.447267 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81ea8542-e45f-42cd-966f-4798c521785a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668922EDC0>]}
2021-10-08 10:20:18.447684 (MainThread): Found 7 models, 11 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-08 10:20:18.448683 (MainThread): 
2021-10-08 10:20:18.448683 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 10:20:18.449987 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-08 10:20:18.458887 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-08 10:20:18.459886 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-08 10:20:18.459886 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-08 10:20:19.954131 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.49 seconds
2021-10-08 10:20:19.958274 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-08 10:20:20.262633 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-08 10:20:20.269143 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-08 10:20:20.269143 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-08 10:20:20.269143 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-08 10:20:21.096606 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.83 seconds
2021-10-08 10:20:21.097706 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-08 10:20:21.413927 (MainThread): Using snowflake connection "master".
2021-10-08 10:20:21.413927 (MainThread): On master: BEGIN
2021-10-08 10:20:21.413927 (MainThread): Opening a new connection, currently in state init
2021-10-08 10:20:22.256719 (MainThread): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-08 10:20:22.257726 (MainThread): On master: COMMIT
2021-10-08 10:20:22.257726 (MainThread): Using snowflake connection "master".
2021-10-08 10:20:22.257726 (MainThread): On master: COMMIT
2021-10-08 10:20:22.562917 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-10-08 10:20:22.563995 (MainThread): On master: Close
2021-10-08 10:20:22.851290 (MainThread): 12:20:22 | Concurrency: 1 threads (target='dev')
2021-10-08 10:20:22.852524 (MainThread): 12:20:22 | 
2021-10-08 10:20:22.854534 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 10:20:22.854534 (Thread-1): 12:20:22 | 1 of 7 START table model dbt.first_model............................. [RUN]
2021-10-08 10:20:22.854534 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:20:22.854534 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 10:20:22.856535 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 10:20:22.858567 (Thread-1): finished collecting timing info
2021-10-08 10:20:22.879246 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-08 10:20:22.882247 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:20:22.882247 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-08 10:20:22.882247 (Thread-1): Opening a new connection, currently in state init
2021-10-08 10:20:23.759767 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-10-08 10:20:23.759767 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:20:23.759767 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all   
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-08 10:20:24.748807 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-10-08 10:20:24.748807 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 10:20:24.748807 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-08 10:20:24.748807 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-08 10:20:24.922545 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 10:20:24.930538 (Thread-1): finished collecting timing info
2021-10-08 10:20:24.930538 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-08 10:20:25.263328 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81ea8542-e45f-42cd-966f-4798c521785a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166894CA400>]}
2021-10-08 10:20:25.264327 (Thread-1): 12:20:25 | 1 of 7 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.41s]
2021-10-08 10:20:25.265134 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-08 10:20:25.265134 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 10:20:25.265134 (Thread-1): 12:20:25 | 2 of 7 START table model dbt.cul_order_price......................... [RUN]
2021-10-08 10:20:25.266182 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:20:25.266182 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 10:20:25.267237 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 10:20:25.272230 (Thread-1): finished collecting timing info
2021-10-08 10:20:25.274416 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-08 10:20:25.276419 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:20:25.276419 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-08 10:20:25.276419 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:20:26.059933 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-08 10:20:26.059933 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:20:26.059933 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-08 10:20:27.614759 (Thread-1): SQL status: SUCCESS 1 in 1.55 seconds
2021-10-08 10:20:27.615847 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 10:20:27.616774 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-08 10:20:27.616774 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-08 10:20:27.777026 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 10:20:27.778022 (Thread-1): finished collecting timing info
2021-10-08 10:20:27.778022 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-08 10:20:28.254958 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81ea8542-e45f-42cd-966f-4798c521785a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668956DE50>]}
2021-10-08 10:20:28.254958 (Thread-1): 12:20:28 | 2 of 7 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.99s]
2021-10-08 10:20:28.256486 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-08 10:20:28.256486 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-08 10:20:28.256486 (Thread-1): 12:20:28 | 3 of 7 START incremental model dbt.dates............................. [RUN]
2021-10-08 10:20:28.256486 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:20:28.257492 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-08 10:20:28.260492 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 10:20:28.265495 (Thread-1): finished collecting timing info
2021-10-08 10:20:28.285058 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:20:28.285058 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-08 10:20:28.285058 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:20:29.631549 (Thread-1): SQL status: SUCCESS 1 in 1.35 seconds
2021-10-08 10:20:29.639426 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:20:29.639426 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-08 10:20:29.824861 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-08 10:20:29.825862 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:20:29.825862 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 10:20:29.984759 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 10:20:29.986101 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:20:29.986101 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-08 10:20:30.147053 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-08 10:20:30.157219 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-08 10:20:30.158875 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:20:30.158875 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-08 10:20:30.377922 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-08 10:20:30.377922 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:20:30.378942 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-08 10:20:30.768520 (Thread-1): SQL status: SUCCESS 0 in 0.39 seconds
2021-10-08 10:20:30.769611 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 10:20:30.769611 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-08 10:20:30.769611 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-08 10:20:31.030483 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-08 10:20:31.031522 (Thread-1): finished collecting timing info
2021-10-08 10:20:31.031522 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-08 10:20:31.327389 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81ea8542-e45f-42cd-966f-4798c521785a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668955D070>]}
2021-10-08 10:20:31.328384 (Thread-1): 12:20:31 | 3 of 7 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.07s]
2021-10-08 10:20:31.329307 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-08 10:20:31.329307 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-08 10:20:31.329307 (Thread-1): 12:20:31 | 4 of 7 START view model dbt.playing_with_tests....................... [RUN]
2021-10-08 10:20:31.329307 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:20:31.329307 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-08 10:20:31.330310 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-08 10:20:31.336556 (Thread-1): finished collecting timing info
2021-10-08 10:20:31.346556 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-08 10:20:31.349210 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:20:31.349210 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-08 10:20:31.350202 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:20:32.334211 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-10-08 10:20:32.334343 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:20:32.334343 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */

  create or replace  view analytics.dbt.playing_with_tests  as (
    SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF001"."CUSTOMER"
  );
2021-10-08 10:20:32.690213 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-08 10:20:32.691161 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-08 10:20:32.691161 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-08 10:20:32.691161 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-08 10:20:32.864303 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 10:20:32.865283 (Thread-1): finished collecting timing info
2021-10-08 10:20:32.865283 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-08 10:20:33.195962 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81ea8542-e45f-42cd-966f-4798c521785a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016689402730>]}
2021-10-08 10:20:33.195962 (Thread-1): 12:20:33 | 4 of 7 OK created view model dbt.playing_with_tests.................. [SUCCESS 1 in 1.87s]
2021-10-08 10:20:33.197272 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-08 10:20:33.197272 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 10:20:33.197272 (Thread-1): 12:20:33 | 5 of 7 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-08 10:20:33.198279 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:20:33.198279 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 10:20:33.198279 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 10:20:33.203601 (Thread-1): finished collecting timing info
2021-10-08 10:20:33.206228 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-08 10:20:33.209418 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:20:33.209418 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-08 10:20:33.209418 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:20:34.031753 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-08 10:20:34.031753 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:20:34.031753 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-08 10:20:35.389974 (Thread-1): SQL status: SUCCESS 1 in 1.36 seconds
2021-10-08 10:20:35.390973 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 10:20:35.390973 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-08 10:20:35.390973 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-08 10:20:35.557517 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 10:20:35.558477 (Thread-1): finished collecting timing info
2021-10-08 10:20:35.558477 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-08 10:20:35.882881 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81ea8542-e45f-42cd-966f-4798c521785a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668958C760>]}
2021-10-08 10:20:35.883386 (Thread-1): 12:20:35 | 5 of 7 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.68s]
2021-10-08 10:20:35.887401 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-08 10:20:35.887907 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-08 10:20:35.888400 (Thread-1): 12:20:35 | 6 of 7 START incremental model dbt.time.............................. [RUN]
2021-10-08 10:20:35.895233 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:20:35.895233 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-08 10:20:35.900683 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 10:20:35.904181 (Thread-1): finished collecting timing info
2021-10-08 10:20:35.909585 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:20:35.909585 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-08 10:20:35.910078 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:20:37.228803 (Thread-1): SQL status: SUCCESS 1 in 1.32 seconds
2021-10-08 10:20:37.232731 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:20:37.232731 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-08 10:20:37.416947 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-08 10:20:37.417942 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:20:37.417942 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 10:20:37.591824 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 10:20:37.593823 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:20:37.593823 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-08 10:20:37.760597 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 10:20:37.761640 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-08 10:20:37.763953 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:20:37.763953 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-08 10:20:37.962273 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-08 10:20:37.962273 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:20:37.962273 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-08 10:20:38.300997 (Thread-1): SQL status: SUCCESS 0 in 0.34 seconds
2021-10-08 10:20:38.301995 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 10:20:38.301995 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-08 10:20:38.301995 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-08 10:20:38.591524 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-08 10:20:38.592524 (Thread-1): finished collecting timing info
2021-10-08 10:20:38.592524 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-08 10:20:38.904409 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81ea8542-e45f-42cd-966f-4798c521785a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166895C21C0>]}
2021-10-08 10:20:38.904409 (Thread-1): 12:20:38 | 6 of 7 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.01s]
2021-10-08 10:20:38.905788 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-08 10:20:38.905788 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 10:20:38.905788 (Thread-1): 12:20:38 | 7 of 7 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-08 10:20:38.906794 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:20:38.906794 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 10:20:38.907794 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 10:20:38.912795 (Thread-1): finished collecting timing info
2021-10-08 10:20:38.913932 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-08 10:20:38.916439 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:20:38.916439 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-08 10:20:38.916439 (Thread-1): Opening a new connection, currently in state closed
2021-10-08 10:20:39.716819 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-08 10:20:39.717817 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:20:39.717817 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-08 10:20:40.748271 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-10-08 10:20:40.749295 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 10:20:40.749295 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-08 10:20:40.749295 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-08 10:20:40.918979 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-08 10:20:40.919983 (Thread-1): finished collecting timing info
2021-10-08 10:20:40.919983 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-08 10:20:41.277519 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81ea8542-e45f-42cd-966f-4798c521785a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016689527DC0>]}
2021-10-08 10:20:41.277519 (Thread-1): 12:20:41 | 7 of 7 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.37s]
2021-10-08 10:20:41.279520 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-08 10:20:41.281517 (MainThread): Acquiring new snowflake connection "master".
2021-10-08 10:20:41.281517 (MainThread): Using snowflake connection "master".
2021-10-08 10:20:41.282597 (MainThread): On master: BEGIN
2021-10-08 10:20:41.282597 (MainThread): Opening a new connection, currently in state closed
2021-10-08 10:20:42.080664 (MainThread): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-08 10:20:42.080664 (MainThread): On master: COMMIT
2021-10-08 10:20:42.080664 (MainThread): Using snowflake connection "master".
2021-10-08 10:20:42.080664 (MainThread): On master: COMMIT
2021-10-08 10:20:42.329520 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-08 10:20:42.330521 (MainThread): On master: Close
2021-10-08 10:20:42.630940 (MainThread): 12:20:42 | 
2021-10-08 10:20:42.631444 (MainThread): 12:20:42 | Finished running 4 table models, 2 incremental models, 1 view model in 24.18s.
2021-10-08 10:20:42.640116 (MainThread): Connection 'master' was properly closed.
2021-10-08 10:20:42.640473 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-08 10:20:42.640713 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-08 10:20:42.640805 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-08 10:20:42.655148 (MainThread): 
2021-10-08 10:20:42.661180 (MainThread): Completed successfully
2021-10-08 10:20:42.662387 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-08 10:20:42.663326 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166891F55B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166891F5B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166891F59D0>]}
2021-10-08 10:20:42.663326 (MainThread): Flushing usage events
2021-10-15 12:13:19.315785 (MainThread): Running with dbt=0.20.2
2021-10-15 12:13:20.587892 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 12:13:20.588893 (MainThread): Tracking: tracking
2021-10-15 12:13:20.589909 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EA7FEDE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EA951ADC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EA951A880>]}
2021-10-15 12:13:20.600944 (MainThread): Partial parsing not enabled
2021-10-15 12:13:20.759513 (MainThread): Parsing macros\adapters.sql
2021-10-15 12:13:20.782807 (MainThread): Parsing macros\catalog.sql
2021-10-15 12:13:20.783807 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 12:13:20.789806 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 12:13:20.790807 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 12:13:20.793705 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 12:13:20.794717 (MainThread): Parsing macros\core.sql
2021-10-15 12:13:20.796717 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 12:13:20.830531 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 12:13:20.836476 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 12:13:20.836476 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 12:13:20.837529 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 12:13:20.838534 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 12:13:20.840535 (MainThread): Parsing macros\etc\query.sql
2021-10-15 12:13:20.840535 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 12:13:20.847531 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 12:13:20.852481 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 12:13:20.861734 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 12:13:20.862732 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 12:13:20.867723 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 12:13:20.883075 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 12:13:20.903996 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 12:13:20.905007 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 12:13:20.919602 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 12:13:20.924601 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 12:13:20.927601 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 12:13:20.932601 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 12:13:20.934600 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 12:13:20.934600 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 12:13:20.936600 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 12:13:21.068568 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 12:13:21.077904 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 12:13:21.079904 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:13:21.086905 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:13:21.090983 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:13:21.091995 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 12:13:21.093992 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 12:13:21.096005 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:13:21.107252 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 12:13:21.109261 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:13:21.110248 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 12:13:21.112260 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:13:21.160270 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:13:21.161260 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:13:21.163260 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:13:21.169049 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:13:21.169049 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:13:21.170023 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:13:21.171028 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:13:21.172035 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:13:21.174035 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:13:21.180275 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:13:21.181309 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:13:21.199011 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f6f67bc-9e50-46f6-b30c-2d10eed082c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EA95B6610>]}
2021-10-15 12:13:21.215674 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 12:13:21.215674 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f6f67bc-9e50-46f6-b30c-2d10eed082c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EA9694A30>]}
2021-10-15 12:13:21.215674 (MainThread): Found 7 models, 11 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 12:13:21.217938 (MainThread): 
2021-10-15 12:13:21.218440 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 12:13:21.220556 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 12:13:21.231839 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 12:13:21.231839 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 12:13:21.231839 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 12:13:23.042115 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.81 seconds
2021-10-15 12:13:23.063147 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 12:13:23.575298 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 12:13:23.584297 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 12:13:23.585288 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 12:13:23.585288 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 12:13:24.519998 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.93 seconds
2021-10-15 12:13:24.521006 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 12:13:24.799214 (MainThread): Using snowflake connection "master".
2021-10-15 12:13:24.799214 (MainThread): On master: BEGIN
2021-10-15 12:13:24.799214 (MainThread): Opening a new connection, currently in state init
2021-10-15 12:13:25.719338 (MainThread): SQL status: SUCCESS 1 in 0.92 seconds
2021-10-15 12:13:25.720335 (MainThread): On master: COMMIT
2021-10-15 12:13:25.720335 (MainThread): Using snowflake connection "master".
2021-10-15 12:13:25.720335 (MainThread): On master: COMMIT
2021-10-15 12:13:26.019684 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-10-15 12:13:26.020185 (MainThread): On master: Close
2021-10-15 12:13:26.309722 (MainThread): 14:13:26 | Concurrency: 1 threads (target='dev')
2021-10-15 12:13:26.310718 (MainThread): 14:13:26 | 
2021-10-15 12:13:26.315985 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 12:13:26.315985 (Thread-1): 14:13:26 | 1 of 7 START table model dbt.first_model............................. [RUN]
2021-10-15 12:13:26.316983 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:13:26.316983 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 12:13:26.319982 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 12:13:26.327983 (Thread-1): finished collecting timing info
2021-10-15 12:13:26.353311 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 12:13:26.359311 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:13:26.359311 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 12:13:26.359311 (Thread-1): Opening a new connection, currently in state init
2021-10-15 12:13:27.744743 (Thread-1): SQL status: SUCCESS 1 in 1.39 seconds
2021-10-15 12:13:27.745742 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:13:27.745742 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all   
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 12:13:30.189502 (Thread-1): SQL status: SUCCESS 1 in 2.44 seconds
2021-10-15 12:13:30.190518 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 12:13:30.190518 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:13:30.190518 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 12:13:30.428935 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-15 12:13:30.439766 (Thread-1): finished collecting timing info
2021-10-15 12:13:30.440945 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 12:13:30.798526 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f6f67bc-9e50-46f6-b30c-2d10eed082c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EA981EAF0>]}
2021-10-15 12:13:30.799524 (Thread-1): 14:13:30 | 1 of 7 OK created table model dbt.first_model........................ [SUCCESS 1 in 4.48s]
2021-10-15 12:13:30.800544 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 12:13:30.801525 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 12:13:30.801525 (Thread-1): 14:13:30 | 2 of 7 START table model dbt.cul_order_price......................... [RUN]
2021-10-15 12:13:30.802738 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 12:13:30.802738 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 12:13:30.803754 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 12:13:30.809835 (Thread-1): finished collecting timing info
2021-10-15 12:13:30.810850 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 12:13:30.817849 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 12:13:30.817849 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-15 12:13:30.817849 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 12:13:31.619414 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-15 12:13:31.619414 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 12:13:31.619414 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-15 12:13:33.608783 (Thread-1): SQL status: SUCCESS 1 in 1.99 seconds
2021-10-15 12:13:33.610785 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 12:13:33.610785 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 12:13:33.611841 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 12:13:33.769885 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 12:13:33.769885 (Thread-1): finished collecting timing info
2021-10-15 12:13:33.769885 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-15 12:13:34.271459 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f6f67bc-9e50-46f6-b30c-2d10eed082c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EA9590CA0>]}
2021-10-15 12:13:34.271459 (Thread-1): 14:13:34 | 2 of 7 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.47s]
2021-10-15 12:13:34.272459 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 12:13:34.272459 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-15 12:13:34.272459 (Thread-1): 14:13:34 | 3 of 7 START incremental model dbt.dates............................. [RUN]
2021-10-15 12:13:34.273459 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:13:34.273459 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-15 12:13:34.278459 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 12:13:34.284616 (Thread-1): finished collecting timing info
2021-10-15 12:13:34.305611 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:13:34.305611 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-15 12:13:34.306611 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 12:13:36.935384 (Thread-1): SQL status: SUCCESS 1 in 2.63 seconds
2021-10-15 12:13:36.944188 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:13:36.944386 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-15 12:13:37.143019 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-15 12:13:37.143950 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:13:37.143950 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 12:13:37.310989 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 12:13:37.312990 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:13:37.312990 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 12:13:37.576576 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-15 12:13:37.587061 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 12:13:37.592072 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:13:37.592072 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-15 12:13:38.048178 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-10-15 12:13:38.048178 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:13:38.048178 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-15 12:13:38.857690 (Thread-1): SQL status: SUCCESS 7 in 0.81 seconds
2021-10-15 12:13:38.858626 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 12:13:38.858626 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:13:38.858626 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 12:13:39.292434 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-10-15 12:13:39.293330 (Thread-1): finished collecting timing info
2021-10-15 12:13:39.293330 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-15 12:13:39.769544 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f6f67bc-9e50-46f6-b30c-2d10eed082c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EA9590CA0>]}
2021-10-15 12:13:39.770617 (Thread-1): 14:13:39 | 3 of 7 OK created incremental model dbt.dates........................ [SUCCESS 7 in 5.50s]
2021-10-15 12:13:39.772539 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-15 12:13:39.772539 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 12:13:39.772539 (Thread-1): 14:13:39 | 4 of 7 START view model dbt.playing_with_tests....................... [RUN]
2021-10-15 12:13:39.773535 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 12:13:39.773535 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 12:13:39.774538 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 12:13:39.779128 (Thread-1): finished collecting timing info
2021-10-15 12:13:39.791608 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 12:13:39.798046 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 12:13:39.798046 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-15 12:13:39.798046 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 12:13:40.693131 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-10-15 12:13:40.693131 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 12:13:40.693131 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */

  create or replace  view analytics.dbt.playing_with_tests  as (
    SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF001"."CUSTOMER"
  );
2021-10-15 12:13:41.181862 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-10-15 12:13:41.183865 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 12:13:41.183865 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 12:13:41.183865 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 12:13:41.338966 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 12:13:41.339977 (Thread-1): finished collecting timing info
2021-10-15 12:13:41.339977 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-15 12:13:41.793063 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f6f67bc-9e50-46f6-b30c-2d10eed082c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EA981E9A0>]}
2021-10-15 12:13:41.794067 (Thread-1): 14:13:41 | 4 of 7 OK created view model dbt.playing_with_tests.................. [SUCCESS 1 in 2.02s]
2021-10-15 12:13:41.796067 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 12:13:41.796067 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 12:13:41.796067 (Thread-1): 14:13:41 | 5 of 7 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-15 12:13:41.796067 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 12:13:41.797166 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 12:13:41.798146 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 12:13:41.805067 (Thread-1): finished collecting timing info
2021-10-15 12:13:41.807064 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 12:13:41.811065 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 12:13:41.811065 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-15 12:13:41.812064 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 12:13:43.182953 (Thread-1): SQL status: SUCCESS 1 in 1.37 seconds
2021-10-15 12:13:43.182953 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 12:13:43.182953 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-15 12:13:45.719934 (Thread-1): SQL status: SUCCESS 1 in 2.54 seconds
2021-10-15 12:13:45.721923 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 12:13:45.721923 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 12:13:45.721923 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 12:13:45.986859 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-15 12:13:45.987863 (Thread-1): finished collecting timing info
2021-10-15 12:13:45.987863 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-15 12:13:46.398501 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f6f67bc-9e50-46f6-b30c-2d10eed082c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EA99D8FD0>]}
2021-10-15 12:13:46.398501 (Thread-1): 14:13:46 | 5 of 7 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 4.60s]
2021-10-15 12:13:46.399426 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 12:13:46.399426 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-15 12:13:46.400424 (Thread-1): 14:13:46 | 6 of 7 START incremental model dbt.time.............................. [RUN]
2021-10-15 12:13:46.400424 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:13:46.400424 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-15 12:13:46.402425 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 12:13:46.407608 (Thread-1): finished collecting timing info
2021-10-15 12:13:46.409684 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:13:46.409684 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-15 12:13:46.409684 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 12:13:48.698018 (Thread-1): SQL status: SUCCESS 1 in 2.29 seconds
2021-10-15 12:13:48.699007 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:13:48.699007 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-15 12:13:48.878094 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-15 12:13:48.882091 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:13:48.882091 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 12:13:49.242115 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-15 12:13:49.244115 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:13:49.244115 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 12:13:49.809630 (Thread-1): SQL status: SUCCESS 1 in 0.57 seconds
2021-10-15 12:13:49.812631 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 12:13:49.827721 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:13:49.827721 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-15 12:13:50.113455 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-15 12:13:50.113455 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:13:50.114462 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-15 12:13:51.339672 (Thread-1): SQL status: SUCCESS 2562 in 1.23 seconds
2021-10-15 12:13:51.341687 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 12:13:51.341687 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:13:51.341687 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 12:13:51.795728 (Thread-1): SQL status: SUCCESS 1 in 0.45 seconds
2021-10-15 12:13:51.797726 (Thread-1): finished collecting timing info
2021-10-15 12:13:51.797726 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-15 12:13:52.274033 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f6f67bc-9e50-46f6-b30c-2d10eed082c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EA99A6A00>]}
2021-10-15 12:13:52.275108 (Thread-1): 14:13:52 | 6 of 7 OK created incremental model dbt.time......................... [SUCCESS 2562 in 5.87s]
2021-10-15 12:13:52.276064 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-15 12:13:52.276064 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 12:13:52.276064 (Thread-1): 14:13:52 | 7 of 7 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-15 12:13:52.277074 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 12:13:52.277074 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 12:13:52.279165 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 12:13:52.297531 (Thread-1): finished collecting timing info
2021-10-15 12:13:52.298529 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 12:13:52.304585 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 12:13:52.304585 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-15 12:13:52.304585 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 12:13:53.504281 (Thread-1): SQL status: SUCCESS 1 in 1.20 seconds
2021-10-15 12:13:53.504474 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 12:13:53.504980 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-15 12:13:54.874675 (Thread-1): SQL status: SUCCESS 1 in 1.37 seconds
2021-10-15 12:13:54.877422 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 12:13:54.877422 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 12:13:54.877422 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 12:13:55.044189 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 12:13:55.046183 (Thread-1): finished collecting timing info
2021-10-15 12:13:55.046330 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-15 12:13:55.429028 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f6f67bc-9e50-46f6-b30c-2d10eed082c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EA994E850>]}
2021-10-15 12:13:55.429028 (Thread-1): 14:13:55 | 7 of 7 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 3.15s]
2021-10-15 12:13:55.430027 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 12:13:55.431046 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 12:13:55.431046 (MainThread): Using snowflake connection "master".
2021-10-15 12:13:55.431046 (MainThread): On master: BEGIN
2021-10-15 12:13:55.432122 (MainThread): Opening a new connection, currently in state closed
2021-10-15 12:13:56.370971 (MainThread): SQL status: SUCCESS 1 in 0.94 seconds
2021-10-15 12:13:56.370971 (MainThread): On master: COMMIT
2021-10-15 12:13:56.371981 (MainThread): Using snowflake connection "master".
2021-10-15 12:13:56.371981 (MainThread): On master: COMMIT
2021-10-15 12:13:56.720187 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-10-15 12:13:56.721211 (MainThread): On master: Close
2021-10-15 12:13:57.053977 (MainThread): 14:13:57 | 
2021-10-15 12:13:57.055157 (MainThread): 14:13:57 | Finished running 4 table models, 2 incremental models, 1 view model in 35.84s.
2021-10-15 12:13:57.056086 (MainThread): Connection 'master' was properly closed.
2021-10-15 12:13:57.056086 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 12:13:57.056086 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 12:13:57.057101 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-15 12:13:57.084835 (MainThread): 
2021-10-15 12:13:57.085403 (MainThread): Completed successfully
2021-10-15 12:13:57.088922 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-15 12:13:57.090917 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EA995BEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EA995BF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EA9949F70>]}
2021-10-15 12:13:57.090917 (MainThread): Flushing usage events
2021-10-15 12:16:00.809862 (MainThread): Running with dbt=0.20.2
2021-10-15 12:16:01.465113 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['example'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 12:16:01.465113 (MainThread): Tracking: tracking
2021-10-15 12:16:01.466197 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314A8FCE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314BE2A160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314BE2A880>]}
2021-10-15 12:16:01.472437 (MainThread): Partial parsing not enabled
2021-10-15 12:16:01.487617 (MainThread): Parsing macros\adapters.sql
2021-10-15 12:16:01.507885 (MainThread): Parsing macros\catalog.sql
2021-10-15 12:16:01.509894 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 12:16:01.517013 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 12:16:01.519015 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 12:16:01.521019 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 12:16:01.522017 (MainThread): Parsing macros\core.sql
2021-10-15 12:16:01.525018 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 12:16:01.557654 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 12:16:01.567887 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 12:16:01.568888 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 12:16:01.569885 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 12:16:01.570882 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 12:16:01.571884 (MainThread): Parsing macros\etc\query.sql
2021-10-15 12:16:01.572880 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 12:16:01.580143 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 12:16:01.585132 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 12:16:01.595436 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 12:16:01.596434 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 12:16:01.602436 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 12:16:01.618111 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 12:16:01.639594 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 12:16:01.640593 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 12:16:01.655279 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 12:16:01.659658 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 12:16:01.662858 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 12:16:01.667016 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 12:16:01.668406 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 12:16:01.669247 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 12:16:01.670175 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 12:16:01.798772 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 12:16:01.804773 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 12:16:01.806875 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:16:01.812124 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:16:01.814074 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:16:01.814989 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 12:16:01.817081 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 12:16:01.819070 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:16:01.832383 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 12:16:01.835460 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:16:01.836456 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 12:16:01.838079 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:16:01.889502 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:16:01.891510 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:16:01.892502 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:16:01.899653 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:16:01.899653 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:16:01.900755 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:16:01.902756 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:16:01.903760 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:16:01.904757 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:16:01.912761 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:16:01.912761 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:16:01.936067 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cf52758-790c-466a-9bfd-ae4282f67032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314BEEE580>]}
2021-10-15 12:16:01.948839 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 12:16:01.949843 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cf52758-790c-466a-9bfd-ae4282f67032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314BEEEDC0>]}
2021-10-15 12:16:01.949843 (MainThread): Found 7 models, 11 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 12:16:01.950774 (MainThread): 
2021-10-15 12:16:01.951837 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 12:16:01.952764 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 12:16:01.963987 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 12:16:01.963987 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 12:16:01.963987 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 12:16:03.422895 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.46 seconds
2021-10-15 12:16:03.428383 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 12:16:03.734667 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 12:16:03.739680 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 12:16:03.739680 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 12:16:03.739680 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 12:16:04.616197 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.88 seconds
2021-10-15 12:16:04.617196 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 12:16:04.908342 (MainThread): Using snowflake connection "master".
2021-10-15 12:16:04.908342 (MainThread): On master: BEGIN
2021-10-15 12:16:04.908342 (MainThread): Opening a new connection, currently in state init
2021-10-15 12:16:05.989634 (MainThread): SQL status: SUCCESS 1 in 1.08 seconds
2021-10-15 12:16:05.989634 (MainThread): On master: COMMIT
2021-10-15 12:16:05.989634 (MainThread): Using snowflake connection "master".
2021-10-15 12:16:05.989634 (MainThread): On master: COMMIT
2021-10-15 12:16:06.299265 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-10-15 12:16:06.299454 (MainThread): On master: Close
2021-10-15 12:16:06.614613 (MainThread): 14:16:06 | Concurrency: 1 threads (target='dev')
2021-10-15 12:16:06.615610 (MainThread): 14:16:06 | 
2021-10-15 12:16:06.620294 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 12:16:06.620294 (Thread-1): 14:16:06 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-15 12:16:06.621289 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:16:06.621289 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 12:16:06.623801 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 12:16:06.629637 (Thread-1): finished collecting timing info
2021-10-15 12:16:06.652160 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 12:16:06.654072 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:16:06.654072 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 12:16:06.654072 (Thread-1): Opening a new connection, currently in state init
2021-10-15 12:16:07.562036 (Thread-1): SQL status: SUCCESS 1 in 0.91 seconds
2021-10-15 12:16:07.562036 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:16:07.562036 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all   
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 12:16:08.580343 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-15 12:16:08.581302 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 12:16:08.581302 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:16:08.581302 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 12:16:08.738372 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 12:16:08.746139 (Thread-1): finished collecting timing info
2021-10-15 12:16:08.746139 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 12:16:09.124339 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cf52758-790c-466a-9bfd-ae4282f67032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314BEF5520>]}
2021-10-15 12:16:09.125340 (Thread-1): 14:16:09 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.50s]
2021-10-15 12:16:09.126339 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 12:16:09.126339 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 12:16:09.126339 (Thread-1): 14:16:09 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-15 12:16:09.126339 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 12:16:09.127343 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 12:16:09.128583 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 12:16:09.129581 (Thread-1): finished collecting timing info
2021-10-15 12:16:09.131617 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 12:16:09.133329 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 12:16:09.134709 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-15 12:16:09.134709 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 12:16:09.938021 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-10-15 12:16:09.939005 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 12:16:09.939005 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-15 12:16:11.486388 (Thread-1): SQL status: SUCCESS 1 in 1.55 seconds
2021-10-15 12:16:11.489069 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 12:16:11.489568 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 12:16:11.489568 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 12:16:11.715193 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-15 12:16:11.716282 (Thread-1): finished collecting timing info
2021-10-15 12:16:11.716282 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-15 12:16:11.969209 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cf52758-790c-466a-9bfd-ae4282f67032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314C2A45B0>]}
2021-10-15 12:16:11.969209 (Thread-1): 14:16:11 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.84s]
2021-10-15 12:16:11.971053 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 12:16:11.971801 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-15 12:16:11.971801 (Thread-1): 14:16:11 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-15 12:16:11.974146 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:16:11.974146 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-15 12:16:11.988190 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 12:16:11.994130 (Thread-1): finished collecting timing info
2021-10-15 12:16:12.014470 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:16:12.014968 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-15 12:16:12.014968 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 12:16:13.414492 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-10-15 12:16:13.428275 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:16:13.428275 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-15 12:16:13.648312 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-15 12:16:13.651329 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:16:13.651329 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 12:16:13.812351 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 12:16:13.815953 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:16:13.815953 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 12:16:14.083325 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-15 12:16:14.102442 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 12:16:14.104379 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:16:14.104379 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-15 12:16:14.354689 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-15 12:16:14.355680 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:16:14.355680 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-15 12:16:15.194361 (Thread-1): SQL status: SUCCESS 0 in 0.84 seconds
2021-10-15 12:16:15.195369 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 12:16:15.195369 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:16:15.196372 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 12:16:15.809842 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2021-10-15 12:16:15.810864 (Thread-1): finished collecting timing info
2021-10-15 12:16:15.810864 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-15 12:16:16.136671 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cf52758-790c-466a-9bfd-ae4282f67032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314C2676A0>]}
2021-10-15 12:16:16.137673 (Thread-1): 14:16:16 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 4.16s]
2021-10-15 12:16:16.139048 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-15 12:16:16.140067 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 12:16:16.140067 (Thread-1): 14:16:16 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-15 12:16:16.141064 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 12:16:16.141064 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 12:16:16.143105 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 12:16:16.149867 (Thread-1): finished collecting timing info
2021-10-15 12:16:16.150955 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 12:16:16.152866 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 12:16:16.152866 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-15 12:16:16.152866 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 12:16:17.270650 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-10-15 12:16:17.271643 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 12:16:17.271643 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-15 12:16:18.780610 (Thread-1): SQL status: SUCCESS 1 in 1.51 seconds
2021-10-15 12:16:18.782789 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 12:16:18.783539 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 12:16:18.783539 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 12:16:18.939308 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 12:16:18.940311 (Thread-1): finished collecting timing info
2021-10-15 12:16:18.940311 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-15 12:16:19.257367 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cf52758-790c-466a-9bfd-ae4282f67032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314C1F8D90>]}
2021-10-15 12:16:19.258362 (Thread-1): 14:16:19 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.12s]
2021-10-15 12:16:19.259427 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 12:16:19.259427 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-15 12:16:19.259427 (Thread-1): 14:16:19 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-15 12:16:19.260441 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:16:19.260441 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-15 12:16:19.262730 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 12:16:19.264734 (Thread-1): finished collecting timing info
2021-10-15 12:16:19.267824 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:16:19.267824 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-15 12:16:19.267824 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 12:16:21.185853 (Thread-1): SQL status: SUCCESS 1 in 1.92 seconds
2021-10-15 12:16:21.186851 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:16:21.186851 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-15 12:16:21.376340 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 12:16:21.378531 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:16:21.378531 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 12:16:21.578755 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-15 12:16:21.581749 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:16:21.581749 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 12:16:21.735763 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 12:16:21.736774 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 12:16:21.738771 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:16:21.738771 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-15 12:16:21.924525 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 12:16:21.924525 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:16:21.924525 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-15 12:16:22.493330 (Thread-1): SQL status: SUCCESS 152 in 0.57 seconds
2021-10-15 12:16:22.493330 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 12:16:22.493330 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:16:22.493330 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 12:16:22.915544 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-10-15 12:16:22.915544 (Thread-1): finished collecting timing info
2021-10-15 12:16:22.915544 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-15 12:16:23.307058 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cf52758-790c-466a-9bfd-ae4282f67032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314C2C7A60>]}
2021-10-15 12:16:23.308063 (Thread-1): 14:16:23 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 152 in 4.05s]
2021-10-15 12:16:23.309052 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-15 12:16:23.309052 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 12:16:23.310055 (Thread-1): 14:16:23 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-15 12:16:23.310055 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 12:16:23.310055 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 12:16:23.313053 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 12:16:23.314501 (Thread-1): finished collecting timing info
2021-10-15 12:16:23.316757 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 12:16:23.318879 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 12:16:23.318879 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-15 12:16:23.318879 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 12:16:24.430095 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2021-10-15 12:16:24.430360 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 12:16:24.430360 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-15 12:16:25.489824 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-10-15 12:16:25.489824 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 12:16:25.489824 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 12:16:25.490817 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 12:16:25.636146 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 12:16:25.637150 (Thread-1): finished collecting timing info
2021-10-15 12:16:25.637150 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-15 12:16:25.952436 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cf52758-790c-466a-9bfd-ae4282f67032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314C1389D0>]}
2021-10-15 12:16:25.952436 (Thread-1): 14:16:25 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.64s]
2021-10-15 12:16:25.953438 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 12:16:25.954436 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 12:16:25.954436 (MainThread): Using snowflake connection "master".
2021-10-15 12:16:25.954436 (MainThread): On master: BEGIN
2021-10-15 12:16:25.954436 (MainThread): Opening a new connection, currently in state closed
2021-10-15 12:16:26.903477 (MainThread): SQL status: SUCCESS 1 in 0.95 seconds
2021-10-15 12:16:26.903477 (MainThread): On master: COMMIT
2021-10-15 12:16:26.904486 (MainThread): Using snowflake connection "master".
2021-10-15 12:16:26.904486 (MainThread): On master: COMMIT
2021-10-15 12:16:27.154207 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-15 12:16:27.154207 (MainThread): On master: Close
2021-10-15 12:16:27.709555 (MainThread): 14:16:27 | 
2021-10-15 12:16:27.710464 (MainThread): 14:16:27 | Finished running 4 table models, 2 incremental models in 25.76s.
2021-10-15 12:16:27.711465 (MainThread): Connection 'master' was properly closed.
2021-10-15 12:16:27.711465 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 12:16:27.711465 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 12:16:27.711465 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-15 12:16:27.726329 (MainThread): 
2021-10-15 12:16:27.727330 (MainThread): Completed successfully
2021-10-15 12:16:27.730103 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-15 12:16:27.730103 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314BFA4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314BE2B2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314C1FFD60>]}
2021-10-15 12:16:27.730103 (MainThread): Flushing usage events
2021-10-15 12:17:44.495865 (MainThread): Running with dbt=0.20.2
2021-10-15 12:17:45.094438 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['dates'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 12:17:45.094438 (MainThread): Tracking: tracking
2021-10-15 12:17:45.094438 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F44233CC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F44386A8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F44386A4C0>]}
2021-10-15 12:17:45.102438 (MainThread): Partial parsing not enabled
2021-10-15 12:17:45.116631 (MainThread): Parsing macros\adapters.sql
2021-10-15 12:17:45.138910 (MainThread): Parsing macros\catalog.sql
2021-10-15 12:17:45.139911 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 12:17:45.146911 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 12:17:45.148912 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 12:17:45.151909 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 12:17:45.153051 (MainThread): Parsing macros\core.sql
2021-10-15 12:17:45.155071 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 12:17:45.188459 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 12:17:45.195459 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 12:17:45.196461 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 12:17:45.197461 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 12:17:45.198843 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 12:17:45.199912 (MainThread): Parsing macros\etc\query.sql
2021-10-15 12:17:45.200912 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 12:17:45.207911 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 12:17:45.212910 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 12:17:45.223037 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 12:17:45.225038 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 12:17:45.231214 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 12:17:45.246495 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 12:17:45.268069 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 12:17:45.269070 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 12:17:45.282234 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 12:17:45.287234 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 12:17:45.290798 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 12:17:45.295937 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 12:17:45.297953 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 12:17:45.298931 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 12:17:45.299940 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 12:17:45.408421 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 12:17:45.414422 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 12:17:45.416767 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:17:45.421810 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:17:45.423810 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:17:45.423810 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 12:17:45.425810 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 12:17:45.427810 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:17:45.436075 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 12:17:45.438077 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:17:45.439077 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 12:17:45.441074 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:17:45.494937 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:17:45.496936 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:17:45.497933 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:17:45.504933 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:17:45.504933 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:17:45.505931 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:17:45.508083 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:17:45.509201 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:17:45.510190 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:17:45.518192 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:17:45.518192 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:17:45.538581 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd85bd1b3-31b5-4e4d-9b4b-79483a0fd7dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F4438FEAC0>]}
2021-10-15 12:17:45.558825 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 12:17:45.558825 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd85bd1b3-31b5-4e4d-9b4b-79483a0fd7dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F4438FE2E0>]}
2021-10-15 12:17:45.559834 (MainThread): Found 7 models, 11 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 12:17:45.561352 (MainThread): 
2021-10-15 12:17:45.561855 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 12:17:45.563844 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 12:17:45.576274 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 12:17:45.576274 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 12:17:45.576274 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 12:17:47.129944 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.55 seconds
2021-10-15 12:17:47.133029 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 12:17:47.457882 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 12:17:47.463054 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 12:17:47.464054 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 12:17:47.464054 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 12:17:48.553839 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.09 seconds
2021-10-15 12:17:48.555933 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 12:17:48.844994 (MainThread): Using snowflake connection "master".
2021-10-15 12:17:48.844994 (MainThread): On master: BEGIN
2021-10-15 12:17:48.846011 (MainThread): Opening a new connection, currently in state init
2021-10-15 12:17:49.663473 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-15 12:17:49.663473 (MainThread): On master: COMMIT
2021-10-15 12:17:49.664471 (MainThread): Using snowflake connection "master".
2021-10-15 12:17:49.664471 (MainThread): On master: COMMIT
2021-10-15 12:17:49.914116 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-15 12:17:49.915190 (MainThread): On master: Close
2021-10-15 12:17:50.213045 (MainThread): 14:17:50 | Concurrency: 1 threads (target='dev')
2021-10-15 12:17:50.213979 (MainThread): 14:17:50 | 
2021-10-15 12:17:50.218629 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-15 12:17:50.218629 (Thread-1): 14:17:50 | 1 of 1 START incremental model dbt.dates............................. [RUN]
2021-10-15 12:17:50.219611 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:17:50.219611 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-15 12:17:50.225133 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 12:17:50.226245 (Thread-1): finished collecting timing info
2021-10-15 12:17:50.270171 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:17:50.270171 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-15 12:17:50.270171 (Thread-1): Opening a new connection, currently in state init
2021-10-15 12:17:51.773237 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-10-15 12:17:51.787310 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:17:51.787310 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-15 12:17:51.991474 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-15 12:17:51.997146 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:17:51.997146 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 12:17:52.158914 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 12:17:52.161907 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:17:52.161907 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 12:17:52.323142 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 12:17:52.332070 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 12:17:52.333934 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:17:52.333934 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-15 12:17:52.622244 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-15 12:17:52.622244 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:17:52.622244 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-15 12:17:52.994520 (Thread-1): SQL status: SUCCESS 0 in 0.37 seconds
2021-10-15 12:17:52.996416 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 12:17:52.996416 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:17:52.996416 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 12:17:53.528965 (Thread-1): SQL status: SUCCESS 1 in 0.53 seconds
2021-10-15 12:17:53.537478 (Thread-1): finished collecting timing info
2021-10-15 12:17:53.537478 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-15 12:17:53.835769 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd85bd1b3-31b5-4e4d-9b4b-79483a0fd7dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F4438FECD0>]}
2021-10-15 12:17:53.836792 (Thread-1): 14:17:53 | 1 of 1 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.62s]
2021-10-15 12:17:53.837784 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-15 12:17:53.839785 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 12:17:53.839785 (MainThread): Using snowflake connection "master".
2021-10-15 12:17:53.839785 (MainThread): On master: BEGIN
2021-10-15 12:17:53.839785 (MainThread): Opening a new connection, currently in state closed
2021-10-15 12:17:54.761056 (MainThread): SQL status: SUCCESS 1 in 0.92 seconds
2021-10-15 12:17:54.761228 (MainThread): On master: COMMIT
2021-10-15 12:17:54.761340 (MainThread): Using snowflake connection "master".
2021-10-15 12:17:54.761386 (MainThread): On master: COMMIT
2021-10-15 12:17:55.021629 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-15 12:17:55.021629 (MainThread): On master: Close
2021-10-15 12:17:55.310065 (MainThread): 14:17:55 | 
2021-10-15 12:17:55.310065 (MainThread): 14:17:55 | Finished running 1 incremental model in 9.75s.
2021-10-15 12:17:55.314611 (MainThread): Connection 'master' was properly closed.
2021-10-15 12:17:55.315556 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 12:17:55.315556 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 12:17:55.315556 (MainThread): Connection 'model.lukeclarke_learn_dbt.dates' was properly closed.
2021-10-15 12:17:55.342030 (MainThread): 
2021-10-15 12:17:55.342030 (MainThread): Completed successfully
2021-10-15 12:17:55.343614 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-15 12:17:55.345097 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F4438FECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F443CEDFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F443CED9A0>]}
2021-10-15 12:17:55.345596 (MainThread): Flushing usage events
2021-10-15 12:21:02.511119 (MainThread): Running with dbt=0.20.2
2021-10-15 12:21:03.103568 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['example'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 12:21:03.104571 (MainThread): Tracking: tracking
2021-10-15 12:21:03.104571 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF9F0DDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFB43F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFB43F760>]}
2021-10-15 12:21:03.111849 (MainThread): Partial parsing not enabled
2021-10-15 12:21:03.124454 (MainThread): Parsing macros\adapters.sql
2021-10-15 12:21:03.146182 (MainThread): Parsing macros\catalog.sql
2021-10-15 12:21:03.147188 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 12:21:03.154300 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 12:21:03.155443 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 12:21:03.158442 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 12:21:03.159448 (MainThread): Parsing macros\core.sql
2021-10-15 12:21:03.162434 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 12:21:03.199031 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 12:21:03.206293 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 12:21:03.207108 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 12:21:03.208344 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 12:21:03.209795 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 12:21:03.210998 (MainThread): Parsing macros\etc\query.sql
2021-10-15 12:21:03.211591 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 12:21:03.219211 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 12:21:03.223568 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 12:21:03.234822 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 12:21:03.235820 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 12:21:03.242445 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 12:21:03.258574 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 12:21:03.280205 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 12:21:03.281187 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 12:21:03.295182 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 12:21:03.300188 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 12:21:03.303201 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 12:21:03.308174 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 12:21:03.309264 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 12:21:03.310402 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 12:21:03.311397 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 12:21:03.440950 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 12:21:03.448043 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 12:21:03.450275 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:21:03.457278 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:21:03.459270 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:21:03.460283 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 12:21:03.462271 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 12:21:03.463457 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:21:03.474951 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 12:21:03.477028 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:21:03.477028 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 12:21:03.479951 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:21:03.529944 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:21:03.530932 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:21:03.532933 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:21:03.539847 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:21:03.539847 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:21:03.541707 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:21:03.543779 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:21:03.545861 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:21:03.546778 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:21:03.554861 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:21:03.555866 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:21:03.574189 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a857ae5-5242-49c7-b0f5-00132ddb5650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFB5A72E0>]}
2021-10-15 12:21:03.594628 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 12:21:03.596490 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a857ae5-5242-49c7-b0f5-00132ddb5650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFB5A7100>]}
2021-10-15 12:21:03.597213 (MainThread): Found 7 models, 11 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 12:21:03.598352 (MainThread): 
2021-10-15 12:21:03.599138 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 12:21:03.601204 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 12:21:03.613997 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 12:21:03.613997 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 12:21:03.614500 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 12:21:05.563953 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.95 seconds
2021-10-15 12:21:05.569983 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 12:21:05.997592 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 12:21:06.002676 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 12:21:06.002676 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 12:21:06.003680 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 12:21:06.944532 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.94 seconds
2021-10-15 12:21:06.946621 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 12:21:07.258804 (MainThread): Using snowflake connection "master".
2021-10-15 12:21:07.258804 (MainThread): On master: BEGIN
2021-10-15 12:21:07.259852 (MainThread): Opening a new connection, currently in state init
2021-10-15 12:21:08.365254 (MainThread): SQL status: SUCCESS 1 in 1.11 seconds
2021-10-15 12:21:08.366253 (MainThread): On master: COMMIT
2021-10-15 12:21:08.366253 (MainThread): Using snowflake connection "master".
2021-10-15 12:21:08.366253 (MainThread): On master: COMMIT
2021-10-15 12:21:08.705403 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-10-15 12:21:08.705403 (MainThread): On master: Close
2021-10-15 12:21:09.038967 (MainThread): 14:21:09 | Concurrency: 1 threads (target='dev')
2021-10-15 12:21:09.039862 (MainThread): 14:21:09 | 
2021-10-15 12:21:09.046471 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 12:21:09.046471 (Thread-1): 14:21:09 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-10-15 12:21:09.046471 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:21:09.046471 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 12:21:09.048477 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 12:21:09.053478 (Thread-1): finished collecting timing info
2021-10-15 12:21:09.070914 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 12:21:09.073447 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:21:09.073447 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 12:21:09.073447 (Thread-1): Opening a new connection, currently in state init
2021-10-15 12:21:09.904857 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-15 12:21:09.904857 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:21:09.904857 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all   
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 12:21:11.213167 (Thread-1): SQL status: SUCCESS 1 in 1.31 seconds
2021-10-15 12:21:11.214278 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 12:21:11.214278 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:21:11.214278 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 12:21:11.382774 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 12:21:11.392692 (Thread-1): finished collecting timing info
2021-10-15 12:21:11.392692 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 12:21:11.713464 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a857ae5-5242-49c7-b0f5-00132ddb5650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFB76DA00>]}
2021-10-15 12:21:11.714463 (Thread-1): 14:21:11 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.67s]
2021-10-15 12:21:11.715831 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 12:21:11.715831 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 12:21:11.716844 (Thread-1): 14:21:11 | 2 of 6 START table model dbt.cul_order_price......................... [RUN]
2021-10-15 12:21:11.716844 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 12:21:11.716844 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 12:21:11.717847 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 12:21:11.719844 (Thread-1): finished collecting timing info
2021-10-15 12:21:11.720874 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 12:21:11.724151 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 12:21:11.724151 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-15 12:21:11.724151 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 12:21:12.586245 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-10-15 12:21:12.586245 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 12:21:12.586245 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-15 12:21:14.592533 (Thread-1): SQL status: SUCCESS 1 in 2.01 seconds
2021-10-15 12:21:14.594861 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 12:21:14.594861 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 12:21:14.594861 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 12:21:14.765085 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 12:21:14.767181 (Thread-1): finished collecting timing info
2021-10-15 12:21:14.767181 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-15 12:21:15.062030 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a857ae5-5242-49c7-b0f5-00132ddb5650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFB8BA160>]}
2021-10-15 12:21:15.063033 (Thread-1): 14:21:15 | 2 of 6 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.35s]
2021-10-15 12:21:15.064509 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 12:21:15.064509 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-15 12:21:15.065525 (Thread-1): 14:21:15 | 3 of 6 START incremental model dbt.dates............................. [RUN]
2021-10-15 12:21:15.065525 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:21:15.066522 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-15 12:21:15.072195 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 12:21:15.073964 (Thread-1): finished collecting timing info
2021-10-15 12:21:15.088764 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:21:15.088764 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-15 12:21:15.088764 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 12:21:17.518490 (Thread-1): SQL status: SUCCESS 1 in 2.43 seconds
2021-10-15 12:21:17.527706 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:21:17.527706 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-15 12:21:17.738529 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-15 12:21:17.744654 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:21:17.744654 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 12:21:17.887844 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 12:21:17.891829 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:21:17.891829 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 12:21:18.065763 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 12:21:18.078709 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 12:21:18.081109 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:21:18.081109 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-15 12:21:18.293920 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-15 12:21:18.293920 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:21:18.293920 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-15 12:21:18.690874 (Thread-1): SQL status: SUCCESS 0 in 0.40 seconds
2021-10-15 12:21:18.694082 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 12:21:18.694082 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:21:18.694082 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 12:21:18.961863 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-15 12:21:18.962863 (Thread-1): finished collecting timing info
2021-10-15 12:21:18.962863 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-15 12:21:19.362236 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a857ae5-5242-49c7-b0f5-00132ddb5650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFB4E2AF0>]}
2021-10-15 12:21:19.363476 (Thread-1): 14:21:19 | 3 of 6 OK created incremental model dbt.dates........................ [SUCCESS 0 in 4.30s]
2021-10-15 12:21:19.365538 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-15 12:21:19.365538 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 12:21:19.365538 (Thread-1): 14:21:19 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-15 12:21:19.366543 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 12:21:19.366543 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 12:21:19.368535 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 12:21:19.373296 (Thread-1): finished collecting timing info
2021-10-15 12:21:19.374370 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 12:21:19.376294 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 12:21:19.376294 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-15 12:21:19.376294 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 12:21:20.554518 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-10-15 12:21:20.554518 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 12:21:20.554518 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-15 12:21:22.440872 (Thread-1): SQL status: SUCCESS 1 in 1.89 seconds
2021-10-15 12:21:22.441291 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 12:21:22.441819 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 12:21:22.441839 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 12:21:22.627473 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 12:21:22.629471 (Thread-1): finished collecting timing info
2021-10-15 12:21:22.629471 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-15 12:21:22.968380 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a857ae5-5242-49c7-b0f5-00132ddb5650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFB810580>]}
2021-10-15 12:21:22.968380 (Thread-1): 14:21:22 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.60s]
2021-10-15 12:21:22.969380 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 12:21:22.969380 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-15 12:21:22.970380 (Thread-1): 14:21:22 | 5 of 6 START incremental model dbt.time.............................. [RUN]
2021-10-15 12:21:22.970380 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:21:22.970380 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-15 12:21:22.972488 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 12:21:22.973488 (Thread-1): finished collecting timing info
2021-10-15 12:21:22.976488 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:21:22.976488 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-15 12:21:22.976488 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 12:21:24.990888 (Thread-1): SQL status: SUCCESS 1 in 2.01 seconds
2021-10-15 12:21:24.994878 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:21:24.994878 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-15 12:21:25.230565 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-15 12:21:25.232541 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:21:25.232541 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 12:21:25.422198 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 12:21:25.426282 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:21:25.426282 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 12:21:25.574220 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 12:21:25.575998 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 12:21:25.578828 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:21:25.578828 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-15 12:21:25.760532 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-15 12:21:25.760657 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:21:25.760711 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-15 12:21:26.377535 (Thread-1): SQL status: SUCCESS 304 in 0.62 seconds
2021-10-15 12:21:26.378533 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 12:21:26.379531 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:21:26.379531 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 12:21:26.737781 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-15 12:21:26.739429 (Thread-1): finished collecting timing info
2021-10-15 12:21:26.739429 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-15 12:21:27.019117 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a857ae5-5242-49c7-b0f5-00132ddb5650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFB744D30>]}
2021-10-15 12:21:27.019117 (Thread-1): 14:21:27 | 5 of 6 OK created incremental model dbt.time......................... [SUCCESS 304 in 4.05s]
2021-10-15 12:21:27.020747 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-15 12:21:27.020747 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 12:21:27.020747 (Thread-1): 14:21:27 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-15 12:21:27.021758 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 12:21:27.021758 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 12:21:27.025943 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 12:21:27.027945 (Thread-1): finished collecting timing info
2021-10-15 12:21:27.028946 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 12:21:27.031030 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 12:21:27.031030 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-15 12:21:27.031030 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 12:21:27.867630 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-15 12:21:27.867630 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 12:21:27.867630 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-15 12:21:28.917123 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-10-15 12:21:28.919527 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 12:21:28.919527 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 12:21:28.919527 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 12:21:29.249953 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-15 12:21:29.251950 (Thread-1): finished collecting timing info
2021-10-15 12:21:29.251950 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-15 12:21:29.594732 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a857ae5-5242-49c7-b0f5-00132ddb5650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFB717730>]}
2021-10-15 12:21:29.595738 (Thread-1): 14:21:29 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.57s]
2021-10-15 12:21:29.597387 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 12:21:29.599405 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 12:21:29.599405 (MainThread): Using snowflake connection "master".
2021-10-15 12:21:29.600456 (MainThread): On master: BEGIN
2021-10-15 12:21:29.600456 (MainThread): Opening a new connection, currently in state closed
2021-10-15 12:21:30.724298 (MainThread): SQL status: SUCCESS 1 in 1.12 seconds
2021-10-15 12:21:30.725339 (MainThread): On master: COMMIT
2021-10-15 12:21:30.725339 (MainThread): Using snowflake connection "master".
2021-10-15 12:21:30.726379 (MainThread): On master: COMMIT
2021-10-15 12:21:31.032765 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-10-15 12:21:31.032765 (MainThread): On master: Close
2021-10-15 12:21:31.375528 (MainThread): 14:21:31 | 
2021-10-15 12:21:31.376419 (MainThread): 14:21:31 | Finished running 4 table models, 2 incremental models in 27.78s.
2021-10-15 12:21:31.377429 (MainThread): Connection 'master' was properly closed.
2021-10-15 12:21:31.377429 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 12:21:31.377429 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 12:21:31.377429 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-15 12:21:31.392528 (MainThread): 
2021-10-15 12:21:31.392528 (MainThread): Completed successfully
2021-10-15 12:21:31.393994 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-10-15 12:21:31.394324 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFB506E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFB4E27F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FFB4E2D90>]}
2021-10-15 12:21:31.394324 (MainThread): Flushing usage events
2021-10-15 12:22:07.107832 (MainThread): Running with dbt=0.20.2
2021-10-15 12:22:07.725333 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['example.my_first_dbt_model'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 12:22:07.725855 (MainThread): Tracking: tracking
2021-10-15 12:22:07.725855 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB17ADE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB2CDFCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB2CDF760>]}
2021-10-15 12:22:07.732870 (MainThread): Partial parsing not enabled
2021-10-15 12:22:07.747397 (MainThread): Parsing macros\adapters.sql
2021-10-15 12:22:07.768672 (MainThread): Parsing macros\catalog.sql
2021-10-15 12:22:07.770762 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 12:22:07.777935 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 12:22:07.778948 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 12:22:07.781938 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 12:22:07.782942 (MainThread): Parsing macros\core.sql
2021-10-15 12:22:07.786292 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 12:22:07.814836 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 12:22:07.820176 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 12:22:07.821177 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 12:22:07.822177 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 12:22:07.823177 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 12:22:07.824177 (MainThread): Parsing macros\etc\query.sql
2021-10-15 12:22:07.824177 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 12:22:07.830176 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 12:22:07.834328 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 12:22:07.843328 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 12:22:07.844329 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 12:22:07.849749 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 12:22:07.862928 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 12:22:07.883227 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 12:22:07.884229 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 12:22:07.894858 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 12:22:07.898857 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 12:22:07.901857 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 12:22:07.905857 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 12:22:07.906859 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 12:22:07.907859 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 12:22:07.909286 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 12:22:08.016095 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 12:22:08.023282 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 12:22:08.026273 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:22:08.032433 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:22:08.034473 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:08.041564 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 12:22:08.043560 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '17c7f31f-8f3a-44e9-bb64-23fffa7469c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB2DBA6A0>]}
2021-10-15 12:22:08.044473 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 12:22:08.045498 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:22:08.053564 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 12:22:08.054558 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:08.055567 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 12:22:08.056560 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:08.106152 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:08.107197 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:08.109214 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:08.118110 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:08.118110 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:08.119111 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:08.121110 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:08.122111 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:08.123111 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:08.129264 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:08.130266 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:08.149146 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17c7f31f-8f3a-44e9-bb64-23fffa7469c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB2E29A00>]}
2021-10-15 12:22:08.167424 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 12:22:08.167424 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17c7f31f-8f3a-44e9-bb64-23fffa7469c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB2D756D0>]}
2021-10-15 12:22:08.167424 (MainThread): Found 7 models, 11 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 12:22:08.169378 (MainThread): 
2021-10-15 12:22:08.170045 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 12:22:08.171883 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 12:22:08.182067 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 12:22:08.182067 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 12:22:08.182067 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 12:22:09.592714 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.41 seconds
2021-10-15 12:22:09.596850 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 12:22:09.912471 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 12:22:09.916488 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 12:22:09.916488 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 12:22:09.916488 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 12:22:10.713141 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.80 seconds
2021-10-15 12:22:10.715137 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 12:22:11.032809 (MainThread): Using snowflake connection "master".
2021-10-15 12:22:11.032809 (MainThread): On master: BEGIN
2021-10-15 12:22:11.032809 (MainThread): Opening a new connection, currently in state init
2021-10-15 12:22:11.780118 (MainThread): SQL status: SUCCESS 1 in 0.75 seconds
2021-10-15 12:22:11.780118 (MainThread): On master: COMMIT
2021-10-15 12:22:11.780118 (MainThread): Using snowflake connection "master".
2021-10-15 12:22:11.781120 (MainThread): On master: COMMIT
2021-10-15 12:22:12.042786 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-15 12:22:12.042786 (MainThread): On master: Close
2021-10-15 12:22:12.339008 (MainThread): 14:22:12 | Concurrency: 1 threads (target='dev')
2021-10-15 12:22:12.339295 (MainThread): 14:22:12 | 
2021-10-15 12:22:12.342843 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 12:22:12.342843 (Thread-1): 14:22:12 | 1 of 1 START table model dbt.first_model............................. [RUN]
2021-10-15 12:22:12.343841 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:22:12.343841 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 12:22:12.345412 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 12:22:12.351422 (Thread-1): finished collecting timing info
2021-10-15 12:22:12.372813 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 12:22:12.374815 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:22:12.374815 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 12:22:12.374815 (Thread-1): Opening a new connection, currently in state init
2021-10-15 12:22:13.225157 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-15 12:22:13.225157 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:22:13.226458 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all   
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 12:22:14.207958 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-15 12:22:14.209956 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 12:22:14.210956 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:22:14.210956 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 12:22:14.371207 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 12:22:14.382660 (Thread-1): finished collecting timing info
2021-10-15 12:22:14.382660 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 12:22:14.854060 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17c7f31f-8f3a-44e9-bb64-23fffa7469c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB2CCEF40>]}
2021-10-15 12:22:14.854060 (Thread-1): 14:22:14 | 1 of 1 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.51s]
2021-10-15 12:22:14.855060 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 12:22:14.856134 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 12:22:14.856134 (MainThread): Using snowflake connection "master".
2021-10-15 12:22:14.856134 (MainThread): On master: BEGIN
2021-10-15 12:22:14.856134 (MainThread): Opening a new connection, currently in state closed
2021-10-15 12:22:15.877981 (MainThread): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-15 12:22:15.877981 (MainThread): On master: COMMIT
2021-10-15 12:22:15.878980 (MainThread): Using snowflake connection "master".
2021-10-15 12:22:15.878980 (MainThread): On master: COMMIT
2021-10-15 12:22:16.142272 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-15 12:22:16.142272 (MainThread): On master: Close
2021-10-15 12:22:16.424068 (MainThread): 14:22:16 | 
2021-10-15 12:22:16.425071 (MainThread): 14:22:16 | Finished running 1 table model in 8.25s.
2021-10-15 12:22:16.426223 (MainThread): Connection 'master' was properly closed.
2021-10-15 12:22:16.426223 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 12:22:16.426223 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 12:22:16.426776 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_first_dbt_model' was properly closed.
2021-10-15 12:22:16.439532 (MainThread): 
2021-10-15 12:22:16.439532 (MainThread): Completed successfully
2021-10-15 12:22:16.440533 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-15 12:22:16.441637 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB2DBA6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB2FBBAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB2FBB730>]}
2021-10-15 12:22:16.441637 (MainThread): Flushing usage events
2021-10-15 12:22:48.959149 (MainThread): Running with dbt=0.20.2
2021-10-15 12:22:49.595178 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['example.my_first_dbt_model', 'example.dates'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 12:22:49.596156 (MainThread): Tracking: tracking
2021-10-15 12:22:49.596156 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC605CEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC7569880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC7569400>]}
2021-10-15 12:22:49.603684 (MainThread): Partial parsing not enabled
2021-10-15 12:22:49.617651 (MainThread): Parsing macros\adapters.sql
2021-10-15 12:22:49.639039 (MainThread): Parsing macros\catalog.sql
2021-10-15 12:22:49.640041 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 12:22:49.646283 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 12:22:49.648282 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 12:22:49.650281 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 12:22:49.651282 (MainThread): Parsing macros\core.sql
2021-10-15 12:22:49.653281 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 12:22:49.679637 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 12:22:49.684637 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 12:22:49.684637 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 12:22:49.685638 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 12:22:49.686638 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 12:22:49.687638 (MainThread): Parsing macros\etc\query.sql
2021-10-15 12:22:49.687638 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 12:22:49.693827 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 12:22:49.697826 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 12:22:49.705980 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 12:22:49.707005 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 12:22:49.712003 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 12:22:49.724079 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 12:22:49.741355 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 12:22:49.742356 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 12:22:49.752443 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 12:22:49.755844 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 12:22:49.758845 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 12:22:49.762844 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 12:22:49.763845 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 12:22:49.764845 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 12:22:49.764845 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 12:22:49.862221 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 12:22:49.868222 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 12:22:49.869222 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:22:49.874222 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'f43adb71-d8c7-4e9b-af4d-6bd9937a4166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC75790A0>]}
2021-10-15 12:22:49.875389 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:22:49.876410 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:49.877410 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 12:22:49.879410 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 12:22:49.880410 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:22:49.888408 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 12:22:49.889410 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:49.890994 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 12:22:49.892224 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:49.938800 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:49.940801 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:49.941801 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:49.946801 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:49.946801 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:49.947801 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:49.948801 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:49.949801 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:49.950801 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:49.957801 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:49.957801 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:22:49.975890 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f43adb71-d8c7-4e9b-af4d-6bd9937a4166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC76F0E80>]}
2021-10-15 12:22:49.991155 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 12:22:49.992151 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f43adb71-d8c7-4e9b-af4d-6bd9937a4166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC75F4CA0>]}
2021-10-15 12:22:49.992151 (MainThread): Found 7 models, 11 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 12:22:49.993170 (MainThread): 
2021-10-15 12:22:49.993170 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 12:22:49.995182 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 12:22:50.004136 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 12:22:50.005521 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 12:22:50.005521 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 12:22:51.611164 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.61 seconds
2021-10-15 12:22:51.617479 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 12:22:52.019465 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 12:22:52.024432 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 12:22:52.024432 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 12:22:52.024432 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 12:22:53.103195 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.08 seconds
2021-10-15 12:22:53.105187 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 12:22:53.383631 (MainThread): Using snowflake connection "master".
2021-10-15 12:22:53.383631 (MainThread): On master: BEGIN
2021-10-15 12:22:53.383631 (MainThread): Opening a new connection, currently in state init
2021-10-15 12:22:54.282231 (MainThread): SQL status: SUCCESS 1 in 0.90 seconds
2021-10-15 12:22:54.283226 (MainThread): On master: COMMIT
2021-10-15 12:22:54.283226 (MainThread): Using snowflake connection "master".
2021-10-15 12:22:54.283226 (MainThread): On master: COMMIT
2021-10-15 12:22:54.542182 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-15 12:22:54.543180 (MainThread): On master: Close
2021-10-15 12:22:54.897381 (MainThread): 14:22:54 | Concurrency: 1 threads (target='dev')
2021-10-15 12:22:54.897815 (MainThread): 14:22:54 | 
2021-10-15 12:22:54.902819 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-15 12:22:54.902819 (Thread-1): 14:22:54 | 1 of 2 START incremental model dbt.dates............................. [RUN]
2021-10-15 12:22:54.903939 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:22:54.903939 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-15 12:22:54.908000 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 12:22:54.910213 (Thread-1): finished collecting timing info
2021-10-15 12:22:54.937711 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:22:54.937711 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-15 12:22:54.937711 (Thread-1): Opening a new connection, currently in state init
2021-10-15 12:22:56.134464 (Thread-1): SQL status: SUCCESS 1 in 1.20 seconds
2021-10-15 12:22:56.140572 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:22:56.140572 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-15 12:22:56.351232 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-15 12:22:56.355437 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:22:56.355437 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 12:22:56.495238 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 12:22:56.498281 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:22:56.498281 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 12:22:56.675806 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-15 12:22:56.689566 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 12:22:56.690712 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:22:56.690712 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-15 12:22:56.881048 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 12:22:56.881048 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:22:56.881048 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-15 12:22:57.271110 (Thread-1): SQL status: SUCCESS 0 in 0.39 seconds
2021-10-15 12:22:57.273187 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 12:22:57.273187 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:22:57.273187 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 12:22:57.562984 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-15 12:22:57.571238 (Thread-1): finished collecting timing info
2021-10-15 12:22:57.571238 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-15 12:22:57.842195 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f43adb71-d8c7-4e9b-af4d-6bd9937a4166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC79B7E50>]}
2021-10-15 12:22:57.842195 (Thread-1): 14:22:57 | 1 of 2 OK created incremental model dbt.dates........................ [SUCCESS 0 in 2.94s]
2021-10-15 12:22:57.844113 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-15 12:22:57.845136 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 12:22:57.845136 (Thread-1): 14:22:57 | 2 of 2 START table model dbt.first_model............................. [RUN]
2021-10-15 12:22:57.846130 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:22:57.846130 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 12:22:57.848220 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 12:22:57.850130 (Thread-1): finished collecting timing info
2021-10-15 12:22:57.856208 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 12:22:57.858705 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:22:57.858705 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 12:22:57.858705 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 12:22:58.734271 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-10-15 12:22:58.734443 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:22:58.734496 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all   
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 12:22:59.702635 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-15 12:22:59.703884 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 12:22:59.705403 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:22:59.705403 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 12:22:59.893931 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 12:22:59.894934 (Thread-1): finished collecting timing info
2021-10-15 12:22:59.894934 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 12:23:00.199598 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f43adb71-d8c7-4e9b-af4d-6bd9937a4166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC798F640>]}
2021-10-15 12:23:00.200588 (Thread-1): 14:23:00 | 2 of 2 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.35s]
2021-10-15 12:23:00.202905 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 12:23:00.204913 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 12:23:00.204913 (MainThread): Using snowflake connection "master".
2021-10-15 12:23:00.205994 (MainThread): On master: BEGIN
2021-10-15 12:23:00.205994 (MainThread): Opening a new connection, currently in state closed
2021-10-15 12:23:01.107219 (MainThread): SQL status: SUCCESS 1 in 0.90 seconds
2021-10-15 12:23:01.108210 (MainThread): On master: COMMIT
2021-10-15 12:23:01.108210 (MainThread): Using snowflake connection "master".
2021-10-15 12:23:01.108210 (MainThread): On master: COMMIT
2021-10-15 12:23:01.356963 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-15 12:23:01.356963 (MainThread): On master: Close
2021-10-15 12:23:01.625258 (MainThread): 14:23:01 | 
2021-10-15 12:23:01.626358 (MainThread): 14:23:01 | Finished running 1 incremental model, 1 table model in 11.63s.
2021-10-15 12:23:01.628377 (MainThread): Connection 'master' was properly closed.
2021-10-15 12:23:01.628377 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 12:23:01.628377 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 12:23:01.628377 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_first_dbt_model' was properly closed.
2021-10-15 12:23:01.650274 (MainThread): 
2021-10-15 12:23:01.651288 (MainThread): Completed successfully
2021-10-15 12:23:01.651288 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-10-15 12:23:01.653380 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC75D1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC76F07C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC76F00A0>]}
2021-10-15 12:23:01.653616 (MainThread): Flushing usage events
2021-10-15 12:31:33.660552 (MainThread): Running with dbt=0.20.2
2021-10-15 12:31:34.292309 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['new'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 12:31:34.293304 (MainThread): Tracking: tracking
2021-10-15 12:31:34.293304 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026479DEDDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002647B328EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002647B3289A0>]}
2021-10-15 12:31:34.300315 (MainThread): Partial parsing not enabled
2021-10-15 12:31:34.315239 (MainThread): Parsing macros\adapters.sql
2021-10-15 12:31:34.335804 (MainThread): Parsing macros\catalog.sql
2021-10-15 12:31:34.337793 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 12:31:34.344741 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 12:31:34.346742 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 12:31:34.349351 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 12:31:34.350418 (MainThread): Parsing macros\core.sql
2021-10-15 12:31:34.353501 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 12:31:34.385560 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 12:31:34.393296 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 12:31:34.393296 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 12:31:34.395293 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 12:31:34.396218 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 12:31:34.398216 (MainThread): Parsing macros\etc\query.sql
2021-10-15 12:31:34.398216 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 12:31:34.405215 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 12:31:34.410215 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 12:31:34.420213 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 12:31:34.421214 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 12:31:34.427213 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 12:31:34.443389 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 12:31:34.464406 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 12:31:34.465407 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 12:31:34.479119 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 12:31:34.483788 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 12:31:34.486796 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 12:31:34.492869 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 12:31:34.493921 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 12:31:34.494904 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 12:31:34.495918 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 12:31:34.623810 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 12:31:34.630547 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 12:31:34.632171 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 12:31:34.635297 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:31:34.635809 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 12:31:34.649854 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 12:31:34.652105 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 12:31:34.659978 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:31:34.671726 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 12:31:34.674795 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:31:34.676422 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 12:31:34.685007 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:31:34.737628 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:31:34.740648 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:31:34.742722 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:31:34.748750 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:31:34.749736 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:31:34.750733 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:31:34.751695 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:31:34.753652 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:31:34.755648 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:31:34.763651 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:31:34.763651 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 12:31:34.780576 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8eeca5d9-388d-4660-a933-72ef74322ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002647B49FEE0>]}
2021-10-15 12:31:34.797141 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 12:31:34.797141 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8eeca5d9-388d-4660-a933-72ef74322ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002647B4A62E0>]}
2021-10-15 12:31:34.798158 (MainThread): Found 7 models, 11 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 12:31:34.799184 (MainThread): 
2021-10-15 12:31:34.799184 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 12:31:34.802045 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 12:31:34.815712 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 12:31:34.815712 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 12:31:34.815712 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 12:31:36.027135 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.21 seconds
2021-10-15 12:31:36.030176 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 12:31:36.296707 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 12:31:36.300773 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 12:31:36.301682 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 12:31:36.301768 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 12:31:37.211931 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.91 seconds
2021-10-15 12:31:37.213011 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 12:31:37.472850 (MainThread): Using snowflake connection "master".
2021-10-15 12:31:37.472850 (MainThread): On master: BEGIN
2021-10-15 12:31:37.473885 (MainThread): Opening a new connection, currently in state init
2021-10-15 12:31:38.203591 (MainThread): SQL status: SUCCESS 1 in 0.73 seconds
2021-10-15 12:31:38.204669 (MainThread): On master: COMMIT
2021-10-15 12:31:38.204669 (MainThread): Using snowflake connection "master".
2021-10-15 12:31:38.204669 (MainThread): On master: COMMIT
2021-10-15 12:31:38.465185 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-15 12:31:38.465185 (MainThread): On master: Close
2021-10-15 12:31:38.730113 (MainThread): 14:31:38 | Concurrency: 1 threads (target='dev')
2021-10-15 12:31:38.730113 (MainThread): 14:31:38 | 
2021-10-15 12:31:38.734181 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-15 12:31:38.734181 (Thread-1): 14:31:38 | 1 of 1 START incremental model dbt.dates............................. [RUN]
2021-10-15 12:31:38.735183 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:31:38.735183 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-15 12:31:38.739183 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 12:31:38.741607 (Thread-1): finished collecting timing info
2021-10-15 12:31:38.775866 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:31:38.776947 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-15 12:31:38.776947 (Thread-1): Opening a new connection, currently in state init
2021-10-15 12:31:40.986721 (Thread-1): SQL status: SUCCESS 1 in 2.21 seconds
2021-10-15 12:31:40.994759 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:31:40.994759 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-15 12:31:41.183964 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 12:31:41.187006 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:31:41.187006 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 12:31:41.336836 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 12:31:41.337516 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:31:41.337516 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 12:31:41.492648 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 12:31:41.504731 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 12:31:41.506963 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:31:41.506963 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-15 12:31:41.674851 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 12:31:41.674851 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:31:41.674851 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-15 12:31:42.066852 (Thread-1): SQL status: SUCCESS 0 in 0.39 seconds
2021-10-15 12:31:42.067853 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 12:31:42.067853 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 12:31:42.067853 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 12:31:42.290449 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-15 12:31:42.302130 (Thread-1): finished collecting timing info
2021-10-15 12:31:42.302130 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-15 12:31:42.564456 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eeca5d9-388d-4660-a933-72ef74322ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002647B74F6A0>]}
2021-10-15 12:31:42.565455 (Thread-1): 14:31:42 | 1 of 1 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.83s]
2021-10-15 12:31:42.566376 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-15 12:31:42.567375 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 12:31:42.567375 (MainThread): Using snowflake connection "master".
2021-10-15 12:31:42.567375 (MainThread): On master: BEGIN
2021-10-15 12:31:42.568453 (MainThread): Opening a new connection, currently in state closed
2021-10-15 12:31:43.348832 (MainThread): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-15 12:31:43.348832 (MainThread): On master: COMMIT
2021-10-15 12:31:43.348832 (MainThread): Using snowflake connection "master".
2021-10-15 12:31:43.348832 (MainThread): On master: COMMIT
2021-10-15 12:31:43.632090 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-15 12:31:43.633069 (MainThread): On master: Close
2021-10-15 12:31:43.900863 (MainThread): 14:31:43 | 
2021-10-15 12:31:43.901714 (MainThread): 14:31:43 | Finished running 1 incremental model in 9.10s.
2021-10-15 12:31:43.903215 (MainThread): Connection 'master' was properly closed.
2021-10-15 12:31:43.903215 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 12:31:43.903215 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 12:31:43.903215 (MainThread): Connection 'model.lukeclarke_learn_dbt.dates' was properly closed.
2021-10-15 12:31:43.919864 (MainThread): 
2021-10-15 12:31:43.920870 (MainThread): Completed successfully
2021-10-15 12:31:43.922109 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-15 12:31:43.922999 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002647B46D3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002647B40EB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002647B6F0700>]}
2021-10-15 12:31:43.923497 (MainThread): Flushing usage events
2021-10-15 13:39:33.505094 (MainThread): Running with dbt=0.20.2
2021-10-15 13:39:34.171556 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 13:39:34.172557 (MainThread): Tracking: tracking
2021-10-15 13:39:34.172557 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144D1C5CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144D319B400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144D319BF40>]}
2021-10-15 13:39:34.179574 (MainThread): Partial parsing not enabled
2021-10-15 13:39:34.196872 (MainThread): Parsing macros\adapters.sql
2021-10-15 13:39:34.215122 (MainThread): Parsing macros\catalog.sql
2021-10-15 13:39:34.216705 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 13:39:34.221768 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 13:39:34.222767 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 13:39:34.225736 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 13:39:34.226734 (MainThread): Parsing macros\core.sql
2021-10-15 13:39:34.228753 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 13:39:34.268996 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 13:39:34.275893 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 13:39:34.276894 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 13:39:34.281933 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 13:39:34.284976 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 13:39:34.286375 (MainThread): Parsing macros\etc\query.sql
2021-10-15 13:39:34.287373 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 13:39:34.295650 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 13:39:34.300730 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 13:39:34.311695 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 13:39:34.312650 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 13:39:34.318731 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 13:39:34.334495 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 13:39:34.357356 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 13:39:34.358379 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 13:39:34.372885 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 13:39:34.377884 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 13:39:34.381806 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 13:39:34.385881 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 13:39:34.388431 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 13:39:34.389430 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 13:39:34.391434 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 13:39:34.521402 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:39:34.529802 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:39:34.531715 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:39:34.533792 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:39:34.534790 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:39:34.536784 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:39:34.538792 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:39:34.546833 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:39:34.556830 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 13:39:34.558916 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:39:34.559827 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 13:39:34.561915 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:39:34.566914 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-15 13:39:34.568921 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-15 13:39:34.569912 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-15 13:39:34.621305 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:39:34.622299 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:39:34.629302 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:39:34.630302 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:39:34.631306 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:39:34.632299 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:39:34.634488 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:39:34.635592 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:39:34.643581 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:39:34.643581 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:39:34.661421 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f312b94-909e-45fb-933a-528f1e0b20c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144D329CFA0>]}
2021-10-15 13:39:34.678940 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 13:39:34.679991 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f312b94-909e-45fb-933a-528f1e0b20c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144D3210640>]}
2021-10-15 13:39:34.679991 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 151 macros, 3 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 13:39:34.681552 (MainThread): 
2021-10-15 13:39:34.682589 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 13:39:34.684038 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 13:39:34.693479 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 13:39:34.693479 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 13:39:34.693479 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 13:39:35.884392 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.19 seconds
2021-10-15 13:39:35.888766 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 13:39:36.135372 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 13:39:36.140005 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 13:39:36.140131 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 13:39:36.140175 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 13:39:37.069975 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.93 seconds
2021-10-15 13:39:37.070979 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 13:39:37.320366 (MainThread): Using snowflake connection "master".
2021-10-15 13:39:37.321377 (MainThread): On master: BEGIN
2021-10-15 13:39:37.321377 (MainThread): Opening a new connection, currently in state init
2021-10-15 13:39:38.029286 (MainThread): SQL status: SUCCESS 1 in 0.71 seconds
2021-10-15 13:39:38.030347 (MainThread): On master: COMMIT
2021-10-15 13:39:38.030347 (MainThread): Using snowflake connection "master".
2021-10-15 13:39:38.030347 (MainThread): On master: COMMIT
2021-10-15 13:39:38.293047 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-15 13:39:38.294062 (MainThread): On master: Close
2021-10-15 13:39:38.599909 (MainThread): 15:39:38 | Concurrency: 1 threads (target='dev')
2021-10-15 13:39:38.600062 (MainThread): 15:39:38 | 
2021-10-15 13:39:38.604115 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:39:38.604115 (Thread-1): 15:39:38 | 1 of 7 START table model dbt.first_model............................. [RUN]
2021-10-15 13:39:38.605118 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:39:38.605118 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:39:38.607626 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 13:39:38.612822 (Thread-1): finished collecting timing info
2021-10-15 13:39:38.637681 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 13:39:38.639663 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:39:38.639663 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 13:39:38.639663 (Thread-1): Opening a new connection, currently in state init
2021-10-15 13:39:39.338943 (Thread-1): SQL status: SUCCESS 1 in 0.70 seconds
2021-10-15 13:39:39.339943 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:39:39.339943 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all   
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 13:39:40.781832 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-10-15 13:39:40.782830 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 13:39:40.782830 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:39:40.782830 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 13:39:40.930255 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 13:39:40.937254 (Thread-1): finished collecting timing info
2021-10-15 13:39:40.937254 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 13:39:41.187134 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f312b94-909e-45fb-933a-528f1e0b20c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144D3494400>]}
2021-10-15 13:39:41.188139 (Thread-1): 15:39:41 | 1 of 7 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.58s]
2021-10-15 13:39:41.189495 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:39:41.189495 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:39:41.189495 (Thread-1): 15:39:41 | 2 of 7 START table model dbt.cul_order_price......................... [RUN]
2021-10-15 13:39:41.191066 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:39:41.191066 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:39:41.193099 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 13:39:41.195100 (Thread-1): finished collecting timing info
2021-10-15 13:39:41.196088 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 13:39:41.198098 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:39:41.198098 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-15 13:39:41.198098 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:39:41.911493 (Thread-1): SQL status: SUCCESS 1 in 0.71 seconds
2021-10-15 13:39:41.911493 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:39:41.911493 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-15 13:39:43.813971 (Thread-1): SQL status: SUCCESS 1 in 1.90 seconds
2021-10-15 13:39:43.814974 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 13:39:43.815979 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:39:43.815979 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 13:39:43.974417 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:39:43.975429 (Thread-1): finished collecting timing info
2021-10-15 13:39:43.975429 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-15 13:39:44.238913 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f312b94-909e-45fb-933a-528f1e0b20c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144D3494250>]}
2021-10-15 13:39:44.239916 (Thread-1): 15:39:44 | 2 of 7 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.05s]
2021-10-15 13:39:44.240914 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:39:44.241919 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-15 13:39:44.241919 (Thread-1): 15:39:44 | 3 of 7 START incremental model dbt.dates............................. [RUN]
2021-10-15 13:39:44.242915 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:39:44.242915 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-15 13:39:44.251351 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 13:39:44.255352 (Thread-1): finished collecting timing info
2021-10-15 13:39:44.269534 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:39:44.269534 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-15 13:39:44.269534 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:39:45.463196 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2021-10-15 13:39:45.469196 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:39:45.469196 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-15 13:39:45.644170 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 13:39:45.646218 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:39:45.647130 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 13:39:45.794968 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 13:39:45.796968 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:39:45.796968 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 13:39:45.940530 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:39:45.951678 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 13:39:45.954095 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:39:45.954095 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-15 13:39:46.145951 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 13:39:46.145951 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:39:46.145951 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-15 13:39:46.499902 (Thread-1): SQL status: SUCCESS 0 in 0.35 seconds
2021-10-15 13:39:46.501013 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 13:39:46.501013 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:39:46.501013 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 13:39:46.759364 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-15 13:39:46.760052 (Thread-1): finished collecting timing info
2021-10-15 13:39:46.760180 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-15 13:39:47.075097 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f312b94-909e-45fb-933a-528f1e0b20c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144D3266760>]}
2021-10-15 13:39:47.075097 (Thread-1): 15:39:47 | 3 of 7 OK created incremental model dbt.dates........................ [SUCCESS 0 in 2.83s]
2021-10-15 13:39:47.076097 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-15 13:39:47.076097 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:39:47.077219 (Thread-1): 15:39:47 | 4 of 7 START view model dbt.playing_with_tests....................... [RUN]
2021-10-15 13:39:47.077675 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:39:47.077675 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:39:47.078846 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 13:39:47.080476 (Thread-1): finished collecting timing info
2021-10-15 13:39:47.090481 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 13:39:47.092148 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:39:47.092148 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-15 13:39:47.092148 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:39:47.977360 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-10-15 13:39:47.978809 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:39:47.978809 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */

  create or replace  view analytics.dbt.playing_with_tests  as (
    SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF001"."CUSTOMER"
  );
2021-10-15 13:39:48.339183 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-15 13:39:48.341183 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 13:39:48.341183 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:39:48.341183 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 13:39:48.488801 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 13:39:48.489784 (Thread-1): finished collecting timing info
2021-10-15 13:39:48.490781 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-15 13:39:48.739987 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f312b94-909e-45fb-933a-528f1e0b20c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144D36398B0>]}
2021-10-15 13:39:48.740292 (Thread-1): 15:39:48 | 4 of 7 OK created view model dbt.playing_with_tests.................. [SUCCESS 1 in 1.66s]
2021-10-15 13:39:48.741255 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:39:48.741339 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:39:48.741617 (Thread-1): 15:39:48 | 5 of 7 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-15 13:39:48.742145 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:39:48.742191 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:39:48.743196 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 13:39:48.750120 (Thread-1): finished collecting timing info
2021-10-15 13:39:48.752741 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 13:39:48.755445 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:39:48.755536 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-15 13:39:48.755536 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:39:49.650039 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-10-15 13:39:49.650971 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:39:49.650971 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-15 13:39:51.261481 (Thread-1): SQL status: SUCCESS 1 in 1.61 seconds
2021-10-15 13:39:51.262475 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 13:39:51.262475 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:39:51.262475 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 13:39:51.421520 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:39:51.422345 (Thread-1): finished collecting timing info
2021-10-15 13:39:51.422545 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-15 13:39:51.691419 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f312b94-909e-45fb-933a-528f1e0b20c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144D3632BE0>]}
2021-10-15 13:39:51.692415 (Thread-1): 15:39:51 | 5 of 7 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.95s]
2021-10-15 13:39:51.693417 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:39:51.693417 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-15 13:39:51.694429 (Thread-1): 15:39:51 | 6 of 7 START incremental model dbt.time.............................. [RUN]
2021-10-15 13:39:51.694663 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:39:51.694663 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-15 13:39:51.696767 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 13:39:51.698340 (Thread-1): finished collecting timing info
2021-10-15 13:39:51.700347 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:39:51.700347 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-15 13:39:51.700347 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:39:53.243045 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2021-10-15 13:39:53.246142 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:39:53.246142 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-15 13:39:53.410591 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:39:53.412238 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:39:53.412377 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 13:39:53.550834 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:39:53.553828 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:39:53.553828 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 13:39:53.702481 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 13:39:53.704882 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 13:39:53.708263 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:39:53.708438 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-15 13:39:53.879699 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 13:39:53.879699 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:39:53.879699 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-15 13:39:54.460260 (Thread-1): SQL status: SUCCESS 866 in 0.58 seconds
2021-10-15 13:39:54.462255 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 13:39:54.462255 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:39:54.462255 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 13:39:54.875102 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-10-15 13:39:54.877099 (Thread-1): finished collecting timing info
2021-10-15 13:39:54.878101 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-15 13:39:55.154923 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f312b94-909e-45fb-933a-528f1e0b20c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144D3174640>]}
2021-10-15 13:39:55.155941 (Thread-1): 15:39:55 | 6 of 7 OK created incremental model dbt.time......................... [SUCCESS 866 in 3.46s]
2021-10-15 13:39:55.156912 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-15 13:39:55.156912 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:39:55.157933 (Thread-1): 15:39:55 | 7 of 7 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-15 13:39:55.157933 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:39:55.158924 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:39:55.163016 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 13:39:55.164481 (Thread-1): finished collecting timing info
2021-10-15 13:39:55.165313 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 13:39:55.167125 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:39:55.167125 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-15 13:39:55.167125 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:39:55.851409 (Thread-1): SQL status: SUCCESS 1 in 0.68 seconds
2021-10-15 13:39:55.851409 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:39:55.851409 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-15 13:39:56.880056 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-10-15 13:39:56.881055 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 13:39:56.881055 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:39:56.881055 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 13:39:57.021203 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:39:57.022194 (Thread-1): finished collecting timing info
2021-10-15 13:39:57.022194 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-15 13:39:57.282095 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f312b94-909e-45fb-933a-528f1e0b20c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144D3606A90>]}
2021-10-15 13:39:57.282095 (Thread-1): 15:39:57 | 7 of 7 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.12s]
2021-10-15 13:39:57.283091 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:39:57.284091 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 13:39:57.284091 (MainThread): Using snowflake connection "master".
2021-10-15 13:39:57.284091 (MainThread): On master: BEGIN
2021-10-15 13:39:57.284091 (MainThread): Opening a new connection, currently in state closed
2021-10-15 13:39:58.185645 (MainThread): SQL status: SUCCESS 1 in 0.90 seconds
2021-10-15 13:39:58.185645 (MainThread): On master: COMMIT
2021-10-15 13:39:58.185645 (MainThread): Using snowflake connection "master".
2021-10-15 13:39:58.185645 (MainThread): On master: COMMIT
2021-10-15 13:39:58.452387 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-15 13:39:58.452387 (MainThread): 15:39:58 | 
2021-10-15 13:39:58.453315 (MainThread): 15:39:58 | Running 3 on-run-end hooks
2021-10-15 13:39:58.454396 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-15 13:39:58.455387 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-15 13:39:58.458099 (MainThread): 15:39:58 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-15 13:39:58.459122 (MainThread): Using snowflake connection "master".
2021-10-15 13:39:58.459122 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-15 13:39:58.612629 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 13:39:58.613728 (MainThread): 15:39:58 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.16s]
2021-10-15 13:39:58.614648 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-15 13:39:58.616724 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-15 13:39:58.617650 (MainThread): 15:39:58 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-15 13:39:58.618651 (MainThread): Using snowflake connection "master".
2021-10-15 13:39:58.618651 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-15 13:39:58.851106 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-15 13:39:58.852119 (MainThread): 15:39:58 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.23s]
2021-10-15 13:39:58.854119 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-15 13:39:58.855119 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-15 13:39:58.857117 (MainThread): 15:39:58 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-15 13:39:58.857117 (MainThread): Using snowflake connection "master".
2021-10-15 13:39:58.857117 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-15 13:39:59.064032 (MainThread): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-15 13:39:59.064032 (MainThread): 15:39:59 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.21s]
2021-10-15 13:39:59.065758 (MainThread): 15:39:59 | 
2021-10-15 13:39:59.065758 (MainThread): On master: Close
2021-10-15 13:39:59.318465 (MainThread): 15:39:59 | 
2021-10-15 13:39:59.319465 (MainThread): 15:39:59 | Finished running 4 table models, 2 incremental models, 1 view model, 3 hooks in 24.64s.
2021-10-15 13:39:59.321853 (MainThread): Connection 'master' was properly closed.
2021-10-15 13:39:59.321853 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 13:39:59.321853 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 13:39:59.321853 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-15 13:39:59.335571 (MainThread): 
2021-10-15 13:39:59.335571 (MainThread): Completed successfully
2021-10-15 13:39:59.335571 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-15 13:39:59.335571 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144D3655B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144D319D3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144D3606A90>]}
2021-10-15 13:39:59.337003 (MainThread): Flushing usage events
2021-10-15 13:46:41.841492 (MainThread): Running with dbt=0.20.2
2021-10-15 13:46:42.424636 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 13:46:42.425638 (MainThread): Tracking: tracking
2021-10-15 13:46:42.425638 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A4C1FCE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A4D73CB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A4D73C9A0>]}
2021-10-15 13:46:42.431557 (MainThread): Partial parsing not enabled
2021-10-15 13:46:42.445953 (MainThread): Parsing macros\adapters.sql
2021-10-15 13:46:42.465654 (MainThread): Parsing macros\catalog.sql
2021-10-15 13:46:42.466658 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 13:46:42.472035 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 13:46:42.473009 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 13:46:42.475015 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 13:46:42.476009 (MainThread): Parsing macros\core.sql
2021-10-15 13:46:42.478012 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 13:46:42.511857 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 13:46:42.517489 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 13:46:42.518516 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 13:46:42.519543 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 13:46:42.520530 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 13:46:42.521528 (MainThread): Parsing macros\etc\query.sql
2021-10-15 13:46:42.522434 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 13:46:42.529513 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 13:46:42.534419 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 13:46:42.544419 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 13:46:42.546433 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 13:46:42.552028 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 13:46:42.567437 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 13:46:42.589797 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 13:46:42.590736 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 13:46:42.604023 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 13:46:42.609323 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 13:46:42.612198 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 13:46:42.617267 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 13:46:42.618262 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 13:46:42.619275 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 13:46:42.620265 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 13:46:42.750902 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:46:42.757906 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:46:42.761281 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:46:42.763370 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:46:42.765365 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:46:42.769381 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:46:42.772297 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:46:42.779591 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:46:42.789792 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 13:46:42.791890 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:46:42.793032 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 13:46:42.795390 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:46:42.847864 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:46:42.849615 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:46:42.856698 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:46:42.856698 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:46:42.858236 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:46:42.860041 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:46:42.861034 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:46:42.862564 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:46:42.870969 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:46:42.870969 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:46:42.890464 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cb7b73b-a9c2-4b00-96a0-671d245fdd39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A4D7B2790>]}
2021-10-15 13:46:42.902674 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 13:46:42.903671 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cb7b73b-a9c2-4b00-96a0-671d245fdd39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A4D7B6AF0>]}
2021-10-15 13:46:42.903671 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 13:46:42.904657 (MainThread): 
2021-10-15 13:46:42.905653 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 13:46:42.906652 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 13:46:42.914812 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 13:46:42.914812 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 13:46:42.916050 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 13:46:44.093077 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.18 seconds
2021-10-15 13:46:44.095430 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 13:46:44.340353 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 13:46:44.348399 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 13:46:44.348399 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 13:46:44.349434 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 13:46:44.985616 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.64 seconds
2021-10-15 13:46:44.987621 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 13:46:45.267734 (MainThread): Using snowflake connection "master".
2021-10-15 13:46:45.267734 (MainThread): On master: BEGIN
2021-10-15 13:46:45.267734 (MainThread): Opening a new connection, currently in state init
2021-10-15 13:46:46.056727 (MainThread): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-15 13:46:46.056727 (MainThread): On master: COMMIT
2021-10-15 13:46:46.056727 (MainThread): Using snowflake connection "master".
2021-10-15 13:46:46.056727 (MainThread): On master: COMMIT
2021-10-15 13:46:46.302890 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-15 13:46:46.302890 (MainThread): On master: Close
2021-10-15 13:46:46.576811 (MainThread): 15:46:46 | Concurrency: 1 threads (target='dev')
2021-10-15 13:46:46.576811 (MainThread): 15:46:46 | 
2021-10-15 13:46:46.580474 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:46:46.581105 (Thread-1): 15:46:46 | 1 of 7 START table model dbt.first_model............................. [RUN]
2021-10-15 13:46:46.582103 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:46:46.582605 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:46:46.586670 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 13:46:46.593652 (Thread-1): finished collecting timing info
2021-10-15 13:46:46.625105 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 13:46:46.627320 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:46:46.627320 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 13:46:46.627932 (Thread-1): Opening a new connection, currently in state init
2021-10-15 13:46:47.533696 (Thread-1): SQL status: SUCCESS 1 in 0.91 seconds
2021-10-15 13:46:47.534321 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:46:47.534393 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all   
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 13:46:48.973111 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-10-15 13:46:48.974219 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:46:48.975572 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:46:48.975572 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */

        grant select on analytics.dbt.first_model to role analyst
2021-10-15 13:46:49.341798 (Thread-1): Snowflake query id: 019fa01a-0601-3e3f-0000-00664703f359
2021-10-15 13:46:49.341798 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 16 unexpected 'a'.
2021-10-15 13:46:49.342713 (Thread-1): finished collecting timing info
2021-10-15 13:46:49.342713 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: ROLLBACK
2021-10-15 13:46:49.487524 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 13:46:49.740008 (Thread-1): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 16 unexpected 'a'.
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 16 unexpected 'a'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 73, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 16 unexpected 'a'.
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-15 13:46:49.747010 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cb7b73b-a9c2-4b00-96a0-671d245fdd39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A4D8202B0>]}
2021-10-15 13:46:49.747010 (Thread-1): 15:46:49 | 1 of 7 ERROR creating table model dbt.first_model.................... [ERROR in 3.17s]
2021-10-15 13:46:49.748579 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:46:49.748579 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:46:49.750596 (Thread-1): 15:46:49 | 2 of 7 START table model dbt.cul_order_price......................... [RUN]
2021-10-15 13:46:49.751594 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:46:49.751594 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:46:49.753595 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 13:46:49.754594 (Thread-1): finished collecting timing info
2021-10-15 13:46:49.756593 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 13:46:49.758698 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:46:49.758698 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-15 13:46:49.758698 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:46:50.426994 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-10-15 13:46:50.426994 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:46:50.426994 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-15 13:46:52.611111 (Thread-1): SQL status: SUCCESS 1 in 2.18 seconds
2021-10-15 13:46:52.612125 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:46:52.612125 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:46:52.613159 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */

        grant select on analytics.dbt.cul_order_price to role analyst
2021-10-15 13:46:52.826408 (Thread-1): Snowflake query id: 019fa01a-0601-3e3f-0000-00664703f365
2021-10-15 13:46:52.827413 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 16 unexpected 'a'.
2021-10-15 13:46:52.827413 (Thread-1): finished collecting timing info
2021-10-15 13:46:52.827413 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: ROLLBACK
2021-10-15 13:46:52.973740 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-15 13:46:53.234179 (Thread-1): Database Error in model cul_order_price (models\example\cul_order_price.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 16 unexpected 'a'.
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\cul_order_price.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 16 unexpected 'a'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 73, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model cul_order_price (models\example\cul_order_price.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 16 unexpected 'a'.
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\cul_order_price.sql
2021-10-15 13:46:53.234684 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cb7b73b-a9c2-4b00-96a0-671d245fdd39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A4D7E87F0>]}
2021-10-15 13:46:53.236052 (Thread-1): 15:46:53 | 2 of 7 ERROR creating table model dbt.cul_order_price................ [ERROR in 3.48s]
2021-10-15 13:46:53.236413 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:46:53.237419 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-15 13:46:53.237419 (Thread-1): 15:46:53 | 3 of 7 START incremental model dbt.dates............................. [RUN]
2021-10-15 13:46:53.237419 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:46:53.237419 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-15 13:46:53.242424 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 13:46:53.244418 (Thread-1): finished collecting timing info
2021-10-15 13:46:53.261419 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:46:53.261419 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-15 13:46:53.261419 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:46:55.105745 (Thread-1): SQL status: SUCCESS 1 in 1.84 seconds
2021-10-15 13:46:55.116640 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:46:55.116640 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-15 13:46:55.277040 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:46:55.281034 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:46:55.281034 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 13:46:55.455161 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 13:46:55.457178 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:46:55.457178 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 13:46:55.602869 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 13:46:55.616221 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 13:46:55.618039 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:46:55.618039 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-15 13:46:55.811323 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 13:46:55.811323 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:46:55.812322 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-15 13:46:56.215653 (Thread-1): SQL status: SUCCESS 0 in 0.40 seconds
2021-10-15 13:46:56.216654 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 13:46:56.216654 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:46:56.216654 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 13:46:56.547556 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-15 13:46:56.557116 (Thread-1): finished collecting timing info
2021-10-15 13:46:56.557116 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-15 13:46:56.835448 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cb7b73b-a9c2-4b00-96a0-671d245fdd39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A4D6F6D00>]}
2021-10-15 13:46:56.835448 (Thread-1): 15:46:56 | 3 of 7 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.60s]
2021-10-15 13:46:56.836654 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-15 13:46:56.836654 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:46:56.836654 (Thread-1): 15:46:56 | 4 of 7 START view model dbt.playing_with_tests....................... [RUN]
2021-10-15 13:46:56.836654 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:46:56.837684 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:46:56.838751 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 13:46:56.840741 (Thread-1): finished collecting timing info
2021-10-15 13:46:56.855522 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 13:46:56.861674 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:46:56.861674 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-15 13:46:56.861674 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:46:57.816464 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-10-15 13:46:57.816464 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:46:57.816464 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */

  create or replace  view analytics.dbt.playing_with_tests  as (
    SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF001"."CUSTOMER"
  );
2021-10-15 13:46:58.317093 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-10-15 13:46:58.319178 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 13:46:58.319178 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:46:58.319178 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 13:46:58.464137 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:46:58.465983 (Thread-1): finished collecting timing info
2021-10-15 13:46:58.467072 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-15 13:46:58.808048 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cb7b73b-a9c2-4b00-96a0-671d245fdd39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A4DB021F0>]}
2021-10-15 13:46:58.808048 (Thread-1): 15:46:58 | 4 of 7 OK created view model dbt.playing_with_tests.................. [SUCCESS 1 in 1.97s]
2021-10-15 13:46:58.809217 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:46:58.809217 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:46:58.809852 (Thread-1): 15:46:58 | 5 of 7 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-15 13:46:58.809852 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:46:58.809852 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:46:58.810865 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 13:46:58.817708 (Thread-1): finished collecting timing info
2021-10-15 13:46:58.819361 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 13:46:58.821670 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:46:58.821670 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-15 13:46:58.821670 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:46:59.987770 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2021-10-15 13:46:59.987770 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:46:59.987770 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-15 13:47:01.771262 (Thread-1): SQL status: SUCCESS 1 in 1.78 seconds
2021-10-15 13:47:01.773143 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:47:01.773143 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:47:01.773143 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */

        grant select on analytics.dbt.snowflake_customer_purchases to role analyst
2021-10-15 13:47:01.969016 (Thread-1): Snowflake query id: 019fa01b-0601-3e3f-0000-00664703f381
2021-10-15 13:47:01.969165 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 16 unexpected 'a'.
2021-10-15 13:47:01.969165 (Thread-1): finished collecting timing info
2021-10-15 13:47:01.969165 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: ROLLBACK
2021-10-15 13:47:02.238499 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-15 13:47:02.509473 (Thread-1): Database Error in model snowflake_customer_purchases (models\example\snowflake_customer_purchases.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 16 unexpected 'a'.
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\snowflake_customer_purchases.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 16 unexpected 'a'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 73, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_customer_purchases (models\example\snowflake_customer_purchases.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 16 unexpected 'a'.
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\snowflake_customer_purchases.sql
2021-10-15 13:47:02.511474 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cb7b73b-a9c2-4b00-96a0-671d245fdd39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A4DB02BB0>]}
2021-10-15 13:47:02.512410 (Thread-1): 15:47:02 | 5 of 7 ERROR creating table model dbt.snowflake_customer_purchases... [ERROR in 3.70s]
2021-10-15 13:47:02.514195 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:47:02.514693 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-15 13:47:02.515787 (Thread-1): 15:47:02 | 6 of 7 START incremental model dbt.time.............................. [RUN]
2021-10-15 13:47:02.516726 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:47:02.516726 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-15 13:47:02.525391 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 13:47:02.528729 (Thread-1): finished collecting timing info
2021-10-15 13:47:02.538549 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:47:02.538549 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-15 13:47:02.539763 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:47:04.258706 (Thread-1): SQL status: SUCCESS 1 in 1.72 seconds
2021-10-15 13:47:04.260796 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:47:04.261796 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-15 13:47:04.470215 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-15 13:47:04.472215 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:47:04.472215 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 13:47:04.630686 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:47:04.633684 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:47:04.633684 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 13:47:04.789399 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:47:04.790391 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 13:47:04.792316 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:47:04.792316 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-15 13:47:04.969725 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-15 13:47:04.969725 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:47:04.969725 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-15 13:47:05.717849 (Thread-1): SQL status: SUCCESS 430 in 0.75 seconds
2021-10-15 13:47:05.718848 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:47:05.719849 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:47:05.719849 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

        grant select on analytics.dbt.time to role analyst
2021-10-15 13:47:05.932119 (Thread-1): Snowflake query id: 019fa01b-0601-3e3f-0000-00664703f399
2021-10-15 13:47:05.932119 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 16 unexpected 'a'.
2021-10-15 13:47:05.932119 (Thread-1): finished collecting timing info
2021-10-15 13:47:05.932119 (Thread-1): On model.lukeclarke_learn_dbt.time: ROLLBACK
2021-10-15 13:47:06.221664 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-15 13:47:06.489048 (Thread-1): Database Error in model time (models\example\time.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 16 unexpected 'a'.
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\time.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 16 unexpected 'a'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 122, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 73, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model time (models\example\time.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 16 unexpected 'a'.
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\time.sql
2021-10-15 13:47:06.490045 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cb7b73b-a9c2-4b00-96a0-671d245fdd39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A4DC65310>]}
2021-10-15 13:47:06.491046 (Thread-1): 15:47:06 | 6 of 7 ERROR creating incremental model dbt.time..................... [ERROR in 3.97s]
2021-10-15 13:47:06.491046 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-15 13:47:06.491046 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:47:06.492045 (Thread-1): 15:47:06 | 7 of 7 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-10-15 13:47:06.493054 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:47:06.493517 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 13:47:06.493517 (MainThread): Using snowflake connection "master".
2021-10-15 13:47:06.494619 (MainThread): On master: BEGIN
2021-10-15 13:47:06.494619 (MainThread): Opening a new connection, currently in state closed
2021-10-15 13:47:07.222312 (MainThread): SQL status: SUCCESS 1 in 0.73 seconds
2021-10-15 13:47:07.222312 (MainThread): On master: COMMIT
2021-10-15 13:47:07.222312 (MainThread): Using snowflake connection "master".
2021-10-15 13:47:07.222312 (MainThread): On master: COMMIT
2021-10-15 13:47:07.478387 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-15 13:47:07.478387 (MainThread): On master: Close
2021-10-15 13:47:07.748007 (MainThread): 15:47:07 | 
2021-10-15 13:47:07.748007 (MainThread): 15:47:07 | Finished running 4 table models, 2 incremental models, 1 view model in 24.84s.
2021-10-15 13:47:07.750920 (MainThread): Connection 'master' was properly closed.
2021-10-15 13:47:07.751919 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 13:47:07.751919 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 13:47:07.751919 (MainThread): Connection 'model.lukeclarke_learn_dbt.time' was properly closed.
2021-10-15 13:47:07.766987 (MainThread): 
2021-10-15 13:47:07.766987 (MainThread): Completed with 4 errors and 0 warnings:
2021-10-15 13:47:07.767996 (MainThread): 
2021-10-15 13:47:07.771225 (MainThread): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-15 13:47:07.772788 (MainThread):   001003 (42000): SQL compilation error:
2021-10-15 13:47:07.772788 (MainThread):   syntax error line 1 at position 16 unexpected 'a'.
2021-10-15 13:47:07.774771 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-15 13:47:07.774771 (MainThread): 
2021-10-15 13:47:07.775777 (MainThread): Database Error in model cul_order_price (models\example\cul_order_price.sql)
2021-10-15 13:47:07.776776 (MainThread):   001003 (42000): SQL compilation error:
2021-10-15 13:47:07.776776 (MainThread):   syntax error line 1 at position 16 unexpected 'a'.
2021-10-15 13:47:07.777776 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\cul_order_price.sql
2021-10-15 13:47:07.777776 (MainThread): 
2021-10-15 13:47:07.778779 (MainThread): Database Error in model snowflake_customer_purchases (models\example\snowflake_customer_purchases.sql)
2021-10-15 13:47:07.778779 (MainThread):   001003 (42000): SQL compilation error:
2021-10-15 13:47:07.779777 (MainThread):   syntax error line 1 at position 16 unexpected 'a'.
2021-10-15 13:47:07.779777 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\snowflake_customer_purchases.sql
2021-10-15 13:47:07.779777 (MainThread): 
2021-10-15 13:47:07.780824 (MainThread): Database Error in model time (models\example\time.sql)
2021-10-15 13:47:07.781236 (MainThread):   001003 (42000): SQL compilation error:
2021-10-15 13:47:07.782255 (MainThread):   syntax error line 1 at position 16 unexpected 'a'.
2021-10-15 13:47:07.783276 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\time.sql
2021-10-15 13:47:07.784336 (MainThread): 
Done. PASS=2 WARN=0 ERROR=4 SKIP=1 TOTAL=7
2021-10-15 13:47:07.784336 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A4DCBF9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A4DCA79D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A4DCA75E0>]}
2021-10-15 13:47:07.784336 (MainThread): Flushing usage events
2021-10-15 13:49:37.609146 (MainThread): Running with dbt=0.20.2
2021-10-15 13:49:38.217437 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 13:49:38.218438 (MainThread): Tracking: tracking
2021-10-15 13:49:38.218438 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001813CAEBEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001813E038760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001813E038E80>]}
2021-10-15 13:49:38.225535 (MainThread): Partial parsing not enabled
2021-10-15 13:49:38.241256 (MainThread): Parsing macros\adapters.sql
2021-10-15 13:49:38.262728 (MainThread): Parsing macros\catalog.sql
2021-10-15 13:49:38.263730 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 13:49:38.270724 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 13:49:38.271669 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 13:49:38.275013 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 13:49:38.275013 (MainThread): Parsing macros\core.sql
2021-10-15 13:49:38.278027 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 13:49:38.307173 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 13:49:38.312173 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 13:49:38.312173 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 13:49:38.313174 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 13:49:38.314174 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 13:49:38.315174 (MainThread): Parsing macros\etc\query.sql
2021-10-15 13:49:38.316173 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 13:49:38.322076 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 13:49:38.325076 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 13:49:38.333603 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 13:49:38.334705 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 13:49:38.338778 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 13:49:38.352179 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 13:49:38.369541 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 13:49:38.370541 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 13:49:38.380659 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 13:49:38.384735 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 13:49:38.387735 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 13:49:38.391734 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 13:49:38.392735 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 13:49:38.393736 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 13:49:38.394736 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 13:49:38.502322 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:49:38.508673 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:49:38.512670 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:49:38.513674 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:49:38.515664 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:49:38.519894 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:49:38.521979 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:49:38.528981 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:49:38.539114 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 13:49:38.541119 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:49:38.542119 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 13:49:38.544113 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:49:38.593966 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:49:38.595120 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:49:38.602266 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:49:38.602266 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:49:38.603248 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:49:38.605263 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:49:38.606249 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:49:38.607249 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:49:38.615780 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:49:38.615780 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:49:38.636050 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b75b215a-2c41-4cfe-ab80-990f0cb6ecdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001813E114B20>]}
2021-10-15 13:49:38.654628 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 13:49:38.655847 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b75b215a-2c41-4cfe-ab80-990f0cb6ecdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001813E1141C0>]}
2021-10-15 13:49:38.655847 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 13:49:38.657468 (MainThread): 
2021-10-15 13:49:38.658594 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 13:49:38.659714 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 13:49:38.674165 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 13:49:38.674165 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 13:49:38.674696 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 13:49:39.972166 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.30 seconds
2021-10-15 13:49:39.975662 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 13:49:40.277544 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 13:49:40.283540 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 13:49:40.283540 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 13:49:40.283540 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 13:49:40.977121 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.69 seconds
2021-10-15 13:49:40.978158 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 13:49:41.254480 (MainThread): Using snowflake connection "master".
2021-10-15 13:49:41.254480 (MainThread): On master: BEGIN
2021-10-15 13:49:41.254480 (MainThread): Opening a new connection, currently in state init
2021-10-15 13:49:42.167239 (MainThread): SQL status: SUCCESS 1 in 0.91 seconds
2021-10-15 13:49:42.168239 (MainThread): On master: COMMIT
2021-10-15 13:49:42.168239 (MainThread): Using snowflake connection "master".
2021-10-15 13:49:42.168239 (MainThread): On master: COMMIT
2021-10-15 13:49:42.402595 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-15 13:49:42.403667 (MainThread): On master: Close
2021-10-15 13:49:42.676771 (MainThread): 15:49:42 | Concurrency: 1 threads (target='dev')
2021-10-15 13:49:42.677274 (MainThread): 15:49:42 | 
2021-10-15 13:49:42.684305 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:49:42.684305 (Thread-1): 15:49:42 | 1 of 7 START table model dbt.first_model............................. [RUN]
2021-10-15 13:49:42.685551 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:49:42.685551 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:49:42.687657 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 13:49:42.694564 (Thread-1): finished collecting timing info
2021-10-15 13:49:42.713560 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 13:49:42.716550 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:49:42.716550 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 13:49:42.716550 (Thread-1): Opening a new connection, currently in state init
2021-10-15 13:49:43.406842 (Thread-1): SQL status: SUCCESS 1 in 0.69 seconds
2021-10-15 13:49:43.406842 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:49:43.406842 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all   
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 13:49:44.423073 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-15 13:49:44.427074 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:49:44.428077 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:49:44.428077 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */

        grant select on analytics.dbt.first_model to role analyst
2021-10-15 13:49:44.597623 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 13:49:44.598643 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 13:49:44.598643 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:49:44.598643 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 13:49:44.742668 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:49:44.750789 (Thread-1): finished collecting timing info
2021-10-15 13:49:44.750988 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 13:49:45.014864 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b75b215a-2c41-4cfe-ab80-990f0cb6ecdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001813E444490>]}
2021-10-15 13:49:45.014864 (Thread-1): 15:49:45 | 1 of 7 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.33s]
2021-10-15 13:49:45.015946 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:49:45.015946 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:49:45.016955 (Thread-1): 15:49:45 | 2 of 7 START table model dbt.cul_order_price......................... [RUN]
2021-10-15 13:49:45.016955 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:49:45.017958 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:49:45.018954 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 13:49:45.020954 (Thread-1): finished collecting timing info
2021-10-15 13:49:45.021956 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 13:49:45.023953 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:49:45.023953 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-15 13:49:45.023953 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:49:45.700139 (Thread-1): SQL status: SUCCESS 1 in 0.68 seconds
2021-10-15 13:49:45.700139 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:49:45.700139 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-15 13:49:47.138783 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-10-15 13:49:47.140783 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:49:47.140783 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:49:47.140783 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */

        grant select on analytics.dbt.cul_order_price to role analyst
2021-10-15 13:49:47.297128 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:49:47.299124 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 13:49:47.299124 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:49:47.299124 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 13:49:47.443151 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:49:47.445518 (Thread-1): finished collecting timing info
2021-10-15 13:49:47.446165 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-15 13:49:47.682108 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b75b215a-2c41-4cfe-ab80-990f0cb6ecdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001813E3550D0>]}
2021-10-15 13:49:47.683107 (Thread-1): 15:49:47 | 2 of 7 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.67s]
2021-10-15 13:49:47.684107 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:49:47.684107 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-15 13:49:47.684107 (Thread-1): 15:49:47 | 3 of 7 START incremental model dbt.dates............................. [RUN]
2021-10-15 13:49:47.684107 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:49:47.684107 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-15 13:49:47.688107 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 13:49:47.690107 (Thread-1): finished collecting timing info
2021-10-15 13:49:47.706151 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:49:47.707139 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-15 13:49:47.707139 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:49:48.842416 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2021-10-15 13:49:48.851398 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:49:48.851398 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-15 13:49:49.002219 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 13:49:49.005208 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:49:49.005208 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 13:49:49.140138 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-10-15 13:49:49.142739 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:49:49.142739 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 13:49:49.279715 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:49:49.295318 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 13:49:49.297354 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:49:49.297354 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-15 13:49:49.469201 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 13:49:49.469201 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:49:49.469201 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-15 13:49:49.822435 (Thread-1): SQL status: SUCCESS 0 in 0.35 seconds
2021-10-15 13:49:49.824523 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 13:49:49.824523 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:49:49.824523 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 13:49:50.049020 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-15 13:49:50.049525 (Thread-1): finished collecting timing info
2021-10-15 13:49:50.049525 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-15 13:49:50.301487 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b75b215a-2c41-4cfe-ab80-990f0cb6ecdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001813E0DF100>]}
2021-10-15 13:49:50.301487 (Thread-1): 15:49:50 | 3 of 7 OK created incremental model dbt.dates........................ [SUCCESS 0 in 2.62s]
2021-10-15 13:49:50.303368 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-15 13:49:50.303368 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:49:50.303368 (Thread-1): 15:49:50 | 4 of 7 START view model dbt.playing_with_tests....................... [RUN]
2021-10-15 13:49:50.304380 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:49:50.304380 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:49:50.305453 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 13:49:50.307759 (Thread-1): finished collecting timing info
2021-10-15 13:49:50.323394 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 13:49:50.329494 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:49:50.329494 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-15 13:49:50.329494 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:49:51.196270 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-15 13:49:51.197282 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:49:51.197282 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */

  create or replace  view analytics.dbt.playing_with_tests  as (
    SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF001"."CUSTOMER"
  );
2021-10-15 13:49:51.848088 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2021-10-15 13:49:51.849089 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 13:49:51.850089 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:49:51.850089 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 13:49:51.989074 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:49:51.990072 (Thread-1): finished collecting timing info
2021-10-15 13:49:51.991070 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-15 13:49:52.330356 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b75b215a-2c41-4cfe-ab80-990f0cb6ecdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001813E4AB7F0>]}
2021-10-15 13:49:52.331352 (Thread-1): 15:49:52 | 4 of 7 OK created view model dbt.playing_with_tests.................. [SUCCESS 1 in 2.03s]
2021-10-15 13:49:52.333148 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:49:52.334167 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:49:52.334167 (Thread-1): 15:49:52 | 5 of 7 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-15 13:49:52.334167 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:49:52.335165 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:49:52.336165 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 13:49:52.343537 (Thread-1): finished collecting timing info
2021-10-15 13:49:52.344614 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 13:49:52.346617 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:49:52.346617 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-15 13:49:52.346617 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:49:53.093849 (Thread-1): SQL status: SUCCESS 1 in 0.75 seconds
2021-10-15 13:49:53.093849 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:49:53.093849 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-15 13:49:54.782288 (Thread-1): SQL status: SUCCESS 1 in 1.69 seconds
2021-10-15 13:49:54.783321 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:49:54.783321 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:49:54.783321 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */

        grant select on analytics.dbt.snowflake_customer_purchases to role analyst
2021-10-15 13:49:54.983393 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-15 13:49:54.984399 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 13:49:54.985402 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:49:54.985402 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 13:49:55.129644 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:49:55.130573 (Thread-1): finished collecting timing info
2021-10-15 13:49:55.130573 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-15 13:49:55.407559 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b75b215a-2c41-4cfe-ab80-990f0cb6ecdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001813E3E6F10>]}
2021-10-15 13:49:55.407559 (Thread-1): 15:49:55 | 5 of 7 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.07s]
2021-10-15 13:49:55.407559 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:49:55.408544 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-15 13:49:55.408544 (Thread-1): 15:49:55 | 6 of 7 START incremental model dbt.time.............................. [RUN]
2021-10-15 13:49:55.409399 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:49:55.409399 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-15 13:49:55.411440 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 13:49:55.412421 (Thread-1): finished collecting timing info
2021-10-15 13:49:55.415380 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:49:55.415380 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-15 13:49:55.415380 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:49:57.126102 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2021-10-15 13:49:57.127176 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:49:57.127176 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-15 13:49:57.297096 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 13:49:57.300096 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:49:57.300096 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 13:49:57.465442 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 13:49:57.466441 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:49:57.466441 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 13:49:57.614736 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 13:49:57.616736 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 13:49:57.617791 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:49:57.617791 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-15 13:49:57.838448 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-15 13:49:57.838448 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:49:57.838448 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-15 13:49:58.444968 (Thread-1): SQL status: SUCCESS 603 in 0.61 seconds
2021-10-15 13:49:58.447083 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:49:58.447083 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:49:58.447083 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

        grant select on analytics.dbt.time to role analyst
2021-10-15 13:49:58.772022 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-15 13:49:58.773043 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 13:49:58.773043 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:49:58.773043 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 13:49:59.205314 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-10-15 13:49:59.207308 (Thread-1): finished collecting timing info
2021-10-15 13:49:59.207308 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-15 13:49:59.498009 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b75b215a-2c41-4cfe-ab80-990f0cb6ecdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001813E323B80>]}
2021-10-15 13:49:59.498009 (Thread-1): 15:49:59 | 6 of 7 OK created incremental model dbt.time......................... [SUCCESS 603 in 4.09s]
2021-10-15 13:49:59.500007 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-15 13:49:59.500007 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:49:59.500007 (Thread-1): 15:49:59 | 7 of 7 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-15 13:49:59.501177 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:49:59.501177 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:49:59.503777 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 13:49:59.505793 (Thread-1): finished collecting timing info
2021-10-15 13:49:59.506875 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 13:49:59.507790 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:49:59.508791 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-15 13:49:59.508791 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:50:00.225811 (Thread-1): SQL status: SUCCESS 1 in 0.72 seconds
2021-10-15 13:50:00.225811 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:50:00.225811 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-15 13:50:01.397771 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2021-10-15 13:50:01.399779 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:50:01.399779 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:50:01.399779 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */

        grant select on analytics.dbt.my_second_dbt_model to role analyst
2021-10-15 13:50:01.568017 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 13:50:01.570016 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 13:50:01.570016 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:50:01.570016 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 13:50:01.730031 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:50:01.731037 (Thread-1): finished collecting timing info
2021-10-15 13:50:01.731037 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-15 13:50:02.003671 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b75b215a-2c41-4cfe-ab80-990f0cb6ecdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001813E448580>]}
2021-10-15 13:50:02.003671 (Thread-1): 15:50:02 | 7 of 7 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.50s]
2021-10-15 13:50:02.004667 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:50:02.005669 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 13:50:02.005669 (MainThread): Using snowflake connection "master".
2021-10-15 13:50:02.005669 (MainThread): On master: BEGIN
2021-10-15 13:50:02.006671 (MainThread): Opening a new connection, currently in state closed
2021-10-15 13:50:02.901737 (MainThread): SQL status: SUCCESS 1 in 0.90 seconds
2021-10-15 13:50:02.902788 (MainThread): On master: COMMIT
2021-10-15 13:50:02.902788 (MainThread): Using snowflake connection "master".
2021-10-15 13:50:02.902788 (MainThread): On master: COMMIT
2021-10-15 13:50:03.201638 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-10-15 13:50:03.201638 (MainThread): On master: Close
2021-10-15 13:50:03.493854 (MainThread): 15:50:03 | 
2021-10-15 13:50:03.494855 (MainThread): 15:50:03 | Finished running 4 table models, 2 incremental models, 1 view model in 24.84s.
2021-10-15 13:50:03.496967 (MainThread): Connection 'master' was properly closed.
2021-10-15 13:50:03.496967 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 13:50:03.496967 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 13:50:03.496967 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-15 13:50:03.510089 (MainThread): 
2021-10-15 13:50:03.510089 (MainThread): Completed successfully
2021-10-15 13:50:03.511085 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-15 13:50:03.511085 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001813E4816D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001813E0F7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001813E4CE8B0>]}
2021-10-15 13:50:03.511085 (MainThread): Flushing usage events
2021-10-15 13:51:16.123700 (MainThread): Running with dbt=0.20.2
2021-10-15 13:51:16.722840 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 13:51:16.722840 (MainThread): Tracking: tracking
2021-10-15 13:51:16.723785 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A596A7CE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A597FAAC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A597FAAA60>]}
2021-10-15 13:51:16.730866 (MainThread): Partial parsing not enabled
2021-10-15 13:51:16.746949 (MainThread): Parsing macros\adapters.sql
2021-10-15 13:51:16.765221 (MainThread): Parsing macros\catalog.sql
2021-10-15 13:51:16.766200 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 13:51:16.772530 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 13:51:16.773531 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 13:51:16.775453 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 13:51:16.776528 (MainThread): Parsing macros\core.sql
2021-10-15 13:51:16.778524 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 13:51:16.806882 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 13:51:16.812886 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 13:51:16.812886 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 13:51:16.814477 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 13:51:16.815486 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 13:51:16.816487 (MainThread): Parsing macros\etc\query.sql
2021-10-15 13:51:16.817486 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 13:51:16.824486 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 13:51:16.828484 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 13:51:16.838756 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 13:51:16.839749 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 13:51:16.845951 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 13:51:16.861218 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 13:51:16.881808 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 13:51:16.882810 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 13:51:16.896316 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 13:51:16.901316 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 13:51:16.904316 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 13:51:16.908988 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 13:51:16.910989 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 13:51:16.911989 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 13:51:16.912989 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 13:51:17.038373 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:51:17.046906 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:51:17.050557 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:51:17.052751 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:51:17.054275 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:51:17.058428 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:51:17.061941 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:51:17.070949 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:51:17.081314 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 13:51:17.083305 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:51:17.084304 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 13:51:17.086303 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:51:17.138735 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:51:17.140717 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:51:17.148799 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:51:17.148799 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:51:17.149791 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:51:17.151800 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:51:17.152801 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:51:17.153816 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:51:17.161800 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:51:17.161800 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:51:17.185182 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3b9957d-b70b-40a2-91b6-985473fc9e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A598015700>]}
2021-10-15 13:51:17.206468 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 13:51:17.206815 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3b9957d-b70b-40a2-91b6-985473fc9e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5980CFEB0>]}
2021-10-15 13:51:17.206815 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 13:51:17.208894 (MainThread): 
2021-10-15 13:51:17.209909 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 13:51:17.210907 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 13:51:17.225151 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 13:51:17.225151 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 13:51:17.225151 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 13:51:18.482907 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.26 seconds
2021-10-15 13:51:18.484804 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 13:51:18.758776 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 13:51:18.763782 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 13:51:18.763782 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 13:51:18.763782 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 13:51:19.675100 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.91 seconds
2021-10-15 13:51:19.677902 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 13:51:19.947075 (MainThread): Using snowflake connection "master".
2021-10-15 13:51:19.947075 (MainThread): On master: BEGIN
2021-10-15 13:51:19.947075 (MainThread): Opening a new connection, currently in state init
2021-10-15 13:51:20.820298 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-15 13:51:20.820298 (MainThread): On master: COMMIT
2021-10-15 13:51:20.820298 (MainThread): Using snowflake connection "master".
2021-10-15 13:51:20.820298 (MainThread): On master: COMMIT
2021-10-15 13:51:21.069962 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-15 13:51:21.069962 (MainThread): On master: Close
2021-10-15 13:51:21.340424 (MainThread): 15:51:21 | Concurrency: 1 threads (target='dev')
2021-10-15 13:51:21.341428 (MainThread): 15:51:21 | 
2021-10-15 13:51:21.347428 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:51:21.347428 (Thread-1): 15:51:21 | 1 of 7 START table model dbt.first_model............................. [RUN]
2021-10-15 13:51:21.347428 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:51:21.347428 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:51:21.349628 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 13:51:21.354550 (Thread-1): finished collecting timing info
2021-10-15 13:51:21.374832 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 13:51:21.377831 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:51:21.377831 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 13:51:21.377831 (Thread-1): Opening a new connection, currently in state init
2021-10-15 13:51:22.144894 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-15 13:51:22.144894 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:51:22.144894 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all   
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 13:51:23.116959 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-15 13:51:23.117980 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:51:23.118983 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:51:23.118983 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */

        grant select on analytics.dbt.first_model to role analyst
2021-10-15 13:51:23.278035 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:51:23.280076 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 13:51:23.280076 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:51:23.280076 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 13:51:23.418487 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:51:23.434068 (Thread-1): finished collecting timing info
2021-10-15 13:51:23.434068 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 13:51:23.705449 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3b9957d-b70b-40a2-91b6-985473fc9e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5980E87C0>]}
2021-10-15 13:51:23.706235 (Thread-1): 15:51:23 | 1 of 7 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.36s]
2021-10-15 13:51:23.707049 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:51:23.707049 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:51:23.707648 (Thread-1): 15:51:23 | 2 of 7 START table model dbt.cul_order_price......................... [RUN]
2021-10-15 13:51:23.707959 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:51:23.707959 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:51:23.709749 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 13:51:23.711124 (Thread-1): finished collecting timing info
2021-10-15 13:51:23.712870 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 13:51:23.714025 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:51:23.714552 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-15 13:51:23.714623 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:51:24.423024 (Thread-1): SQL status: SUCCESS 1 in 0.71 seconds
2021-10-15 13:51:24.423199 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:51:24.423269 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-15 13:51:25.917707 (Thread-1): SQL status: SUCCESS 1 in 1.49 seconds
2021-10-15 13:51:25.918708 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:51:25.918708 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:51:25.918708 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */

        grant select on analytics.dbt.cul_order_price to role analyst
2021-10-15 13:51:26.087639 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 13:51:26.088590 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 13:51:26.089587 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:51:26.089587 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 13:51:26.227502 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:51:26.228472 (Thread-1): finished collecting timing info
2021-10-15 13:51:26.229462 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-15 13:51:26.487674 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3b9957d-b70b-40a2-91b6-985473fc9e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5982B6B20>]}
2021-10-15 13:51:26.487674 (Thread-1): 15:51:26 | 2 of 7 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.78s]
2021-10-15 13:51:26.488712 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:51:26.488712 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-15 13:51:26.489051 (Thread-1): 15:51:26 | 3 of 7 START incremental model dbt.dates............................. [RUN]
2021-10-15 13:51:26.489550 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:51:26.489550 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-15 13:51:26.497182 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 13:51:26.498817 (Thread-1): finished collecting timing info
2021-10-15 13:51:26.522894 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:51:26.523363 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-15 13:51:26.523363 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:51:27.693334 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2021-10-15 13:51:27.703937 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:51:27.703937 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-15 13:51:27.860120 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:51:27.864118 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:51:27.864118 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 13:51:28.003340 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:51:28.003935 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:51:28.005124 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 13:51:28.153091 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 13:51:28.165854 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 13:51:28.167931 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:51:28.167931 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-15 13:51:28.328001 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:51:28.328001 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:51:28.328001 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-15 13:51:28.730905 (Thread-1): SQL status: SUCCESS 0 in 0.40 seconds
2021-10-15 13:51:28.732908 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 13:51:28.733873 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:51:28.733873 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 13:51:28.961156 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-15 13:51:28.962220 (Thread-1): finished collecting timing info
2021-10-15 13:51:28.962220 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-15 13:51:29.420866 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3b9957d-b70b-40a2-91b6-985473fc9e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A597F77D90>]}
2021-10-15 13:51:29.421854 (Thread-1): 15:51:29 | 3 of 7 OK created incremental model dbt.dates........................ [SUCCESS 0 in 2.93s]
2021-10-15 13:51:29.421854 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-15 13:51:29.422772 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:51:29.422772 (Thread-1): 15:51:29 | 4 of 7 START view model dbt.playing_with_tests....................... [RUN]
2021-10-15 13:51:29.423292 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:51:29.423292 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:51:29.423792 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 13:51:29.425798 (Thread-1): finished collecting timing info
2021-10-15 13:51:29.445756 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 13:51:29.446716 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:51:29.447716 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-15 13:51:29.447716 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:51:30.459010 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-15 13:51:30.459165 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:51:30.459221 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */

  create or replace  view analytics.dbt.playing_with_tests  as (
    SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF001"."CUSTOMER"
  );
2021-10-15 13:51:30.841017 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-10-15 13:51:30.842942 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 13:51:30.842942 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:51:30.842942 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 13:51:31.003934 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:51:31.004936 (Thread-1): finished collecting timing info
2021-10-15 13:51:31.004936 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-15 13:51:31.290325 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3b9957d-b70b-40a2-91b6-985473fc9e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A598455DF0>]}
2021-10-15 13:51:31.290325 (Thread-1): 15:51:31 | 4 of 7 OK created view model dbt.playing_with_tests.................. [SUCCESS 1 in 1.87s]
2021-10-15 13:51:31.292364 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:51:31.293408 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:51:31.293408 (Thread-1): 15:51:31 | 5 of 7 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-15 13:51:31.294364 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:51:31.294364 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:51:31.295365 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 13:51:31.300362 (Thread-1): finished collecting timing info
2021-10-15 13:51:31.301543 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 13:51:31.303621 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:51:31.303621 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-15 13:51:31.303621 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:51:32.072620 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-15 13:51:32.072620 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:51:32.072620 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-15 13:51:33.729069 (Thread-1): SQL status: SUCCESS 1 in 1.66 seconds
2021-10-15 13:51:33.732066 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:51:33.733077 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:51:33.733077 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */

        grant select on analytics.dbt.snowflake_customer_purchases to role analyst
2021-10-15 13:51:33.925116 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 13:51:33.926135 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 13:51:33.926135 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:51:33.926135 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 13:51:34.086518 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:51:34.087553 (Thread-1): finished collecting timing info
2021-10-15 13:51:34.087553 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-15 13:51:34.360843 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3b9957d-b70b-40a2-91b6-985473fc9e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A598455DF0>]}
2021-10-15 13:51:34.361929 (Thread-1): 15:51:34 | 5 of 7 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.07s]
2021-10-15 13:51:34.363522 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:51:34.363522 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-15 13:51:34.364539 (Thread-1): 15:51:34 | 6 of 7 START incremental model dbt.time.............................. [RUN]
2021-10-15 13:51:34.364539 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:51:34.365540 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-15 13:51:34.369726 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 13:51:34.372872 (Thread-1): finished collecting timing info
2021-10-15 13:51:34.376615 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:51:34.376615 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-15 13:51:34.376615 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:51:36.036935 (Thread-1): SQL status: SUCCESS 1 in 1.66 seconds
2021-10-15 13:51:36.040292 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:51:36.040292 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-15 13:51:36.190392 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 13:51:36.197262 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:51:36.198262 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 13:51:36.337455 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:51:36.341444 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:51:36.341444 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 13:51:36.482899 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:51:36.482899 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 13:51:36.485459 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:51:36.485459 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-15 13:51:36.666084 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-15 13:51:36.667081 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:51:36.667081 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-15 13:51:37.338091 (Thread-1): SQL status: SUCCESS 99 in 0.67 seconds
2021-10-15 13:51:37.340098 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:51:37.340098 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:51:37.340098 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

        grant select on analytics.dbt.time to role analyst
2021-10-15 13:51:37.484687 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:51:37.485772 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 13:51:37.485772 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:51:37.486720 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 13:51:37.834245 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-10-15 13:51:37.835274 (Thread-1): finished collecting timing info
2021-10-15 13:51:37.835274 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-15 13:51:38.088388 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3b9957d-b70b-40a2-91b6-985473fc9e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5984357C0>]}
2021-10-15 13:51:38.089387 (Thread-1): 15:51:38 | 6 of 7 OK created incremental model dbt.time......................... [SUCCESS 99 in 3.72s]
2021-10-15 13:51:38.090304 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-15 13:51:38.090304 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:51:38.090304 (Thread-1): 15:51:38 | 7 of 7 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-15 13:51:38.091462 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:51:38.091462 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:51:38.092547 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 13:51:38.094259 (Thread-1): finished collecting timing info
2021-10-15 13:51:38.095267 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 13:51:38.097265 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:51:38.097265 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-15 13:51:38.097265 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:51:38.788192 (Thread-1): SQL status: SUCCESS 1 in 0.69 seconds
2021-10-15 13:51:38.788192 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:51:38.788192 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-15 13:51:39.785823 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-15 13:51:39.786937 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:51:39.787451 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:51:39.787451 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */

        grant select on analytics.dbt.my_second_dbt_model to role analyst
2021-10-15 13:51:39.949030 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:51:39.950029 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 13:51:39.950029 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:51:39.950029 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 13:51:40.091179 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:51:40.092261 (Thread-1): finished collecting timing info
2021-10-15 13:51:40.092261 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-15 13:51:40.358409 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3b9957d-b70b-40a2-91b6-985473fc9e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5983D64C0>]}
2021-10-15 13:51:40.359509 (Thread-1): 15:51:40 | 7 of 7 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.27s]
2021-10-15 13:51:40.360688 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:51:40.361686 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 13:51:40.361686 (MainThread): Using snowflake connection "master".
2021-10-15 13:51:40.361686 (MainThread): On master: BEGIN
2021-10-15 13:51:40.361686 (MainThread): Opening a new connection, currently in state closed
2021-10-15 13:51:41.290716 (MainThread): SQL status: SUCCESS 1 in 0.93 seconds
2021-10-15 13:51:41.290716 (MainThread): On master: COMMIT
2021-10-15 13:51:41.290716 (MainThread): Using snowflake connection "master".
2021-10-15 13:51:41.290716 (MainThread): On master: COMMIT
2021-10-15 13:51:41.513690 (MainThread): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-15 13:51:41.514687 (MainThread): On master: Close
2021-10-15 13:51:41.805458 (MainThread): 15:51:41 | 
2021-10-15 13:51:41.805960 (MainThread): 15:51:41 | Finished running 4 table models, 2 incremental models, 1 view model in 24.60s.
2021-10-15 13:51:41.807691 (MainThread): Connection 'master' was properly closed.
2021-10-15 13:51:41.807787 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 13:51:41.807787 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 13:51:41.807869 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-15 13:51:41.821611 (MainThread): 
2021-10-15 13:51:41.821611 (MainThread): Completed successfully
2021-10-15 13:51:41.821611 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-15 13:51:41.822607 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A598042040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5980423D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5980421C0>]}
2021-10-15 13:51:41.822607 (MainThread): Flushing usage events
2021-10-15 13:53:55.943938 (MainThread): Running with dbt=0.20.2
2021-10-15 13:53:56.545796 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 13:53:56.546818 (MainThread): Tracking: tracking
2021-10-15 13:53:56.546818 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D951F2CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D95345A460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D95345A9D0>]}
2021-10-15 13:53:56.564819 (MainThread): Partial parsing not enabled
2021-10-15 13:53:56.578887 (MainThread): Parsing macros\adapters.sql
2021-10-15 13:53:56.598634 (MainThread): Parsing macros\catalog.sql
2021-10-15 13:53:56.599635 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 13:53:56.604909 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 13:53:56.605887 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 13:53:56.607892 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 13:53:56.608888 (MainThread): Parsing macros\core.sql
2021-10-15 13:53:56.610883 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 13:53:56.643452 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 13:53:56.649743 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 13:53:56.650742 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 13:53:56.651741 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 13:53:56.653742 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 13:53:56.654742 (MainThread): Parsing macros\etc\query.sql
2021-10-15 13:53:56.654742 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 13:53:56.661797 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 13:53:56.666996 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 13:53:56.676997 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 13:53:56.678118 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 13:53:56.684255 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 13:53:56.699259 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 13:53:56.721705 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 13:53:56.722698 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 13:53:56.735756 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 13:53:56.742283 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 13:53:56.745290 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 13:53:56.749286 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 13:53:56.751296 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 13:53:56.752300 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 13:53:56.753205 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 13:53:56.883384 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:53:56.890380 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:53:56.893933 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:53:56.896103 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:53:56.898107 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:53:56.902112 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:53:56.905099 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:53:56.911755 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:53:56.921751 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 13:53:56.923754 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:53:56.925053 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 13:53:56.927175 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:53:56.976921 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:53:56.977913 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:53:56.984923 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:53:56.984923 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:53:56.986733 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:53:56.989034 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:53:56.990020 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:53:56.992019 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:53:56.999829 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:53:56.999829 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:53:57.015908 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93d59cf1-fe33-4f1b-8027-fb12760be11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9534EF730>]}
2021-10-15 13:53:57.029763 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 13:53:57.029763 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93d59cf1-fe33-4f1b-8027-fb12760be11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9534C5940>]}
2021-10-15 13:53:57.029763 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 13:53:57.030763 (MainThread): 
2021-10-15 13:53:57.031761 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 13:53:57.033399 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 13:53:57.045701 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 13:53:57.046677 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 13:53:57.046677 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 13:53:58.350844 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.30 seconds
2021-10-15 13:53:58.358024 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 13:53:58.616787 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 13:53:58.622803 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 13:53:58.622803 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 13:53:58.622803 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 13:53:59.300186 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.68 seconds
2021-10-15 13:53:59.301258 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 13:53:59.578308 (MainThread): Using snowflake connection "master".
2021-10-15 13:53:59.578308 (MainThread): On master: BEGIN
2021-10-15 13:53:59.578308 (MainThread): Opening a new connection, currently in state init
2021-10-15 13:54:00.545106 (MainThread): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-15 13:54:00.546107 (MainThread): On master: COMMIT
2021-10-15 13:54:00.546107 (MainThread): Using snowflake connection "master".
2021-10-15 13:54:00.546107 (MainThread): On master: COMMIT
2021-10-15 13:54:00.800838 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-15 13:54:00.801837 (MainThread): On master: Close
2021-10-15 13:54:01.085847 (MainThread): 15:54:01 | Concurrency: 1 threads (target='dev')
2021-10-15 13:54:01.086266 (MainThread): 15:54:01 | 
2021-10-15 13:54:01.088834 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:54:01.089000 (Thread-1): 15:54:01 | 1 of 7 START table model dbt.first_model............................. [RUN]
2021-10-15 13:54:01.089296 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:54:01.089296 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:54:01.091603 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 13:54:01.096888 (Thread-1): finished collecting timing info
2021-10-15 13:54:01.117902 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 13:54:01.121429 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:54:01.121429 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 13:54:01.121429 (Thread-1): Opening a new connection, currently in state init
2021-10-15 13:54:01.829936 (Thread-1): SQL status: SUCCESS 1 in 0.71 seconds
2021-10-15 13:54:01.829936 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:54:01.829936 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all   
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 13:54:03.063002 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-10-15 13:54:03.064785 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:54:03.064785 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:54:03.064785 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */

        grant select on analytics.dbt.first_model to role analyst
2021-10-15 13:54:03.269679 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-15 13:54:03.270671 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 13:54:03.270671 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:54:03.270671 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 13:54:03.414642 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:54:03.426623 (Thread-1): finished collecting timing info
2021-10-15 13:54:03.426623 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 13:54:03.681829 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93d59cf1-fe33-4f1b-8027-fb12760be11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D953550160>]}
2021-10-15 13:54:03.681829 (Thread-1): 15:54:03 | 1 of 7 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.59s]
2021-10-15 13:54:03.684187 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:54:03.684187 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:54:03.684187 (Thread-1): 15:54:03 | 2 of 7 START table model dbt.cul_order_price......................... [RUN]
2021-10-15 13:54:03.685185 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:54:03.685185 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:54:03.686226 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 13:54:03.688267 (Thread-1): finished collecting timing info
2021-10-15 13:54:03.691015 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 13:54:03.693001 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:54:03.693264 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-15 13:54:03.693264 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:54:04.363804 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-10-15 13:54:04.364806 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:54:04.364806 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-15 13:54:05.856692 (Thread-1): SQL status: SUCCESS 1 in 1.49 seconds
2021-10-15 13:54:05.859702 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:54:05.859702 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:54:05.859702 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */

        grant select on analytics.dbt.cul_order_price to role analyst
2021-10-15 13:54:06.066277 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-15 13:54:06.068272 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 13:54:06.068272 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:54:06.068272 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 13:54:06.209862 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:54:06.211850 (Thread-1): finished collecting timing info
2021-10-15 13:54:06.211850 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-15 13:54:06.456690 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93d59cf1-fe33-4f1b-8027-fb12760be11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9538811F0>]}
2021-10-15 13:54:06.457685 (Thread-1): 15:54:06 | 2 of 7 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.77s]
2021-10-15 13:54:06.457685 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:54:06.457685 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-15 13:54:06.457685 (Thread-1): 15:54:06 | 3 of 7 START incremental model dbt.dates............................. [RUN]
2021-10-15 13:54:06.458667 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:54:06.458667 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-15 13:54:06.461683 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 13:54:06.462752 (Thread-1): finished collecting timing info
2021-10-15 13:54:06.477565 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:54:06.478661 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-15 13:54:06.478661 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:54:07.638361 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2021-10-15 13:54:07.644721 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:54:07.644721 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-15 13:54:07.798639 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 13:54:07.799666 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:54:07.800757 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 13:54:07.938766 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:54:07.940783 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:54:07.940783 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 13:54:08.126132 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 13:54:08.139241 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 13:54:08.141158 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:54:08.141158 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-15 13:54:08.324930 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-15 13:54:08.326199 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:54:08.326199 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-15 13:54:08.779998 (Thread-1): SQL status: SUCCESS 0 in 0.45 seconds
2021-10-15 13:54:08.781008 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 13:54:08.781008 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:54:08.781008 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 13:54:09.006178 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-15 13:54:09.007218 (Thread-1): finished collecting timing info
2021-10-15 13:54:09.007218 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-15 13:54:09.286850 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93d59cf1-fe33-4f1b-8027-fb12760be11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9535828E0>]}
2021-10-15 13:54:09.286850 (Thread-1): 15:54:09 | 3 of 7 OK created incremental model dbt.dates........................ [SUCCESS 0 in 2.83s]
2021-10-15 13:54:09.288187 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-15 13:54:09.288187 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:54:09.288187 (Thread-1): 15:54:09 | 4 of 7 START view model dbt.playing_with_tests....................... [RUN]
2021-10-15 13:54:09.289194 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:54:09.289194 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:54:09.289194 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 13:54:09.291199 (Thread-1): finished collecting timing info
2021-10-15 13:54:09.302194 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 13:54:09.304666 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:54:09.304666 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-15 13:54:09.304666 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:54:09.975991 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-10-15 13:54:09.975991 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:54:09.975991 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */

  create or replace  view analytics.dbt.playing_with_tests  as (
    SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF001"."CUSTOMER"
  );
2021-10-15 13:54:10.398496 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-10-15 13:54:10.398984 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 13:54:10.399484 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:54:10.399484 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 13:54:10.542312 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:54:10.543348 (Thread-1): finished collecting timing info
2021-10-15 13:54:10.543348 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-15 13:54:10.824908 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93d59cf1-fe33-4f1b-8027-fb12760be11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D951F2C850>]}
2021-10-15 13:54:10.824908 (Thread-1): 15:54:10 | 4 of 7 OK created view model dbt.playing_with_tests.................. [SUCCESS 1 in 1.54s]
2021-10-15 13:54:10.826979 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:54:10.826979 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:54:10.826979 (Thread-1): 15:54:10 | 5 of 7 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-15 13:54:10.827985 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:54:10.827985 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:54:10.828985 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 13:54:10.832985 (Thread-1): finished collecting timing info
2021-10-15 13:54:10.833985 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 13:54:10.836033 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:54:10.836033 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-15 13:54:10.836033 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:54:11.831426 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-10-15 13:54:11.831426 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:54:11.832422 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-15 13:54:13.454467 (Thread-1): SQL status: SUCCESS 1 in 1.62 seconds
2021-10-15 13:54:13.456082 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:54:13.457053 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:54:13.457053 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */

        grant select on analytics.dbt.snowflake_customer_purchases to role analyst
2021-10-15 13:54:13.651900 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 13:54:13.652814 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 13:54:13.653891 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:54:13.653891 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 13:54:13.790336 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:54:13.791321 (Thread-1): finished collecting timing info
2021-10-15 13:54:13.791321 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-15 13:54:14.194447 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93d59cf1-fe33-4f1b-8027-fb12760be11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D951F2C850>]}
2021-10-15 13:54:14.195449 (Thread-1): 15:54:14 | 5 of 7 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.37s]
2021-10-15 13:54:14.196449 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:54:14.196449 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-15 13:54:14.196449 (Thread-1): 15:54:14 | 6 of 7 START incremental model dbt.time.............................. [RUN]
2021-10-15 13:54:14.199608 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:54:14.199608 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-15 13:54:14.203730 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 13:54:14.205704 (Thread-1): finished collecting timing info
2021-10-15 13:54:14.207784 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:54:14.207784 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-15 13:54:14.207784 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:54:15.858560 (Thread-1): SQL status: SUCCESS 1 in 1.65 seconds
2021-10-15 13:54:15.860553 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:54:15.860553 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-15 13:54:16.023374 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:54:16.026490 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:54:16.026490 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 13:54:16.191109 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:54:16.193107 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:54:16.193107 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 13:54:16.335800 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:54:16.337290 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 13:54:16.340286 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:54:16.340286 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-15 13:54:16.512997 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 13:54:16.512997 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:54:16.512997 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-15 13:54:17.245719 (Thread-1): SQL status: SUCCESS 160 in 0.73 seconds
2021-10-15 13:54:17.248623 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:54:17.249708 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:54:17.249708 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

        grant select on analytics.dbt.time to role analyst
2021-10-15 13:54:17.395115 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 13:54:17.396091 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 13:54:17.396091 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:54:17.397089 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 13:54:17.933829 (Thread-1): SQL status: SUCCESS 1 in 0.54 seconds
2021-10-15 13:54:17.934360 (Thread-1): finished collecting timing info
2021-10-15 13:54:17.934360 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-15 13:54:18.203763 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93d59cf1-fe33-4f1b-8027-fb12760be11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9539081F0>]}
2021-10-15 13:54:18.203763 (Thread-1): 15:54:18 | 6 of 7 OK created incremental model dbt.time......................... [SUCCESS 160 in 4.00s]
2021-10-15 13:54:18.204761 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-15 13:54:18.204761 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:54:18.204761 (Thread-1): 15:54:18 | 7 of 7 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-15 13:54:18.205760 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:54:18.205760 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:54:18.207761 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 13:54:18.209800 (Thread-1): finished collecting timing info
2021-10-15 13:54:18.210801 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 13:54:18.212537 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:54:18.212537 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-15 13:54:18.212537 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:54:19.261463 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-10-15 13:54:19.261463 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:54:19.261463 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-15 13:54:20.295204 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-10-15 13:54:20.296252 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:54:20.296252 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:54:20.296252 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */

        grant select on analytics.dbt.my_second_dbt_model to role analyst
2021-10-15 13:54:20.477435 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-15 13:54:20.479069 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 13:54:20.479069 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:54:20.479069 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 13:54:20.618531 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:54:20.619638 (Thread-1): finished collecting timing info
2021-10-15 13:54:20.619638 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-15 13:54:20.871556 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93d59cf1-fe33-4f1b-8027-fb12760be11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9535958B0>]}
2021-10-15 13:54:20.872554 (Thread-1): 15:54:20 | 7 of 7 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.67s]
2021-10-15 13:54:20.874553 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:54:20.875553 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 13:54:20.875553 (MainThread): Using snowflake connection "master".
2021-10-15 13:54:20.875553 (MainThread): On master: BEGIN
2021-10-15 13:54:20.875553 (MainThread): Opening a new connection, currently in state closed
2021-10-15 13:54:21.558833 (MainThread): SQL status: SUCCESS 1 in 0.68 seconds
2021-10-15 13:54:21.560864 (MainThread): On master: COMMIT
2021-10-15 13:54:21.560864 (MainThread): Using snowflake connection "master".
2021-10-15 13:54:21.560864 (MainThread): On master: COMMIT
2021-10-15 13:54:21.869259 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-10-15 13:54:21.869259 (MainThread): On master: Close
2021-10-15 13:54:22.127579 (MainThread): 15:54:22 | 
2021-10-15 13:54:22.128506 (MainThread): 15:54:22 | Finished running 4 table models, 2 incremental models, 1 view model in 25.10s.
2021-10-15 13:54:22.129536 (MainThread): Connection 'master' was properly closed.
2021-10-15 13:54:22.129536 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 13:54:22.129536 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 13:54:22.129536 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-15 13:54:22.145464 (MainThread): 
2021-10-15 13:54:22.146366 (MainThread): Completed successfully
2021-10-15 13:54:22.148809 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-15 13:54:22.148809 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D95388A790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D95356BE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D953883F70>]}
2021-10-15 13:54:22.148809 (MainThread): Flushing usage events
2021-10-15 13:55:48.101489 (MainThread): Running with dbt=0.20.2
2021-10-15 13:55:48.704922 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 13:55:48.704922 (MainThread): Tracking: tracking
2021-10-15 13:55:48.704922 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CC62BE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CDB78AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CDB78E80>]}
2021-10-15 13:55:48.711122 (MainThread): Partial parsing not enabled
2021-10-15 13:55:48.726359 (MainThread): Parsing macros\adapters.sql
2021-10-15 13:55:48.747771 (MainThread): Parsing macros\catalog.sql
2021-10-15 13:55:48.748783 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 13:55:48.757054 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 13:55:48.760282 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 13:55:48.765369 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 13:55:48.766660 (MainThread): Parsing macros\core.sql
2021-10-15 13:55:48.770166 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 13:55:48.806138 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 13:55:48.813160 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 13:55:48.814161 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 13:55:48.815155 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 13:55:48.816138 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 13:55:48.818155 (MainThread): Parsing macros\etc\query.sql
2021-10-15 13:55:48.818155 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 13:55:48.825153 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 13:55:48.830780 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 13:55:48.841825 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 13:55:48.842830 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 13:55:48.849009 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 13:55:48.864174 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 13:55:48.886161 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 13:55:48.888239 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 13:55:48.901236 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 13:55:48.906333 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 13:55:48.909425 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 13:55:48.914421 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 13:55:48.915426 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 13:55:48.916393 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 13:55:48.917418 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 13:55:49.047491 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:55:49.054400 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:55:49.058400 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:55:49.060400 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:55:49.062558 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:55:49.066556 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:55:49.068557 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:55:49.075558 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:55:49.085746 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 13:55:49.087748 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:55:49.088748 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 13:55:49.090748 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:55:49.141984 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:55:49.142962 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:55:49.149653 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:55:49.149653 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:55:49.151825 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:55:49.152820 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:55:49.153936 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:55:49.155028 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:55:49.163044 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:55:49.163044 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:55:49.185079 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3411eb0-d469-4cb3-9aba-a94e35a3500c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CDC96BB0>]}
2021-10-15 13:55:49.198883 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 13:55:49.199942 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3411eb0-d469-4cb3-9aba-a94e35a3500c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CDC96FD0>]}
2021-10-15 13:55:49.200442 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 151 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 13:55:49.201451 (MainThread): 
2021-10-15 13:55:49.201451 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 13:55:49.203452 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 13:55:49.213455 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 13:55:49.213455 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 13:55:49.213455 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 13:55:50.568160 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.35 seconds
2021-10-15 13:55:50.572208 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 13:55:50.839982 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 13:55:50.844738 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 13:55:50.844738 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 13:55:50.844738 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 13:55:51.533612 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.69 seconds
2021-10-15 13:55:51.535607 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 13:55:51.823478 (MainThread): Using snowflake connection "master".
2021-10-15 13:55:51.823478 (MainThread): On master: BEGIN
2021-10-15 13:55:51.823478 (MainThread): Opening a new connection, currently in state init
2021-10-15 13:55:52.883126 (MainThread): SQL status: SUCCESS 1 in 1.06 seconds
2021-10-15 13:55:52.884275 (MainThread): On master: COMMIT
2021-10-15 13:55:52.884275 (MainThread): Using snowflake connection "master".
2021-10-15 13:55:52.884275 (MainThread): On master: COMMIT
2021-10-15 13:55:53.114998 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-15 13:55:53.114998 (MainThread): On master: Close
2021-10-15 13:55:53.393386 (MainThread): 15:55:53 | Concurrency: 1 threads (target='dev')
2021-10-15 13:55:53.393386 (MainThread): 15:55:53 | 
2021-10-15 13:55:53.398872 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:55:53.398872 (Thread-1): 15:55:53 | 1 of 7 START table model dbt.first_model............................. [RUN]
2021-10-15 13:55:53.399598 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:55:53.399598 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:55:53.401717 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 13:55:53.406642 (Thread-1): finished collecting timing info
2021-10-15 13:55:53.436101 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 13:55:53.438675 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:55:53.438850 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 13:55:53.438979 (Thread-1): Opening a new connection, currently in state init
2021-10-15 13:55:54.294273 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-10-15 13:55:54.294273 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:55:54.294273 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id
    union all
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 13:55:55.411595 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-10-15 13:55:55.414383 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:55:55.414910 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:55:55.414910 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */

        grant select on analytics.dbt.first_model to role analyst
2021-10-15 13:55:55.683422 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-15 13:55:55.684473 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:55:55.684473 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:55:55.684473 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */

        grant select on analytics.dbt.first_model to role analyst
2021-10-15 13:55:55.933486 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-15 13:55:55.935486 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 13:55:55.935486 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:55:55.935486 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 13:55:56.153454 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-15 13:55:56.163479 (Thread-1): finished collecting timing info
2021-10-15 13:55:56.163479 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 13:55:56.535679 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3411eb0-d469-4cb3-9aba-a94e35a3500c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CDFB8B80>]}
2021-10-15 13:55:56.536678 (Thread-1): 15:55:56 | 1 of 7 OK created table model dbt.first_model........................ [SUCCESS 1 in 3.14s]
2021-10-15 13:55:56.536678 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:55:56.537676 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:55:56.537676 (Thread-1): 15:55:56 | 2 of 7 START table model dbt.cul_order_price......................... [RUN]
2021-10-15 13:55:56.537676 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:55:56.537676 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:55:56.538679 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 13:55:56.540770 (Thread-1): finished collecting timing info
2021-10-15 13:55:56.541874 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 13:55:56.544456 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:55:56.544456 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-15 13:55:56.544669 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:55:57.235017 (Thread-1): SQL status: SUCCESS 1 in 0.69 seconds
2021-10-15 13:55:57.235017 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:55:57.235017 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-15 13:55:59.072107 (Thread-1): SQL status: SUCCESS 1 in 1.84 seconds
2021-10-15 13:55:59.075135 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:55:59.075135 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:55:59.075135 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */

        grant select on analytics.dbt.cul_order_price to role analyst
2021-10-15 13:55:59.287523 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-15 13:55:59.289522 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 13:55:59.289522 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:55:59.289522 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 13:55:59.425511 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:55:59.426197 (Thread-1): finished collecting timing info
2021-10-15 13:55:59.426320 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-15 13:55:59.683784 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3411eb0-d469-4cb3-9aba-a94e35a3500c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CDC18B80>]}
2021-10-15 13:55:59.683784 (Thread-1): 15:55:59 | 2 of 7 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.15s]
2021-10-15 13:55:59.684783 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:55:59.684783 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-15 13:55:59.685400 (Thread-1): 15:55:59 | 3 of 7 START incremental model dbt.dates............................. [RUN]
2021-10-15 13:55:59.685915 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:55:59.685915 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-15 13:55:59.689939 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 13:55:59.690940 (Thread-1): finished collecting timing info
2021-10-15 13:55:59.704258 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:55:59.705257 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-15 13:55:59.705257 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:56:01.034518 (Thread-1): SQL status: SUCCESS 1 in 1.33 seconds
2021-10-15 13:56:01.044505 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:56:01.045505 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-15 13:56:01.204728 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:56:01.206819 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:56:01.206819 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 13:56:01.435977 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-15 13:56:01.437684 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:56:01.437791 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 13:56:01.595303 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:56:01.604389 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 13:56:01.606279 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:56:01.606781 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-15 13:56:01.957818 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-10-15 13:56:01.957818 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:56:01.957818 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-15 13:56:02.376236 (Thread-1): SQL status: SUCCESS 0 in 0.42 seconds
2021-10-15 13:56:02.377192 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 13:56:02.377192 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:56:02.377192 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 13:56:02.763957 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-10-15 13:56:02.765228 (Thread-1): finished collecting timing info
2021-10-15 13:56:02.765228 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-15 13:56:03.053367 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3411eb0-d469-4cb3-9aba-a94e35a3500c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CDFC8700>]}
2021-10-15 13:56:03.053367 (Thread-1): 15:56:03 | 3 of 7 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.37s]
2021-10-15 13:56:03.054556 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-15 13:56:03.055502 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:56:03.055502 (Thread-1): 15:56:03 | 4 of 7 START view model dbt.playing_with_tests....................... [RUN]
2021-10-15 13:56:03.056484 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:56:03.056484 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:56:03.057497 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 13:56:03.059494 (Thread-1): finished collecting timing info
2021-10-15 13:56:03.072496 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 13:56:03.074366 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:56:03.074366 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-15 13:56:03.074366 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:56:03.974041 (Thread-1): SQL status: SUCCESS 1 in 0.90 seconds
2021-10-15 13:56:03.975119 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:56:03.975119 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */

  create or replace  view analytics.dbt.playing_with_tests  as (
    SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF001"."CUSTOMER"
  );
2021-10-15 13:56:04.433385 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-10-15 13:56:04.435432 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 13:56:04.436458 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:56:04.436458 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 13:56:04.577795 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:56:04.579883 (Thread-1): finished collecting timing info
2021-10-15 13:56:04.579883 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-15 13:56:04.908602 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3411eb0-d469-4cb3-9aba-a94e35a3500c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CDCDB910>]}
2021-10-15 13:56:04.909600 (Thread-1): 15:56:04 | 4 of 7 OK created view model dbt.playing_with_tests.................. [SUCCESS 1 in 1.85s]
2021-10-15 13:56:04.910597 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:56:04.910597 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:56:04.911600 (Thread-1): 15:56:04 | 5 of 7 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-15 13:56:04.911984 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:56:04.911984 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:56:04.912992 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 13:56:04.917848 (Thread-1): finished collecting timing info
2021-10-15 13:56:04.921906 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 13:56:04.923903 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:56:04.923903 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-15 13:56:04.923903 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:56:05.826524 (Thread-1): SQL status: SUCCESS 1 in 0.90 seconds
2021-10-15 13:56:05.826524 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:56:05.826524 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-15 13:56:07.430952 (Thread-1): SQL status: SUCCESS 1 in 1.60 seconds
2021-10-15 13:56:07.432274 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:56:07.432686 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:56:07.432869 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */

        grant select on analytics.dbt.snowflake_customer_purchases to role analyst
2021-10-15 13:56:07.603381 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 13:56:07.604485 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 13:56:07.604485 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:56:07.604485 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 13:56:07.767915 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:56:07.768921 (Thread-1): finished collecting timing info
2021-10-15 13:56:07.768921 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-15 13:56:08.045810 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3411eb0-d469-4cb3-9aba-a94e35a3500c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CE000AF0>]}
2021-10-15 13:56:08.045810 (Thread-1): 15:56:08 | 5 of 7 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.13s]
2021-10-15 13:56:08.046918 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:56:08.047991 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-15 13:56:08.047991 (Thread-1): 15:56:08 | 6 of 7 START incremental model dbt.time.............................. [RUN]
2021-10-15 13:56:08.048992 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:56:08.048992 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-15 13:56:08.053080 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 13:56:08.054783 (Thread-1): finished collecting timing info
2021-10-15 13:56:08.057335 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:56:08.057335 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-15 13:56:08.057335 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:56:09.848767 (Thread-1): SQL status: SUCCESS 1 in 1.79 seconds
2021-10-15 13:56:09.850765 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:56:09.850765 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-15 13:56:10.021045 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 13:56:10.023028 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:56:10.023028 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 13:56:10.162240 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:56:10.165324 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:56:10.165324 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 13:56:10.309439 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:56:10.310439 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 13:56:10.312365 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:56:10.312365 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-15 13:56:10.477311 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:56:10.477311 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:56:10.478286 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-15 13:56:11.123580 (Thread-1): SQL status: SUCCESS 114 in 0.65 seconds
2021-10-15 13:56:11.126583 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:56:11.127649 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:56:11.127649 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

        grant select on analytics.dbt.time to role analyst
2021-10-15 13:56:11.311008 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-15 13:56:11.312006 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 13:56:11.312006 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:56:11.312006 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 13:56:11.728681 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-10-15 13:56:11.729674 (Thread-1): finished collecting timing info
2021-10-15 13:56:11.729674 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-15 13:56:12.019337 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3411eb0-d469-4cb3-9aba-a94e35a3500c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CDE5C040>]}
2021-10-15 13:56:12.020334 (Thread-1): 15:56:12 | 6 of 7 OK created incremental model dbt.time......................... [SUCCESS 114 in 3.97s]
2021-10-15 13:56:12.021335 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-15 13:56:12.022333 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:56:12.022333 (Thread-1): 15:56:12 | 7 of 7 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-15 13:56:12.023331 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:56:12.023331 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:56:12.025371 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 13:56:12.027326 (Thread-1): finished collecting timing info
2021-10-15 13:56:12.028411 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 13:56:12.029993 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:56:12.029993 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-15 13:56:12.029993 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:56:13.041105 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-15 13:56:13.041105 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:56:13.041105 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-15 13:56:14.135115 (Thread-1): SQL status: SUCCESS 1 in 1.09 seconds
2021-10-15 13:56:14.137122 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:56:14.137122 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:56:14.138131 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */

        grant select on analytics.dbt.my_second_dbt_model to role analyst
2021-10-15 13:56:14.303269 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 13:56:14.314441 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 13:56:14.314441 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:56:14.315441 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 13:56:14.454204 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:56:14.456202 (Thread-1): finished collecting timing info
2021-10-15 13:56:14.456202 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-15 13:56:14.707493 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3411eb0-d469-4cb3-9aba-a94e35a3500c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CDFDDF10>]}
2021-10-15 13:56:14.707780 (Thread-1): 15:56:14 | 7 of 7 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.68s]
2021-10-15 13:56:14.708653 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:56:14.709671 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 13:56:14.709671 (MainThread): Using snowflake connection "master".
2021-10-15 13:56:14.709671 (MainThread): On master: BEGIN
2021-10-15 13:56:14.709671 (MainThread): Opening a new connection, currently in state closed
2021-10-15 13:56:15.583553 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-15 13:56:15.583553 (MainThread): On master: COMMIT
2021-10-15 13:56:15.583553 (MainThread): Using snowflake connection "master".
2021-10-15 13:56:15.583553 (MainThread): On master: COMMIT
2021-10-15 13:56:15.859932 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-15 13:56:15.859932 (MainThread): On master: Close
2021-10-15 13:56:16.110032 (MainThread): 15:56:16 | 
2021-10-15 13:56:16.111028 (MainThread): 15:56:16 | Finished running 4 table models, 2 incremental models, 1 view model in 26.91s.
2021-10-15 13:56:16.112993 (MainThread): Connection 'master' was properly closed.
2021-10-15 13:56:16.112993 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 13:56:16.112993 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 13:56:16.112993 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-15 13:56:16.127363 (MainThread): 
2021-10-15 13:56:16.127363 (MainThread): Completed successfully
2021-10-15 13:56:16.128370 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-15 13:56:16.129632 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CDF868E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CDC007F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215CDFD5E50>]}
2021-10-15 13:56:16.129632 (MainThread): Flushing usage events
2021-10-15 13:58:32.607149 (MainThread): Running with dbt=0.20.2
2021-10-15 13:58:33.225270 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 13:58:33.225270 (MainThread): Tracking: tracking
2021-10-15 13:58:33.225270 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FEF0BDE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FF05FA490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FF05FA9D0>]}
2021-10-15 13:58:33.233582 (MainThread): Partial parsing not enabled
2021-10-15 13:58:33.248134 (MainThread): Parsing macros\adapters.sql
2021-10-15 13:58:33.267553 (MainThread): Parsing macros\catalog.sql
2021-10-15 13:58:33.269112 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 13:58:33.274197 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 13:58:33.276271 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 13:58:33.279385 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 13:58:33.280371 (MainThread): Parsing macros\core.sql
2021-10-15 13:58:33.283367 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 13:58:33.315520 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 13:58:33.321527 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 13:58:33.322652 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 13:58:33.323787 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 13:58:33.324790 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 13:58:33.325720 (MainThread): Parsing macros\etc\query.sql
2021-10-15 13:58:33.326782 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 13:58:33.337316 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 13:58:33.342072 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 13:58:33.354191 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 13:58:33.356248 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 13:58:33.363356 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 13:58:33.380540 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 13:58:33.401304 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 13:58:33.402303 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 13:58:33.415302 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 13:58:33.419302 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 13:58:33.423302 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 13:58:33.427302 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 13:58:33.428303 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 13:58:33.429303 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 13:58:33.430303 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 13:58:33.555702 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:58:33.562955 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:58:33.564955 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:58:33.566955 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:58:33.566955 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:58:33.568955 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:58:33.569955 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:58:33.575183 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:58:33.583181 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 13:58:33.585182 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:58:33.586184 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 13:58:33.588316 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:58:33.593313 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-15 13:58:33.595315 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-15 13:58:33.597315 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-15 13:58:33.644437 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:58:33.645456 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:58:33.654084 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:58:33.654084 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:58:33.655084 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:58:33.657083 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:58:33.658083 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:58:33.659084 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:58:33.667082 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:58:33.668083 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 13:58:33.687932 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c042b8f9-dee2-423d-81e4-227e5343d0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FF0768460>]}
2021-10-15 13:58:33.708389 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 13:58:33.708389 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c042b8f9-dee2-423d-81e4-227e5343d0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FF05FDF40>]}
2021-10-15 13:58:33.708389 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 151 macros, 3 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 13:58:33.710270 (MainThread): 
2021-10-15 13:58:33.710270 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 13:58:33.713008 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 13:58:33.726644 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 13:58:33.726644 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 13:58:33.726644 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 13:58:35.034929 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.31 seconds
2021-10-15 13:58:35.038785 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 13:58:35.293544 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 13:58:35.300559 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 13:58:35.300559 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 13:58:35.300559 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 13:58:35.974383 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.67 seconds
2021-10-15 13:58:35.974383 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 13:58:36.233102 (MainThread): Using snowflake connection "master".
2021-10-15 13:58:36.234145 (MainThread): On master: BEGIN
2021-10-15 13:58:36.234145 (MainThread): Opening a new connection, currently in state init
2021-10-15 13:58:37.117811 (MainThread): SQL status: SUCCESS 1 in 0.88 seconds
2021-10-15 13:58:37.117811 (MainThread): On master: COMMIT
2021-10-15 13:58:37.117811 (MainThread): Using snowflake connection "master".
2021-10-15 13:58:37.117811 (MainThread): On master: COMMIT
2021-10-15 13:58:37.414444 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-10-15 13:58:37.414444 (MainThread): On master: Close
2021-10-15 13:58:37.695686 (MainThread): 15:58:37 | Concurrency: 1 threads (target='dev')
2021-10-15 13:58:37.696597 (MainThread): 15:58:37 | 
2021-10-15 13:58:37.705699 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:58:37.705699 (Thread-1): 15:58:37 | 1 of 7 START table model dbt.first_model............................. [RUN]
2021-10-15 13:58:37.706723 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:58:37.706723 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:58:37.708714 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 13:58:37.714538 (Thread-1): finished collecting timing info
2021-10-15 13:58:37.743656 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 13:58:37.753302 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:58:37.753302 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 13:58:37.754316 (Thread-1): Opening a new connection, currently in state init
2021-10-15 13:58:38.474561 (Thread-1): SQL status: SUCCESS 1 in 0.72 seconds
2021-10-15 13:58:38.474561 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:58:38.474561 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below

    post_hook="grant select on analytics.dbt.first_model to role analyst" can put in config
*/




with source_data as (

    select 1 as id
    union all
    select null as id
    union all
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 13:58:39.479965 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-15 13:58:39.481962 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 13:58:39.481962 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 13:58:39.481962 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 13:58:39.626032 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:58:39.635099 (Thread-1): finished collecting timing info
2021-10-15 13:58:39.635099 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 13:58:39.898163 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c042b8f9-dee2-423d-81e4-227e5343d0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FF08F46D0>]}
2021-10-15 13:58:39.898728 (Thread-1): 15:58:39 | 1 of 7 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.19s]
2021-10-15 13:58:39.899559 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 13:58:39.899748 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:58:39.899902 (Thread-1): 15:58:39 | 2 of 7 START table model dbt.cul_order_price......................... [RUN]
2021-10-15 13:58:39.900326 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:58:39.900702 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:58:39.901497 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 13:58:39.902706 (Thread-1): finished collecting timing info
2021-10-15 13:58:39.903954 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 13:58:39.905127 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:58:39.905127 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-15 13:58:39.905514 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:58:40.618711 (Thread-1): SQL status: SUCCESS 1 in 0.71 seconds
2021-10-15 13:58:40.618711 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:58:40.618711 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-15 13:58:41.961119 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-10-15 13:58:41.962122 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 13:58:41.962122 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 13:58:41.962122 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 13:58:42.104444 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:58:42.104444 (Thread-1): finished collecting timing info
2021-10-15 13:58:42.104444 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-15 13:58:42.368196 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c042b8f9-dee2-423d-81e4-227e5343d0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FF09D6AF0>]}
2021-10-15 13:58:42.369818 (Thread-1): 15:58:42 | 2 of 7 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.47s]
2021-10-15 13:58:42.370542 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 13:58:42.370542 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-15 13:58:42.370542 (Thread-1): 15:58:42 | 3 of 7 START incremental model dbt.dates............................. [RUN]
2021-10-15 13:58:42.370542 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:58:42.370542 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-15 13:58:42.375162 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 13:58:42.377123 (Thread-1): finished collecting timing info
2021-10-15 13:58:42.394601 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:58:42.394601 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-15 13:58:42.395131 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:58:43.553195 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2021-10-15 13:58:43.563325 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:58:43.563325 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-15 13:58:43.713629 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 13:58:43.715637 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:58:43.715637 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 13:58:43.851471 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-10-15 13:58:43.854470 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:58:43.854470 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 13:58:43.993582 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:58:44.014320 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 13:58:44.017242 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:58:44.017242 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-15 13:58:44.204857 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 13:58:44.205876 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:58:44.205876 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-15 13:58:44.558106 (Thread-1): SQL status: SUCCESS 0 in 0.35 seconds
2021-10-15 13:58:44.561304 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 13:58:44.561809 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 13:58:44.561809 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 13:58:44.822391 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-15 13:58:44.824390 (Thread-1): finished collecting timing info
2021-10-15 13:58:44.824390 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-15 13:58:45.095516 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c042b8f9-dee2-423d-81e4-227e5343d0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FF0AA32E0>]}
2021-10-15 13:58:45.096601 (Thread-1): 15:58:45 | 3 of 7 OK created incremental model dbt.dates........................ [SUCCESS 0 in 2.72s]
2021-10-15 13:58:45.099602 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-15 13:58:45.100598 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:58:45.101662 (Thread-1): 15:58:45 | 4 of 7 START view model dbt.playing_with_tests....................... [RUN]
2021-10-15 13:58:45.103612 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:58:45.103612 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:58:45.108678 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 13:58:45.117094 (Thread-1): finished collecting timing info
2021-10-15 13:58:45.162689 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 13:58:45.169163 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:58:45.169163 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-15 13:58:45.170185 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:58:46.100611 (Thread-1): SQL status: SUCCESS 1 in 0.93 seconds
2021-10-15 13:58:46.100611 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:58:46.100611 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */

  create or replace  view analytics.dbt.playing_with_tests  as (
    SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF001"."CUSTOMER"
  );
2021-10-15 13:58:46.475549 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-10-15 13:58:46.476655 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 13:58:46.476655 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 13:58:46.476655 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 13:58:46.612584 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:58:46.613582 (Thread-1): finished collecting timing info
2021-10-15 13:58:46.613582 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-15 13:58:46.887306 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c042b8f9-dee2-423d-81e4-227e5343d0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FF0AA0AF0>]}
2021-10-15 13:58:46.888306 (Thread-1): 15:58:46 | 4 of 7 OK created view model dbt.playing_with_tests.................. [SUCCESS 1 in 1.78s]
2021-10-15 13:58:46.889304 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 13:58:46.889304 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:58:46.889304 (Thread-1): 15:58:46 | 5 of 7 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-15 13:58:46.889304 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:58:46.890307 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:58:46.890307 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 13:58:46.892305 (Thread-1): finished collecting timing info
2021-10-15 13:58:46.894629 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 13:58:46.896291 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:58:46.896291 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-15 13:58:46.897289 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:58:47.584000 (Thread-1): SQL status: SUCCESS 1 in 0.69 seconds
2021-10-15 13:58:47.584000 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:58:47.584000 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-15 13:58:48.999359 (Thread-1): SQL status: SUCCESS 1 in 1.42 seconds
2021-10-15 13:58:49.000376 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 13:58:49.000376 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 13:58:49.000376 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 13:58:49.143113 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 13:58:49.143113 (Thread-1): finished collecting timing info
2021-10-15 13:58:49.143113 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-15 13:58:49.420206 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c042b8f9-dee2-423d-81e4-227e5343d0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FF0A30400>]}
2021-10-15 13:58:49.421205 (Thread-1): 15:58:49 | 5 of 7 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.53s]
2021-10-15 13:58:49.421569 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 13:58:49.421569 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-15 13:58:49.422602 (Thread-1): 15:58:49 | 6 of 7 START incremental model dbt.time.............................. [RUN]
2021-10-15 13:58:49.422602 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:58:49.422602 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-15 13:58:49.424666 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 13:58:49.426577 (Thread-1): finished collecting timing info
2021-10-15 13:58:49.428215 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:58:49.428215 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-15 13:58:49.428215 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:58:51.069358 (Thread-1): SQL status: SUCCESS 1 in 1.64 seconds
2021-10-15 13:58:51.071372 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:58:51.071372 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-15 13:58:51.233548 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:58:51.235559 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:58:51.235559 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 13:58:51.369659 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-10-15 13:58:51.371877 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:58:51.371877 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 13:58:51.662651 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-15 13:58:51.663990 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 13:58:51.666503 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:58:51.666503 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-15 13:58:51.841420 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 13:58:51.841420 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:58:51.841420 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-15 13:58:52.524107 (Thread-1): SQL status: SUCCESS 161 in 0.68 seconds
2021-10-15 13:58:52.525111 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 13:58:52.525111 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 13:58:52.525111 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 13:58:52.899779 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-10-15 13:58:52.900808 (Thread-1): finished collecting timing info
2021-10-15 13:58:52.900808 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-15 13:58:53.173343 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c042b8f9-dee2-423d-81e4-227e5343d0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FF0A3A280>]}
2021-10-15 13:58:53.174316 (Thread-1): 15:58:53 | 6 of 7 OK created incremental model dbt.time......................... [SUCCESS 161 in 3.75s]
2021-10-15 13:58:53.175379 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-15 13:58:53.175379 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:58:53.175890 (Thread-1): 15:58:53 | 7 of 7 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-15 13:58:53.178248 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:58:53.178248 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:58:53.180349 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 13:58:53.182349 (Thread-1): finished collecting timing info
2021-10-15 13:58:53.183349 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 13:58:53.184349 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:58:53.184349 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-15 13:58:53.184349 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 13:58:54.009286 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-15 13:58:54.009792 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:58:54.009792 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-15 13:58:55.144911 (Thread-1): SQL status: SUCCESS 1 in 1.14 seconds
2021-10-15 13:58:55.146494 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 13:58:55.147524 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 13:58:55.147524 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 13:58:55.305358 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 13:58:55.305358 (Thread-1): finished collecting timing info
2021-10-15 13:58:55.306359 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-15 13:58:55.575382 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c042b8f9-dee2-423d-81e4-227e5343d0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FF0A448E0>]}
2021-10-15 13:58:55.575382 (Thread-1): 15:58:55 | 7 of 7 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.40s]
2021-10-15 13:58:55.576748 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 13:58:55.578061 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 13:58:55.578061 (MainThread): Using snowflake connection "master".
2021-10-15 13:58:55.578061 (MainThread): On master: BEGIN
2021-10-15 13:58:55.578061 (MainThread): Opening a new connection, currently in state closed
2021-10-15 13:58:56.574909 (MainThread): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-15 13:58:56.574909 (MainThread): On master: COMMIT
2021-10-15 13:58:56.574909 (MainThread): Using snowflake connection "master".
2021-10-15 13:58:56.574909 (MainThread): On master: COMMIT
2021-10-15 13:58:56.800439 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-15 13:58:56.801513 (MainThread): 15:58:56 | 
2021-10-15 13:58:56.801513 (MainThread): 15:58:56 | Running 3 on-run-end hooks
2021-10-15 13:58:56.803439 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-15 13:58:56.804444 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-15 13:58:56.809486 (MainThread): 15:58:56 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-15 13:58:56.809486 (MainThread): Using snowflake connection "master".
2021-10-15 13:58:56.810436 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-15 13:58:56.977025 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 13:58:56.978024 (MainThread): 15:58:56 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.17s]
2021-10-15 13:58:56.979026 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-15 13:58:56.981025 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-15 13:58:56.985112 (MainThread): 15:58:56 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-15 13:58:56.986023 (MainThread): Using snowflake connection "master".
2021-10-15 13:58:56.986023 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-15 13:58:57.211011 (MainThread): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-15 13:58:57.213245 (MainThread): 15:58:57 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.23s]
2021-10-15 13:58:57.215242 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-15 13:58:57.216241 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-15 13:58:57.221209 (MainThread): 15:58:57 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-15 13:58:57.222176 (MainThread): Using snowflake connection "master".
2021-10-15 13:58:57.222176 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-15 13:58:57.397694 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-15 13:58:57.398692 (MainThread): 15:58:57 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.18s]
2021-10-15 13:58:57.399692 (MainThread): 15:58:57 | 
2021-10-15 13:58:57.400692 (MainThread): On master: Close
2021-10-15 13:58:57.650404 (MainThread): 15:58:57 | 
2021-10-15 13:58:57.651397 (MainThread): 15:58:57 | Finished running 4 table models, 2 incremental models, 1 view model, 3 hooks in 23.94s.
2021-10-15 13:58:57.652584 (MainThread): Connection 'master' was properly closed.
2021-10-15 13:58:57.652584 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 13:58:57.652584 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 13:58:57.652584 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-15 13:58:57.666733 (MainThread): 
2021-10-15 13:58:57.666733 (MainThread): Completed successfully
2021-10-15 13:58:57.669321 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-15 13:58:57.670417 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FF0A3A280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FF0A44FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FF0A44250>]}
2021-10-15 13:58:57.670417 (MainThread): Flushing usage events
2021-10-15 14:03:53.052245 (MainThread): Running with dbt=0.20.2
2021-10-15 14:03:53.699490 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 14:03:53.700655 (MainThread): Tracking: tracking
2021-10-15 14:03:53.700655 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002816DC2CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002816F178790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002816F178760>]}
2021-10-15 14:03:53.709644 (MainThread): Partial parsing not enabled
2021-10-15 14:03:53.724640 (MainThread): Parsing macros\adapters.sql
2021-10-15 14:03:53.744751 (MainThread): Parsing macros\catalog.sql
2021-10-15 14:03:53.746425 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 14:03:53.753510 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 14:03:53.754519 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 14:03:53.757519 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 14:03:53.758527 (MainThread): Parsing macros\core.sql
2021-10-15 14:03:53.760526 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 14:03:53.791764 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 14:03:53.798007 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 14:03:53.799001 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 14:03:53.800005 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 14:03:53.800999 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 14:03:53.802920 (MainThread): Parsing macros\etc\query.sql
2021-10-15 14:03:53.802920 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 14:03:53.810171 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 14:03:53.815170 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 14:03:53.825171 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 14:03:53.826172 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 14:03:53.831170 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 14:03:53.847267 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 14:03:53.868454 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 14:03:53.869637 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 14:03:53.881860 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 14:03:53.886063 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 14:03:53.889062 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 14:03:53.892062 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 14:03:53.894063 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 14:03:53.894063 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 14:03:53.895063 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 14:03:54.032672 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:03:54.041582 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:03:54.043585 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:03:54.046585 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:03:54.046585 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 14:03:54.049584 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:03:54.051584 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:03:54.066820 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:03:54.076931 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 14:03:54.078930 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:03:54.078930 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 14:03:54.080931 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:03:54.084922 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-15 14:03:54.087893 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-15 14:03:54.088893 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-15 14:03:54.091893 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-15 14:03:54.140379 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:03:54.142377 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:03:54.149247 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:03:54.149247 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:03:54.151292 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:03:54.152292 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:03:54.154292 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:03:54.155292 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:03:54.163269 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:03:54.163269 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:03:54.185786 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30aeed28-adcd-4959-9e34-32c236f2346c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002816F16D070>]}
2021-10-15 14:03:54.204556 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 14:03:54.205560 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30aeed28-adcd-4959-9e34-32c236f2346c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002816F16D4C0>]}
2021-10-15 14:03:54.205560 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 151 macros, 4 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 14:03:54.206661 (MainThread): 
2021-10-15 14:03:54.207556 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:03:54.208592 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 14:03:54.216864 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 14:03:54.216864 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 14:03:54.216864 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 14:03:55.678071 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.46 seconds
2021-10-15 14:03:55.681147 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 14:03:55.978449 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 14:03:55.982495 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 14:03:55.982495 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 14:03:55.982495 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 14:03:56.772740 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.79 seconds
2021-10-15 14:03:56.774739 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 14:03:57.121813 (MainThread): Using snowflake connection "master".
2021-10-15 14:03:57.121813 (MainThread): On master: BEGIN
2021-10-15 14:03:57.121813 (MainThread): Opening a new connection, currently in state init
2021-10-15 14:03:58.082780 (MainThread): SQL status: SUCCESS 1 in 0.96 seconds
2021-10-15 14:03:58.082780 (MainThread): On master: COMMIT
2021-10-15 14:03:58.082780 (MainThread): Using snowflake connection "master".
2021-10-15 14:03:58.083787 (MainThread): On master: COMMIT
2021-10-15 14:03:58.313746 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-15 14:03:58.313746 (MainThread): 16:03:58 | 
2021-10-15 14:03:58.314764 (MainThread): 16:03:58 | Running 1 on-run-start hook
2021-10-15 14:03:58.315751 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-15 14:03:58.316775 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-15 14:03:58.319916 (MainThread): 16:03:58 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-15 14:03:58.319916 (MainThread): Using snowflake connection "master".
2021-10-15 14:03:58.321316 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-15 14:03:58.708866 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2021-10-15 14:03:58.709911 (MainThread): 16:03:58 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.39s]
2021-10-15 14:03:58.710617 (MainThread): 16:03:58 | 
2021-10-15 14:03:58.710617 (MainThread): On master: Close
2021-10-15 14:03:58.975498 (MainThread): 16:03:58 | Concurrency: 1 threads (target='dev')
2021-10-15 14:03:58.975498 (MainThread): 16:03:58 | 
2021-10-15 14:03:58.982091 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:03:58.982091 (Thread-1): 16:03:58 | 1 of 7 START table model dbt.first_model............................. [RUN]
2021-10-15 14:03:58.983091 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:03:58.983091 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:03:58.986326 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 14:03:58.997326 (Thread-1): finished collecting timing info
2021-10-15 14:03:59.014668 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 14:03:59.020662 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:03:59.020662 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 14:03:59.020662 (Thread-1): Opening a new connection, currently in state init
2021-10-15 14:03:59.769056 (Thread-1): SQL status: SUCCESS 1 in 0.75 seconds
2021-10-15 14:03:59.770058 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:03:59.770058 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below

    post_hook="grant select on analytics.dbt.first_model to role analyst" can put in config
*/




with source_data as (

    select 1 as id
    union all
    select null as id
    union all
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 14:04:00.777709 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-15 14:04:00.779724 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 14:04:00.779724 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:04:00.779724 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 14:04:00.923635 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 14:04:00.930722 (Thread-1): finished collecting timing info
2021-10-15 14:04:00.930722 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 14:04:01.205389 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30aeed28-adcd-4959-9e34-32c236f2346c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002816F5AAE50>]}
2021-10-15 14:04:01.206390 (Thread-1): 16:04:01 | 1 of 7 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.22s]
2021-10-15 14:04:01.207381 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:04:01.207381 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 14:04:01.207381 (Thread-1): 16:04:01 | 2 of 7 START table model dbt.cul_order_price......................... [RUN]
2021-10-15 14:04:01.208383 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:04:01.208383 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 14:04:01.209456 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 14:04:01.210380 (Thread-1): finished collecting timing info
2021-10-15 14:04:01.212460 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 14:04:01.213967 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:04:01.213967 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-15 14:04:01.213967 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 14:04:01.975893 (Thread-1): SQL status: SUCCESS 1 in 0.76 seconds
2021-10-15 14:04:01.976057 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:04:01.976109 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-15 14:04:03.759492 (Thread-1): SQL status: SUCCESS 1 in 1.78 seconds
2021-10-15 14:04:03.760858 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 14:04:03.760858 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:04:03.760858 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 14:04:03.915606 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 14:04:03.916618 (Thread-1): finished collecting timing info
2021-10-15 14:04:03.916618 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-15 14:04:04.182540 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30aeed28-adcd-4959-9e34-32c236f2346c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002816F2D16D0>]}
2021-10-15 14:04:04.183808 (Thread-1): 16:04:04 | 2 of 7 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.97s]
2021-10-15 14:04:04.185827 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 14:04:04.186828 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-15 14:04:04.186828 (Thread-1): 16:04:04 | 3 of 7 START incremental model dbt.dates............................. [RUN]
2021-10-15 14:04:04.189362 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:04:04.189362 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-15 14:04:04.199444 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 14:04:04.201356 (Thread-1): finished collecting timing info
2021-10-15 14:04:04.218988 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:04:04.219171 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-15 14:04:04.219675 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 14:04:05.393727 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2021-10-15 14:04:05.406971 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:04:05.406971 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-15 14:04:05.566743 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 14:04:05.569240 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:04:05.569240 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 14:04:05.710843 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 14:04:05.711844 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:04:05.712852 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 14:04:05.850242 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 14:04:05.869072 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 14:04:05.871173 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:04:05.871173 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-15 14:04:06.098320 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-15 14:04:06.098320 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:04:06.099424 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-15 14:04:06.465884 (Thread-1): SQL status: SUCCESS 0 in 0.37 seconds
2021-10-15 14:04:06.467874 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 14:04:06.467874 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:04:06.467874 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 14:04:06.706032 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-15 14:04:06.706032 (Thread-1): finished collecting timing info
2021-10-15 14:04:06.706032 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-15 14:04:07.001276 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30aeed28-adcd-4959-9e34-32c236f2346c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002816F2AEE20>]}
2021-10-15 14:04:07.002948 (Thread-1): 16:04:07 | 3 of 7 OK created incremental model dbt.dates........................ [SUCCESS 0 in 2.81s]
2021-10-15 14:04:07.003963 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-15 14:04:07.005063 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 14:04:07.005969 (Thread-1): 16:04:07 | 4 of 7 START view model dbt.playing_with_tests....................... [RUN]
2021-10-15 14:04:07.006101 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:04:07.006101 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 14:04:07.007271 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 14:04:07.009271 (Thread-1): finished collecting timing info
2021-10-15 14:04:07.026918 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 14:04:07.027958 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:04:07.028919 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-15 14:04:07.028919 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 14:04:07.945925 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2021-10-15 14:04:07.945925 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:04:07.945925 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */

  create or replace  view analytics.dbt.playing_with_tests  as (
    SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF001"."CUSTOMER"
  );
2021-10-15 14:04:08.348193 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-10-15 14:04:08.350189 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 14:04:08.351212 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:04:08.351212 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 14:04:08.493533 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 14:04:08.494549 (Thread-1): finished collecting timing info
2021-10-15 14:04:08.495546 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-15 14:04:08.773917 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30aeed28-adcd-4959-9e34-32c236f2346c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002816F597520>]}
2021-10-15 14:04:08.773917 (Thread-1): 16:04:08 | 4 of 7 OK created view model dbt.playing_with_tests.................. [SUCCESS 1 in 1.77s]
2021-10-15 14:04:08.775028 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 14:04:08.775917 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 14:04:08.775917 (Thread-1): 16:04:08 | 5 of 7 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-15 14:04:08.776723 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:04:08.776723 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 14:04:08.777733 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 14:04:08.779735 (Thread-1): finished collecting timing info
2021-10-15 14:04:08.781734 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 14:04:08.783733 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:04:08.783733 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-15 14:04:08.783733 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 14:04:09.658533 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-15 14:04:09.658533 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:04:09.658533 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-15 14:04:11.149395 (Thread-1): SQL status: SUCCESS 1 in 1.49 seconds
2021-10-15 14:04:11.151403 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 14:04:11.151403 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:04:11.151403 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 14:04:11.305327 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 14:04:11.306323 (Thread-1): finished collecting timing info
2021-10-15 14:04:11.306323 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-15 14:04:11.608876 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30aeed28-adcd-4959-9e34-32c236f2346c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002816F42E7C0>]}
2021-10-15 14:04:11.609871 (Thread-1): 16:04:11 | 5 of 7 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.83s]
2021-10-15 14:04:11.610890 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 14:04:11.611912 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-15 14:04:11.611912 (Thread-1): 16:04:11 | 6 of 7 START incremental model dbt.time.............................. [RUN]
2021-10-15 14:04:11.611912 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:04:11.611912 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-15 14:04:11.616042 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 14:04:11.619507 (Thread-1): finished collecting timing info
2021-10-15 14:04:11.621613 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:04:11.622638 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-15 14:04:11.622638 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 14:04:13.425736 (Thread-1): SQL status: SUCCESS 1 in 1.80 seconds
2021-10-15 14:04:13.427732 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:04:13.428738 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-15 14:04:13.619481 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 14:04:13.623236 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:04:13.623236 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 14:04:13.792437 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 14:04:13.794437 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:04:13.794437 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 14:04:13.946776 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 14:04:13.949826 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 14:04:13.952734 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:04:13.952734 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-15 14:04:14.155575 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-15 14:04:14.156577 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:04:14.156577 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-15 14:04:14.851098 (Thread-1): SQL status: SUCCESS 323 in 0.69 seconds
2021-10-15 14:04:14.853095 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 14:04:14.853095 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:04:14.853095 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 14:04:15.222481 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-10-15 14:04:15.223479 (Thread-1): finished collecting timing info
2021-10-15 14:04:15.223479 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-15 14:04:15.587798 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30aeed28-adcd-4959-9e34-32c236f2346c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002816F625460>]}
2021-10-15 14:04:15.587798 (Thread-1): 16:04:15 | 6 of 7 OK created incremental model dbt.time......................... [SUCCESS 323 in 3.98s]
2021-10-15 14:04:15.589238 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-15 14:04:15.589238 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 14:04:15.589238 (Thread-1): 16:04:15 | 7 of 7 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-15 14:04:15.590244 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 14:04:15.590244 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 14:04:15.591323 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 14:04:15.593285 (Thread-1): finished collecting timing info
2021-10-15 14:04:15.594246 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 14:04:15.596245 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 14:04:15.596245 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-15 14:04:15.596245 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 14:04:16.347025 (Thread-1): SQL status: SUCCESS 1 in 0.75 seconds
2021-10-15 14:04:16.347025 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 14:04:16.347025 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-15 14:04:17.473935 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2021-10-15 14:04:17.475979 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 14:04:17.475979 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 14:04:17.475979 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 14:04:17.733325 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-15 14:04:17.734331 (Thread-1): finished collecting timing info
2021-10-15 14:04:17.734331 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-15 14:04:18.174146 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30aeed28-adcd-4959-9e34-32c236f2346c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002816F1522B0>]}
2021-10-15 14:04:18.175292 (Thread-1): 16:04:18 | 7 of 7 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.58s]
2021-10-15 14:04:18.176495 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 14:04:18.177646 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:04:18.177646 (MainThread): Using snowflake connection "master".
2021-10-15 14:04:18.177646 (MainThread): On master: BEGIN
2021-10-15 14:04:18.177646 (MainThread): Opening a new connection, currently in state closed
2021-10-15 14:04:18.907591 (MainThread): SQL status: SUCCESS 1 in 0.73 seconds
2021-10-15 14:04:18.907591 (MainThread): On master: COMMIT
2021-10-15 14:04:18.907591 (MainThread): Using snowflake connection "master".
2021-10-15 14:04:18.908833 (MainThread): On master: COMMIT
2021-10-15 14:04:19.160113 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-15 14:04:19.160113 (MainThread): 16:04:19 | 
2021-10-15 14:04:19.161120 (MainThread): 16:04:19 | Running 3 on-run-end hooks
2021-10-15 14:04:19.161120 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-15 14:04:19.164137 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-15 14:04:19.167135 (MainThread): 16:04:19 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-15 14:04:19.168138 (MainThread): Using snowflake connection "master".
2021-10-15 14:04:19.168138 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-15 14:04:19.323533 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 14:04:19.324623 (MainThread): 16:04:19 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.16s]
2021-10-15 14:04:19.324623 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-15 14:04:19.325541 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-15 14:04:19.327005 (MainThread): 16:04:19 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-15 14:04:19.328009 (MainThread): Using snowflake connection "master".
2021-10-15 14:04:19.328009 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-15 14:04:19.596488 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-15 14:04:19.597462 (MainThread): 16:04:19 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.27s]
2021-10-15 14:04:19.598365 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-15 14:04:19.599456 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-15 14:04:19.600365 (MainThread): 16:04:19 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-15 14:04:19.601457 (MainThread): Using snowflake connection "master".
2021-10-15 14:04:19.602049 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-15 14:04:19.807357 (MainThread): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-15 14:04:19.807357 (MainThread): 16:04:19 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.21s]
2021-10-15 14:04:19.808959 (MainThread): 16:04:19 | 
2021-10-15 14:04:19.808959 (MainThread): On master: Close
2021-10-15 14:04:20.063368 (MainThread): 16:04:20 | 
2021-10-15 14:04:20.064403 (MainThread): 16:04:20 | Finished running 4 table models, 2 incremental models, 1 view model, 4 hooks in 25.86s.
2021-10-15 14:04:20.066294 (MainThread): Connection 'master' was properly closed.
2021-10-15 14:04:20.066294 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 14:04:20.066294 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 14:04:20.066294 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-15 14:04:20.081197 (MainThread): 
2021-10-15 14:04:20.081197 (MainThread): Completed successfully
2021-10-15 14:04:20.082198 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-15 14:04:20.082198 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002816F625460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002816F1C5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002816F2AEC40>]}
2021-10-15 14:04:20.082198 (MainThread): Flushing usage events
2021-10-15 14:15:48.427585 (MainThread): Running with dbt=0.20.2
2021-10-15 14:15:49.128040 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['example.my_first_dbt_model'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 14:15:49.128040 (MainThread): Tracking: tracking
2021-10-15 14:15:49.128040 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B90FECE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B9252A340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B9252AF40>]}
2021-10-15 14:15:49.137231 (MainThread): Partial parsing not enabled
2021-10-15 14:15:49.153070 (MainThread): Parsing macros\adapters.sql
2021-10-15 14:15:49.174415 (MainThread): Parsing macros\catalog.sql
2021-10-15 14:15:49.175396 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 14:15:49.182112 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 14:15:49.183447 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 14:15:49.188572 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 14:15:49.189598 (MainThread): Parsing macros\core.sql
2021-10-15 14:15:49.192787 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 14:15:49.227426 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 14:15:49.233434 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 14:15:49.234426 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 14:15:49.236425 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 14:15:49.237499 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 14:15:49.239021 (MainThread): Parsing macros\etc\query.sql
2021-10-15 14:15:49.239021 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 14:15:49.246457 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 14:15:49.251027 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 14:15:49.261023 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 14:15:49.262024 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 14:15:49.268024 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 14:15:49.286512 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 14:15:49.309195 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 14:15:49.310197 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 14:15:49.323784 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 14:15:49.328784 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 14:15:49.332917 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 14:15:49.338932 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 14:15:49.340933 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 14:15:49.341934 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 14:15:49.342934 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 14:15:49.485369 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:15:49.491777 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:15:49.493708 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:15:49.495779 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:15:49.495779 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 14:15:49.497779 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:15:49.499698 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:15:49.509043 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:15:49.524850 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 14:15:49.526842 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:15:49.527845 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 14:15:49.529845 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:15:49.538255 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-15 14:15:49.540351 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-15 14:15:49.542339 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-15 14:15:49.544339 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-15 14:15:49.603168 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:15:49.604945 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:15:49.611903 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:15:49.612019 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:15:49.613724 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:15:49.615421 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:15:49.616858 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:15:49.619169 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:15:49.629472 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:15:49.629591 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:15:49.648886 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c82a260c-9398-4af6-af35-4b1c1a877dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B92592DF0>]}
2021-10-15 14:15:49.667656 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 14:15:49.670392 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c82a260c-9398-4af6-af35-4b1c1a877dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B92592E50>]}
2021-10-15 14:15:49.670888 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 151 macros, 4 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 14:15:49.672014 (MainThread): 
2021-10-15 14:15:49.673273 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:15:49.675073 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 14:15:49.688704 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 14:15:49.688704 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 14:15:49.688704 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 14:15:51.454379 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.77 seconds
2021-10-15 14:15:51.457380 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 14:15:51.742994 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 14:15:51.747215 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 14:15:51.747215 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 14:15:51.747215 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 14:15:52.748786 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.00 seconds
2021-10-15 14:15:52.749700 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 14:15:53.055111 (MainThread): Using snowflake connection "master".
2021-10-15 14:15:53.055111 (MainThread): On master: BEGIN
2021-10-15 14:15:53.055111 (MainThread): Opening a new connection, currently in state init
2021-10-15 14:15:54.228909 (MainThread): SQL status: SUCCESS 1 in 1.17 seconds
2021-10-15 14:15:54.228909 (MainThread): On master: COMMIT
2021-10-15 14:15:54.228909 (MainThread): Using snowflake connection "master".
2021-10-15 14:15:54.228909 (MainThread): On master: COMMIT
2021-10-15 14:15:54.465814 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-15 14:15:54.465814 (MainThread): 16:15:54 | 
2021-10-15 14:15:54.466997 (MainThread): 16:15:54 | Running 1 on-run-start hook
2021-10-15 14:15:54.467502 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-15 14:15:54.468515 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-15 14:15:54.473514 (MainThread): 16:15:54 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-15 14:15:54.474717 (MainThread): Using snowflake connection "master".
2021-10-15 14:15:54.474717 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-15 14:15:54.696505 (MainThread): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-15 14:15:54.696505 (MainThread): 16:15:54 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.22s]
2021-10-15 14:15:54.697486 (MainThread): 16:15:54 | 
2021-10-15 14:15:54.698456 (MainThread): On master: Close
2021-10-15 14:15:54.995267 (MainThread): 16:15:54 | Concurrency: 1 threads (target='dev')
2021-10-15 14:15:54.995267 (MainThread): 16:15:54 | 
2021-10-15 14:15:54.999660 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:15:54.999985 (Thread-1): 16:15:54 | 1 of 1 START table model dbt.first_model............................. [RUN]
2021-10-15 14:15:55.000374 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:15:55.000398 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:15:55.002341 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 14:15:55.003932 (Thread-1): finished collecting timing info
2021-10-15 14:15:55.036272 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 14:15:55.038928 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:15:55.038928 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 14:15:55.038928 (Thread-1): Opening a new connection, currently in state init
2021-10-15 14:15:56.150364 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2021-10-15 14:15:56.150364 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:15:56.150364 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below

    post_hook="grant select on analytics.dbt.first_model to role analyst" can put in config
*/




with source_data as (

    select 1 as id, "CA" AS state, "2020-01-01 00:00:00.000"::timestamp as updated_at
    union all
    select null as id, "TX" AS state, "2020-01-01 00:00:00.000"::timestamp as updated_at
    union all
    select 3 as id, "VT" AS state, "2020-01-01 00:00:00.000"::timestamp as updated_at

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 14:15:56.386720 (Thread-1): Snowflake query id: 019fa037-0601-3c5d-0000-00664703d61d
2021-10-15 14:15:56.386720 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 20
invalid identifier 'CA'
2021-10-15 14:15:56.386720 (Thread-1): finished collecting timing info
2021-10-15 14:15:56.386720 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: ROLLBACK
2021-10-15 14:15:56.615340 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 14:15:56.992962 (Thread-1): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  000904 (42000): SQL compilation error: error line 17 at position 20
  invalid identifier 'CA'
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 17 at position 20
invalid identifier 'CA'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  000904 (42000): SQL compilation error: error line 17 at position 20
  invalid identifier 'CA'
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-15 14:15:56.994312 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c82a260c-9398-4af6-af35-4b1c1a877dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B928F7D30>]}
2021-10-15 14:15:56.994570 (Thread-1): 16:15:56 | 1 of 1 ERROR creating table model dbt.first_model.................... [ERROR in 1.99s]
2021-10-15 14:15:56.995108 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:15:56.996170 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:15:56.996170 (MainThread): Using snowflake connection "master".
2021-10-15 14:15:56.996170 (MainThread): On master: BEGIN
2021-10-15 14:15:56.997144 (MainThread): Opening a new connection, currently in state closed
2021-10-15 14:15:57.845283 (MainThread): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-15 14:15:57.846360 (MainThread): On master: COMMIT
2021-10-15 14:15:57.846360 (MainThread): Using snowflake connection "master".
2021-10-15 14:15:57.846360 (MainThread): On master: COMMIT
2021-10-15 14:15:58.180716 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-15 14:15:58.180716 (MainThread): 16:15:58 | 
2021-10-15 14:15:58.180716 (MainThread): 16:15:58 | Running 3 on-run-end hooks
2021-10-15 14:15:58.182851 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-15 14:15:58.184085 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-15 14:15:58.187241 (MainThread): 16:15:58 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-15 14:15:58.188240 (MainThread): Using snowflake connection "master".
2021-10-15 14:15:58.188240 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-15 14:15:58.358099 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 14:15:58.358823 (MainThread): 16:15:58 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.17s]
2021-10-15 14:15:58.359368 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-15 14:15:58.360776 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-15 14:15:58.362817 (MainThread): 16:15:58 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-15 14:15:58.363391 (MainThread): Using snowflake connection "master".
2021-10-15 14:15:58.363391 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-15 14:15:58.676876 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-10-15 14:15:58.676876 (MainThread): 16:15:58 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.31s]
2021-10-15 14:15:58.677911 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-15 14:15:58.678886 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-15 14:15:58.680827 (MainThread): 16:15:58 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-15 14:15:58.681829 (MainThread): Using snowflake connection "master".
2021-10-15 14:15:58.681829 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-15 14:15:58.955699 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-15 14:15:58.956697 (MainThread): 16:15:58 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.27s]
2021-10-15 14:15:58.957700 (MainThread): 16:15:58 | 
2021-10-15 14:15:58.957700 (MainThread): On master: Close
2021-10-15 14:15:59.281365 (MainThread): 16:15:59 | 
2021-10-15 14:15:59.282341 (MainThread): 16:15:59 | Finished running 1 table model, 4 hooks in 9.61s.
2021-10-15 14:15:59.284340 (MainThread): Connection 'master' was properly closed.
2021-10-15 14:15:59.284340 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 14:15:59.284340 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 14:15:59.284340 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_first_dbt_model' was properly closed.
2021-10-15 14:15:59.296770 (MainThread): 
2021-10-15 14:15:59.296770 (MainThread): Completed with 1 error and 0 warnings:
2021-10-15 14:15:59.297727 (MainThread): 
2021-10-15 14:15:59.299727 (MainThread): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-15 14:15:59.299727 (MainThread):   000904 (42000): SQL compilation error: error line 17 at position 20
2021-10-15 14:15:59.300730 (MainThread):   invalid identifier 'CA'
2021-10-15 14:15:59.300730 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-15 14:15:59.301727 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-15 14:15:59.302364 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B925F90D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B928F0EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B928F08E0>]}
2021-10-15 14:15:59.302364 (MainThread): Flushing usage events
2021-10-15 14:18:00.749211 (MainThread): Running with dbt=0.20.2
2021-10-15 14:18:01.405148 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 14:18:01.405148 (MainThread): Tracking: tracking
2021-10-15 14:18:01.405148 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115B8CCC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115CE19400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115CE196D0>]}
2021-10-15 14:18:01.414640 (MainThread): Partial parsing not enabled
2021-10-15 14:18:01.431127 (MainThread): Parsing macros\adapters.sql
2021-10-15 14:18:01.450110 (MainThread): Parsing macros\catalog.sql
2021-10-15 14:18:01.452152 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 14:18:01.458095 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 14:18:01.460084 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 14:18:01.462087 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 14:18:01.463004 (MainThread): Parsing macros\core.sql
2021-10-15 14:18:01.466099 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 14:18:01.504261 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 14:18:01.511754 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 14:18:01.512190 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 14:18:01.512691 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 14:18:01.514697 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 14:18:01.515715 (MainThread): Parsing macros\etc\query.sql
2021-10-15 14:18:01.516790 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 14:18:01.524027 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 14:18:01.529027 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 14:18:01.539027 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 14:18:01.540027 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 14:18:01.546011 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 14:18:01.561463 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 14:18:01.584436 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 14:18:01.585457 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 14:18:01.600020 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 14:18:01.604706 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 14:18:01.608705 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 14:18:01.613027 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 14:18:01.614953 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 14:18:01.616021 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 14:18:01.617026 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 14:18:01.747953 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:18:01.755309 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:18:01.757309 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:18:01.759309 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:01.760310 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 14:18:01.762304 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:18:01.764301 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:18:01.770542 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:18:01.780662 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 14:18:01.782786 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:01.783787 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 14:18:01.785787 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:01.791814 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-15 14:18:01.792789 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-15 14:18:01.794787 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-15 14:18:01.797539 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-15 14:18:01.849150 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:01.850151 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:01.856151 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:01.856151 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:01.857946 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:01.859086 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:01.860086 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:01.861086 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:01.867086 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:01.868086 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:01.889265 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1adc01a-876e-4261-9c20-728697313bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115CE86280>]}
2021-10-15 14:18:01.905397 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 14:18:01.906376 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1adc01a-876e-4261-9c20-728697313bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115CE86A30>]}
2021-10-15 14:18:01.906376 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 151 macros, 4 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 14:18:01.908309 (MainThread): 
2021-10-15 14:18:01.908309 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:18:01.910310 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 14:18:01.918392 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 14:18:01.918392 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 14:18:01.918392 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 14:18:03.931975 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.01 seconds
2021-10-15 14:18:03.936518 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 14:18:04.386745 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 14:18:04.391752 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 14:18:04.391752 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 14:18:04.391752 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 14:18:05.681292 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.29 seconds
2021-10-15 14:18:05.683856 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 14:18:06.041953 (MainThread): Using snowflake connection "master".
2021-10-15 14:18:06.041953 (MainThread): On master: BEGIN
2021-10-15 14:18:06.041953 (MainThread): Opening a new connection, currently in state init
2021-10-15 14:18:06.961130 (MainThread): SQL status: SUCCESS 1 in 0.92 seconds
2021-10-15 14:18:06.961130 (MainThread): On master: COMMIT
2021-10-15 14:18:06.961130 (MainThread): Using snowflake connection "master".
2021-10-15 14:18:06.961130 (MainThread): On master: COMMIT
2021-10-15 14:18:07.318222 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-15 14:18:07.318222 (MainThread): 16:18:07 | 
2021-10-15 14:18:07.319232 (MainThread): 16:18:07 | Running 1 on-run-start hook
2021-10-15 14:18:07.322144 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-15 14:18:07.323143 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-15 14:18:07.327146 (MainThread): 16:18:07 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-15 14:18:07.327146 (MainThread): Using snowflake connection "master".
2021-10-15 14:18:07.328145 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-15 14:18:07.779677 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2021-10-15 14:18:07.781699 (MainThread): 16:18:07 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.45s]
2021-10-15 14:18:07.782624 (MainThread): 16:18:07 | 
2021-10-15 14:18:07.783624 (MainThread): On master: Close
2021-10-15 14:18:08.234437 (MainThread): 16:18:08 | Concurrency: 1 threads (target='dev')
2021-10-15 14:18:08.234437 (MainThread): 16:18:08 | 
2021-10-15 14:18:08.237438 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:18:08.238439 (Thread-1): 16:18:08 | 1 of 7 START table model dbt.first_model............................. [RUN]
2021-10-15 14:18:08.238439 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:18:08.238439 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:18:08.240436 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 14:18:08.247762 (Thread-1): finished collecting timing info
2021-10-15 14:18:08.265466 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 14:18:08.274768 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:18:08.274768 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 14:18:08.274768 (Thread-1): Opening a new connection, currently in state init
2021-10-15 14:18:09.514389 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-10-15 14:18:09.514389 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:18:09.514389 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below

    post_hook="grant select on analytics.dbt.first_model to role analyst" can put in config
*/




with source_data as (

    select 1 as id, "CA" as state, "2020-01-01 00:00:00.000"::timestamp as updated_at
    union all
    select null as id, "TX" as state, "2020-01-01 00:00:00.000"::timestamp as updated_at
    union all
    select 3 as id, "VT" as state, "2020-01-01 00:00:00.000"::timestamp as updated_at

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 14:18:09.798983 (Thread-1): Snowflake query id: 019fa03a-0601-3c5d-0000-00664703d635
2021-10-15 14:18:09.798983 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 20
invalid identifier 'CA'
2021-10-15 14:18:09.798983 (Thread-1): finished collecting timing info
2021-10-15 14:18:09.798983 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: ROLLBACK
2021-10-15 14:18:10.145808 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 14:18:10.497817 (Thread-1): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  000904 (42000): SQL compilation error: error line 17 at position 20
  invalid identifier 'CA'
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 17 at position 20
invalid identifier 'CA'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  000904 (42000): SQL compilation error: error line 17 at position 20
  invalid identifier 'CA'
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-15 14:18:10.499814 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1adc01a-876e-4261-9c20-728697313bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115D242D30>]}
2021-10-15 14:18:10.499814 (Thread-1): 16:18:10 | 1 of 7 ERROR creating table model dbt.first_model.................... [ERROR in 2.26s]
2021-10-15 14:18:10.500823 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:18:10.501831 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 14:18:10.501831 (Thread-1): 16:18:10 | 2 of 7 START table model dbt.cul_order_price......................... [RUN]
2021-10-15 14:18:10.501831 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:18:10.501831 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 14:18:10.502832 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 14:18:10.504831 (Thread-1): finished collecting timing info
2021-10-15 14:18:10.506470 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 14:18:10.507796 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:18:10.507796 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-15 14:18:10.507796 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 14:18:11.479999 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-15 14:18:11.481092 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:18:11.481092 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-15 14:18:14.534899 (Thread-1): SQL status: SUCCESS 1 in 3.05 seconds
2021-10-15 14:18:14.536898 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 14:18:14.536898 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:18:14.536898 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 14:18:14.845899 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-10-15 14:18:14.855968 (Thread-1): finished collecting timing info
2021-10-15 14:18:14.855968 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-15 14:18:15.235293 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1adc01a-876e-4261-9c20-728697313bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115CF22490>]}
2021-10-15 14:18:15.235293 (Thread-1): 16:18:15 | 2 of 7 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 4.73s]
2021-10-15 14:18:15.236554 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 14:18:15.236554 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-15 14:18:15.236554 (Thread-1): 16:18:15 | 3 of 7 START incremental model dbt.dates............................. [RUN]
2021-10-15 14:18:15.236554 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:18:15.237525 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-15 14:18:15.240027 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 14:18:15.242109 (Thread-1): finished collecting timing info
2021-10-15 14:18:15.256188 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:18:15.256188 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-15 14:18:15.256188 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 14:18:16.987067 (Thread-1): SQL status: SUCCESS 1 in 1.73 seconds
2021-10-15 14:18:16.995079 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:18:16.995079 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-15 14:18:17.268035 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-15 14:18:17.271042 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:18:17.271042 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 14:18:17.450575 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-15 14:18:17.452548 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:18:17.452548 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 14:18:17.640918 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 14:18:17.652165 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 14:18:17.654123 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:18:17.654123 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-15 14:18:17.875011 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-15 14:18:17.875011 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:18:17.875011 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-15 14:18:18.821106 (Thread-1): SQL status: SUCCESS 0 in 0.95 seconds
2021-10-15 14:18:18.823106 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 14:18:18.823106 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:18:18.823106 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 14:18:19.218908 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-10-15 14:18:19.221052 (Thread-1): finished collecting timing info
2021-10-15 14:18:19.222191 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-15 14:18:19.636228 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1adc01a-876e-4261-9c20-728697313bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115D2231C0>]}
2021-10-15 14:18:19.637228 (Thread-1): 16:18:19 | 3 of 7 OK created incremental model dbt.dates........................ [SUCCESS 0 in 4.40s]
2021-10-15 14:18:19.638230 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-15 14:18:19.638230 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 14:18:19.638230 (Thread-1): 16:18:19 | 4 of 7 START view model dbt.playing_with_tests....................... [RUN]
2021-10-15 14:18:19.639226 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:18:19.639226 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 14:18:19.640301 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 14:18:19.642089 (Thread-1): finished collecting timing info
2021-10-15 14:18:19.655033 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 14:18:19.657565 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:18:19.657565 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-15 14:18:19.657565 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 14:18:20.590299 (Thread-1): SQL status: SUCCESS 1 in 0.93 seconds
2021-10-15 14:18:20.590299 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:18:20.590299 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */

  create or replace  view analytics.dbt.playing_with_tests  as (
    SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF001"."CUSTOMER"
  );
2021-10-15 14:18:20.980270 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-10-15 14:18:20.982927 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 14:18:20.983425 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:18:20.983425 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 14:18:21.147452 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 14:18:21.152921 (Thread-1): finished collecting timing info
2021-10-15 14:18:21.153103 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-15 14:18:21.506760 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1adc01a-876e-4261-9c20-728697313bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115D222B50>]}
2021-10-15 14:18:21.507748 (Thread-1): 16:18:21 | 4 of 7 OK created view model dbt.playing_with_tests.................. [SUCCESS 1 in 1.87s]
2021-10-15 14:18:21.509668 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 14:18:21.509668 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 14:18:21.509668 (Thread-1): 16:18:21 | 5 of 7 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-15 14:18:21.510956 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:18:21.510956 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 14:18:21.511965 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 14:18:21.513965 (Thread-1): finished collecting timing info
2021-10-15 14:18:21.517234 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 14:18:21.520125 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:18:21.520125 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-15 14:18:21.520125 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 14:18:22.409535 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-10-15 14:18:22.409535 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:18:22.409535 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-15 14:18:24.062439 (Thread-1): SQL status: SUCCESS 1 in 1.65 seconds
2021-10-15 14:18:24.063458 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 14:18:24.063458 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:18:24.063458 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 14:18:24.252028 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 14:18:24.253043 (Thread-1): finished collecting timing info
2021-10-15 14:18:24.253043 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-15 14:18:24.581486 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1adc01a-876e-4261-9c20-728697313bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115CF23100>]}
2021-10-15 14:18:24.582488 (Thread-1): 16:18:24 | 5 of 7 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.07s]
2021-10-15 14:18:24.583409 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 14:18:24.583409 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-15 14:18:24.583409 (Thread-1): 16:18:24 | 6 of 7 START incremental model dbt.time.............................. [RUN]
2021-10-15 14:18:24.583409 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:18:24.584407 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-15 14:18:24.586794 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 14:18:24.589795 (Thread-1): finished collecting timing info
2021-10-15 14:18:24.591795 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:18:24.591795 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-15 14:18:24.591795 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 14:18:27.624288 (Thread-1): SQL status: SUCCESS 1 in 3.03 seconds
2021-10-15 14:18:27.627286 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:18:27.628286 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-15 14:18:27.813485 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 14:18:27.818503 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:18:27.818503 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 14:18:27.996375 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-15 14:18:28.000081 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:18:28.000352 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 14:18:28.226853 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-15 14:18:28.229008 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 14:18:28.233078 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:18:28.233078 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-15 14:18:28.441589 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-15 14:18:28.441589 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:18:28.441589 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-15 14:18:29.370676 (Thread-1): SQL status: SUCCESS 853 in 0.93 seconds
2021-10-15 14:18:29.371677 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 14:18:29.371677 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:18:29.371677 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 14:18:30.264599 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-10-15 14:18:30.267686 (Thread-1): finished collecting timing info
2021-10-15 14:18:30.267686 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-15 14:18:30.679173 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1adc01a-876e-4261-9c20-728697313bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115CF22070>]}
2021-10-15 14:18:30.679313 (Thread-1): 16:18:30 | 6 of 7 OK created incremental model dbt.time......................... [SUCCESS 853 in 6.10s]
2021-10-15 14:18:30.679814 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-15 14:18:30.679814 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 14:18:30.679814 (Thread-1): 16:18:30 | 7 of 7 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-10-15 14:18:30.679814 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 14:18:30.680821 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:18:30.680821 (MainThread): Using snowflake connection "master".
2021-10-15 14:18:30.680821 (MainThread): On master: BEGIN
2021-10-15 14:18:30.680821 (MainThread): Opening a new connection, currently in state closed
2021-10-15 14:18:31.809317 (MainThread): SQL status: SUCCESS 1 in 1.13 seconds
2021-10-15 14:18:31.809317 (MainThread): On master: COMMIT
2021-10-15 14:18:31.809317 (MainThread): Using snowflake connection "master".
2021-10-15 14:18:31.809317 (MainThread): On master: COMMIT
2021-10-15 14:18:32.121268 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-10-15 14:18:32.122312 (MainThread): 16:18:32 | 
2021-10-15 14:18:32.122312 (MainThread): 16:18:32 | Running 3 on-run-end hooks
2021-10-15 14:18:32.125169 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-15 14:18:32.126245 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-15 14:18:32.129803 (MainThread): 16:18:32 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-15 14:18:32.130801 (MainThread): Using snowflake connection "master".
2021-10-15 14:18:32.130801 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-15 14:18:32.295013 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 14:18:32.297127 (MainThread): 16:18:32 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.17s]
2021-10-15 14:18:32.298123 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-15 14:18:32.300239 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-15 14:18:32.302509 (MainThread): 16:18:32 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-15 14:18:32.303583 (MainThread): Using snowflake connection "master".
2021-10-15 14:18:32.303583 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-15 14:18:32.539468 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-15 14:18:32.540467 (MainThread): 16:18:32 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.24s]
2021-10-15 14:18:32.542222 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-15 14:18:32.544242 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-15 14:18:32.547642 (MainThread): 16:18:32 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-15 14:18:32.548453 (MainThread): Using snowflake connection "master".
2021-10-15 14:18:32.548453 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-15 14:18:32.767611 (MainThread): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-15 14:18:32.769604 (MainThread): 16:18:32 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.22s]
2021-10-15 14:18:32.771571 (MainThread): 16:18:32 | 
2021-10-15 14:18:32.771571 (MainThread): On master: Close
2021-10-15 14:18:33.239886 (MainThread): 16:18:33 | 
2021-10-15 14:18:33.241301 (MainThread): 16:18:33 | Finished running 4 table models, 2 incremental models, 1 view model, 4 hooks in 31.33s.
2021-10-15 14:18:33.246825 (MainThread): Connection 'master' was properly closed.
2021-10-15 14:18:33.246825 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 14:18:33.246825 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 14:18:33.246825 (MainThread): Connection 'model.lukeclarke_learn_dbt.time' was properly closed.
2021-10-15 14:18:33.266146 (MainThread): 
2021-10-15 14:18:33.266146 (MainThread): Completed with 1 error and 0 warnings:
2021-10-15 14:18:33.267142 (MainThread): 
2021-10-15 14:18:33.267142 (MainThread): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-15 14:18:33.268025 (MainThread):   000904 (42000): SQL compilation error: error line 17 at position 20
2021-10-15 14:18:33.268025 (MainThread):   invalid identifier 'CA'
2021-10-15 14:18:33.268025 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-15 14:18:33.269035 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=1 TOTAL=7
2021-10-15 14:18:33.269035 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115CE19580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115D1DBB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115D1DBD90>]}
2021-10-15 14:18:33.269035 (MainThread): Flushing usage events
2021-10-15 14:18:52.629769 (MainThread): Running with dbt=0.20.2
2021-10-15 14:18:53.256363 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['example.my_first_dbt_model'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 14:18:53.256363 (MainThread): Tracking: tracking
2021-10-15 14:18:53.256363 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF6BBCD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF80F8EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF80F8F40>]}
2021-10-15 14:18:53.264364 (MainThread): Partial parsing not enabled
2021-10-15 14:18:53.280575 (MainThread): Parsing macros\adapters.sql
2021-10-15 14:18:53.299653 (MainThread): Parsing macros\catalog.sql
2021-10-15 14:18:53.301622 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 14:18:53.308714 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 14:18:53.309738 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 14:18:53.312706 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 14:18:53.312706 (MainThread): Parsing macros\core.sql
2021-10-15 14:18:53.315719 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 14:18:53.349926 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 14:18:53.356237 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 14:18:53.357256 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 14:18:53.358274 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 14:18:53.359793 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 14:18:53.360828 (MainThread): Parsing macros\etc\query.sql
2021-10-15 14:18:53.361596 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 14:18:53.368843 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 14:18:53.373948 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 14:18:53.384077 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 14:18:53.385077 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 14:18:53.391077 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 14:18:53.409163 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 14:18:53.431779 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 14:18:53.432783 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 14:18:53.446019 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 14:18:53.451015 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 14:18:53.454020 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 14:18:53.459356 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 14:18:53.460355 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 14:18:53.461382 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 14:18:53.462361 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 14:18:53.593669 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:18:53.600671 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:18:53.602671 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:18:53.605671 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:53.605671 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 14:18:53.608671 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:18:53.610671 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:18:53.616323 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:18:53.627414 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 14:18:53.628490 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:53.629490 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 14:18:53.631490 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:53.637488 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-15 14:18:53.639490 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-15 14:18:53.640490 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-15 14:18:53.642903 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-15 14:18:53.693374 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:53.695374 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:53.702375 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:53.702375 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:53.703375 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:53.705632 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:53.706632 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:53.708631 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:53.716631 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:53.716631 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:18:53.737919 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd1cdac4-f224-4f9f-ab00-285fcf3d4843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF8192AC0>]}
2021-10-15 14:18:53.755763 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 14:18:53.756795 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd1cdac4-f224-4f9f-ab00-285fcf3d4843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF81920A0>]}
2021-10-15 14:18:53.756795 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 151 macros, 4 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 14:18:53.757653 (MainThread): 
2021-10-15 14:18:53.758937 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:18:53.760958 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 14:18:53.769087 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 14:18:53.769087 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 14:18:53.769087 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 14:18:55.410857 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.64 seconds
2021-10-15 14:18:55.416862 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 14:18:55.846676 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 14:18:55.855030 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 14:18:55.856032 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 14:18:55.856032 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 14:18:56.594213 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.74 seconds
2021-10-15 14:18:56.596211 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 14:18:56.837120 (MainThread): Using snowflake connection "master".
2021-10-15 14:18:56.838119 (MainThread): On master: BEGIN
2021-10-15 14:18:56.838119 (MainThread): Opening a new connection, currently in state init
2021-10-15 14:18:57.917646 (MainThread): SQL status: SUCCESS 1 in 1.08 seconds
2021-10-15 14:18:57.917646 (MainThread): On master: COMMIT
2021-10-15 14:18:57.918653 (MainThread): Using snowflake connection "master".
2021-10-15 14:18:57.918653 (MainThread): On master: COMMIT
2021-10-15 14:18:58.216460 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-10-15 14:18:58.217457 (MainThread): 16:18:58 | 
2021-10-15 14:18:58.218458 (MainThread): 16:18:58 | Running 1 on-run-start hook
2021-10-15 14:18:58.220450 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-15 14:18:58.222451 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-15 14:18:58.225449 (MainThread): 16:18:58 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-15 14:18:58.226654 (MainThread): Using snowflake connection "master".
2021-10-15 14:18:58.226654 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-15 14:18:58.468373 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-15 14:18:58.469384 (MainThread): 16:18:58 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.24s]
2021-10-15 14:18:58.470298 (MainThread): 16:18:58 | 
2021-10-15 14:18:58.470298 (MainThread): On master: Close
2021-10-15 14:18:58.761553 (MainThread): 16:18:58 | Concurrency: 1 threads (target='dev')
2021-10-15 14:18:58.762561 (MainThread): 16:18:58 | 
2021-10-15 14:18:58.768996 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:18:58.768996 (Thread-1): 16:18:58 | 1 of 1 START table model dbt.first_model............................. [RUN]
2021-10-15 14:18:58.769955 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:18:58.769955 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:18:58.773572 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 14:18:58.786791 (Thread-1): finished collecting timing info
2021-10-15 14:18:58.812628 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 14:18:58.819965 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:18:58.819965 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 14:18:58.819965 (Thread-1): Opening a new connection, currently in state init
2021-10-15 14:18:59.887194 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-10-15 14:18:59.888196 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:18:59.888196 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below

    post_hook="grant select on analytics.dbt.first_model to role analyst" can put in config
*/




with source_data as (

    select 1 as id, "CA" as state, "2020-01-01 00:00:00.000"::timestamp as updated_at
    union all
    select null as id
    union all
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 14:19:00.198226 (Thread-1): Snowflake query id: 019fa03a-0601-3c5d-0000-00664703d689
2021-10-15 14:19:00.198226 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 20
invalid identifier 'CA'
2021-10-15 14:19:00.198226 (Thread-1): finished collecting timing info
2021-10-15 14:19:00.198226 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: ROLLBACK
2021-10-15 14:19:00.484168 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 14:19:00.879903 (Thread-1): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  000904 (42000): SQL compilation error: error line 17 at position 20
  invalid identifier 'CA'
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 17 at position 20
invalid identifier 'CA'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  000904 (42000): SQL compilation error: error line 17 at position 20
  invalid identifier 'CA'
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-15 14:19:00.881902 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd1cdac4-f224-4f9f-ab00-285fcf3d4843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF80C0430>]}
2021-10-15 14:19:00.881902 (Thread-1): 16:19:00 | 1 of 1 ERROR creating table model dbt.first_model.................... [ERROR in 2.11s]
2021-10-15 14:19:00.883651 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:19:00.884661 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:19:00.884661 (MainThread): Using snowflake connection "master".
2021-10-15 14:19:00.884661 (MainThread): On master: BEGIN
2021-10-15 14:19:00.885665 (MainThread): Opening a new connection, currently in state closed
2021-10-15 14:19:01.757077 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-10-15 14:19:01.757077 (MainThread): On master: COMMIT
2021-10-15 14:19:01.757077 (MainThread): Using snowflake connection "master".
2021-10-15 14:19:01.758241 (MainThread): On master: COMMIT
2021-10-15 14:19:02.205604 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2021-10-15 14:19:02.205968 (MainThread): 16:19:02 | 
2021-10-15 14:19:02.205968 (MainThread): 16:19:02 | Running 3 on-run-end hooks
2021-10-15 14:19:02.207064 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-15 14:19:02.208064 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-15 14:19:02.210065 (MainThread): 16:19:02 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-15 14:19:02.211279 (MainThread): Using snowflake connection "master".
2021-10-15 14:19:02.211379 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-15 14:19:02.396942 (MainThread): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 14:19:02.397984 (MainThread): 16:19:02 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.19s]
2021-10-15 14:19:02.398988 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-15 14:19:02.399998 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-15 14:19:02.401518 (MainThread): 16:19:02 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-15 14:19:02.401518 (MainThread): Using snowflake connection "master".
2021-10-15 14:19:02.401518 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-15 14:19:02.665473 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-15 14:19:02.666157 (MainThread): 16:19:02 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.26s]
2021-10-15 14:19:02.666801 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-15 14:19:02.667657 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-15 14:19:02.669500 (MainThread): 16:19:02 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-15 14:19:02.670129 (MainThread): Using snowflake connection "master".
2021-10-15 14:19:02.670248 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-15 14:19:02.888460 (MainThread): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-15 14:19:02.890489 (MainThread): 16:19:02 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.22s]
2021-10-15 14:19:02.892439 (MainThread): 16:19:02 | 
2021-10-15 14:19:02.893457 (MainThread): On master: Close
2021-10-15 14:19:03.235571 (MainThread): 16:19:03 | 
2021-10-15 14:19:03.236564 (MainThread): 16:19:03 | Finished running 1 table model, 4 hooks in 9.48s.
2021-10-15 14:19:03.238477 (MainThread): Connection 'master' was properly closed.
2021-10-15 14:19:03.238477 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 14:19:03.238477 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 14:19:03.238477 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_first_dbt_model' was properly closed.
2021-10-15 14:19:03.252519 (MainThread): 
2021-10-15 14:19:03.252519 (MainThread): Completed with 1 error and 0 warnings:
2021-10-15 14:19:03.253517 (MainThread): 
2021-10-15 14:19:03.253517 (MainThread): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-15 14:19:03.254517 (MainThread):   000904 (42000): SQL compilation error: error line 17 at position 20
2021-10-15 14:19:03.255517 (MainThread):   invalid identifier 'CA'
2021-10-15 14:19:03.257134 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-15 14:19:03.259169 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-15 14:19:03.259169 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF80EA910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF80EA760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EF80D1E50>]}
2021-10-15 14:19:03.260146 (MainThread): Flushing usage events
2021-10-15 14:20:03.691830 (MainThread): Running with dbt=0.20.2
2021-10-15 14:20:04.314806 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['example.my_first_dbt_model'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 14:20:04.315806 (MainThread): Tracking: tracking
2021-10-15 14:20:04.315806 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E0E1BE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E23584F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E2358A60>]}
2021-10-15 14:20:04.323311 (MainThread): Partial parsing not enabled
2021-10-15 14:20:04.338132 (MainThread): Parsing macros\adapters.sql
2021-10-15 14:20:04.359662 (MainThread): Parsing macros\catalog.sql
2021-10-15 14:20:04.360664 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 14:20:04.366662 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 14:20:04.368325 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 14:20:04.370335 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 14:20:04.371338 (MainThread): Parsing macros\core.sql
2021-10-15 14:20:04.373336 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 14:20:04.404132 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 14:20:04.410213 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 14:20:04.411232 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 14:20:04.412213 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 14:20:04.413232 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 14:20:04.415317 (MainThread): Parsing macros\etc\query.sql
2021-10-15 14:20:04.416302 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 14:20:04.422302 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 14:20:04.427302 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 14:20:04.436779 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 14:20:04.438780 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 14:20:04.444731 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 14:20:04.459691 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 14:20:04.481529 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 14:20:04.482522 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 14:20:04.495811 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 14:20:04.500811 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 14:20:04.503811 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 14:20:04.507810 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 14:20:04.509810 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 14:20:04.510810 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 14:20:04.511811 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 14:20:04.641571 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:20:04.647910 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:20:04.649905 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:20:04.652907 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:04.653902 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 14:20:04.655904 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:20:04.657914 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:20:04.663624 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:20:04.673632 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 14:20:04.676189 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:04.676708 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 14:20:04.685813 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:04.691729 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-15 14:20:04.693733 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-15 14:20:04.695823 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-15 14:20:04.697817 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-15 14:20:04.747041 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:04.749040 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:04.756245 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:04.756245 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:04.758243 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:04.759253 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:04.760238 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:04.762238 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:04.770666 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:04.770666 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:04.790344 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1565f932-3a01-4db1-a1b3-38d15dbf6e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E2358280>]}
2021-10-15 14:20:04.803579 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 14:20:04.804579 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1565f932-3a01-4db1-a1b3-38d15dbf6e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E23E0610>]}
2021-10-15 14:20:04.804579 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 151 macros, 4 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 14:20:04.805728 (MainThread): 
2021-10-15 14:20:04.806581 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:20:04.808582 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 14:20:04.817115 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 14:20:04.818117 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 14:20:04.818117 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 14:20:07.012593 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.19 seconds
2021-10-15 14:20:07.018592 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 14:20:07.481329 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 14:20:07.487843 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 14:20:07.488233 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 14:20:07.488318 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 14:20:08.748457 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.26 seconds
2021-10-15 14:20:08.749511 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 14:20:09.063164 (MainThread): Using snowflake connection "master".
2021-10-15 14:20:09.063164 (MainThread): On master: BEGIN
2021-10-15 14:20:09.063164 (MainThread): Opening a new connection, currently in state init
2021-10-15 14:20:10.064763 (MainThread): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-15 14:20:10.065773 (MainThread): On master: COMMIT
2021-10-15 14:20:10.065773 (MainThread): Using snowflake connection "master".
2021-10-15 14:20:10.065773 (MainThread): On master: COMMIT
2021-10-15 14:20:10.328558 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-15 14:20:10.328558 (MainThread): 16:20:10 | 
2021-10-15 14:20:10.329609 (MainThread): 16:20:10 | Running 1 on-run-start hook
2021-10-15 14:20:10.330530 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-15 14:20:10.331530 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-15 14:20:10.333927 (MainThread): 16:20:10 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-15 14:20:10.333927 (MainThread): Using snowflake connection "master".
2021-10-15 14:20:10.333927 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-15 14:20:10.529682 (MainThread): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-15 14:20:10.530688 (MainThread): 16:20:10 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.20s]
2021-10-15 14:20:10.532608 (MainThread): 16:20:10 | 
2021-10-15 14:20:10.532608 (MainThread): On master: Close
2021-10-15 14:20:10.998882 (MainThread): 16:20:10 | Concurrency: 1 threads (target='dev')
2021-10-15 14:20:10.999824 (MainThread): 16:20:10 | 
2021-10-15 14:20:11.003961 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:20:11.003961 (Thread-1): 16:20:11 | 1 of 1 START table model dbt.first_model............................. [RUN]
2021-10-15 14:20:11.003961 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:20:11.004844 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:20:11.005843 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 14:20:11.012946 (Thread-1): finished collecting timing info
2021-10-15 14:20:11.030730 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 14:20:11.039402 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:20:11.039402 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 14:20:11.039402 (Thread-1): Opening a new connection, currently in state init
2021-10-15 14:20:12.062444 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-15 14:20:12.063437 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:20:12.063437 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below

    post_hook="grant select on analytics.dbt.first_model to role analyst" can put in config
*/




with source_data as (

    select 1 as id, 'CA' as state, "2020-01-01 00:00:00.000"::timestamp as updated_at
    union all
    select null as id
    union all
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 14:20:12.281135 (Thread-1): Snowflake query id: 019fa03c-0601-3e3f-0000-00664703f605
2021-10-15 14:20:12.281135 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 35
invalid identifier '"2020-01-01 00:00:00.000"'
2021-10-15 14:20:12.281550 (Thread-1): finished collecting timing info
2021-10-15 14:20:12.281550 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: ROLLBACK
2021-10-15 14:20:12.518306 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 14:20:12.989887 (Thread-1): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  000904 (42000): SQL compilation error: error line 17 at position 35
  invalid identifier '"2020-01-01 00:00:00.000"'
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 17 at position 35
invalid identifier '"2020-01-01 00:00:00.000"'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  000904 (42000): SQL compilation error: error line 17 at position 35
  invalid identifier '"2020-01-01 00:00:00.000"'
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-15 14:20:12.990883 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1565f932-3a01-4db1-a1b3-38d15dbf6e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E2664FD0>]}
2021-10-15 14:20:12.990883 (Thread-1): 16:20:12 | 1 of 1 ERROR creating table model dbt.first_model.................... [ERROR in 1.99s]
2021-10-15 14:20:12.991794 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:20:12.993392 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:20:12.993392 (MainThread): Using snowflake connection "master".
2021-10-15 14:20:12.993392 (MainThread): On master: BEGIN
2021-10-15 14:20:12.993392 (MainThread): Opening a new connection, currently in state closed
2021-10-15 14:20:13.886184 (MainThread): SQL status: SUCCESS 1 in 0.89 seconds
2021-10-15 14:20:13.886184 (MainThread): On master: COMMIT
2021-10-15 14:20:13.886184 (MainThread): Using snowflake connection "master".
2021-10-15 14:20:13.886184 (MainThread): On master: COMMIT
2021-10-15 14:20:14.222445 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-10-15 14:20:14.222445 (MainThread): 16:20:14 | 
2021-10-15 14:20:14.223406 (MainThread): 16:20:14 | Running 3 on-run-end hooks
2021-10-15 14:20:14.225389 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-15 14:20:14.227431 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-15 14:20:14.230627 (MainThread): 16:20:14 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-15 14:20:14.231592 (MainThread): Using snowflake connection "master".
2021-10-15 14:20:14.232125 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-15 14:20:14.373597 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 14:20:14.374822 (MainThread): 16:20:14 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.14s]
2021-10-15 14:20:14.375495 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-15 14:20:14.376096 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-15 14:20:14.378109 (MainThread): 16:20:14 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-15 14:20:14.379109 (MainThread): Using snowflake connection "master".
2021-10-15 14:20:14.379109 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-15 14:20:14.568192 (MainThread): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 14:20:14.568192 (MainThread): 16:20:14 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.19s]
2021-10-15 14:20:14.569204 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-15 14:20:14.571284 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-15 14:20:14.573285 (MainThread): 16:20:14 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-15 14:20:14.573786 (MainThread): Using snowflake connection "master".
2021-10-15 14:20:14.573786 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-15 14:20:14.769901 (MainThread): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-15 14:20:14.770902 (MainThread): 16:20:14 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.20s]
2021-10-15 14:20:14.772963 (MainThread): 16:20:14 | 
2021-10-15 14:20:14.773965 (MainThread): On master: Close
2021-10-15 14:20:15.036208 (MainThread): 16:20:15 | 
2021-10-15 14:20:15.037206 (MainThread): 16:20:15 | Finished running 1 table model, 4 hooks in 10.23s.
2021-10-15 14:20:15.038209 (MainThread): Connection 'master' was properly closed.
2021-10-15 14:20:15.038209 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 14:20:15.038209 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 14:20:15.038209 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_first_dbt_model' was properly closed.
2021-10-15 14:20:15.053113 (MainThread): 
2021-10-15 14:20:15.054039 (MainThread): Completed with 1 error and 0 warnings:
2021-10-15 14:20:15.055006 (MainThread): 
2021-10-15 14:20:15.056025 (MainThread): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-15 14:20:15.056025 (MainThread):   000904 (42000): SQL compilation error: error line 17 at position 35
2021-10-15 14:20:15.057011 (MainThread):   invalid identifier '"2020-01-01 00:00:00.000"'
2021-10-15 14:20:15.057011 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-15 14:20:15.058019 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-15 14:20:15.058019 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E24685B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E2415070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E2403F10>]}
2021-10-15 14:20:15.058019 (MainThread): Flushing usage events
2021-10-15 14:20:38.930614 (MainThread): Running with dbt=0.20.2
2021-10-15 14:20:39.555653 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['example.my_first_dbt_model'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 14:20:39.556654 (MainThread): Tracking: tracking
2021-10-15 14:20:39.556654 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021135DACBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211372F9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211372F9760>]}
2021-10-15 14:20:39.562654 (MainThread): Partial parsing not enabled
2021-10-15 14:20:39.574938 (MainThread): Parsing macros\adapters.sql
2021-10-15 14:20:39.593276 (MainThread): Parsing macros\catalog.sql
2021-10-15 14:20:39.594272 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 14:20:39.601112 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 14:20:39.603088 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 14:20:39.605104 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 14:20:39.606097 (MainThread): Parsing macros\core.sql
2021-10-15 14:20:39.609090 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 14:20:39.642926 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 14:20:39.648842 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 14:20:39.648842 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 14:20:39.649843 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 14:20:39.650843 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 14:20:39.651843 (MainThread): Parsing macros\etc\query.sql
2021-10-15 14:20:39.652843 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 14:20:39.661003 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 14:20:39.666001 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 14:20:39.675163 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 14:20:39.676164 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 14:20:39.682163 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 14:20:39.697165 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 14:20:39.720158 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 14:20:39.721152 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 14:20:39.733170 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 14:20:39.737735 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 14:20:39.740750 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 14:20:39.746011 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 14:20:39.747037 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 14:20:39.748012 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 14:20:39.749005 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 14:20:39.874680 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:20:39.881679 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:20:39.883681 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:20:39.885681 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:39.886680 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 14:20:39.889289 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:20:39.891296 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:20:39.898296 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:20:39.908730 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 14:20:39.910816 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:39.911741 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 14:20:39.912815 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:39.918825 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-15 14:20:39.920734 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-15 14:20:39.921731 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-15 14:20:39.923733 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-15 14:20:39.974611 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:39.975528 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:39.983799 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:39.983799 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:39.985798 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:39.986798 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:39.988798 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:39.989798 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:39.999799 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:39.999799 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:20:40.018314 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfa1208d-bf54-4440-9712-3ae1d74edae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021137385790>]}
2021-10-15 14:20:40.036556 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 14:20:40.036556 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfa1208d-bf54-4440-9712-3ae1d74edae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211373857C0>]}
2021-10-15 14:20:40.037661 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 151 macros, 4 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 14:20:40.038636 (MainThread): 
2021-10-15 14:20:40.039557 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:20:40.042714 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 14:20:40.049913 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 14:20:40.049913 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 14:20:40.049913 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 14:20:42.439516 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.39 seconds
2021-10-15 14:20:42.445769 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 14:20:42.919496 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 14:20:42.925505 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 14:20:42.925505 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 14:20:42.925505 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 14:20:44.229859 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.30 seconds
2021-10-15 14:20:44.231859 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 14:20:44.847727 (MainThread): Using snowflake connection "master".
2021-10-15 14:20:44.847727 (MainThread): On master: BEGIN
2021-10-15 14:20:44.847727 (MainThread): Opening a new connection, currently in state init
2021-10-15 14:20:46.096505 (MainThread): SQL status: SUCCESS 1 in 1.25 seconds
2021-10-15 14:20:46.096682 (MainThread): On master: COMMIT
2021-10-15 14:20:46.096828 (MainThread): Using snowflake connection "master".
2021-10-15 14:20:46.096915 (MainThread): On master: COMMIT
2021-10-15 14:20:46.320705 (MainThread): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-15 14:20:46.321725 (MainThread): 16:20:46 | 
2021-10-15 14:20:46.321725 (MainThread): 16:20:46 | Running 1 on-run-start hook
2021-10-15 14:20:46.322669 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-15 14:20:46.323679 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-15 14:20:46.325717 (MainThread): 16:20:46 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-15 14:20:46.326763 (MainThread): Using snowflake connection "master".
2021-10-15 14:20:46.326763 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-15 14:20:46.515202 (MainThread): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 14:20:46.516202 (MainThread): 16:20:46 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.19s]
2021-10-15 14:20:46.517851 (MainThread): 16:20:46 | 
2021-10-15 14:20:46.517851 (MainThread): On master: Close
2021-10-15 14:20:46.795101 (MainThread): 16:20:46 | Concurrency: 1 threads (target='dev')
2021-10-15 14:20:46.795287 (MainThread): 16:20:46 | 
2021-10-15 14:20:46.798649 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:20:46.798841 (Thread-1): 16:20:46 | 1 of 1 START table model dbt.first_model............................. [RUN]
2021-10-15 14:20:46.799218 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:20:46.799322 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:20:46.800516 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 14:20:46.805407 (Thread-1): finished collecting timing info
2021-10-15 14:20:46.827727 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 14:20:46.834731 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:20:46.834731 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 14:20:46.834731 (Thread-1): Opening a new connection, currently in state init
2021-10-15 14:20:47.698993 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-10-15 14:20:47.698993 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:20:47.698993 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below

    post_hook="grant select on analytics.dbt.first_model to role analyst" can put in config
*/




with source_data as (

    select 1 as id, 'CA' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at
    union all
    select null as id
    union all
    select 3 as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 14:20:47.912345 (Thread-1): Snowflake query id: 019fa03c-0601-3c5d-0000-00664703d6ad
2021-10-15 14:20:47.912345 (Thread-1): Snowflake error: 001789 (42601): SQL compilation error:
invalid number of result columns for set operator input branches, expected 3, got 1 in branch 2
2021-10-15 14:20:47.912345 (Thread-1): finished collecting timing info
2021-10-15 14:20:47.912345 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: ROLLBACK
2021-10-15 14:20:48.171659 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 14:20:48.737508 (Thread-1): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  001789 (42601): SQL compilation error:
  invalid number of result columns for set operator input branches, expected 3, got 1 in branch 2
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001789 (42601): SQL compilation error:
invalid number of result columns for set operator input branches, expected 3, got 1 in branch 2

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  001789 (42601): SQL compilation error:
  invalid number of result columns for set operator input branches, expected 3, got 1 in branch 2
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-15 14:20:48.740512 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfa1208d-bf54-4440-9712-3ae1d74edae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021137713B50>]}
2021-10-15 14:20:48.740512 (Thread-1): 16:20:48 | 1 of 1 ERROR creating table model dbt.first_model.................... [ERROR in 1.94s]
2021-10-15 14:20:48.741508 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:20:48.743631 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:20:48.743631 (MainThread): Using snowflake connection "master".
2021-10-15 14:20:48.744739 (MainThread): On master: BEGIN
2021-10-15 14:20:48.744739 (MainThread): Opening a new connection, currently in state closed
2021-10-15 14:20:49.714497 (MainThread): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-15 14:20:49.714497 (MainThread): On master: COMMIT
2021-10-15 14:20:49.714497 (MainThread): Using snowflake connection "master".
2021-10-15 14:20:49.714497 (MainThread): On master: COMMIT
2021-10-15 14:20:49.953723 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-15 14:20:49.953723 (MainThread): 16:20:49 | 
2021-10-15 14:20:49.954722 (MainThread): 16:20:49 | Running 3 on-run-end hooks
2021-10-15 14:20:49.955809 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-15 14:20:49.958722 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-15 14:20:49.960716 (MainThread): 16:20:49 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-15 14:20:49.961716 (MainThread): Using snowflake connection "master".
2021-10-15 14:20:49.961716 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-15 14:20:50.113687 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 14:20:50.114098 (MainThread): 16:20:50 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.15s]
2021-10-15 14:20:50.114993 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-15 14:20:50.116177 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-15 14:20:50.117585 (MainThread): 16:20:50 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-15 14:20:50.118226 (MainThread): Using snowflake connection "master".
2021-10-15 14:20:50.118368 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-15 14:20:50.370154 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-15 14:20:50.370305 (MainThread): 16:20:50 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.25s]
2021-10-15 14:20:50.371551 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-15 14:20:50.372557 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-15 14:20:50.373624 (MainThread): 16:20:50 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-15 14:20:50.374857 (MainThread): Using snowflake connection "master".
2021-10-15 14:20:50.374901 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-15 14:20:50.541311 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 14:20:50.542874 (MainThread): 16:20:50 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.17s]
2021-10-15 14:20:50.544893 (MainThread): 16:20:50 | 
2021-10-15 14:20:50.545892 (MainThread): On master: Close
2021-10-15 14:20:50.804204 (MainThread): 16:20:50 | 
2021-10-15 14:20:50.804721 (MainThread): 16:20:50 | Finished running 1 table model, 4 hooks in 10.77s.
2021-10-15 14:20:50.805809 (MainThread): Connection 'master' was properly closed.
2021-10-15 14:20:50.805809 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 14:20:50.805809 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 14:20:50.805809 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_first_dbt_model' was properly closed.
2021-10-15 14:20:50.818836 (MainThread): 
2021-10-15 14:20:50.818836 (MainThread): Completed with 1 error and 0 warnings:
2021-10-15 14:20:50.819842 (MainThread): 
2021-10-15 14:20:50.819842 (MainThread): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2021-10-15 14:20:50.820838 (MainThread):   001789 (42601): SQL compilation error:
2021-10-15 14:20:50.821030 (MainThread):   invalid number of result columns for set operator input branches, expected 3, got 1 in branch 2
2021-10-15 14:20:50.823199 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\my_first_dbt_model.sql
2021-10-15 14:20:50.824511 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-15 14:20:50.824906 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211372DA280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021137346640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021137713A60>]}
2021-10-15 14:20:50.825387 (MainThread): Flushing usage events
2021-10-15 14:21:16.545256 (MainThread): Running with dbt=0.20.2
2021-10-15 14:21:17.179904 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['example.my_first_dbt_model'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 14:21:17.179904 (MainThread): Tracking: tracking
2021-10-15 14:21:17.179904 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F253E2DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F255368CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F255368F10>]}
2021-10-15 14:21:17.186900 (MainThread): Partial parsing not enabled
2021-10-15 14:21:17.201816 (MainThread): Parsing macros\adapters.sql
2021-10-15 14:21:17.219585 (MainThread): Parsing macros\catalog.sql
2021-10-15 14:21:17.220773 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 14:21:17.226771 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 14:21:17.227771 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 14:21:17.229766 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 14:21:17.230768 (MainThread): Parsing macros\core.sql
2021-10-15 14:21:17.232768 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 14:21:17.262800 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 14:21:17.269022 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 14:21:17.270028 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 14:21:17.271046 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 14:21:17.271974 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 14:21:17.273038 (MainThread): Parsing macros\etc\query.sql
2021-10-15 14:21:17.273997 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 14:21:17.281093 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 14:21:17.285092 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 14:21:17.295644 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 14:21:17.296601 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 14:21:17.302704 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 14:21:17.317715 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 14:21:17.338398 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 14:21:17.339398 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 14:21:17.352398 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 14:21:17.357317 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 14:21:17.360982 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 14:21:17.366061 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 14:21:17.368036 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 14:21:17.368036 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 14:21:17.370062 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 14:21:17.504433 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:21:17.511570 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:21:17.514459 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:21:17.516475 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:21:17.517475 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 14:21:17.519475 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:21:17.521475 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:21:17.527599 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:21:17.537733 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 14:21:17.539722 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:21:17.540660 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 14:21:17.542857 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:21:17.547976 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-15 14:21:17.549978 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-15 14:21:17.551899 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-15 14:21:17.554002 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-15 14:21:17.602390 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:21:17.603392 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:21:17.610973 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:21:17.610973 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:21:17.612982 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:21:17.613979 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:21:17.614974 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:21:17.616988 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:21:17.624923 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:21:17.625926 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:21:17.643088 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cee9bc97-c134-450a-aae8-09456a8eb6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2553537F0>]}
2021-10-15 14:21:17.662034 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 14:21:17.662034 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cee9bc97-c134-450a-aae8-09456a8eb6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2553A3490>]}
2021-10-15 14:21:17.662034 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 151 macros, 4 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 14:21:17.664056 (MainThread): 
2021-10-15 14:21:17.664056 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:21:17.666145 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 14:21:17.676111 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 14:21:17.677123 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 14:21:17.677123 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 14:21:20.025397 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.35 seconds
2021-10-15 14:21:20.032395 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 14:21:20.438302 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 14:21:20.445294 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 14:21:20.445294 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 14:21:20.445294 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 14:21:21.789634 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.34 seconds
2021-10-15 14:21:21.790928 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 14:21:22.065175 (MainThread): Using snowflake connection "master".
2021-10-15 14:21:22.065175 (MainThread): On master: BEGIN
2021-10-15 14:21:22.065175 (MainThread): Opening a new connection, currently in state init
2021-10-15 14:21:23.115762 (MainThread): SQL status: SUCCESS 1 in 1.05 seconds
2021-10-15 14:21:23.115762 (MainThread): On master: COMMIT
2021-10-15 14:21:23.115762 (MainThread): Using snowflake connection "master".
2021-10-15 14:21:23.115762 (MainThread): On master: COMMIT
2021-10-15 14:21:23.336563 (MainThread): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-15 14:21:23.336563 (MainThread): 16:21:23 | 
2021-10-15 14:21:23.336563 (MainThread): 16:21:23 | Running 1 on-run-start hook
2021-10-15 14:21:23.338478 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-15 14:21:23.340484 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-15 14:21:23.344480 (MainThread): 16:21:23 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-15 14:21:23.345480 (MainThread): Using snowflake connection "master".
2021-10-15 14:21:23.345480 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-15 14:21:23.544572 (MainThread): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-15 14:21:23.545891 (MainThread): 16:21:23 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.20s]
2021-10-15 14:21:23.546891 (MainThread): 16:21:23 | 
2021-10-15 14:21:23.547890 (MainThread): On master: Close
2021-10-15 14:21:23.915262 (MainThread): 16:21:23 | Concurrency: 1 threads (target='dev')
2021-10-15 14:21:23.916328 (MainThread): 16:21:23 | 
2021-10-15 14:21:23.921948 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:21:23.921948 (Thread-1): 16:21:23 | 1 of 1 START table model dbt.first_model............................. [RUN]
2021-10-15 14:21:23.923203 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:21:23.923203 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:21:23.927921 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 14:21:23.932639 (Thread-1): finished collecting timing info
2021-10-15 14:21:23.949770 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 14:21:23.956108 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:21:23.956108 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 14:21:23.956108 (Thread-1): Opening a new connection, currently in state init
2021-10-15 14:21:24.885954 (Thread-1): SQL status: SUCCESS 1 in 0.93 seconds
2021-10-15 14:21:24.885954 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:21:24.885954 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below

    post_hook="grant select on analytics.dbt.first_model to role analyst" can put in config
*/




with source_data as (

    select 1 as id, 'CA' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at
    union all
    select null as id, 'TX' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at
    union all
    select 3 as id, 'VT' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 14:21:25.880309 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-10-15 14:21:25.882305 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 14:21:25.883305 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:21:25.883305 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 14:21:26.105195 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-15 14:21:26.112894 (Thread-1): finished collecting timing info
2021-10-15 14:21:26.113047 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 14:21:26.382965 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cee9bc97-c134-450a-aae8-09456a8eb6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F25564D5B0>]}
2021-10-15 14:21:26.383931 (Thread-1): 16:21:26 | 1 of 1 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.46s]
2021-10-15 14:21:26.386131 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:21:26.387315 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:21:26.388330 (MainThread): Using snowflake connection "master".
2021-10-15 14:21:26.388330 (MainThread): On master: BEGIN
2021-10-15 14:21:26.388330 (MainThread): Opening a new connection, currently in state closed
2021-10-15 14:21:27.646799 (MainThread): SQL status: SUCCESS 1 in 1.26 seconds
2021-10-15 14:21:27.647298 (MainThread): On master: COMMIT
2021-10-15 14:21:27.647797 (MainThread): Using snowflake connection "master".
2021-10-15 14:21:27.647797 (MainThread): On master: COMMIT
2021-10-15 14:21:28.015351 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-10-15 14:21:28.015351 (MainThread): 16:21:28 | 
2021-10-15 14:21:28.016406 (MainThread): 16:21:28 | Running 3 on-run-end hooks
2021-10-15 14:21:28.017392 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-15 14:21:28.017392 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-15 14:21:28.019389 (MainThread): 16:21:28 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-15 14:21:28.020542 (MainThread): Using snowflake connection "master".
2021-10-15 14:21:28.020542 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-15 14:21:28.156162 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-15 14:21:28.157161 (MainThread): 16:21:28 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.14s]
2021-10-15 14:21:28.158163 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-15 14:21:28.159163 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-15 14:21:28.163807 (MainThread): 16:21:28 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-15 14:21:28.164793 (MainThread): Using snowflake connection "master".
2021-10-15 14:21:28.164793 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-15 14:21:28.403902 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-15 14:21:28.404834 (MainThread): 16:21:28 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.24s]
2021-10-15 14:21:28.407570 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-15 14:21:28.408863 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-15 14:21:28.412201 (MainThread): 16:21:28 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-15 14:21:28.413200 (MainThread): Using snowflake connection "master".
2021-10-15 14:21:28.413200 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-15 14:21:28.572774 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 14:21:28.573706 (MainThread): 16:21:28 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.16s]
2021-10-15 14:21:28.575554 (MainThread): 16:21:28 | 
2021-10-15 14:21:28.576606 (MainThread): On master: Close
2021-10-15 14:21:28.976672 (MainThread): 16:21:28 | 
2021-10-15 14:21:28.976672 (MainThread): 16:21:28 | Finished running 1 table model, 4 hooks in 11.31s.
2021-10-15 14:21:28.978810 (MainThread): Connection 'master' was properly closed.
2021-10-15 14:21:28.979827 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 14:21:28.979827 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 14:21:28.979827 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_first_dbt_model' was properly closed.
2021-10-15 14:21:28.997509 (MainThread): 
2021-10-15 14:21:28.997509 (MainThread): Completed successfully
2021-10-15 14:21:28.998582 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-15 14:21:28.999967 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F255671430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F25573A5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F25564D5E0>]}
2021-10-15 14:21:28.999967 (MainThread): Flushing usage events
2021-10-15 14:30:23.514647 (MainThread): Running with dbt=0.20.2
2021-10-15 14:30:24.152575 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, threads=None, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.snapshot.SnapshotTask'>, which='snapshot', rpc_method='snapshot')
2021-10-15 14:30:24.152575 (MainThread): Tracking: tracking
2021-10-15 14:30:24.152575 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B41004CE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B41158CCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B41158CFA0>]}
2021-10-15 14:30:24.158576 (MainThread): Partial parsing not enabled
2021-10-15 14:30:24.172575 (MainThread): Parsing macros\adapters.sql
2021-10-15 14:30:24.190865 (MainThread): Parsing macros\catalog.sql
2021-10-15 14:30:24.192446 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 14:30:24.200728 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 14:30:24.202725 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 14:30:24.204722 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 14:30:24.205729 (MainThread): Parsing macros\core.sql
2021-10-15 14:30:24.208854 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 14:30:24.238592 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 14:30:24.244701 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 14:30:24.245708 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 14:30:24.246711 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 14:30:24.247708 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 14:30:24.248703 (MainThread): Parsing macros\etc\query.sql
2021-10-15 14:30:24.249699 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 14:30:24.257099 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 14:30:24.262102 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 14:30:24.271633 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 14:30:24.273640 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 14:30:24.278627 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 14:30:24.295102 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 14:30:24.316575 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 14:30:24.317577 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 14:30:24.328575 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 14:30:24.331737 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 14:30:24.334737 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 14:30:24.337736 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 14:30:24.339738 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 14:30:24.339738 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 14:30:24.340738 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 14:30:24.452915 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:30:24.460500 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:30:24.463742 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:30:24.466295 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:30:24.467389 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 14:30:24.470208 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:30:24.472370 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:30:24.479456 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:30:24.490700 (MainThread): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:30:24.501239 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 14:30:24.503577 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:30:24.504576 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 14:30:24.506595 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:30:24.541574 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-15 14:30:24.543575 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-15 14:30:24.544575 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-15 14:30:24.546575 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-15 14:30:24.563575 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:30:24.565577 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:30:24.572577 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:30:24.572577 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:30:24.574577 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:30:24.575577 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:30:24.577577 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:30:24.578577 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:30:24.591064 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:30:24.592034 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:30:24.621603 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '806ac087-5f0f-48f5-bbbe-54d0497e4a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4115F7C70>]}
2021-10-15 14:30:24.635722 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 14:30:24.635722 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '806ac087-5f0f-48f5-bbbe-54d0497e4a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4115F73D0>]}
2021-10-15 14:30:24.635722 (MainThread): Found 7 models, 10 tests, 1 snapshot, 0 analyses, 151 macros, 4 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 14:30:24.637726 (MainThread): 
2021-10-15 14:30:24.637726 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:30:24.638749 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 14:30:24.651481 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 14:30:24.651719 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 14:30:24.651719 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 14:30:26.393665 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.74 seconds
2021-10-15 14:30:26.401003 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 14:30:26.900993 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_snapshots".
2021-10-15 14:30:26.900993 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_snapshots".
2021-10-15 14:30:26.902015 (ThreadPoolExecutor-0_0): Creating schema "analytics.snapshots"
2021-10-15 14:30:26.907007 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_snapshots".
2021-10-15 14:30:26.907007 (ThreadPoolExecutor-0_0): On create_analytics_snapshots: BEGIN
2021-10-15 14:30:26.907007 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-15 14:30:28.061238 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 1.15 seconds
2021-10-15 14:30:28.061238 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_snapshots".
2021-10-15 14:30:28.061238 (ThreadPoolExecutor-0_0): On create_analytics_snapshots: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "create_analytics_snapshots"} */
create schema if not exists analytics.snapshots
2021-10-15 14:30:28.338338 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-15 14:30:28.340298 (ThreadPoolExecutor-0_0): On create_analytics_snapshots: COMMIT
2021-10-15 14:30:28.340298 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_snapshots".
2021-10-15 14:30:28.340298 (ThreadPoolExecutor-0_0): On create_analytics_snapshots: COMMIT
2021-10-15 14:30:28.960829 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.62 seconds
2021-10-15 14:30:28.961825 (ThreadPoolExecutor-0_0): On create_analytics_snapshots: Close
2021-10-15 14:30:29.278405 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_snapshots".
2021-10-15 14:30:29.284407 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_snapshots".
2021-10-15 14:30:29.284407 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */

    show terse objects in analytics.snapshots
2021-10-15 14:30:29.284407 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 14:30:30.501928 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.22 seconds
2021-10-15 14:30:30.502897 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: Close
2021-10-15 14:30:31.428699 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 14:30:31.429695 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 14:30:31.429695 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 14:30:31.429695 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-15 14:30:32.398449 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.97 seconds
2021-10-15 14:30:32.399447 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 14:30:32.694970 (MainThread): Using snowflake connection "master".
2021-10-15 14:30:32.695403 (MainThread): On master: BEGIN
2021-10-15 14:30:32.695403 (MainThread): Opening a new connection, currently in state init
2021-10-15 14:30:33.919446 (MainThread): SQL status: SUCCESS 1 in 1.22 seconds
2021-10-15 14:30:33.919446 (MainThread): On master: COMMIT
2021-10-15 14:30:33.919446 (MainThread): Using snowflake connection "master".
2021-10-15 14:30:33.919446 (MainThread): On master: COMMIT
2021-10-15 14:30:34.213407 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-15 14:30:34.213407 (MainThread): 16:30:34 | 
2021-10-15 14:30:34.213407 (MainThread): 16:30:34 | Running 1 on-run-start hook
2021-10-15 14:30:34.214314 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-15 14:30:34.214314 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-15 14:30:34.216639 (MainThread): 16:30:34 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-15 14:30:34.217639 (MainThread): Using snowflake connection "master".
2021-10-15 14:30:34.217639 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-15 14:30:34.519198 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-10-15 14:30:34.520093 (MainThread): 16:30:34 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.30s]
2021-10-15 14:30:51.280405 (MainThread): 16:30:51 | 
2021-10-15 14:30:51.281636 (MainThread): On master: Close
2021-10-15 14:30:51.580613 (MainThread): 16:30:51 | Concurrency: 1 threads (target='dev')
2021-10-15 14:30:51.580613 (MainThread): 16:30:51 | 
2021-10-15 14:30:51.583134 (Thread-1): Began running node snapshot.lukeclarke_learn_dbt.first_model_snapshot
2021-10-15 14:30:51.583134 (Thread-1): 16:30:51 | 1 of 1 START snapshot snapshots.first_model_snapshot................. [RUN]
2021-10-15 14:30:51.584131 (Thread-1): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:30:51.584131 (Thread-1): Compiling snapshot.lukeclarke_learn_dbt.first_model_snapshot
2021-10-15 14:30:51.585133 (Thread-1): finished collecting timing info
2021-10-15 14:30:51.601449 (Thread-1): Using snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:30:51.601449 (Thread-1): On snapshot.lukeclarke_learn_dbt.first_model_snapshot: BEGIN
2021-10-15 14:30:51.601449 (Thread-1): Opening a new connection, currently in state init
2021-10-15 14:30:52.714117 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2021-10-15 14:30:52.715115 (Thread-1): Using snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:30:52.715115 (Thread-1): On snapshot.lukeclarke_learn_dbt.first_model_snapshot: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "snapshot.lukeclarke_learn_dbt.first_model_snapshot"} */
select count(*)
        from analytics.INFORMATION_SCHEMA.schemata
        where upper(schema_name) = upper('snapshots')
            and upper(catalog_name) = upper('analytics')
2021-10-15 14:30:54.262562 (Thread-1): SQL status: SUCCESS 1 in 1.55 seconds
2021-10-15 14:30:54.290304 (Thread-1): Writing runtime SQL for node "snapshot.lukeclarke_learn_dbt.first_model_snapshot"
2021-10-15 14:30:54.292760 (Thread-1): Using snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:30:54.292760 (Thread-1): On snapshot.lukeclarke_learn_dbt.first_model_snapshot: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "snapshot.lukeclarke_learn_dbt.first_model_snapshot"} */

      

      create or replace transient table analytics.snapshots.first_model_snapshot  as
      (

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        

    


    --Pro-Tip: Use sources in snapshots!
    select * from analytics.dbt.first_model

    ) sbq


      );
2021-10-15 14:30:55.637723 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-10-15 14:30:55.646734 (Thread-1): On snapshot.lukeclarke_learn_dbt.first_model_snapshot: COMMIT
2021-10-15 14:30:55.646734 (Thread-1): Using snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:30:55.646734 (Thread-1): On snapshot.lukeclarke_learn_dbt.first_model_snapshot: COMMIT
2021-10-15 14:30:55.975995 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-15 14:30:55.976994 (Thread-1): finished collecting timing info
2021-10-15 14:30:55.976994 (Thread-1): On snapshot.lukeclarke_learn_dbt.first_model_snapshot: Close
2021-10-15 14:30:56.469122 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '806ac087-5f0f-48f5-bbbe-54d0497e4a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4118EFC70>]}
2021-10-15 14:30:56.470123 (Thread-1): 16:30:56 | 1 of 1 OK snapshotted snapshots.first_model_snapshot................. [SUCCESS 1 in 4.89s]
2021-10-15 14:30:56.470123 (Thread-1): Finished running node snapshot.lukeclarke_learn_dbt.first_model_snapshot
2021-10-15 14:30:56.471123 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:30:56.471123 (MainThread): Using snowflake connection "master".
2021-10-15 14:30:56.471123 (MainThread): On master: BEGIN
2021-10-15 14:30:56.471123 (MainThread): Opening a new connection, currently in state closed
2021-10-15 14:30:57.605512 (MainThread): SQL status: SUCCESS 1 in 1.13 seconds
2021-10-15 14:30:57.606500 (MainThread): On master: COMMIT
2021-10-15 14:30:57.606500 (MainThread): Using snowflake connection "master".
2021-10-15 14:30:57.606500 (MainThread): On master: COMMIT
2021-10-15 14:30:57.861726 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-15 14:30:57.862814 (MainThread): 16:30:57 | 
2021-10-15 14:30:57.862814 (MainThread): 16:30:57 | Running 3 on-run-end hooks
2021-10-15 14:30:57.863769 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-15 14:30:57.865723 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-15 14:30:57.868178 (MainThread): 16:30:57 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-15 14:30:57.868178 (MainThread): Using snowflake connection "master".
2021-10-15 14:30:57.868178 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-15 14:30:58.052183 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-15 14:30:58.053197 (MainThread): 16:30:58 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.19s]
2021-10-15 14:30:58.055197 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-15 14:30:58.057200 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-15 14:30:58.059198 (MainThread): 16:30:58 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-15 14:30:58.059198 (MainThread): Using snowflake connection "master".
2021-10-15 14:30:58.059198 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-15 14:30:58.327386 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-15 14:30:58.329311 (MainThread): 16:30:58 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.27s]
2021-10-15 14:30:58.331308 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-15 14:30:58.332302 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-15 14:30:58.336345 (MainThread): 16:30:58 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-15 14:30:58.337303 (MainThread): Using snowflake connection "master".
2021-10-15 14:30:58.337303 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-15 14:30:58.511697 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 14:30:58.512794 (MainThread): 16:30:58 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.18s]
2021-10-15 14:30:58.512794 (MainThread): 16:30:58 | 
2021-10-15 14:30:58.513848 (MainThread): On master: Close
2021-10-15 14:30:58.799231 (MainThread): 16:30:58 | 
2021-10-15 14:30:58.800145 (MainThread): 16:30:58 | Finished running 1 snapshot, 4 hooks in 34.16s.
2021-10-15 14:30:58.801253 (MainThread): Connection 'master' was properly closed.
2021-10-15 14:30:58.801253 (MainThread): Connection 'create_analytics_snapshots' was properly closed.
2021-10-15 14:30:58.801253 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 14:30:58.801253 (MainThread): Connection 'snapshot.lukeclarke_learn_dbt.first_model_snapshot' was properly closed.
2021-10-15 14:30:58.816051 (MainThread): 
2021-10-15 14:30:58.816051 (MainThread): Completed successfully
2021-10-15 14:30:58.816051 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-15 14:30:58.818307 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B41163CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B41191D940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4118BEDF0>]}
2021-10-15 14:30:58.818307 (MainThread): Flushing usage events
2021-10-15 14:35:52.785153 (MainThread): Running with dbt=0.20.2
2021-10-15 14:35:53.454805 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-15 14:35:53.455810 (MainThread): Tracking: tracking
2021-10-15 14:35:53.455810 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F2A6DE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F3FAC610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F3FACEE0>]}
2021-10-15 14:35:53.462811 (MainThread): Partial parsing not enabled
2021-10-15 14:35:53.477259 (MainThread): Parsing macros\adapters.sql
2021-10-15 14:35:53.498534 (MainThread): Parsing macros\catalog.sql
2021-10-15 14:35:53.499534 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 14:35:53.506214 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 14:35:53.508226 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 14:35:53.510217 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 14:35:53.511225 (MainThread): Parsing macros\core.sql
2021-10-15 14:35:53.514220 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 14:35:53.547052 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 14:35:53.552463 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 14:35:53.552463 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 14:35:53.553451 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 14:35:53.554459 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 14:35:53.555450 (MainThread): Parsing macros\etc\query.sql
2021-10-15 14:35:53.556447 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 14:35:53.561437 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 14:35:53.566055 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 14:35:53.576235 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 14:35:53.577237 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 14:35:53.583679 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 14:35:53.598758 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 14:35:53.619240 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 14:35:53.620245 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 14:35:53.630342 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 14:35:53.636346 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 14:35:53.639342 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 14:35:53.643342 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 14:35:53.645705 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 14:35:53.646705 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 14:35:53.647704 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 14:35:53.769092 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:35:53.776186 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:35:53.778180 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:35:53.780185 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:35:53.781180 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 14:35:53.783100 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:35:53.786058 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:35:53.792137 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:35:53.800662 (MainThread): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:35:53.809930 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 14:35:53.811938 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:35:53.811938 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 14:35:53.813931 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:35:53.850356 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-15 14:35:53.852403 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-15 14:35:53.854403 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-15 14:35:53.855409 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-15 14:35:53.875075 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:35:53.876067 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:35:53.883596 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:35:53.884638 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:35:53.885643 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:35:53.886640 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:35:53.888641 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:35:53.889640 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:35:53.898158 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:35:53.898158 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:35:53.915664 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f582b43c-d820-4c32-b417-9eff71bd5c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F2A6DEE0>]}
2021-10-15 14:35:53.932983 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 14:35:53.932983 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f582b43c-d820-4c32-b417-9eff71bd5c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F3FF65B0>]}
2021-10-15 14:35:53.933980 (MainThread): Found 7 models, 10 tests, 1 snapshot, 0 analyses, 151 macros, 4 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 14:35:53.936052 (MainThread): 
2021-10-15 14:35:53.936052 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:35:53.938065 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 14:35:53.945975 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 14:35:53.945975 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 14:35:53.945975 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 14:35:55.672182 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.73 seconds
2021-10-15 14:35:55.674141 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 14:35:55.944908 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_snapshots".
2021-10-15 14:35:55.950658 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_snapshots".
2021-10-15 14:35:55.951344 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */

    show terse objects in analytics.snapshots
2021-10-15 14:35:55.951344 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 14:35:56.917227 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-15 14:35:56.919235 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: Close
2021-10-15 14:35:57.304999 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 14:35:57.306008 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 14:35:57.306008 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 14:35:57.306008 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-15 14:35:58.392327 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.09 seconds
2021-10-15 14:35:58.392327 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 14:35:58.839355 (MainThread): Using snowflake connection "master".
2021-10-15 14:35:58.839355 (MainThread): On master: BEGIN
2021-10-15 14:35:58.839355 (MainThread): Opening a new connection, currently in state init
2021-10-15 14:35:59.849448 (MainThread): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-15 14:35:59.849448 (MainThread): On master: COMMIT
2021-10-15 14:35:59.849448 (MainThread): Using snowflake connection "master".
2021-10-15 14:35:59.850453 (MainThread): On master: COMMIT
2021-10-15 14:36:00.395315 (MainThread): SQL status: SUCCESS 1 in 0.54 seconds
2021-10-15 14:36:00.395315 (MainThread): 16:36:00 | 
2021-10-15 14:36:00.396240 (MainThread): 16:36:00 | Running 1 on-run-start hook
2021-10-15 14:36:00.398338 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-15 14:36:00.400765 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-15 14:36:00.403846 (MainThread): 16:36:00 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-15 14:36:00.403846 (MainThread): Using snowflake connection "master".
2021-10-15 14:36:00.403846 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-15 14:36:00.637569 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-15 14:36:00.638581 (MainThread): 16:36:00 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.23s]
2021-10-15 14:36:00.639501 (MainThread): 16:36:00 | 
2021-10-15 14:36:00.639501 (MainThread): On master: Close
2021-10-15 14:36:00.999646 (MainThread): 16:36:00 | Concurrency: 1 threads (target='dev')
2021-10-15 14:36:01.000678 (MainThread): 16:36:01 | 
2021-10-15 14:36:01.006422 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:36:01.006422 (Thread-1): 16:36:01 | 1 of 7 START table model dbt.first_model............................. [RUN]
2021-10-15 14:36:01.007422 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:36:01.007422 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:36:01.009502 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 14:36:01.015349 (Thread-1): finished collecting timing info
2021-10-15 14:36:01.034819 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-15 14:36:01.040833 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:36:01.040833 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-15 14:36:01.041833 (Thread-1): Opening a new connection, currently in state init
2021-10-15 14:36:01.888961 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-15 14:36:01.889961 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:36:01.889961 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below

    post_hook="grant select on analytics.dbt.first_model to role analyst" can put in config
*/




with source_data as (

    select 1 as id, 'CA' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at
    union all
    select null as id, 'TX' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at
    union all
    select 3 as id, 'VT' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-15 14:36:02.972410 (Thread-1): SQL status: SUCCESS 1 in 1.08 seconds
2021-10-15 14:36:02.974409 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 14:36:02.974409 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:36:02.974409 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-15 14:36:03.258359 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-15 14:36:03.270275 (Thread-1): finished collecting timing info
2021-10-15 14:36:03.270275 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-15 14:36:03.588685 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f582b43c-d820-4c32-b417-9eff71bd5c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F4432B20>]}
2021-10-15 14:36:03.588685 (Thread-1): 16:36:03 | 1 of 7 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.58s]
2021-10-15 14:36:03.590764 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-15 14:36:03.590764 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 14:36:03.591785 (Thread-1): 16:36:03 | 2 of 7 START table model dbt.cul_order_price......................... [RUN]
2021-10-15 14:36:03.592787 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:36:03.592787 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 14:36:03.595147 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 14:36:03.597033 (Thread-1): finished collecting timing info
2021-10-15 14:36:03.599470 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-15 14:36:03.603473 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:36:03.603473 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-15 14:36:03.604472 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 14:36:04.442674 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-15 14:36:04.442674 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:36:04.442674 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-15 14:36:06.175938 (Thread-1): SQL status: SUCCESS 1 in 1.73 seconds
2021-10-15 14:36:06.177896 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 14:36:06.177896 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:36:06.177896 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-15 14:36:06.349711 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 14:36:06.350713 (Thread-1): finished collecting timing info
2021-10-15 14:36:06.351819 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-15 14:36:06.637889 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f582b43c-d820-4c32-b417-9eff71bd5c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F446CA90>]}
2021-10-15 14:36:06.638899 (Thread-1): 16:36:06 | 2 of 7 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.05s]
2021-10-15 14:36:06.639815 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-15 14:36:06.639815 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-15 14:36:06.639815 (Thread-1): 16:36:06 | 3 of 7 START incremental model dbt.dates............................. [RUN]
2021-10-15 14:36:06.640816 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:36:06.640816 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-15 14:36:06.644977 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 14:36:06.646850 (Thread-1): finished collecting timing info
2021-10-15 14:36:06.663314 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:36:06.663314 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-15 14:36:06.663756 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 14:36:08.289901 (Thread-1): SQL status: SUCCESS 1 in 1.63 seconds
2021-10-15 14:36:08.300914 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:36:08.300914 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-15 14:36:08.490329 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-15 14:36:08.492327 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:36:08.492327 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 14:36:08.661689 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 14:36:08.663728 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:36:08.663728 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-15 14:36:08.827754 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 14:36:08.836934 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-15 14:36:08.839011 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:36:08.839011 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-15 14:36:09.002777 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 14:36:09.002777 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:36:09.003791 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-15 14:36:09.412536 (Thread-1): SQL status: SUCCESS 0 in 0.41 seconds
2021-10-15 14:36:09.414488 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 14:36:09.415588 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:36:09.415588 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-15 14:36:09.820783 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-10-15 14:36:09.821779 (Thread-1): finished collecting timing info
2021-10-15 14:36:09.822779 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-15 14:36:10.263325 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f582b43c-d820-4c32-b417-9eff71bd5c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F40CE190>]}
2021-10-15 14:36:10.263325 (Thread-1): 16:36:10 | 3 of 7 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.62s]
2021-10-15 14:36:10.264474 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-15 14:36:10.264474 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 14:36:10.264474 (Thread-1): 16:36:10 | 4 of 7 START view model dbt.playing_with_tests....................... [RUN]
2021-10-15 14:36:10.265606 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:36:10.265606 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 14:36:10.267685 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 14:36:10.268684 (Thread-1): finished collecting timing info
2021-10-15 14:36:10.278603 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-15 14:36:10.281799 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:36:10.281799 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-15 14:36:10.281799 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 14:36:11.711501 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2021-10-15 14:36:11.711501 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:36:11.711501 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */

  create or replace  view analytics.dbt.playing_with_tests  as (
    SELECT *
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF001"."CUSTOMER"
  );
2021-10-15 14:36:12.147900 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-10-15 14:36:12.149901 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 14:36:12.149901 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:36:12.149901 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-15 14:36:12.300382 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-15 14:36:12.301368 (Thread-1): finished collecting timing info
2021-10-15 14:36:12.301368 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-15 14:36:12.672162 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f582b43c-d820-4c32-b417-9eff71bd5c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F446C4F0>]}
2021-10-15 14:36:12.672162 (Thread-1): 16:36:12 | 4 of 7 OK created view model dbt.playing_with_tests.................. [SUCCESS 1 in 2.41s]
2021-10-15 14:36:12.673160 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-15 14:36:12.673160 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 14:36:12.673160 (Thread-1): 16:36:12 | 5 of 7 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-15 14:36:12.673160 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:36:12.673160 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 14:36:12.674160 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 14:36:12.675158 (Thread-1): finished collecting timing info
2021-10-15 14:36:12.677162 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-15 14:36:12.679165 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:36:12.679165 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-15 14:36:12.679165 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 14:36:13.910791 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-10-15 14:36:13.910791 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:36:13.910791 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" AS c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-15 14:36:15.705770 (Thread-1): SQL status: SUCCESS 1 in 1.79 seconds
2021-10-15 14:36:15.707762 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 14:36:15.707762 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:36:15.707762 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-15 14:36:16.088028 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-10-15 14:36:16.090026 (Thread-1): finished collecting timing info
2021-10-15 14:36:16.090026 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-15 14:36:16.349323 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f582b43c-d820-4c32-b417-9eff71bd5c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F408F280>]}
2021-10-15 14:36:16.350323 (Thread-1): 16:36:16 | 5 of 7 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.68s]
2021-10-15 14:36:16.350939 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-15 14:36:16.351948 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-15 14:36:16.351948 (Thread-1): 16:36:16 | 6 of 7 START incremental model dbt.time.............................. [RUN]
2021-10-15 14:36:16.351948 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:36:16.352948 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-15 14:36:16.355027 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 14:36:16.356341 (Thread-1): finished collecting timing info
2021-10-15 14:36:16.358608 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:36:16.358608 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-15 14:36:16.358608 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 14:36:18.175153 (Thread-1): SQL status: SUCCESS 1 in 1.82 seconds
2021-10-15 14:36:18.178148 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:36:18.179154 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-15 14:36:18.414706 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-15 14:36:18.419381 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:36:18.419381 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 14:36:18.712123 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-10-15 14:36:18.714144 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:36:18.714144 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-15 14:36:18.872101 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 14:36:18.873113 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-15 14:36:18.876388 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:36:18.876388 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-15 14:36:19.261902 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-10-15 14:36:19.261902 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:36:19.261902 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-15 14:36:20.318346 (Thread-1): SQL status: SUCCESS 1071 in 1.06 seconds
2021-10-15 14:36:20.319325 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 14:36:20.319325 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:36:20.319325 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-15 14:36:20.929771 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2021-10-15 14:36:20.931771 (Thread-1): finished collecting timing info
2021-10-15 14:36:20.932771 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-15 14:36:21.451406 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f582b43c-d820-4c32-b417-9eff71bd5c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F40579A0>]}
2021-10-15 14:36:21.451406 (Thread-1): 16:36:21 | 6 of 7 OK created incremental model dbt.time......................... [SUCCESS 1071 in 5.10s]
2021-10-15 14:36:21.453409 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-15 14:36:21.453409 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 14:36:21.454507 (Thread-1): 16:36:21 | 7 of 7 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-15 14:36:21.455409 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 14:36:21.455409 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 14:36:21.459494 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 14:36:21.462681 (Thread-1): finished collecting timing info
2021-10-15 14:36:21.463983 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-15 14:36:21.467088 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 14:36:21.467088 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-15 14:36:21.467088 (Thread-1): Opening a new connection, currently in state closed
2021-10-15 14:36:22.952111 (Thread-1): SQL status: SUCCESS 1 in 1.49 seconds
2021-10-15 14:36:22.953108 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 14:36:22.953108 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-15 14:36:24.186470 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-10-15 14:36:24.187495 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 14:36:24.188498 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 14:36:24.188498 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-15 14:36:24.351235 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-15 14:36:24.352235 (Thread-1): finished collecting timing info
2021-10-15 14:36:24.353234 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-15 14:36:25.100278 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f582b43c-d820-4c32-b417-9eff71bd5c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F44BFD30>]}
2021-10-15 14:36:25.100278 (Thread-1): 16:36:25 | 7 of 7 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 3.64s]
2021-10-15 14:36:25.101297 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-15 14:36:25.102292 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:36:25.103374 (MainThread): Using snowflake connection "master".
2021-10-15 14:36:25.103374 (MainThread): On master: BEGIN
2021-10-15 14:36:25.103374 (MainThread): Opening a new connection, currently in state closed
2021-10-15 14:36:26.170181 (MainThread): SQL status: SUCCESS 1 in 1.07 seconds
2021-10-15 14:36:26.170181 (MainThread): On master: COMMIT
2021-10-15 14:36:26.170181 (MainThread): Using snowflake connection "master".
2021-10-15 14:36:26.170181 (MainThread): On master: COMMIT
2021-10-15 14:36:26.418231 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-15 14:36:26.418231 (MainThread): 16:36:26 | 
2021-10-15 14:36:26.419299 (MainThread): 16:36:26 | Running 3 on-run-end hooks
2021-10-15 14:36:26.421318 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-15 14:36:26.423322 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-15 14:36:26.426266 (MainThread): 16:36:26 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-15 14:36:26.427266 (MainThread): Using snowflake connection "master".
2021-10-15 14:36:26.427266 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-15 14:36:26.599844 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-15 14:36:26.600625 (MainThread): 16:36:26 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.17s]
2021-10-15 14:36:26.601147 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-15 14:36:26.602690 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-15 14:36:26.604253 (MainThread): 16:36:26 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-15 14:36:26.604881 (MainThread): Using snowflake connection "master".
2021-10-15 14:36:26.605047 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-15 14:36:26.859458 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-15 14:36:26.860497 (MainThread): 16:36:26 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.26s]
2021-10-15 14:36:26.862596 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-15 14:36:26.864726 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-15 14:36:26.869074 (MainThread): 16:36:26 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-15 14:36:26.869074 (MainThread): Using snowflake connection "master".
2021-10-15 14:36:26.869074 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-15 14:36:27.125357 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-15 14:36:27.126760 (MainThread): 16:36:27 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.26s]
2021-10-15 14:36:27.128457 (MainThread): 16:36:27 | 
2021-10-15 14:36:27.129468 (MainThread): On master: Close
2021-10-15 14:36:27.457714 (MainThread): 16:36:27 | 
2021-10-15 14:36:27.458712 (MainThread): 16:36:27 | Finished running 4 table models, 2 incremental models, 1 view model, 4 hooks in 33.52s.
2021-10-15 14:36:27.459720 (MainThread): Connection 'master' was properly closed.
2021-10-15 14:36:27.459720 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 14:36:27.459720 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-15 14:36:27.459720 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-15 14:36:27.476913 (MainThread): 
2021-10-15 14:36:27.477914 (MainThread): Completed successfully
2021-10-15 14:36:27.478189 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-15 14:36:27.478189 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F2BAC2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F4471DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F4471700>]}
2021-10-15 14:36:27.478189 (MainThread): Flushing usage events
2021-10-15 14:36:53.656634 (MainThread): Running with dbt=0.20.2
2021-10-15 14:36:54.285630 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, threads=None, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.snapshot.SnapshotTask'>, which='snapshot', rpc_method='snapshot')
2021-10-15 14:36:54.285716 (MainThread): Tracking: tracking
2021-10-15 14:36:54.285716 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119659BDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021197ADAF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021197ADACD0>]}
2021-10-15 14:36:54.292823 (MainThread): Partial parsing not enabled
2021-10-15 14:36:54.307042 (MainThread): Parsing macros\adapters.sql
2021-10-15 14:36:54.330826 (MainThread): Parsing macros\catalog.sql
2021-10-15 14:36:54.331936 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-15 14:36:54.339107 (MainThread): Parsing macros\materializations\merge.sql
2021-10-15 14:36:54.340119 (MainThread): Parsing macros\materializations\table.sql
2021-10-15 14:36:54.343108 (MainThread): Parsing macros\materializations\view.sql
2021-10-15 14:36:54.344113 (MainThread): Parsing macros\core.sql
2021-10-15 14:36:54.346114 (MainThread): Parsing macros\adapters\common.sql
2021-10-15 14:36:54.377916 (MainThread): Parsing macros\etc\datetime.sql
2021-10-15 14:36:54.384794 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-15 14:36:54.384794 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-15 14:36:54.385825 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-15 14:36:54.387795 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-15 14:36:54.388794 (MainThread): Parsing macros\etc\query.sql
2021-10-15 14:36:54.388794 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-15 14:36:54.397732 (MainThread): Parsing macros\materializations\test.sql
2021-10-15 14:36:54.402717 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-15 14:36:54.412756 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-15 14:36:54.413762 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-15 14:36:54.419756 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-15 14:36:54.432662 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-15 14:36:54.452665 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-15 14:36:54.453666 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-15 14:36:54.466761 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-15 14:36:54.471857 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-15 14:36:54.475450 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-15 14:36:54.479450 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-15 14:36:54.481451 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-15 14:36:54.482452 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-15 14:36:54.483454 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-15 14:36:54.618440 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-15 14:36:54.624513 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-15 14:36:54.626722 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-15 14:36:54.628722 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:36:54.628722 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-15 14:36:54.631638 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-15 14:36:54.633686 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-15 14:36:54.639717 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-15 14:36:54.648678 (MainThread): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:36:54.661943 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-15 14:36:54.663983 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:36:54.664902 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-15 14:36:54.666983 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:36:54.704461 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-15 14:36:54.705473 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-15 14:36:54.707461 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-15 14:36:54.709489 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-15 14:36:54.726622 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:36:54.727623 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:36:54.736384 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:36:54.736384 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:36:54.737390 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:36:54.739388 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:36:54.740404 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:36:54.742385 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:36:54.749952 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:36:54.749952 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-15 14:36:54.767009 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b24afd2-32e7-4424-8096-21153a925aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021197B47A90>]}
2021-10-15 14:36:54.786888 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-15 14:36:54.787888 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b24afd2-32e7-4424-8096-21153a925aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021197B479A0>]}
2021-10-15 14:36:54.787888 (MainThread): Found 7 models, 10 tests, 1 snapshot, 0 analyses, 151 macros, 4 operations, 0 seed files, 0 sources, 0 exposures
2021-10-15 14:36:54.789265 (MainThread): 
2021-10-15 14:36:54.789265 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:36:54.790667 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-15 14:36:54.802166 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-15 14:36:54.802166 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-15 14:36:54.802166 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-15 14:36:56.508579 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.71 seconds
2021-10-15 14:36:56.513989 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-15 14:36:56.909144 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-15 14:36:56.915063 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-15 14:36:56.915063 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-15 14:36:56.915063 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-15 14:36:58.571881 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.66 seconds
2021-10-15 14:36:58.572889 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-15 14:36:58.905975 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_snapshots".
2021-10-15 14:36:58.908176 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_snapshots".
2021-10-15 14:36:58.908416 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */

    show terse objects in analytics.snapshots
2021-10-15 14:36:58.908602 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-15 14:37:00.102534 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 1.19 seconds
2021-10-15 14:37:00.103541 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: Close
2021-10-15 14:37:00.559338 (MainThread): Using snowflake connection "master".
2021-10-15 14:37:00.559338 (MainThread): On master: BEGIN
2021-10-15 14:37:00.559338 (MainThread): Opening a new connection, currently in state init
2021-10-15 14:37:01.463302 (MainThread): SQL status: SUCCESS 1 in 0.90 seconds
2021-10-15 14:37:01.463302 (MainThread): On master: COMMIT
2021-10-15 14:37:01.463302 (MainThread): Using snowflake connection "master".
2021-10-15 14:37:01.463302 (MainThread): On master: COMMIT
2021-10-15 14:37:02.113514 (MainThread): SQL status: SUCCESS 1 in 0.65 seconds
2021-10-15 14:37:02.113514 (MainThread): 16:37:02 | 
2021-10-15 14:37:02.114511 (MainThread): 16:37:02 | Running 1 on-run-start hook
2021-10-15 14:37:02.115512 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-15 14:37:02.116509 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-15 14:37:02.121506 (MainThread): 16:37:02 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-15 14:37:02.122265 (MainThread): Using snowflake connection "master".
2021-10-15 14:37:02.122265 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-15 14:37:02.356850 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-15 14:37:02.358775 (MainThread): 16:37:02 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.24s]
2021-10-15 14:37:02.360856 (MainThread): 16:37:02 | 
2021-10-15 14:37:02.361261 (MainThread): On master: Close
2021-10-15 14:37:02.833219 (MainThread): 16:37:02 | Concurrency: 1 threads (target='dev')
2021-10-15 14:37:02.835216 (MainThread): 16:37:02 | 
2021-10-15 14:37:02.837317 (Thread-1): Began running node snapshot.lukeclarke_learn_dbt.first_model_snapshot
2021-10-15 14:37:02.837317 (Thread-1): 16:37:02 | 1 of 1 START snapshot snapshots.first_model_snapshot................. [RUN]
2021-10-15 14:37:02.838416 (Thread-1): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:37:02.838416 (Thread-1): Compiling snapshot.lukeclarke_learn_dbt.first_model_snapshot
2021-10-15 14:37:02.841428 (Thread-1): finished collecting timing info
2021-10-15 14:37:02.858191 (Thread-1): Using snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:37:02.858191 (Thread-1): On snapshot.lukeclarke_learn_dbt.first_model_snapshot: BEGIN
2021-10-15 14:37:02.858191 (Thread-1): Opening a new connection, currently in state init
2021-10-15 14:37:04.200100 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-10-15 14:37:04.201185 (Thread-1): Using snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:37:04.201185 (Thread-1): On snapshot.lukeclarke_learn_dbt.first_model_snapshot: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "snapshot.lukeclarke_learn_dbt.first_model_snapshot"} */
select count(*)
        from analytics.INFORMATION_SCHEMA.schemata
        where upper(schema_name) = upper('snapshots')
            and upper(catalog_name) = upper('analytics')
2021-10-15 14:37:04.668327 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2021-10-15 14:37:04.689485 (Thread-1): Using snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:37:04.689485 (Thread-1): On snapshot.lukeclarke_learn_dbt.first_model_snapshot: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "snapshot.lukeclarke_learn_dbt.first_model_snapshot"} */

    describe table "ANALYTICS"."SNAPSHOTS"."FIRST_MODEL_SNAPSHOT"
2021-10-15 14:37:04.908178 (Thread-1): SQL status: SUCCESS 7 in 0.22 seconds
2021-10-15 14:37:04.929407 (Thread-1): Using snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:37:04.929407 (Thread-1): On snapshot.lukeclarke_learn_dbt.first_model_snapshot: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "snapshot.lukeclarke_learn_dbt.first_model_snapshot"} */

        

      create or replace temporary table "ANALYTICS"."SNAPSHOTS"."FIRST_MODEL_SNAPSHOT__dbt_tmp"  as
      (with snapshot_query as (

        

    


    --Pro-Tip: Use sources in snapshots!
    select * from analytics.dbt.first_model


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "ANALYTICS"."SNAPSHOTS"."FIRST_MODEL_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates
      );
2021-10-15 14:37:06.213381 (Thread-1): SQL status: SUCCESS 1 in 1.28 seconds
2021-10-15 14:37:06.214379 (Thread-1): Using snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:37:06.215461 (Thread-1): On snapshot.lukeclarke_learn_dbt.first_model_snapshot: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "snapshot.lukeclarke_learn_dbt.first_model_snapshot"} */

    describe table "ANALYTICS"."SNAPSHOTS"."FIRST_MODEL_SNAPSHOT__dbt_tmp"
2021-10-15 14:37:06.392464 (Thread-1): SQL status: SUCCESS 9 in 0.18 seconds
2021-10-15 14:37:06.395098 (Thread-1): Using snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:37:06.395098 (Thread-1): On snapshot.lukeclarke_learn_dbt.first_model_snapshot: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "snapshot.lukeclarke_learn_dbt.first_model_snapshot"} */

    describe table "ANALYTICS"."SNAPSHOTS"."FIRST_MODEL_SNAPSHOT"
2021-10-15 14:37:06.731529 (Thread-1): SQL status: SUCCESS 7 in 0.34 seconds
2021-10-15 14:37:06.734796 (Thread-1): Using snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:37:06.734796 (Thread-1): On snapshot.lukeclarke_learn_dbt.first_model_snapshot: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "snapshot.lukeclarke_learn_dbt.first_model_snapshot"} */

    describe table "ANALYTICS"."SNAPSHOTS"."FIRST_MODEL_SNAPSHOT__dbt_tmp"
2021-10-15 14:37:07.157906 (Thread-1): SQL status: SUCCESS 9 in 0.42 seconds
2021-10-15 14:37:07.160996 (Thread-1): Using snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:37:07.160996 (Thread-1): On snapshot.lukeclarke_learn_dbt.first_model_snapshot: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "snapshot.lukeclarke_learn_dbt.first_model_snapshot"} */

    describe table "ANALYTICS"."SNAPSHOTS"."FIRST_MODEL_SNAPSHOT"
2021-10-15 14:37:07.356922 (Thread-1): SQL status: SUCCESS 7 in 0.20 seconds
2021-10-15 14:37:07.362919 (Thread-1): Using snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:37:07.362919 (Thread-1): On snapshot.lukeclarke_learn_dbt.first_model_snapshot: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "snapshot.lukeclarke_learn_dbt.first_model_snapshot"} */

    describe table "ANALYTICS"."SNAPSHOTS"."FIRST_MODEL_SNAPSHOT__dbt_tmp"
2021-10-15 14:37:07.648770 (Thread-1): SQL status: SUCCESS 9 in 0.29 seconds
2021-10-15 14:37:07.654756 (Thread-1): Writing runtime SQL for node "snapshot.lukeclarke_learn_dbt.first_model_snapshot"
2021-10-15 14:37:07.660757 (Thread-1): Using snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:37:07.660757 (Thread-1): On snapshot.lukeclarke_learn_dbt.first_model_snapshot: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "snapshot.lukeclarke_learn_dbt.first_model_snapshot"} */

      merge into "ANALYTICS"."SNAPSHOTS"."FIRST_MODEL_SNAPSHOT" as DBT_INTERNAL_DEST
    using "ANALYTICS"."SNAPSHOTS"."FIRST_MODEL_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "STATE", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "STATE", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
    ;
2021-10-15 14:37:08.590208 (Thread-1): SQL status: SUCCESS 0 in 0.93 seconds
2021-10-15 14:37:08.595205 (Thread-1): On snapshot.lukeclarke_learn_dbt.first_model_snapshot: COMMIT
2021-10-15 14:37:08.595205 (Thread-1): Using snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-15 14:37:08.595205 (Thread-1): On snapshot.lukeclarke_learn_dbt.first_model_snapshot: COMMIT
2021-10-15 14:37:09.032130 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-10-15 14:37:09.035602 (Thread-1): finished collecting timing info
2021-10-15 14:37:09.035602 (Thread-1): On snapshot.lukeclarke_learn_dbt.first_model_snapshot: Close
2021-10-15 14:37:09.309326 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b24afd2-32e7-4424-8096-21153a925aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021197F72970>]}
2021-10-15 14:37:09.310323 (Thread-1): 16:37:09 | 1 of 1 OK snapshotted snapshots.first_model_snapshot................. [SUCCESS 0 in 6.47s]
2021-10-15 14:37:09.310849 (Thread-1): Finished running node snapshot.lukeclarke_learn_dbt.first_model_snapshot
2021-10-15 14:37:09.311858 (MainThread): Acquiring new snowflake connection "master".
2021-10-15 14:37:09.311858 (MainThread): Using snowflake connection "master".
2021-10-15 14:37:09.312862 (MainThread): On master: BEGIN
2021-10-15 14:37:09.312862 (MainThread): Opening a new connection, currently in state closed
2021-10-15 14:37:10.408382 (MainThread): SQL status: SUCCESS 1 in 1.10 seconds
2021-10-15 14:37:10.408382 (MainThread): On master: COMMIT
2021-10-15 14:37:10.408382 (MainThread): Using snowflake connection "master".
2021-10-15 14:37:10.408382 (MainThread): On master: COMMIT
2021-10-15 14:37:10.844732 (MainThread): SQL status: SUCCESS 1 in 0.44 seconds
2021-10-15 14:37:10.845826 (MainThread): 16:37:10 | 
2021-10-15 14:37:10.845826 (MainThread): 16:37:10 | Running 3 on-run-end hooks
2021-10-15 14:37:10.845826 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-15 14:37:10.846741 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-15 14:37:10.849433 (MainThread): 16:37:10 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-15 14:37:10.849433 (MainThread): Using snowflake connection "master".
2021-10-15 14:37:10.849433 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-15 14:37:11.046942 (MainThread): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-15 14:37:11.047942 (MainThread): 16:37:11 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.20s]
2021-10-15 14:37:11.048949 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-15 14:37:11.049944 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-15 14:37:11.051944 (MainThread): 16:37:11 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-15 14:37:11.051944 (MainThread): Using snowflake connection "master".
2021-10-15 14:37:11.051944 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-15 14:37:11.275238 (MainThread): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-15 14:37:11.275238 (MainThread): 16:37:11 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.22s]
2021-10-15 14:37:11.276821 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-15 14:37:11.277827 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-15 14:37:11.279829 (MainThread): 16:37:11 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-15 14:37:11.279829 (MainThread): Using snowflake connection "master".
2021-10-15 14:37:11.280827 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-15 14:37:11.607236 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-15 14:37:11.608199 (MainThread): 16:37:11 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.33s]
2021-10-15 14:37:11.609117 (MainThread): 16:37:11 | 
2021-10-15 14:37:11.609117 (MainThread): On master: Close
2021-10-15 14:37:11.951487 (MainThread): 16:37:11 | 
2021-10-15 14:37:11.952531 (MainThread): 16:37:11 | Finished running 1 snapshot, 4 hooks in 17.16s.
2021-10-15 14:37:11.953514 (MainThread): Connection 'master' was properly closed.
2021-10-15 14:37:11.953514 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-15 14:37:11.953514 (MainThread): Connection 'list_analytics_snapshots' was properly closed.
2021-10-15 14:37:11.953514 (MainThread): Connection 'snapshot.lukeclarke_learn_dbt.first_model_snapshot' was properly closed.
2021-10-15 14:37:11.971402 (MainThread): 
2021-10-15 14:37:11.972420 (MainThread): Completed successfully
2021-10-15 14:37:11.973326 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-15 14:37:11.974333 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021197FED1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021197F9BF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021197F7F6D0>]}
2021-10-15 14:37:11.974333 (MainThread): Flushing usage events
2021-10-22 14:30:28.903722 (MainThread): Running with dbt=0.20.2
2021-10-22 14:30:30.765886 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['example'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-22 14:30:30.767886 (MainThread): Tracking: tracking
2021-10-22 14:30:30.768885 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EBB6CDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190ED0A95E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190ED0A99D0>]}
2021-10-22 14:30:30.790628 (MainThread): Partial parsing not enabled
2021-10-22 14:30:31.047235 (MainThread): Parsing macros\adapters.sql
2021-10-22 14:30:31.087334 (MainThread): Parsing macros\catalog.sql
2021-10-22 14:30:31.090868 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-22 14:30:31.105081 (MainThread): Parsing macros\materializations\merge.sql
2021-10-22 14:30:31.109085 (MainThread): Parsing macros\materializations\table.sql
2021-10-22 14:30:31.116065 (MainThread): Parsing macros\materializations\view.sql
2021-10-22 14:30:31.118064 (MainThread): Parsing macros\core.sql
2021-10-22 14:30:31.125313 (MainThread): Parsing macros\adapters\common.sql
2021-10-22 14:30:31.224644 (MainThread): Parsing macros\etc\datetime.sql
2021-10-22 14:30:31.244871 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-22 14:30:31.246855 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-22 14:30:31.249806 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-22 14:30:31.253897 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-22 14:30:31.256878 (MainThread): Parsing macros\etc\query.sql
2021-10-22 14:30:31.258802 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-22 14:30:31.271841 (MainThread): Parsing macros\materializations\test.sql
2021-10-22 14:30:31.281075 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-22 14:30:31.309916 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-22 14:30:31.313918 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-22 14:30:31.329198 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-22 14:30:31.362255 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-22 14:30:31.407757 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-22 14:30:31.409664 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-22 14:30:31.438346 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-22 14:30:31.448953 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-22 14:30:31.454006 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-22 14:30:31.465857 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-22 14:30:31.469796 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-22 14:30:31.472861 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-22 14:30:31.475845 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-22 14:30:31.742731 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-22 14:30:31.754702 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-22 14:30:31.756704 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-22 14:30:31.760704 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:30:31.761684 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-22 14:30:31.766700 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 14:30:31.770708 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:30:31.780255 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-22 14:30:31.801607 (MainThread): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-22 14:30:31.826039 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-22 14:30:31.831809 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:30:31.834908 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-22 14:30:31.838385 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:30:31.890064 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-22 14:30:31.892099 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-22 14:30:31.894168 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-22 14:30:31.896074 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-22 14:30:31.930164 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:30:31.932171 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:30:31.944414 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:30:31.944414 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:30:31.946426 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:30:31.949424 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:30:31.951426 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:30:31.953426 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:30:31.972209 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:30:31.972209 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:30:32.025555 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc2c6cc2-b8b1-49bf-9d07-f85ae0913a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EBB6CC10>]}
2021-10-22 14:30:32.051180 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-22 14:30:32.052337 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc2c6cc2-b8b1-49bf-9d07-f85ae0913a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190ED1A87C0>]}
2021-10-22 14:30:32.052623 (MainThread): Found 7 models, 10 tests, 1 snapshot, 0 analyses, 151 macros, 4 operations, 0 seed files, 2 sources, 0 exposures
2021-10-22 14:30:32.054513 (MainThread): 
2021-10-22 14:30:32.055012 (MainThread): Acquiring new snowflake connection "master".
2021-10-22 14:30:32.057025 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-22 14:30:32.077908 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-22 14:30:32.077908 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-22 14:30:32.077908 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-22 14:30:34.246675 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.17 seconds
2021-10-22 14:30:34.264101 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-22 14:30:34.700376 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_snapshots".
2021-10-22 14:30:34.706268 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_snapshots".
2021-10-22 14:30:34.707262 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */

    show terse objects in analytics.snapshots
2021-10-22 14:30:34.707262 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-22 14:30:35.859209 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 1.15 seconds
2021-10-22 14:30:35.859209 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: Close
2021-10-22 14:30:36.323889 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-22 14:30:36.325790 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-22 14:30:36.325790 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-22 14:30:36.325790 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-22 14:30:37.489975 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.16 seconds
2021-10-22 14:30:37.490974 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-22 14:30:37.913761 (MainThread): Using snowflake connection "master".
2021-10-22 14:30:37.913761 (MainThread): On master: BEGIN
2021-10-22 14:30:37.913761 (MainThread): Opening a new connection, currently in state init
2021-10-22 14:30:38.912671 (MainThread): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-22 14:30:38.912671 (MainThread): On master: COMMIT
2021-10-22 14:30:38.912671 (MainThread): Using snowflake connection "master".
2021-10-22 14:30:38.912671 (MainThread): On master: COMMIT
2021-10-22 14:30:39.172567 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-22 14:30:39.172567 (MainThread): 16:30:39 | 
2021-10-22 14:30:39.172567 (MainThread): 16:30:39 | Running 1 on-run-start hook
2021-10-22 14:30:39.174656 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-22 14:30:39.174656 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-22 14:30:39.181565 (MainThread): 16:30:39 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-22 14:30:39.182673 (MainThread): Using snowflake connection "master".
2021-10-22 14:30:39.182673 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-22 14:30:39.383373 (MainThread): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-22 14:30:39.384419 (MainThread): 16:30:39 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.20s]
2021-10-22 14:30:39.385369 (MainThread): 16:30:39 | 
2021-10-22 14:30:39.386378 (MainThread): On master: Close
2021-10-22 14:30:39.816079 (MainThread): 16:30:39 | Concurrency: 1 threads (target='dev')
2021-10-22 14:30:39.817155 (MainThread): 16:30:39 | 
2021-10-22 14:30:39.821320 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-22 14:30:39.821320 (Thread-1): 16:30:39 | 1 of 5 START table model dbt.first_model............................. [RUN]
2021-10-22 14:30:39.821320 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-22 14:30:39.822415 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-22 14:30:39.823488 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-22 14:30:39.831463 (Thread-1): finished collecting timing info
2021-10-22 14:30:39.856135 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-22 14:30:39.865171 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-22 14:30:39.866144 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-22 14:30:39.866144 (Thread-1): Opening a new connection, currently in state init
2021-10-22 14:30:40.861135 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-10-22 14:30:40.862137 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-22 14:30:40.862137 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below

    post_hook="grant select on analytics.dbt.first_model to role analyst" can put in config
*/




with source_data as (

    select 1 as id, 'CA' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at
    union all
    select null as id, 'TX' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at
    union all
    select 3 as id, 'VT' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-22 14:30:42.278096 (Thread-1): SQL status: SUCCESS 1 in 1.42 seconds
2021-10-22 14:30:42.279111 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-22 14:30:42.279111 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-22 14:30:42.279111 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-22 14:30:42.544261 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-22 14:30:42.553953 (Thread-1): finished collecting timing info
2021-10-22 14:30:42.553953 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-22 14:30:42.882451 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc2c6cc2-b8b1-49bf-9d07-f85ae0913a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190ED4E0F10>]}
2021-10-22 14:30:42.882451 (Thread-1): 16:30:42 | 1 of 5 OK created table model dbt.first_model........................ [SUCCESS 1 in 3.06s]
2021-10-22 14:30:42.883464 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-22 14:30:42.883464 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-22 14:30:42.884520 (Thread-1): 16:30:42 | 2 of 5 START table model dbt.cul_order_price......................... [RUN]
2021-10-22 14:30:42.884520 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-22 14:30:42.884520 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-22 14:30:42.885462 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-22 14:30:42.890447 (Thread-1): finished collecting timing info
2021-10-22 14:30:42.892598 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-22 14:30:42.901232 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-22 14:30:42.901232 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-22 14:30:42.901232 (Thread-1): Opening a new connection, currently in state closed
2021-10-22 14:30:44.019077 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-10-22 14:30:44.019077 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-22 14:30:44.020233 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-22 14:30:45.729034 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2021-10-22 14:30:45.730034 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-22 14:30:45.730034 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-22 14:30:45.730034 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-22 14:30:45.945668 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-22 14:30:45.946733 (Thread-1): finished collecting timing info
2021-10-22 14:30:45.946733 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-22 14:30:46.358727 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc2c6cc2-b8b1-49bf-9d07-f85ae0913a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190ED15F8B0>]}
2021-10-22 14:30:46.359794 (Thread-1): 16:30:46 | 2 of 5 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.47s]
2021-10-22 14:30:46.360816 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-22 14:30:46.360816 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-22 14:30:46.360816 (Thread-1): 16:30:46 | 3 of 5 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-22 14:30:46.361722 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 14:30:46.361722 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-22 14:30:46.365248 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-22 14:30:46.370290 (Thread-1): finished collecting timing info
2021-10-22 14:30:46.372285 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-22 14:30:46.378349 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 14:30:46.378349 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-22 14:30:46.378964 (Thread-1): Opening a new connection, currently in state closed
2021-10-22 14:30:47.553722 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-10-22 14:30:47.553722 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 14:30:47.553722 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM snowflake_sample_data.tpch_sf1.customer c
LEFT JOIN snowflake_sample_data.tpch_sf1.order o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-22 14:30:47.909884 (Thread-1): Snowflake query id: 019fc7a6-0601-44e0-0066-47030001108e
2021-10-22 14:30:47.909884 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 41 unexpected 'order'.
syntax error line 10 at position 47 unexpected 'o'.
syntax error line 11 at position 0 unexpected 'ON'.
syntax error line 11 at position 3 unexpected 'c'.
2021-10-22 14:30:47.909884 (Thread-1): finished collecting timing info
2021-10-22 14:30:47.909884 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: ROLLBACK
2021-10-22 14:30:48.255661 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-22 14:30:48.795378 (Thread-1): Database Error in model snowflake_customer_purchases (models\example\snowflake_customer_purchases.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 41 unexpected 'order'.
  syntax error line 10 at position 47 unexpected 'o'.
  syntax error line 11 at position 0 unexpected 'ON'.
  syntax error line 11 at position 3 unexpected 'c'.
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\snowflake_customer_purchases.sql
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 179, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 10 at position 41 unexpected 'order'.
syntax error line 10 at position 47 unexpected 'o'.
syntax error line 11 at position 0 unexpected 'ON'.
syntax error line 11 at position 3 unexpected 'c'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 333, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 196, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_customer_purchases (models\example\snowflake_customer_purchases.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 41 unexpected 'order'.
  syntax error line 10 at position 47 unexpected 'o'.
  syntax error line 11 at position 0 unexpected 'ON'.
  syntax error line 11 at position 3 unexpected 'c'.
  compiled SQL at target\run\lukeclarke_learn_dbt\models\example\snowflake_customer_purchases.sql
2021-10-22 14:30:48.804399 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc2c6cc2-b8b1-49bf-9d07-f85ae0913a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190ED072520>]}
2021-10-22 14:30:48.804399 (Thread-1): 16:30:48 | 3 of 5 ERROR creating table model dbt.snowflake_customer_purchases... [ERROR in 2.44s]
2021-10-22 14:30:48.805844 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-22 14:30:48.805844 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-22 14:30:48.805844 (Thread-1): 16:30:48 | 4 of 5 START incremental model dbt.time.............................. [RUN]
2021-10-22 14:30:48.806432 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:30:48.806432 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-22 14:30:48.813448 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-22 14:30:48.819774 (Thread-1): finished collecting timing info
2021-10-22 14:30:48.842429 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:30:48.843430 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-22 14:30:48.843430 (Thread-1): Opening a new connection, currently in state closed
2021-10-22 14:30:51.253240 (Thread-1): SQL status: SUCCESS 1 in 2.41 seconds
2021-10-22 14:30:51.260240 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:30:51.260240 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-22 14:30:51.520915 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-22 14:30:51.523914 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:30:51.523914 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-22 14:30:51.768346 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-22 14:30:51.770345 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:30:51.770345 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-22 14:30:51.939734 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-22 14:30:51.954084 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-22 14:30:51.969939 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:30:51.969939 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-22 14:30:52.172906 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-22 14:30:52.172906 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:30:52.172906 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-22 14:30:52.620520 (Thread-1): SQL status: SUCCESS 0 in 0.45 seconds
2021-10-22 14:30:52.621534 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-22 14:30:52.621534 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:30:52.621534 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-22 14:30:52.955877 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-10-22 14:30:52.956657 (Thread-1): finished collecting timing info
2021-10-22 14:30:52.956657 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-22 14:30:53.291572 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc2c6cc2-b8b1-49bf-9d07-f85ae0913a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190ED1A84C0>]}
2021-10-22 14:30:53.291572 (Thread-1): 16:30:53 | 4 of 5 OK created incremental model dbt.time......................... [SUCCESS 0 in 4.49s]
2021-10-22 14:30:53.292589 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-22 14:30:53.292589 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-22 14:30:53.293620 (Thread-1): 16:30:53 | 5 of 5 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-22 14:30:53.294142 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-22 14:30:53.294142 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-22 14:30:53.296572 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-22 14:30:53.302744 (Thread-1): finished collecting timing info
2021-10-22 14:30:53.305107 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-22 14:30:53.309797 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-22 14:30:53.310752 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-22 14:30:53.310752 (Thread-1): Opening a new connection, currently in state closed
2021-10-22 14:30:55.165583 (Thread-1): SQL status: SUCCESS 1 in 1.85 seconds
2021-10-22 14:30:55.165583 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-22 14:30:55.165583 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-22 14:30:56.213619 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-10-22 14:30:56.215635 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-22 14:30:56.215635 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-22 14:30:56.215635 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-22 14:30:56.553783 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-10-22 14:30:56.554847 (Thread-1): finished collecting timing info
2021-10-22 14:30:56.555740 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-22 14:30:56.957843 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc2c6cc2-b8b1-49bf-9d07-f85ae0913a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190ED57BCD0>]}
2021-10-22 14:30:56.957843 (Thread-1): 16:30:56 | 5 of 5 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 3.66s]
2021-10-22 14:30:56.958842 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-22 14:30:56.960553 (MainThread): Acquiring new snowflake connection "master".
2021-10-22 14:30:56.960553 (MainThread): Using snowflake connection "master".
2021-10-22 14:30:56.960553 (MainThread): On master: BEGIN
2021-10-22 14:30:56.960553 (MainThread): Opening a new connection, currently in state closed
2021-10-22 14:30:58.298102 (MainThread): SQL status: SUCCESS 1 in 1.34 seconds
2021-10-22 14:30:58.298102 (MainThread): On master: COMMIT
2021-10-22 14:30:58.298102 (MainThread): Using snowflake connection "master".
2021-10-22 14:30:58.299117 (MainThread): On master: COMMIT
2021-10-22 14:30:58.570893 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-22 14:30:58.570893 (MainThread): 16:30:58 | 
2021-10-22 14:30:58.571892 (MainThread): 16:30:58 | Running 3 on-run-end hooks
2021-10-22 14:30:58.572895 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-22 14:30:58.573891 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-22 14:30:58.582516 (MainThread): 16:30:58 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-22 14:30:58.582516 (MainThread): Using snowflake connection "master".
2021-10-22 14:30:58.583531 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-22 14:30:59.182528 (MainThread): SQL status: SUCCESS 1 in 0.60 seconds
2021-10-22 14:30:59.183529 (MainThread): 16:30:59 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.60s]
2021-10-22 14:30:59.184527 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-22 14:30:59.185528 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-22 14:30:59.202055 (MainThread): 16:30:59 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-22 14:30:59.203057 (MainThread): Using snowflake connection "master".
2021-10-22 14:30:59.203057 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-22 14:30:59.452191 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-22 14:30:59.453192 (MainThread): 16:30:59 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.25s]
2021-10-22 14:30:59.454144 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-22 14:30:59.455119 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-22 14:30:59.461366 (MainThread): 16:30:59 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-22 14:30:59.461366 (MainThread): Using snowflake connection "master".
2021-10-22 14:30:59.461366 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-22 14:30:59.642150 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-22 14:30:59.643189 (MainThread): 16:30:59 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.18s]
2021-10-22 14:30:59.645111 (MainThread): 16:30:59 | 
2021-10-22 14:30:59.645111 (MainThread): On master: Close
2021-10-22 14:31:00.057528 (MainThread): 16:31:00 | 
2021-10-22 14:31:00.057528 (MainThread): 16:31:00 | Finished running 4 table models, 1 incremental model, 4 hooks in 28.00s.
2021-10-22 14:31:00.058525 (MainThread): Connection 'master' was properly closed.
2021-10-22 14:31:00.058525 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-22 14:31:00.058525 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-22 14:31:00.059525 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-22 14:31:00.074972 (MainThread): 
2021-10-22 14:31:00.075306 (MainThread): Completed with 1 error and 0 warnings:
2021-10-22 14:31:00.076372 (MainThread): 
2021-10-22 14:31:00.077316 (MainThread): Database Error in model snowflake_customer_purchases (models\example\snowflake_customer_purchases.sql)
2021-10-22 14:31:00.078082 (MainThread):   001003 (42000): SQL compilation error:
2021-10-22 14:31:00.078533 (MainThread):   syntax error line 10 at position 41 unexpected 'order'.
2021-10-22 14:31:00.078922 (MainThread):   syntax error line 10 at position 47 unexpected 'o'.
2021-10-22 14:31:00.079422 (MainThread):   syntax error line 11 at position 0 unexpected 'ON'.
2021-10-22 14:31:00.079922 (MainThread):   syntax error line 11 at position 3 unexpected 'c'.
2021-10-22 14:31:00.079922 (MainThread):   compiled SQL at target\run\lukeclarke_learn_dbt\models\example\snowflake_customer_purchases.sql
2021-10-22 14:31:00.081490 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-10-22 14:31:00.081975 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190ED697370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190ED4E8AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190ED098700>]}
2021-10-22 14:31:00.082333 (MainThread): Flushing usage events
2021-10-22 14:34:15.970390 (MainThread): Running with dbt=0.20.2
2021-10-22 14:34:16.929544 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['example'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-22 14:34:16.930543 (MainThread): Tracking: tracking
2021-10-22 14:34:16.930543 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCE26DD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCF7B8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCF7B8760>]}
2021-10-22 14:34:16.942622 (MainThread): Partial parsing not enabled
2021-10-22 14:34:16.968590 (MainThread): Parsing macros\adapters.sql
2021-10-22 14:34:16.999276 (MainThread): Parsing macros\catalog.sql
2021-10-22 14:34:17.001196 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-22 14:34:17.011627 (MainThread): Parsing macros\materializations\merge.sql
2021-10-22 14:34:17.013648 (MainThread): Parsing macros\materializations\table.sql
2021-10-22 14:34:17.017663 (MainThread): Parsing macros\materializations\view.sql
2021-10-22 14:34:17.018645 (MainThread): Parsing macros\core.sql
2021-10-22 14:34:17.022655 (MainThread): Parsing macros\adapters\common.sql
2021-10-22 14:34:17.067185 (MainThread): Parsing macros\etc\datetime.sql
2021-10-22 14:34:17.077611 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-22 14:34:17.078691 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-22 14:34:17.079701 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-22 14:34:17.081707 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-22 14:34:17.082691 (MainThread): Parsing macros\etc\query.sql
2021-10-22 14:34:17.083691 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-22 14:34:17.094970 (MainThread): Parsing macros\materializations\test.sql
2021-10-22 14:34:17.101897 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-22 14:34:17.114900 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-22 14:34:17.117587 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-22 14:34:17.125599 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-22 14:34:17.144810 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-22 14:34:17.174603 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-22 14:34:17.175604 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-22 14:34:17.196741 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-22 14:34:17.203746 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-22 14:34:17.208746 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-22 14:34:17.214747 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-22 14:34:17.216747 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-22 14:34:17.217747 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-22 14:34:17.219746 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-22 14:34:17.398750 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-22 14:34:17.411969 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-22 14:34:17.415278 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-22 14:34:17.419291 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:34:17.420281 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-22 14:34:17.424281 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 14:34:17.429052 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:34:17.437254 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-22 14:34:17.452290 (MainThread): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-22 14:34:17.469662 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-22 14:34:17.472665 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:34:17.473586 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-22 14:34:17.476756 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:34:17.518409 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-22 14:34:17.520418 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-22 14:34:17.523004 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-22 14:34:17.525025 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-22 14:34:17.557134 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:34:17.560340 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:34:17.571931 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:34:17.572150 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:34:17.574573 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:34:17.576922 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:34:17.579036 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:34:17.580880 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:34:17.595609 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:34:17.595609 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:34:17.634419 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9de8d45a-d1a2-47ea-8cc6-52c24669f864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCF812820>]}
2021-10-22 14:34:17.668074 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-22 14:34:17.668575 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9de8d45a-d1a2-47ea-8cc6-52c24669f864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCF812A00>]}
2021-10-22 14:34:17.669593 (MainThread): Found 7 models, 10 tests, 1 snapshot, 0 analyses, 151 macros, 4 operations, 0 seed files, 2 sources, 0 exposures
2021-10-22 14:34:17.671593 (MainThread): 
2021-10-22 14:34:17.672977 (MainThread): Acquiring new snowflake connection "master".
2021-10-22 14:34:17.674488 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-22 14:34:17.690402 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-22 14:34:17.690402 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-22 14:34:17.690926 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-22 14:34:19.515854 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.82 seconds
2021-10-22 14:34:19.517845 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-22 14:34:19.887102 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-22 14:34:19.891675 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-22 14:34:19.892578 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-22 14:34:19.892578 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-22 14:34:21.250417 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.36 seconds
2021-10-22 14:34:21.251371 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-22 14:34:21.610236 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_snapshots".
2021-10-22 14:34:21.612237 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_snapshots".
2021-10-22 14:34:21.612237 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */

    show terse objects in analytics.snapshots
2021-10-22 14:34:21.612237 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-22 14:34:22.549837 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.94 seconds
2021-10-22 14:34:22.549837 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: Close
2021-10-22 14:34:22.989471 (MainThread): Using snowflake connection "master".
2021-10-22 14:34:22.989471 (MainThread): On master: BEGIN
2021-10-22 14:34:22.989471 (MainThread): Opening a new connection, currently in state init
2021-10-22 14:34:24.109455 (MainThread): SQL status: SUCCESS 1 in 1.12 seconds
2021-10-22 14:34:24.109455 (MainThread): On master: COMMIT
2021-10-22 14:34:24.109455 (MainThread): Using snowflake connection "master".
2021-10-22 14:34:24.110464 (MainThread): On master: COMMIT
2021-10-22 14:34:24.566325 (MainThread): SQL status: SUCCESS 1 in 0.46 seconds
2021-10-22 14:34:24.566325 (MainThread): 16:34:24 | 
2021-10-22 14:34:24.566325 (MainThread): 16:34:24 | Running 1 on-run-start hook
2021-10-22 14:34:24.567324 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-22 14:34:24.568322 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-22 14:34:24.571963 (MainThread): 16:34:24 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-22 14:34:24.571963 (MainThread): Using snowflake connection "master".
2021-10-22 14:34:24.571963 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-22 14:34:24.805306 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-22 14:34:24.806213 (MainThread): 16:34:24 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.23s]
2021-10-22 14:34:24.806927 (MainThread): 16:34:24 | 
2021-10-22 14:34:24.807940 (MainThread): On master: Close
2021-10-22 14:34:25.462775 (MainThread): 16:34:25 | Concurrency: 1 threads (target='dev')
2021-10-22 14:34:25.462775 (MainThread): 16:34:25 | 
2021-10-22 14:34:25.466572 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-22 14:34:25.467573 (Thread-1): 16:34:25 | 1 of 5 START table model dbt.first_model............................. [RUN]
2021-10-22 14:34:25.467573 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-22 14:34:25.467573 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-22 14:34:25.469576 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-22 14:34:25.471573 (Thread-1): finished collecting timing info
2021-10-22 14:34:25.494261 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-22 14:34:25.500427 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-22 14:34:25.500427 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-22 14:34:25.501427 (Thread-1): Opening a new connection, currently in state init
2021-10-22 14:34:26.555875 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-10-22 14:34:26.555875 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-22 14:34:26.555875 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below

    post_hook="grant select on analytics.dbt.first_model to role analyst" can put in config
*/




with source_data as (

    select 1 as id, 'CA' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at
    union all
    select null as id, 'TX' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at
    union all
    select 3 as id, 'VT' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-22 14:34:27.544841 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-10-22 14:34:27.545761 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-22 14:34:27.545873 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-22 14:34:27.545960 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-22 14:34:27.761990 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-22 14:34:27.768453 (Thread-1): finished collecting timing info
2021-10-22 14:34:27.768453 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-22 14:34:28.118674 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de8d45a-d1a2-47ea-8cc6-52c24669f864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCFBE3B50>]}
2021-10-22 14:34:28.118674 (Thread-1): 16:34:28 | 1 of 5 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.65s]
2021-10-22 14:34:28.119872 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-22 14:34:28.119872 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-22 14:34:28.119872 (Thread-1): 16:34:28 | 2 of 5 START table model dbt.cul_order_price......................... [RUN]
2021-10-22 14:34:28.120871 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-22 14:34:28.120871 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-22 14:34:28.121870 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-22 14:34:28.123705 (Thread-1): finished collecting timing info
2021-10-22 14:34:28.125782 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-22 14:34:28.127875 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-22 14:34:28.127875 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-22 14:34:28.127875 (Thread-1): Opening a new connection, currently in state closed
2021-10-22 14:34:29.048526 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2021-10-22 14:34:29.048526 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-22 14:34:29.048526 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-22 14:34:30.392501 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-10-22 14:34:30.393578 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-22 14:34:30.393578 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-22 14:34:30.393578 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-22 14:34:30.632354 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-22 14:34:30.633443 (Thread-1): finished collecting timing info
2021-10-22 14:34:30.633443 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-22 14:34:31.012688 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de8d45a-d1a2-47ea-8cc6-52c24669f864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCF839CD0>]}
2021-10-22 14:34:31.012688 (Thread-1): 16:34:31 | 2 of 5 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 2.89s]
2021-10-22 14:34:31.013776 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-22 14:34:31.014689 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-22 14:34:31.014689 (Thread-1): 16:34:31 | 3 of 5 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-22 14:34:31.014689 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 14:34:31.014689 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-22 14:34:31.016687 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-22 14:34:31.021840 (Thread-1): finished collecting timing info
2021-10-22 14:34:31.024756 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-22 14:34:31.030677 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 14:34:31.030677 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-22 14:34:31.030677 (Thread-1): Opening a new connection, currently in state closed
2021-10-22 14:34:32.235566 (Thread-1): SQL status: SUCCESS 1 in 1.20 seconds
2021-10-22 14:34:32.235566 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 14:34:32.235566 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM snowflake_sample_data.tpch_sf1.customer c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-22 14:34:33.975139 (Thread-1): SQL status: SUCCESS 1 in 1.74 seconds
2021-10-22 14:34:33.976539 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-22 14:34:33.976539 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 14:34:33.976539 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-22 14:34:34.156934 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-22 14:34:34.157955 (Thread-1): finished collecting timing info
2021-10-22 14:34:34.157955 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-22 14:34:34.563394 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de8d45a-d1a2-47ea-8cc6-52c24669f864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCFC8C8B0>]}
2021-10-22 14:34:34.563394 (Thread-1): 16:34:34 | 3 of 5 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.55s]
2021-10-22 14:34:34.564393 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-22 14:34:34.564393 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-22 14:34:34.564393 (Thread-1): 16:34:34 | 4 of 5 START incremental model dbt.time.............................. [RUN]
2021-10-22 14:34:34.565393 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:34:34.565393 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-22 14:34:34.569081 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-22 14:34:34.571081 (Thread-1): finished collecting timing info
2021-10-22 14:34:34.593738 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:34:34.593738 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-22 14:34:34.593738 (Thread-1): Opening a new connection, currently in state closed
2021-10-22 14:34:36.044797 (Thread-1): SQL status: SUCCESS 1 in 1.45 seconds
2021-10-22 14:34:36.052718 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:34:36.052718 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-22 14:34:36.266315 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-22 14:34:36.268312 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:34:36.268312 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-22 14:34:36.465049 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-22 14:34:36.466911 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:34:36.466911 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-22 14:34:36.632233 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-22 14:34:36.642232 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-22 14:34:36.644949 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:34:36.644949 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-22 14:34:36.857162 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-22 14:34:36.857255 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:34:36.857255 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-22 14:34:37.197335 (Thread-1): SQL status: SUCCESS 0 in 0.34 seconds
2021-10-22 14:34:37.198335 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-22 14:34:37.198335 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:34:37.198335 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-22 14:34:37.464351 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-22 14:34:37.465421 (Thread-1): finished collecting timing info
2021-10-22 14:34:37.465421 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-22 14:34:37.827209 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de8d45a-d1a2-47ea-8cc6-52c24669f864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCF801760>]}
2021-10-22 14:34:37.828209 (Thread-1): 16:34:37 | 4 of 5 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.26s]
2021-10-22 14:34:37.829208 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-22 14:34:37.829208 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-22 14:34:37.829208 (Thread-1): 16:34:37 | 5 of 5 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-22 14:34:37.830206 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-22 14:34:37.830206 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-22 14:34:37.832207 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-22 14:34:37.833295 (Thread-1): finished collecting timing info
2021-10-22 14:34:37.834206 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-22 14:34:37.836918 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-22 14:34:37.836918 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-22 14:34:37.837420 (Thread-1): Opening a new connection, currently in state closed
2021-10-22 14:34:38.797516 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-10-22 14:34:38.797913 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-22 14:34:38.797913 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-22 14:34:40.124280 (Thread-1): SQL status: SUCCESS 1 in 1.33 seconds
2021-10-22 14:34:40.125583 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-22 14:34:40.126097 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-22 14:34:40.126097 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-22 14:34:40.359915 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-22 14:34:40.361021 (Thread-1): finished collecting timing info
2021-10-22 14:34:40.361021 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-22 14:34:40.707562 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de8d45a-d1a2-47ea-8cc6-52c24669f864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCFBE6B80>]}
2021-10-22 14:34:40.707562 (Thread-1): 16:34:40 | 5 of 5 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.88s]
2021-10-22 14:34:40.708561 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-22 14:34:40.710255 (MainThread): Acquiring new snowflake connection "master".
2021-10-22 14:34:40.710255 (MainThread): Using snowflake connection "master".
2021-10-22 14:34:40.710255 (MainThread): On master: BEGIN
2021-10-22 14:34:40.710255 (MainThread): Opening a new connection, currently in state closed
2021-10-22 14:34:41.661200 (MainThread): SQL status: SUCCESS 1 in 0.95 seconds
2021-10-22 14:34:41.661200 (MainThread): On master: COMMIT
2021-10-22 14:34:41.661200 (MainThread): Using snowflake connection "master".
2021-10-22 14:34:41.662195 (MainThread): On master: COMMIT
2021-10-22 14:34:41.921541 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-22 14:34:41.921541 (MainThread): 16:34:41 | 
2021-10-22 14:34:41.922772 (MainThread): 16:34:41 | Running 3 on-run-end hooks
2021-10-22 14:34:41.925278 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-22 14:34:41.927389 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-22 14:34:41.929279 (MainThread): 16:34:41 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-22 14:34:41.930281 (MainThread): Using snowflake connection "master".
2021-10-22 14:34:41.930281 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-22 14:34:42.160779 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-22 14:34:42.160779 (MainThread): 16:34:42 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.23s]
2021-10-22 14:34:42.161782 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-22 14:34:42.162712 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-22 14:34:42.164691 (MainThread): 16:34:42 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-22 14:34:42.165694 (MainThread): Using snowflake connection "master".
2021-10-22 14:34:42.165694 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-22 14:34:42.415798 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-22 14:34:42.415798 (MainThread): 16:34:42 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.25s]
2021-10-22 14:34:42.416798 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-22 14:34:42.418798 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-22 14:34:42.420798 (MainThread): 16:34:42 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-22 14:34:42.421213 (MainThread): Using snowflake connection "master".
2021-10-22 14:34:42.421213 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-22 14:34:42.675539 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-22 14:34:42.676466 (MainThread): 16:34:42 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.26s]
2021-10-22 14:34:42.677464 (MainThread): 16:34:42 | 
2021-10-22 14:34:42.678465 (MainThread): On master: Close
2021-10-22 14:34:43.069386 (MainThread): 16:34:43 | 
2021-10-22 14:34:43.069386 (MainThread): 16:34:43 | Finished running 4 table models, 1 incremental model, 4 hooks in 25.40s.
2021-10-22 14:34:43.070293 (MainThread): Connection 'master' was properly closed.
2021-10-22 14:34:43.070293 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-22 14:34:43.070293 (MainThread): Connection 'list_analytics_snapshots' was properly closed.
2021-10-22 14:34:43.070293 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-22 14:34:43.086088 (MainThread): 
2021-10-22 14:34:43.086088 (MainThread): Completed successfully
2021-10-22 14:34:43.087273 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-10-22 14:34:43.088312 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCFC42790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCF83C520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCCFBE6B80>]}
2021-10-22 14:34:43.088312 (MainThread): Flushing usage events
2021-10-22 14:42:04.174922 (MainThread): Running with dbt=0.20.2
2021-10-22 14:42:05.136392 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-10-22 14:42:05.137389 (MainThread): Tracking: tracking
2021-10-22 14:42:05.137910 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C455B9DE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4570D89A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4570D8730>]}
2021-10-22 14:42:05.155139 (MainThread): Partial parsing not enabled
2021-10-22 14:42:05.164839 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4570CBF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4570CB670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4571006D0>]}
2021-10-22 14:42:05.164839 (MainThread): Flushing usage events
2021-10-22 14:42:06.207176 (MainThread): Encountered an error:
2021-10-22 14:42:06.207176 (MainThread): Compilation Error
  Error reading lukeclarke_learn_dbt: example\schema.yml - Runtime Error
    Syntax error near line 70
    ------------------------------
    67 |       - name: customer      #specify tables to reference as source tables in the database
    68 |         columns:
    69 |         - name: c_custkey
    70 |            tests:
    71 |              - unique
    72 |              - not_null 
    73 |       - name: orders
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 70, column 17
2021-10-22 14:42:06.257846 (MainThread): Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\yaml\__init__.py", line 114, in load
    return loader.get_single_data()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml\_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml\_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.scanner.ScannerError: mapping values are not allowed in this context
  in "<unicode string>", line 70, column 17

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 106, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 70
  ------------------------------
  67 |       - name: customer      #specify tables to reference as source tables in the database
  68 |         columns:
  69 |         - name: c_custkey
  70 |            tests:
  71 |              - unique
  72 |              - not_null 
  73 |       - name: orders
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 70, column 17

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\manifest.py", line 207, in load
    read_files(project, self.manifest.files, project_parser_files)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 137, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 92, in read_files_for_parser
    source_files = get_source_files(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 83, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\read_files.py", line 23, in load_source_file
    dfy = yaml_from_file(source_file)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\parser\schemas.py", line 109, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading lukeclarke_learn_dbt: example\schema.yml - Runtime Error
    Syntax error near line 70
    ------------------------------
    67 |       - name: customer      #specify tables to reference as source tables in the database
    68 |         columns:
    69 |         - name: c_custkey
    70 |            tests:
    71 |              - unique
    72 |              - not_null 
    73 |       - name: orders
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 70, column 17

2021-10-22 14:43:00.813915 (MainThread): Running with dbt=0.20.2
2021-10-22 14:43:01.704962 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-10-22 14:43:01.705965 (MainThread): Tracking: tracking
2021-10-22 14:43:01.705965 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054AD2CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054C278970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054C278760>]}
2021-10-22 14:43:01.717414 (MainThread): Partial parsing not enabled
2021-10-22 14:43:01.742002 (MainThread): Parsing macros\adapters.sql
2021-10-22 14:43:01.773585 (MainThread): Parsing macros\catalog.sql
2021-10-22 14:43:01.775582 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-22 14:43:01.788204 (MainThread): Parsing macros\materializations\merge.sql
2021-10-22 14:43:01.790697 (MainThread): Parsing macros\materializations\table.sql
2021-10-22 14:43:01.795698 (MainThread): Parsing macros\materializations\view.sql
2021-10-22 14:43:01.797698 (MainThread): Parsing macros\core.sql
2021-10-22 14:43:01.801704 (MainThread): Parsing macros\adapters\common.sql
2021-10-22 14:43:01.858319 (MainThread): Parsing macros\etc\datetime.sql
2021-10-22 14:43:01.868558 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-22 14:43:01.869565 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-22 14:43:01.871476 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-22 14:43:01.873564 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-22 14:43:01.875473 (MainThread): Parsing macros\etc\query.sql
2021-10-22 14:43:01.876575 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-22 14:43:01.887841 (MainThread): Parsing macros\materializations\test.sql
2021-10-22 14:43:01.894841 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-22 14:43:01.912126 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-22 14:43:01.914130 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-22 14:43:01.921129 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-22 14:43:01.938708 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-22 14:43:01.971596 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-22 14:43:01.973647 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-22 14:43:01.989917 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-22 14:43:01.998957 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-22 14:43:02.004391 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-22 14:43:02.014398 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-22 14:43:02.016399 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-22 14:43:02.017474 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-22 14:43:02.019493 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-22 14:43:02.224159 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-22 14:43:02.234208 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-22 14:43:02.237208 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-22 14:43:02.240774 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:43:02.242775 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-22 14:43:02.246774 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 14:43:02.251774 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:43:02.260556 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-22 14:43:02.274256 (MainThread): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-22 14:43:02.294879 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-22 14:43:02.297846 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:43:02.298847 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-22 14:43:02.302038 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:43:02.344604 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-22 14:43:02.347604 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-22 14:43:02.349605 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-22 14:43:02.352604 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-22 14:43:02.387620 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:43:02.389615 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:43:02.401354 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:43:02.402356 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:43:02.404353 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:43:02.406357 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:43:02.408358 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:43:02.410355 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:43:02.424356 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:43:02.424356 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:43:02.437169 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:43:02.439169 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:43:02.465669 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f8db0ea-9fe8-454d-a82b-591c4943f425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054C259CD0>]}
2021-10-22 14:43:02.492202 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-22 14:43:02.492947 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f8db0ea-9fe8-454d-a82b-591c4943f425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054C259B80>]}
2021-10-22 14:43:02.492947 (MainThread): Found 7 models, 12 tests, 1 snapshot, 0 analyses, 151 macros, 4 operations, 0 seed files, 2 sources, 0 exposures
2021-10-22 14:43:02.495217 (MainThread): 
2021-10-22 14:43:02.496497 (MainThread): Acquiring new snowflake connection "master".
2021-10-22 14:43:02.497645 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-22 14:43:02.513367 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-22 14:43:02.513718 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-22 14:43:02.513718 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-22 14:43:04.509367 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 2.00 seconds
2021-10-22 14:43:04.513273 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-22 14:43:04.876188 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_snapshots".
2021-10-22 14:43:04.878762 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_snapshots".
2021-10-22 14:43:04.878762 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */

    show terse objects in analytics.snapshots
2021-10-22 14:43:04.878762 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-22 14:43:06.059907 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 1.18 seconds
2021-10-22 14:43:06.059907 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: Close
2021-10-22 14:43:06.364933 (MainThread): 16:43:06 | Concurrency: 1 threads (target='dev')
2021-10-22 14:43:06.364933 (MainThread): 16:43:06 | 
2021-10-22 14:43:06.368940 (Thread-1): Began running node test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2
2021-10-22 14:43:06.368940 (Thread-1): 16:43:06 | 1 of 12 START test accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING [RUN]
2021-10-22 14:43:06.369944 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2".
2021-10-22 14:43:06.369944 (Thread-1): Compiling test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2
2021-10-22 14:43:06.376502 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2"
2021-10-22 14:43:06.389186 (Thread-1): finished collecting timing info
2021-10-22 14:43:06.402144 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2"
2021-10-22 14:43:06.414030 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2".
2021-10-22 14:43:06.414155 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2: BEGIN
2021-10-22 14:43:06.414155 (Thread-1): Opening a new connection, currently in state init
2021-10-22 14:43:07.412163 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-22 14:43:07.412163 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2".
2021-10-22 14:43:07.412163 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        c_mktsegment as value_field,
        count(*) as n_records

    from analytics.dbt.playing_with_tests
    group by 1

)

select *
from all_values
where value_field not in (
    'AUTOMOBILE','MACHINERY','HOUSEHOLD','FURNITURE','BUILDING'
)



      
    ) dbt_internal_test
2021-10-22 14:43:08.501661 (Thread-1): SQL status: SUCCESS 1 in 1.09 seconds
2021-10-22 14:43:08.505227 (Thread-1): finished collecting timing info
2021-10-22 14:43:08.506105 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2: ROLLBACK
2021-10-22 14:43:08.785309 (Thread-1): On test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2: Close
2021-10-22 14:43:09.102256 (Thread-1): 16:43:09 | 1 of 12 PASS accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING [PASS in 2.73s]
2021-10-22 14:43:09.105597 (Thread-1): Finished running node test.lukeclarke_learn_dbt.accepted_values_playing_with_tests_c_mktsegment__AUTOMOBILE__MACHINERY__HOUSEHOLD__FURNITURE__BUILDING.13ff678ee2
2021-10-22 14:43:09.105597 (Thread-1): Began running node test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-22 14:43:09.105597 (Thread-1): 16:43:09 | 2 of 12 START test assert_under_ten_percent_not_null................. [RUN]
2021-10-22 14:43:09.106586 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-22 14:43:09.106586 (Thread-1): Compiling test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-22 14:43:09.107668 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"
2021-10-22 14:43:09.113590 (Thread-1): finished collecting timing info
2021-10-22 14:43:09.114586 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"
2021-10-22 14:43:09.120931 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-22 14:43:09.120931 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: BEGIN
2021-10-22 14:43:09.120931 (Thread-1): Opening a new connection, currently in state closed
2021-10-22 14:43:10.040488 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2021-10-22 14:43:10.040488 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-22 14:43:10.040488 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
  SUM(CASE WHEN id IS NULL THEN 1 ELSE 0 END)/COUNT(*) AS total_nulls
FROM analytics.dbt.first_model
HAVING  SUM(CASE WHEN id IS NULL THEN 1 ELSE 0 END)/COUNT(*) > .4
      
    ) dbt_internal_test
2021-10-22 14:43:10.628090 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2021-10-22 14:43:10.628090 (Thread-1): finished collecting timing info
2021-10-22 14:43:10.628090 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: ROLLBACK
2021-10-22 14:43:10.927816 (Thread-1): On test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null: Close
2021-10-22 14:43:11.265196 (Thread-1): 16:43:11 | 2 of 12 PASS assert_under_ten_percent_not_null....................... [PASS in 2.16s]
2021-10-22 14:43:11.266194 (Thread-1): Finished running node test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null
2021-10-22 14:43:11.266194 (Thread-1): Began running node test.lukeclarke_learn_dbt.mkt_segment_test
2021-10-22 14:43:11.266194 (Thread-1): 16:43:11 | 3 of 12 START test mkt_segment_test.................................. [RUN]
2021-10-22 14:43:11.267194 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-22 14:43:11.267194 (Thread-1): Compiling test.lukeclarke_learn_dbt.mkt_segment_test
2021-10-22 14:43:11.268279 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.mkt_segment_test"
2021-10-22 14:43:11.274509 (Thread-1): finished collecting timing info
2021-10-22 14:43:11.275461 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.mkt_segment_test"
2021-10-22 14:43:11.280460 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-22 14:43:11.281461 (Thread-1): On test.lukeclarke_learn_dbt.mkt_segment_test: BEGIN
2021-10-22 14:43:11.281461 (Thread-1): Opening a new connection, currently in state closed
2021-10-22 14:43:12.401905 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-10-22 14:43:12.401905 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-22 14:43:12.402962 (Thread-1): On test.lukeclarke_learn_dbt.mkt_segment_test: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.mkt_segment_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT SUM(c_acctbal)
FROM analytics.dbt.playing_with_tests
HAVING SUM(c_acctbal) > 100000000
      
    ) dbt_internal_test
2021-10-22 14:43:12.975090 (Thread-1): SQL status: SUCCESS 1 in 0.57 seconds
2021-10-22 14:43:12.975090 (Thread-1): finished collecting timing info
2021-10-22 14:43:12.976089 (Thread-1): On test.lukeclarke_learn_dbt.mkt_segment_test: ROLLBACK
2021-10-22 14:43:13.367080 (Thread-1): On test.lukeclarke_learn_dbt.mkt_segment_test: Close
2021-10-22 14:43:13.780834 (Thread-1): 16:43:13 | 3 of 12 PASS mkt_segment_test........................................ [PASS in 2.51s]
2021-10-22 14:43:13.781836 (Thread-1): Finished running node test.lukeclarke_learn_dbt.mkt_segment_test
2021-10-22 14:43:13.781836 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172
2021-10-22 14:43:13.781836 (Thread-1): 16:43:13 | 4 of 12 START test not_null_playing_with_tests_c_custkey............. [RUN]
2021-10-22 14:43:13.782834 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172".
2021-10-22 14:43:13.782834 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172
2021-10-22 14:43:13.790049 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172"
2021-10-22 14:43:13.796704 (Thread-1): finished collecting timing info
2021-10-22 14:43:13.797479 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172"
2021-10-22 14:43:13.803993 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172".
2021-10-22 14:43:13.803993 (Thread-1): On test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172: BEGIN
2021-10-22 14:43:13.803993 (Thread-1): Opening a new connection, currently in state closed
2021-10-22 14:43:14.990007 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2021-10-22 14:43:14.990007 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172".
2021-10-22 14:43:14.990007 (Thread-1): On test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.playing_with_tests
where c_custkey is null



      
    ) dbt_internal_test
2021-10-22 14:43:15.325560 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-10-22 14:43:15.326484 (Thread-1): finished collecting timing info
2021-10-22 14:43:15.326484 (Thread-1): On test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172: ROLLBACK
2021-10-22 14:43:15.734801 (Thread-1): On test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172: Close
2021-10-22 14:43:16.060880 (Thread-1): 16:43:16 | 4 of 12 PASS not_null_playing_with_tests_c_custkey................... [PASS in 2.28s]
2021-10-22 14:43:16.061382 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_playing_with_tests_c_custkey.3bfccb4172
2021-10-22 14:43:16.061382 (Thread-1): Began running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-22 14:43:16.062399 (Thread-1): 16:43:16 | 5 of 12 START test not_null_snowflake_customer_purchases_c_custkey... [RUN]
2021-10-22 14:43:16.062399 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-22 14:43:16.062399 (Thread-1): Compiling test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-22 14:43:16.066403 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-22 14:43:16.083317 (Thread-1): finished collecting timing info
2021-10-22 14:43:16.084798 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"
2021-10-22 14:43:16.091506 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-22 14:43:16.091680 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: BEGIN
2021-10-22 14:43:16.091680 (Thread-1): Opening a new connection, currently in state closed
2021-10-22 14:43:17.265965 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2021-10-22 14:43:17.265965 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a".
2021-10-22 14:43:17.267045 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from analytics.dbt.snowflake_customer_purchases
where c_custkey is null



      
    ) dbt_internal_test
2021-10-22 14:43:17.618506 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-10-22 14:43:17.619006 (Thread-1): finished collecting timing info
2021-10-22 14:43:17.619006 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: ROLLBACK
2021-10-22 14:43:17.994146 (Thread-1): On test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a: Close
2021-10-22 14:43:18.327157 (Thread-1): 16:43:18 | 5 of 12 PASS not_null_snowflake_customer_purchases_c_custkey......... [PASS in 2.26s]
2021-10-22 14:43:18.327930 (Thread-1): Finished running node test.lukeclarke_learn_dbt.not_null_snowflake_customer_purchases_c_custkey.ed6bfb9d4a
2021-10-22 14:43:18.328250 (Thread-1): Began running node test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-22 14:43:18.328250 (Thread-1): 16:43:18 | 6 of 12 START test relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_ [RUN]
2021-10-22 14:43:18.328753 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-22 14:43:18.328753 (Thread-1): Compiling test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-22 14:43:18.333892 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"
2021-10-22 14:43:18.339946 (Thread-1): finished collecting timing info
2021-10-22 14:43:18.342474 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"
2021-10-22 14:43:18.349883 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-22 14:43:18.349883 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: BEGIN
2021-10-22 14:43:18.349883 (Thread-1): Opening a new connection, currently in state closed
2021-10-22 14:43:19.475594 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2021-10-22 14:43:19.475594 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc".
2021-10-22 14:43:19.475594 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select id as from_field
    from analytics.dbt.my_second_dbt_model
    where id is not null
),

parent as (
    select id as to_field
    from analytics.dbt.first_model
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
2021-10-22 14:43:19.933954 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-10-22 14:43:19.933954 (Thread-1): finished collecting timing info
2021-10-22 14:43:19.933954 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: ROLLBACK
2021-10-22 14:43:20.168812 (Thread-1): On test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc: Close
2021-10-22 14:43:20.565160 (Thread-1): 16:43:20 | 6 of 12 PASS relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_ [PASS in 2.24s]
2021-10-22 14:43:20.566250 (Thread-1): Finished running node test.lukeclarke_learn_dbt.relationships_my_second_dbt_model_id__id__ref_my_first_dbt_model_.aaf7ce43bc
2021-10-22 14:43:20.567160 (Thread-1): Began running node test.lukeclarke_learn_dbt.source_not_null_sample_customer_c_custkey.116bc070c6
2021-10-22 14:43:20.567160 (Thread-1): 16:43:20 | 7 of 12 START test source_not_null_sample_customer_c_custkey......... [RUN]
2021-10-22 14:43:20.567160 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.source_not_null_sample_customer_c_custkey.116bc070c6".
2021-10-22 14:43:20.567160 (Thread-1): Compiling test.lukeclarke_learn_dbt.source_not_null_sample_customer_c_custkey.116bc070c6
2021-10-22 14:43:20.571256 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.source_not_null_sample_customer_c_custkey.116bc070c6"
2021-10-22 14:43:20.571862 (Thread-1): finished collecting timing info
2021-10-22 14:43:20.573022 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.source_not_null_sample_customer_c_custkey.116bc070c6"
2021-10-22 14:43:20.575689 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.source_not_null_sample_customer_c_custkey.116bc070c6".
2021-10-22 14:43:20.575689 (Thread-1): On test.lukeclarke_learn_dbt.source_not_null_sample_customer_c_custkey.116bc070c6: BEGIN
2021-10-22 14:43:20.575689 (Thread-1): Opening a new connection, currently in state closed
2021-10-22 14:43:21.586663 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-22 14:43:21.586663 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.source_not_null_sample_customer_c_custkey.116bc070c6".
2021-10-22 14:43:21.586663 (Thread-1): On test.lukeclarke_learn_dbt.source_not_null_sample_customer_c_custkey.116bc070c6: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.source_not_null_sample_customer_c_custkey.116bc070c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from snowflake_sample_data.tpch_sf1.customer
where c_custkey is null



      
    ) dbt_internal_test
2021-10-22 14:43:21.858423 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-22 14:43:21.859417 (Thread-1): finished collecting timing info
2021-10-22 14:43:21.859417 (Thread-1): On test.lukeclarke_learn_dbt.source_not_null_sample_customer_c_custkey.116bc070c6: ROLLBACK
2021-10-22 14:43:22.114303 (Thread-1): On test.lukeclarke_learn_dbt.source_not_null_sample_customer_c_custkey.116bc070c6: Close
2021-10-22 14:43:22.479606 (Thread-1): 16:43:22 | 7 of 12 PASS source_not_null_sample_customer_c_custkey............... [PASS in 1.91s]
2021-10-22 14:43:22.479606 (Thread-1): Finished running node test.lukeclarke_learn_dbt.source_not_null_sample_customer_c_custkey.116bc070c6
2021-10-22 14:43:22.480605 (Thread-1): Began running node test.lukeclarke_learn_dbt.source_unique_sample_customer_c_custkey.fb881fd112
2021-10-22 14:43:22.480605 (Thread-1): 16:43:22 | 8 of 12 START test source_unique_sample_customer_c_custkey........... [RUN]
2021-10-22 14:43:22.480605 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.source_unique_sample_customer_c_custkey.fb881fd112".
2021-10-22 14:43:22.480605 (Thread-1): Compiling test.lukeclarke_learn_dbt.source_unique_sample_customer_c_custkey.fb881fd112
2021-10-22 14:43:22.488676 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.source_unique_sample_customer_c_custkey.fb881fd112"
2021-10-22 14:43:22.489603 (Thread-1): finished collecting timing info
2021-10-22 14:43:22.490603 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.source_unique_sample_customer_c_custkey.fb881fd112"
2021-10-22 14:43:22.493202 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.source_unique_sample_customer_c_custkey.fb881fd112".
2021-10-22 14:43:22.493202 (Thread-1): On test.lukeclarke_learn_dbt.source_unique_sample_customer_c_custkey.fb881fd112: BEGIN
2021-10-22 14:43:22.493202 (Thread-1): Opening a new connection, currently in state closed
2021-10-22 14:43:23.477558 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-22 14:43:23.477558 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.source_unique_sample_customer_c_custkey.fb881fd112".
2021-10-22 14:43:23.477558 (Thread-1): On test.lukeclarke_learn_dbt.source_unique_sample_customer_c_custkey.fb881fd112: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.source_unique_sample_customer_c_custkey.fb881fd112"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.customer
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-22 14:43:23.944812 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2021-10-22 14:43:23.945909 (Thread-1): finished collecting timing info
2021-10-22 14:43:23.945909 (Thread-1): On test.lukeclarke_learn_dbt.source_unique_sample_customer_c_custkey.fb881fd112: ROLLBACK
2021-10-22 14:43:24.218399 (Thread-1): On test.lukeclarke_learn_dbt.source_unique_sample_customer_c_custkey.fb881fd112: Close
2021-10-22 14:43:24.648282 (Thread-1): 16:43:24 | 8 of 12 PASS source_unique_sample_customer_c_custkey................. [PASS in 2.17s]
2021-10-22 14:43:24.649282 (Thread-1): Finished running node test.lukeclarke_learn_dbt.source_unique_sample_customer_c_custkey.fb881fd112
2021-10-22 14:43:24.649282 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-22 14:43:24.649282 (Thread-1): 16:43:24 | 9 of 12 START test unique_my_first_dbt_model_id...................... [RUN]
2021-10-22 14:43:24.650282 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-22 14:43:24.650282 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-22 14:43:24.655287 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-22 14:43:24.660282 (Thread-1): finished collecting timing info
2021-10-22 14:43:24.663130 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"
2021-10-22 14:43:24.668233 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-22 14:43:24.669181 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: BEGIN
2021-10-22 14:43:24.669181 (Thread-1): Opening a new connection, currently in state closed
2021-10-22 14:43:25.782931 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2021-10-22 14:43:25.782931 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb".
2021-10-22 14:43:25.782931 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.first_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-22 14:43:26.033750 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-22 14:43:26.034748 (Thread-1): finished collecting timing info
2021-10-22 14:43:26.034748 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: ROLLBACK
2021-10-22 14:43:26.255385 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb: Close
2021-10-22 14:43:26.606426 (Thread-1): 16:43:26 | 9 of 12 PASS unique_my_first_dbt_model_id............................ [PASS in 1.96s]
2021-10-22 14:43:26.607157 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_first_dbt_model_id.5ef3c774bb
2021-10-22 14:43:26.607907 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-22 14:43:26.608407 (Thread-1): 16:43:26 | 10 of 12 START test unique_my_second_dbt_model_id.................... [RUN]
2021-10-22 14:43:26.608914 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-22 14:43:26.608914 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-22 14:43:26.615854 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-22 14:43:26.625214 (Thread-1): finished collecting timing info
2021-10-22 14:43:26.628682 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"
2021-10-22 14:43:26.639537 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-22 14:43:26.640036 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: BEGIN
2021-10-22 14:43:26.640036 (Thread-1): Opening a new connection, currently in state closed
2021-10-22 14:43:27.770485 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2021-10-22 14:43:27.770605 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570".
2021-10-22 14:43:27.770605 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from analytics.dbt.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-22 14:43:28.128587 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-22 14:43:28.129291 (Thread-1): finished collecting timing info
2021-10-22 14:43:28.129679 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: ROLLBACK
2021-10-22 14:43:28.395558 (Thread-1): On test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570: Close
2021-10-22 14:43:28.720130 (Thread-1): 16:43:28 | 10 of 12 PASS unique_my_second_dbt_model_id.......................... [PASS in 2.11s]
2021-10-22 14:43:28.721128 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_my_second_dbt_model_id.bc96125570
2021-10-22 14:43:28.721128 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c
2021-10-22 14:43:28.721128 (Thread-1): 16:43:28 | 11 of 12 START test unique_playing_with_tests_c_custkey.............. [RUN]
2021-10-22 14:43:28.722226 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c".
2021-10-22 14:43:28.722226 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c
2021-10-22 14:43:28.726740 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c"
2021-10-22 14:43:28.732744 (Thread-1): finished collecting timing info
2021-10-22 14:43:28.734745 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c"
2021-10-22 14:43:28.743641 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c".
2021-10-22 14:43:28.743641 (Thread-1): On test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c: BEGIN
2021-10-22 14:43:28.743641 (Thread-1): Opening a new connection, currently in state closed
2021-10-22 14:43:29.975887 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-10-22 14:43:29.975887 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c".
2021-10-22 14:43:29.975887 (Thread-1): On test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.playing_with_tests
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-22 14:43:30.286527 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-10-22 14:43:30.287534 (Thread-1): finished collecting timing info
2021-10-22 14:43:30.287534 (Thread-1): On test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c: ROLLBACK
2021-10-22 14:43:30.510060 (Thread-1): On test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c: Close
2021-10-22 14:43:30.923909 (Thread-1): 16:43:30 | 11 of 12 PASS unique_playing_with_tests_c_custkey.................... [PASS in 2.20s]
2021-10-22 14:43:30.924927 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_playing_with_tests_c_custkey.b27d329c8c
2021-10-22 14:43:30.924927 (Thread-1): Began running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-22 14:43:30.924927 (Thread-1): 16:43:30 | 12 of 12 START test unique_snowflake_customer_purchases_c_custkey.... [RUN]
2021-10-22 14:43:30.925973 (Thread-1): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-22 14:43:30.926473 (Thread-1): Compiling test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-22 14:43:30.929810 (Thread-1): Writing injected SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-22 14:43:30.934804 (Thread-1): finished collecting timing info
2021-10-22 14:43:30.937209 (Thread-1): Writing runtime SQL for node "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"
2021-10-22 14:43:30.943551 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-22 14:43:30.943551 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: BEGIN
2021-10-22 14:43:30.943551 (Thread-1): Opening a new connection, currently in state closed
2021-10-22 14:43:31.943188 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-22 14:43:31.943791 (Thread-1): Using snowflake connection "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8".
2021-10-22 14:43:31.943791 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    c_custkey as unique_field,
    count(*) as n_records

from analytics.dbt.snowflake_customer_purchases
where c_custkey is not null
group by c_custkey
having count(*) > 1



      
    ) dbt_internal_test
2021-10-22 14:43:32.321869 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-10-22 14:43:32.323055 (Thread-1): finished collecting timing info
2021-10-22 14:43:32.323055 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: ROLLBACK
2021-10-22 14:43:32.581990 (Thread-1): On test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8: Close
2021-10-22 14:43:32.966925 (Thread-1): 16:43:32 | 12 of 12 PASS unique_snowflake_customer_purchases_c_custkey.......... [PASS in 2.04s]
2021-10-22 14:43:32.968551 (Thread-1): Finished running node test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8
2021-10-22 14:43:32.970051 (MainThread): Acquiring new snowflake connection "master".
2021-10-22 14:43:32.970550 (MainThread): 16:43:32 | 
2021-10-22 14:43:32.970550 (MainThread): 16:43:32 | Finished running 12 tests in 30.48s.
2021-10-22 14:43:32.971201 (MainThread): Connection 'master' was properly closed.
2021-10-22 14:43:32.971201 (MainThread): Connection 'list_analytics_snapshots' was properly closed.
2021-10-22 14:43:32.971201 (MainThread): Connection 'test.lukeclarke_learn_dbt.unique_snowflake_customer_purchases_c_custkey.743d92eab8' was properly closed.
2021-10-22 14:43:32.994301 (MainThread): 
2021-10-22 14:43:32.994855 (MainThread): Completed successfully
2021-10-22 14:43:32.995432 (MainThread): 
Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
2021-10-22 14:43:32.995936 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054C638A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054C722A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054C232C70>]}
2021-10-22 14:43:32.995936 (MainThread): Flushing usage events
2021-10-22 14:46:20.173277 (MainThread): Running with dbt=0.20.2
2021-10-22 14:46:21.030675 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['source:sample+'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-22 14:46:21.031675 (MainThread): Tracking: tracking
2021-10-22 14:46:21.031675 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA3202CDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA33578790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA33578760>]}
2021-10-22 14:46:21.040916 (MainThread): Partial parsing not enabled
2021-10-22 14:46:21.063192 (MainThread): Parsing macros\adapters.sql
2021-10-22 14:46:21.093797 (MainThread): Parsing macros\catalog.sql
2021-10-22 14:46:21.095240 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-22 14:46:21.105897 (MainThread): Parsing macros\materializations\merge.sql
2021-10-22 14:46:21.107629 (MainThread): Parsing macros\materializations\table.sql
2021-10-22 14:46:21.111702 (MainThread): Parsing macros\materializations\view.sql
2021-10-22 14:46:21.112807 (MainThread): Parsing macros\core.sql
2021-10-22 14:46:21.117373 (MainThread): Parsing macros\adapters\common.sql
2021-10-22 14:46:21.165021 (MainThread): Parsing macros\etc\datetime.sql
2021-10-22 14:46:21.174057 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-22 14:46:21.175170 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-22 14:46:21.176369 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-22 14:46:21.178368 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-22 14:46:21.179368 (MainThread): Parsing macros\etc\query.sql
2021-10-22 14:46:21.180368 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-22 14:46:21.190542 (MainThread): Parsing macros\materializations\test.sql
2021-10-22 14:46:21.198204 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-22 14:46:21.211894 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-22 14:46:21.213895 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-22 14:46:21.220893 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-22 14:46:21.242638 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-22 14:46:21.276282 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-22 14:46:21.277282 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-22 14:46:21.298332 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-22 14:46:21.306696 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-22 14:46:21.311693 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-22 14:46:21.317944 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-22 14:46:21.320960 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-22 14:46:21.321959 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-22 14:46:21.323421 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-22 14:46:21.529736 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-22 14:46:21.539360 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-22 14:46:21.542361 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-22 14:46:21.546359 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:46:21.547810 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-22 14:46:21.551810 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 14:46:21.555811 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 14:46:21.563809 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-22 14:46:21.578552 (MainThread): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-22 14:46:21.596578 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-22 14:46:21.599563 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:46:21.600586 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-22 14:46:21.603608 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:46:21.650164 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-22 14:46:21.652166 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-22 14:46:21.654165 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-22 14:46:21.657278 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-22 14:46:21.687504 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:46:21.689653 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:46:21.700653 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:46:21.700653 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:46:21.702652 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:46:21.704648 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:46:21.706648 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:46:21.708648 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:46:21.719798 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:46:21.719798 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:46:21.733598 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:46:21.737636 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 14:46:21.771108 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f26c1b5-2542-42a4-be0d-b7eadddfb9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA335590A0>]}
2021-10-22 14:46:21.793872 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-22 14:46:21.794607 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f26c1b5-2542-42a4-be0d-b7eadddfb9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA33559AF0>]}
2021-10-22 14:46:21.794607 (MainThread): Found 7 models, 12 tests, 1 snapshot, 0 analyses, 151 macros, 4 operations, 0 seed files, 2 sources, 0 exposures
2021-10-22 14:46:21.797178 (MainThread): 
2021-10-22 14:46:21.798464 (MainThread): Acquiring new snowflake connection "master".
2021-10-22 14:46:21.799783 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-22 14:46:21.818021 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-22 14:46:21.818520 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-22 14:46:21.818520 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-22 14:46:23.859712 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.04 seconds
2021-10-22 14:46:23.863783 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-22 14:46:24.232092 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-22 14:46:24.237179 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-22 14:46:24.238184 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-22 14:46:24.238361 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-22 14:46:25.595205 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.36 seconds
2021-10-22 14:46:25.597493 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-22 14:46:25.944094 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_snapshots".
2021-10-22 14:46:25.945092 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_snapshots".
2021-10-22 14:46:25.945092 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */

    show terse objects in analytics.snapshots
2021-10-22 14:46:25.946013 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-22 14:46:26.936247 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.99 seconds
2021-10-22 14:46:26.936746 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: Close
2021-10-22 14:46:27.456449 (MainThread): Using snowflake connection "master".
2021-10-22 14:46:27.456449 (MainThread): On master: BEGIN
2021-10-22 14:46:27.456449 (MainThread): Opening a new connection, currently in state init
2021-10-22 14:46:28.365006 (MainThread): SQL status: SUCCESS 1 in 0.91 seconds
2021-10-22 14:46:28.365006 (MainThread): On master: COMMIT
2021-10-22 14:46:28.365006 (MainThread): Using snowflake connection "master".
2021-10-22 14:46:28.365006 (MainThread): On master: COMMIT
2021-10-22 14:46:28.669890 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-10-22 14:46:28.669890 (MainThread): 16:46:28 | 
2021-10-22 14:46:28.669890 (MainThread): 16:46:28 | Running 1 on-run-start hook
2021-10-22 14:46:28.671867 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-22 14:46:28.673868 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-22 14:46:28.677219 (MainThread): 16:46:28 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-22 14:46:28.677699 (MainThread): Using snowflake connection "master".
2021-10-22 14:46:28.677699 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-22 14:46:28.934411 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-22 14:46:28.935410 (MainThread): 16:46:28 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.26s]
2021-10-22 14:46:28.936410 (MainThread): 16:46:28 | 
2021-10-22 14:46:28.936410 (MainThread): On master: Close
2021-10-22 14:46:29.391457 (MainThread): 16:46:29 | Concurrency: 1 threads (target='dev')
2021-10-22 14:46:29.391457 (MainThread): 16:46:29 | 
2021-10-22 14:46:29.394457 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-22 14:46:29.394457 (Thread-1): 16:46:29 | 1 of 1 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-22 14:46:29.395476 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 14:46:29.395476 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-22 14:46:29.398272 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-22 14:46:29.404534 (Thread-1): finished collecting timing info
2021-10-22 14:46:29.441312 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-22 14:46:29.448802 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 14:46:29.449305 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-22 14:46:29.449353 (Thread-1): Opening a new connection, currently in state init
2021-10-22 14:46:30.499890 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-10-22 14:46:30.499890 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 14:46:30.499890 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM snowflake_sample_data.tpch_sf1.customer c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey
group by
    c.c_custkey,
    c.c_name,
    c.c_nationkey
      );
2021-10-22 14:46:32.077858 (Thread-1): SQL status: SUCCESS 1 in 1.58 seconds
2021-10-22 14:46:32.079941 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-22 14:46:32.080452 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 14:46:32.080507 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-22 14:46:32.253091 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-22 14:46:32.263072 (Thread-1): finished collecting timing info
2021-10-22 14:46:32.263072 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-22 14:46:32.688302 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f26c1b5-2542-42a4-be0d-b7eadddfb9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA33A2AFA0>]}
2021-10-22 14:46:32.689302 (Thread-1): 16:46:32 | 1 of 1 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.29s]
2021-10-22 14:46:32.689749 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-22 14:46:32.690934 (MainThread): Acquiring new snowflake connection "master".
2021-10-22 14:46:32.690934 (MainThread): Using snowflake connection "master".
2021-10-22 14:46:32.690934 (MainThread): On master: BEGIN
2021-10-22 14:46:32.690934 (MainThread): Opening a new connection, currently in state closed
2021-10-22 14:46:33.724642 (MainThread): SQL status: SUCCESS 1 in 1.03 seconds
2021-10-22 14:46:33.724642 (MainThread): On master: COMMIT
2021-10-22 14:46:33.724642 (MainThread): Using snowflake connection "master".
2021-10-22 14:46:33.724642 (MainThread): On master: COMMIT
2021-10-22 14:46:33.962528 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-22 14:46:33.962528 (MainThread): 16:46:33 | 
2021-10-22 14:46:33.963529 (MainThread): 16:46:33 | Running 3 on-run-end hooks
2021-10-22 14:46:33.963529 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-22 14:46:33.966140 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-22 14:46:33.971150 (MainThread): 16:46:33 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-22 14:46:33.971150 (MainThread): Using snowflake connection "master".
2021-10-22 14:46:33.971150 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-22 14:46:34.155352 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-22 14:46:34.156349 (MainThread): 16:46:34 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.19s]
2021-10-22 14:46:34.157293 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-22 14:46:34.158275 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-22 14:46:34.163266 (MainThread): 16:46:34 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-22 14:46:34.164267 (MainThread): Using snowflake connection "master".
2021-10-22 14:46:34.164267 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-22 14:46:34.399297 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-22 14:46:34.400246 (MainThread): 16:46:34 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.24s]
2021-10-22 14:46:34.401482 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-22 14:46:34.401979 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-22 14:46:34.404085 (MainThread): 16:46:34 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-22 14:46:34.404085 (MainThread): Using snowflake connection "master".
2021-10-22 14:46:34.404085 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-22 14:46:34.670458 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-22 14:46:34.671458 (MainThread): 16:46:34 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.27s]
2021-10-22 14:46:34.671458 (MainThread): 16:46:34 | 
2021-10-22 14:46:34.672684 (MainThread): On master: Close
2021-10-22 14:46:34.975725 (MainThread): 16:46:34 | 
2021-10-22 14:46:34.976855 (MainThread): 16:46:34 | Finished running 1 table model, 4 hooks in 13.18s.
2021-10-22 14:46:34.977946 (MainThread): Connection 'master' was properly closed.
2021-10-22 14:46:34.977946 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-22 14:46:34.977946 (MainThread): Connection 'list_analytics_snapshots' was properly closed.
2021-10-22 14:46:34.977946 (MainThread): Connection 'model.lukeclarke_learn_dbt.snowflake_customer_purchases' was properly closed.
2021-10-22 14:46:34.993073 (MainThread): 
2021-10-22 14:46:34.993073 (MainThread): Completed successfully
2021-10-22 14:46:34.994075 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-22 14:46:34.995155 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA33A12E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA33A2DAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA33657940>]}
2021-10-22 14:46:34.995155 (MainThread): Flushing usage events
2021-10-22 15:05:27.567163 (MainThread): Running with dbt=0.20.2
2021-10-22 15:05:28.699278 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['example.snowflake_customer_purchases'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-22 15:05:28.700281 (MainThread): Tracking: tracking
2021-10-22 15:05:28.700281 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC4AC1DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC4C141880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC4C1419D0>]}
2021-10-22 15:05:28.711364 (MainThread): Partial parsing not enabled
2021-10-22 15:05:28.741909 (MainThread): Parsing macros\group_by.sql
2021-10-22 15:05:28.741909 (MainThread): Parsing macros\adapters.sql
2021-10-22 15:05:28.787851 (MainThread): Parsing macros\catalog.sql
2021-10-22 15:05:28.789774 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-22 15:05:28.806471 (MainThread): Parsing macros\materializations\merge.sql
2021-10-22 15:05:28.810470 (MainThread): Parsing macros\materializations\table.sql
2021-10-22 15:05:28.814470 (MainThread): Parsing macros\materializations\view.sql
2021-10-22 15:05:28.815471 (MainThread): Parsing macros\core.sql
2021-10-22 15:05:28.820469 (MainThread): Parsing macros\adapters\common.sql
2021-10-22 15:05:28.878871 (MainThread): Parsing macros\etc\datetime.sql
2021-10-22 15:05:28.893099 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-22 15:05:28.895099 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-22 15:05:28.899100 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-22 15:05:28.902265 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-22 15:05:28.905265 (MainThread): Parsing macros\etc\query.sql
2021-10-22 15:05:28.906344 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-22 15:05:28.920522 (MainThread): Parsing macros\materializations\test.sql
2021-10-22 15:05:28.932522 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-22 15:05:28.952525 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-22 15:05:28.955526 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-22 15:05:28.966527 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-22 15:05:29.011000 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-22 15:05:29.059841 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-22 15:05:29.062843 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-22 15:05:29.100162 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-22 15:05:29.113874 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-22 15:05:29.125363 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-22 15:05:29.140310 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-22 15:05:29.145484 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-22 15:05:29.147540 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-22 15:05:29.151605 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-22 15:05:29.421191 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-22 15:05:29.434777 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-22 15:05:29.438774 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-22 15:05:29.443847 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:05:29.444777 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-22 15:05:29.450059 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 15:05:29.456068 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 15:05:29.467014 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-22 15:05:29.493466 (MainThread): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-22 15:05:29.520836 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-22 15:05:29.524744 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:05:29.525822 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-22 15:05:29.529830 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:05:29.580989 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-22 15:05:29.583015 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-22 15:05:29.587111 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-22 15:05:29.593111 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-22 15:05:29.632908 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:05:29.634908 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:05:29.645910 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:05:29.645910 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:05:29.648873 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:05:29.650982 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:05:29.653973 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:05:29.655981 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:05:29.669265 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:05:29.669265 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:05:29.684523 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:05:29.686463 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:05:29.709464 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '921ad6c4-95a7-4975-a2c6-4ccff5093a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC4C144190>]}
2021-10-22 15:05:29.729235 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-22 15:05:29.730228 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '921ad6c4-95a7-4975-a2c6-4ccff5093a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC4C144190>]}
2021-10-22 15:05:29.730228 (MainThread): Found 7 models, 12 tests, 1 snapshot, 0 analyses, 151 macros, 4 operations, 0 seed files, 2 sources, 0 exposures
2021-10-22 15:05:29.732225 (MainThread): 
2021-10-22 15:05:29.732225 (MainThread): Acquiring new snowflake connection "master".
2021-10-22 15:05:29.734226 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-22 15:05:29.751670 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-22 15:05:29.752157 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-22 15:05:29.752157 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-22 15:05:31.432428 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.68 seconds
2021-10-22 15:05:31.436422 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-22 15:05:31.739764 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_snapshots".
2021-10-22 15:05:31.746765 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_snapshots".
2021-10-22 15:05:31.746765 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */

    show terse objects in analytics.snapshots
2021-10-22 15:05:31.746765 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-22 15:05:32.647084 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.90 seconds
2021-10-22 15:05:32.648083 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: Close
2021-10-22 15:05:32.964815 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-22 15:05:32.965816 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-22 15:05:32.965816 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-22 15:05:32.965816 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-22 15:05:33.814787 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.85 seconds
2021-10-22 15:05:33.815509 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-22 15:05:34.125785 (MainThread): Using snowflake connection "master".
2021-10-22 15:05:34.125785 (MainThread): On master: BEGIN
2021-10-22 15:05:34.125785 (MainThread): Opening a new connection, currently in state init
2021-10-22 15:05:35.144460 (MainThread): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-22 15:05:35.144961 (MainThread): On master: COMMIT
2021-10-22 15:05:35.144961 (MainThread): Using snowflake connection "master".
2021-10-22 15:05:35.144961 (MainThread): On master: COMMIT
2021-10-22 15:05:35.395442 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-22 15:05:35.395442 (MainThread): 17:05:35 | 
2021-10-22 15:05:35.396366 (MainThread): 17:05:35 | Running 1 on-run-start hook
2021-10-22 15:05:35.397450 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-22 15:05:35.398436 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-22 15:05:35.401405 (MainThread): 17:05:35 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-22 15:05:35.402372 (MainThread): Using snowflake connection "master".
2021-10-22 15:05:35.402372 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-22 15:05:35.595594 (MainThread): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-22 15:05:35.596094 (MainThread): 17:05:35 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.19s]
2021-10-22 15:05:35.597128 (MainThread): 17:05:35 | 
2021-10-22 15:05:35.597172 (MainThread): On master: Close
2021-10-22 15:05:35.900362 (MainThread): 17:05:35 | Concurrency: 1 threads (target='dev')
2021-10-22 15:05:35.900362 (MainThread): 17:05:35 | 
2021-10-22 15:05:35.904275 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-22 15:05:35.904275 (Thread-1): 17:05:35 | 1 of 1 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-22 15:05:35.905421 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 15:05:35.905421 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-22 15:05:35.911563 (Thread-1): finished collecting timing info
2021-10-22 15:05:35.911563 (Thread-1): Compilation Error in model snowflake_customer_purchases (models\example\snowflake_customer_purchases.sql)
  'group_by' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 517, in catch_jinja
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 12, in top-level template code
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'group_by' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 464, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 371, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 522, in catch_jinja
    raise UndefinedMacroException(str(e), node) from e
dbt.exceptions.UndefinedMacroException: Compilation Error in model snowflake_customer_purchases (models\example\snowflake_customer_purchases.sql)
  'group_by' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-22 15:05:35.937317 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '921ad6c4-95a7-4975-a2c6-4ccff5093a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC4C6224C0>]}
2021-10-22 15:05:35.938346 (Thread-1): 17:05:35 | 1 of 1 ERROR creating table model dbt.snowflake_customer_purchases... [ERROR in 0.03s]
2021-10-22 15:05:35.939318 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-22 15:05:35.940235 (MainThread): Acquiring new snowflake connection "master".
2021-10-22 15:05:35.940235 (MainThread): Using snowflake connection "master".
2021-10-22 15:05:35.940235 (MainThread): On master: BEGIN
2021-10-22 15:05:35.940235 (MainThread): Opening a new connection, currently in state closed
2021-10-22 15:05:36.879183 (MainThread): SQL status: SUCCESS 1 in 0.94 seconds
2021-10-22 15:05:36.879183 (MainThread): On master: COMMIT
2021-10-22 15:05:36.880262 (MainThread): Using snowflake connection "master".
2021-10-22 15:05:36.880262 (MainThread): On master: COMMIT
2021-10-22 15:05:37.149177 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-10-22 15:05:37.149177 (MainThread): 17:05:37 | 
2021-10-22 15:05:37.150266 (MainThread): 17:05:37 | Running 3 on-run-end hooks
2021-10-22 15:05:37.151254 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-22 15:05:37.152180 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-22 15:05:37.153262 (MainThread): 17:05:37 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-22 15:05:37.154176 (MainThread): Using snowflake connection "master".
2021-10-22 15:05:37.154176 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-22 15:05:37.347497 (MainThread): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-22 15:05:37.348498 (MainThread): 17:05:37 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.19s]
2021-10-22 15:05:37.349499 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-22 15:05:37.351112 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-22 15:05:37.356213 (MainThread): 17:05:37 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-22 15:05:37.357122 (MainThread): Using snowflake connection "master".
2021-10-22 15:05:37.357122 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-22 15:05:37.571553 (MainThread): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-22 15:05:37.572553 (MainThread): 17:05:37 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.22s]
2021-10-22 15:05:37.573816 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-22 15:05:37.573816 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-22 15:05:37.576824 (MainThread): 17:05:37 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-22 15:05:37.577824 (MainThread): Using snowflake connection "master".
2021-10-22 15:05:37.577824 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-22 15:05:37.769751 (MainThread): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-22 15:05:37.770681 (MainThread): 17:05:37 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.19s]
2021-10-22 15:05:37.770859 (MainThread): 17:05:37 | 
2021-10-22 15:05:37.771362 (MainThread): On master: Close
2021-10-22 15:05:38.085381 (MainThread): 17:05:38 | 
2021-10-22 15:05:38.085381 (MainThread): 17:05:38 | Finished running 1 table model, 4 hooks in 8.35s.
2021-10-22 15:05:38.087383 (MainThread): Connection 'master' was properly closed.
2021-10-22 15:05:38.087383 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-22 15:05:38.087383 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-22 15:05:38.087383 (MainThread): Connection 'model.lukeclarke_learn_dbt.snowflake_customer_purchases' was properly closed.
2021-10-22 15:05:38.106774 (MainThread): 
2021-10-22 15:05:38.106774 (MainThread): Completed with 1 error and 0 warnings:
2021-10-22 15:05:38.107775 (MainThread): 
2021-10-22 15:05:38.107775 (MainThread): Compilation Error in model snowflake_customer_purchases (models\example\snowflake_customer_purchases.sql)
2021-10-22 15:05:38.108772 (MainThread):   'group_by' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-22 15:05:38.109771 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-22 15:05:38.109771 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC4C63B6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC4C63B2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC4C63B820>]}
2021-10-22 15:05:38.109771 (MainThread): Flushing usage events
2021-10-22 15:06:27.368645 (MainThread): Running with dbt=0.20.2
2021-10-22 15:06:28.200711 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['example.snowflake_customer_purchases'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-22 15:06:28.200711 (MainThread): Tracking: tracking
2021-10-22 15:06:28.200711 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE318DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE46D9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE46D9730>]}
2021-10-22 15:06:28.210711 (MainThread): Partial parsing not enabled
2021-10-22 15:06:28.231980 (MainThread): Parsing macros\group_by.sql
2021-10-22 15:06:28.231980 (MainThread): Parsing macros\adapters.sql
2021-10-22 15:06:28.258959 (MainThread): Parsing macros\catalog.sql
2021-10-22 15:06:28.259959 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-22 15:06:28.268958 (MainThread): Parsing macros\materializations\merge.sql
2021-10-22 15:06:28.270958 (MainThread): Parsing macros\materializations\table.sql
2021-10-22 15:06:28.274958 (MainThread): Parsing macros\materializations\view.sql
2021-10-22 15:06:28.275958 (MainThread): Parsing macros\core.sql
2021-10-22 15:06:28.279958 (MainThread): Parsing macros\adapters\common.sql
2021-10-22 15:06:28.326812 (MainThread): Parsing macros\etc\datetime.sql
2021-10-22 15:06:28.335013 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-22 15:06:28.336012 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-22 15:06:28.337012 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-22 15:06:28.339012 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-22 15:06:28.340012 (MainThread): Parsing macros\etc\query.sql
2021-10-22 15:06:28.341012 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-22 15:06:28.350186 (MainThread): Parsing macros\materializations\test.sql
2021-10-22 15:06:28.357186 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-22 15:06:28.369786 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-22 15:06:28.370786 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-22 15:06:28.377969 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-22 15:06:28.396969 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-22 15:06:28.425196 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-22 15:06:28.427196 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-22 15:06:28.443200 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-22 15:06:28.449200 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-22 15:06:28.453304 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-22 15:06:28.458346 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-22 15:06:28.460346 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-22 15:06:28.461346 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-22 15:06:28.462346 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-22 15:06:28.603227 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-22 15:06:28.611308 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-22 15:06:28.613300 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-22 15:06:28.616302 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:06:28.617314 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-22 15:06:28.620311 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 15:06:28.624226 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 15:06:28.629225 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-22 15:06:28.637225 (MainThread): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-22 15:06:28.652228 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-22 15:06:28.654849 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:06:28.655874 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-22 15:06:28.657874 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:06:28.695287 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-22 15:06:28.697289 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-22 15:06:28.700288 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-22 15:06:28.702894 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-22 15:06:28.727166 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:06:28.728166 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:06:28.741056 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:06:28.741056 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:06:28.743065 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:06:28.745067 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:06:28.746074 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:06:28.747070 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:06:28.756797 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:06:28.757797 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:06:28.767329 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:06:28.768330 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:06:28.796228 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf6980f9-b2e9-42c1-b167-8bf6103aeb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE323BCA0>]}
2021-10-22 15:06:28.816798 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-22 15:06:28.817784 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf6980f9-b2e9-42c1-b167-8bf6103aeb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE323BB50>]}
2021-10-22 15:06:28.817784 (MainThread): Found 7 models, 12 tests, 1 snapshot, 0 analyses, 151 macros, 4 operations, 0 seed files, 2 sources, 0 exposures
2021-10-22 15:06:28.819779 (MainThread): 
2021-10-22 15:06:28.819779 (MainThread): Acquiring new snowflake connection "master".
2021-10-22 15:06:28.821781 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-22 15:06:28.832921 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-22 15:06:28.832921 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-22 15:06:28.832921 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-22 15:06:30.197831 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.36 seconds
2021-10-22 15:06:30.200830 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-22 15:06:30.559637 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-22 15:06:30.564732 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-22 15:06:30.564732 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-22 15:06:30.564732 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-22 15:06:31.637843 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.07 seconds
2021-10-22 15:06:31.638843 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-22 15:06:31.951792 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_snapshots".
2021-10-22 15:06:31.952792 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_snapshots".
2021-10-22 15:06:31.952792 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */

    show terse objects in analytics.snapshots
2021-10-22 15:06:31.952792 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-22 15:06:32.935866 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-22 15:06:32.936866 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: Close
2021-10-22 15:06:33.245210 (MainThread): Using snowflake connection "master".
2021-10-22 15:06:33.245210 (MainThread): On master: BEGIN
2021-10-22 15:06:33.245210 (MainThread): Opening a new connection, currently in state init
2021-10-22 15:06:34.069766 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-22 15:06:34.070284 (MainThread): On master: COMMIT
2021-10-22 15:06:34.070284 (MainThread): Using snowflake connection "master".
2021-10-22 15:06:34.070284 (MainThread): On master: COMMIT
2021-10-22 15:06:34.319055 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-22 15:06:34.319055 (MainThread): 17:06:34 | 
2021-10-22 15:06:34.319055 (MainThread): 17:06:34 | Running 1 on-run-start hook
2021-10-22 15:06:34.320066 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-22 15:06:34.320971 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-22 15:06:34.322965 (MainThread): 17:06:34 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-22 15:06:34.324011 (MainThread): Using snowflake connection "master".
2021-10-22 15:06:34.324011 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-22 15:06:34.507791 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-22 15:06:34.508779 (MainThread): 17:06:34 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.18s]
2021-10-22 15:06:34.508779 (MainThread): 17:06:34 | 
2021-10-22 15:06:34.509778 (MainThread): On master: Close
2021-10-22 15:06:34.816167 (MainThread): 17:06:34 | Concurrency: 1 threads (target='dev')
2021-10-22 15:06:34.816167 (MainThread): 17:06:34 | 
2021-10-22 15:06:34.822168 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-22 15:06:34.822168 (Thread-1): 17:06:34 | 1 of 1 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-22 15:06:34.823167 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 15:06:34.823167 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-22 15:06:34.827292 (Thread-1): finished collecting timing info
2021-10-22 15:06:34.828304 (Thread-1): Compilation Error in model snowflake_customer_purchases (models\example\snowflake_customer_purchases.sql)
  'group_by' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 517, in catch_jinja
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 12, in top-level template code
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'group_by' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 464, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\compilation.py", line 371, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 549, in render_template
    return template.render(ctx)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 522, in catch_jinja
    raise UndefinedMacroException(str(e), node) from e
dbt.exceptions.UndefinedMacroException: Compilation Error in model snowflake_customer_purchases (models\example\snowflake_customer_purchases.sql)
  'group_by' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-22 15:06:34.829304 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6980f9-b2e9-42c1-b167-8bf6103aeb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE4BA5430>]}
2021-10-22 15:06:34.830304 (Thread-1): 17:06:34 | 1 of 1 ERROR creating table model dbt.snowflake_customer_purchases... [ERROR in 0.01s]
2021-10-22 15:06:34.831306 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-22 15:06:34.832303 (MainThread): Acquiring new snowflake connection "master".
2021-10-22 15:06:34.832303 (MainThread): Using snowflake connection "master".
2021-10-22 15:06:34.832303 (MainThread): On master: BEGIN
2021-10-22 15:06:34.832303 (MainThread): Opening a new connection, currently in state closed
2021-10-22 15:06:35.694106 (MainThread): SQL status: SUCCESS 1 in 0.86 seconds
2021-10-22 15:06:35.694106 (MainThread): On master: COMMIT
2021-10-22 15:06:35.694106 (MainThread): Using snowflake connection "master".
2021-10-22 15:06:35.694106 (MainThread): On master: COMMIT
2021-10-22 15:06:36.083400 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2021-10-22 15:06:36.083400 (MainThread): 17:06:36 | 
2021-10-22 15:06:36.083400 (MainThread): 17:06:36 | Running 3 on-run-end hooks
2021-10-22 15:06:36.085403 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-22 15:06:36.087128 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-22 15:06:36.088554 (MainThread): 17:06:36 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-22 15:06:36.089285 (MainThread): Using snowflake connection "master".
2021-10-22 15:06:36.089285 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-22 15:06:36.260772 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-22 15:06:36.261771 (MainThread): 17:06:36 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.17s]
2021-10-22 15:06:36.263771 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-22 15:06:36.264854 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-22 15:06:36.266859 (MainThread): 17:06:36 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-22 15:06:36.267859 (MainThread): Using snowflake connection "master".
2021-10-22 15:06:36.267859 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-22 15:06:36.466533 (MainThread): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-22 15:06:36.467622 (MainThread): 17:06:36 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.20s]
2021-10-22 15:06:36.468621 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-22 15:06:36.469621 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-22 15:06:36.471995 (MainThread): 17:06:36 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-22 15:06:36.471995 (MainThread): Using snowflake connection "master".
2021-10-22 15:06:36.471995 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-22 15:06:36.660971 (MainThread): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-22 15:06:36.661660 (MainThread): 17:06:36 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.19s]
2021-10-22 15:06:36.662082 (MainThread): 17:06:36 | 
2021-10-22 15:06:36.662584 (MainThread): On master: Close
2021-10-22 15:06:36.967431 (MainThread): 17:06:36 | 
2021-10-22 15:06:36.967431 (MainThread): 17:06:36 | Finished running 1 table model, 4 hooks in 8.15s.
2021-10-22 15:06:36.968431 (MainThread): Connection 'master' was properly closed.
2021-10-22 15:06:36.968431 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-22 15:06:36.968431 (MainThread): Connection 'list_analytics_snapshots' was properly closed.
2021-10-22 15:06:36.968431 (MainThread): Connection 'model.lukeclarke_learn_dbt.snowflake_customer_purchases' was properly closed.
2021-10-22 15:06:36.982431 (MainThread): 
2021-10-22 15:06:36.982431 (MainThread): Completed with 1 error and 0 warnings:
2021-10-22 15:06:36.983431 (MainThread): 
2021-10-22 15:06:36.984432 (MainThread): Compilation Error in model snowflake_customer_purchases (models\example\snowflake_customer_purchases.sql)
2021-10-22 15:06:36.985431 (MainThread):   'group_by' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-22 15:06:36.985431 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-22 15:06:36.986431 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE4B7FE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE4B7F3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DE4B7F760>]}
2021-10-22 15:06:36.986431 (MainThread): Flushing usage events
2021-10-22 15:07:03.724959 (MainThread): Running with dbt=0.20.2
2021-10-22 15:07:04.379105 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['example.snowflake_customer_purchases'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-22 15:07:04.380012 (MainThread): Tracking: tracking
2021-10-22 15:07:04.380012 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF3B39DC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF3C8D9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF3C8D9760>]}
2021-10-22 15:07:04.388091 (MainThread): Partial parsing not enabled
2021-10-22 15:07:04.409806 (MainThread): Parsing macros\group_by.sql
2021-10-22 15:07:04.409806 (MainThread): Parsing macros\adapters.sql
2021-10-22 15:07:04.433804 (MainThread): Parsing macros\catalog.sql
2021-10-22 15:07:04.434805 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-22 15:07:04.443888 (MainThread): Parsing macros\materializations\merge.sql
2021-10-22 15:07:04.445805 (MainThread): Parsing macros\materializations\table.sql
2021-10-22 15:07:04.448893 (MainThread): Parsing macros\materializations\view.sql
2021-10-22 15:07:04.449895 (MainThread): Parsing macros\core.sql
2021-10-22 15:07:04.453012 (MainThread): Parsing macros\adapters\common.sql
2021-10-22 15:07:04.495611 (MainThread): Parsing macros\etc\datetime.sql
2021-10-22 15:07:04.504011 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-22 15:07:04.505122 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-22 15:07:04.506657 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-22 15:07:04.508715 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-22 15:07:04.510768 (MainThread): Parsing macros\etc\query.sql
2021-10-22 15:07:04.511792 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-22 15:07:04.523518 (MainThread): Parsing macros\materializations\test.sql
2021-10-22 15:07:04.529756 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-22 15:07:04.542767 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-22 15:07:04.543767 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-22 15:07:04.549942 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-22 15:07:04.567961 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-22 15:07:04.592716 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-22 15:07:04.593717 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-22 15:07:04.607466 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-22 15:07:04.613544 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-22 15:07:04.618547 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-22 15:07:04.625545 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-22 15:07:04.627544 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-22 15:07:04.628542 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-22 15:07:04.629544 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-22 15:07:04.760001 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-22 15:07:04.766640 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-22 15:07:04.768640 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-22 15:07:04.771645 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:07:04.771645 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-22 15:07:04.774552 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 15:07:04.779403 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 15:07:04.784360 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-22 15:07:04.791409 (MainThread): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-22 15:07:04.805136 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-22 15:07:04.807137 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:07:04.807137 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-22 15:07:04.809424 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:07:04.844422 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-22 15:07:04.846412 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-22 15:07:04.847416 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-22 15:07:04.849418 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-22 15:07:04.871726 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:07:04.873735 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:07:04.880723 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:07:04.880723 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:07:04.881722 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:07:04.883725 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:07:04.884730 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:07:04.887038 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:07:04.895048 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:07:04.895048 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:07:04.905582 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:07:04.907582 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:07:04.925210 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf73da0b-8aa3-45a2-a615-71c24c811e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF3B38C340>]}
2021-10-22 15:07:04.940209 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-22 15:07:04.940209 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf73da0b-8aa3-45a2-a615-71c24c811e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF3C921490>]}
2021-10-22 15:07:04.940209 (MainThread): Found 7 models, 12 tests, 1 snapshot, 0 analyses, 152 macros, 4 operations, 0 seed files, 2 sources, 0 exposures
2021-10-22 15:07:04.942374 (MainThread): 
2021-10-22 15:07:04.942374 (MainThread): Acquiring new snowflake connection "master".
2021-10-22 15:07:04.944371 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-22 15:07:04.954409 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-22 15:07:04.954409 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-22 15:07:04.954409 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-22 15:07:06.874293 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.92 seconds
2021-10-22 15:07:06.876316 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-22 15:07:07.184910 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-22 15:07:07.189910 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-22 15:07:07.189910 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-22 15:07:07.190911 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-22 15:07:08.063533 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.87 seconds
2021-10-22 15:07:08.064491 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-22 15:07:08.379246 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_snapshots".
2021-10-22 15:07:08.380247 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_snapshots".
2021-10-22 15:07:08.380247 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */

    show terse objects in analytics.snapshots
2021-10-22 15:07:08.380247 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-22 15:07:09.200210 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-22 15:07:09.200210 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: Close
2021-10-22 15:07:09.515525 (MainThread): Using snowflake connection "master".
2021-10-22 15:07:09.516525 (MainThread): On master: BEGIN
2021-10-22 15:07:09.516525 (MainThread): Opening a new connection, currently in state init
2021-10-22 15:07:10.692046 (MainThread): SQL status: SUCCESS 1 in 1.18 seconds
2021-10-22 15:07:10.692046 (MainThread): On master: COMMIT
2021-10-22 15:07:10.692046 (MainThread): Using snowflake connection "master".
2021-10-22 15:07:10.693046 (MainThread): On master: COMMIT
2021-10-22 15:07:10.933226 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-22 15:07:10.933226 (MainThread): 17:07:10 | 
2021-10-22 15:07:10.933226 (MainThread): 17:07:10 | Running 1 on-run-start hook
2021-10-22 15:07:10.936223 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-22 15:07:10.937367 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-22 15:07:10.939460 (MainThread): 17:07:10 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-22 15:07:10.940460 (MainThread): Using snowflake connection "master".
2021-10-22 15:07:10.940460 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-22 15:07:11.130863 (MainThread): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-22 15:07:11.131832 (MainThread): 17:07:11 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.19s]
2021-10-22 15:07:11.132831 (MainThread): 17:07:11 | 
2021-10-22 15:07:11.132831 (MainThread): On master: Close
2021-10-22 15:07:11.500944 (MainThread): 17:07:11 | Concurrency: 1 threads (target='dev')
2021-10-22 15:07:11.501943 (MainThread): 17:07:11 | 
2021-10-22 15:07:11.505979 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-22 15:07:11.505979 (Thread-1): 17:07:11 | 1 of 1 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-22 15:07:11.505979 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 15:07:11.506940 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-22 15:07:11.508940 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-22 15:07:11.510603 (Thread-1): finished collecting timing info
2021-10-22 15:07:11.532591 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-22 15:07:11.534847 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 15:07:11.534847 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-22 15:07:11.534847 (Thread-1): Opening a new connection, currently in state init
2021-10-22 15:07:12.370932 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-22 15:07:12.371086 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 15:07:12.371151 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM snowflake_sample_data.tpch_sf1.customer c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey

   -- starts macro namesmacro and parameter
  GROUP BY                -- SQL code to be inserted everytime macro called
      -- If n = 1 group by columns 1 - 5, not inclusive at end, thus, n+1
      1
       ,   -- Inserts a comma after each loop except the last one, endif
      -- If n = 1 group by columns 1 - 5, not inclusive at end, thus, n+1
      2
       ,   -- Inserts a comma after each loop except the last one, endif
      -- If n = 1 group by columns 1 - 5, not inclusive at end, thus, n+1
      3
        -- Inserts a comma after each loop except the last one, endif
                                -- end for loop

      );
2021-10-22 15:07:14.729203 (Thread-1): SQL status: SUCCESS 1 in 2.36 seconds
2021-10-22 15:07:14.729203 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-22 15:07:14.729203 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 15:07:14.730405 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-22 15:07:14.896936 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-22 15:07:14.904136 (Thread-1): finished collecting timing info
2021-10-22 15:07:14.904136 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-22 15:07:18.520057 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf73da0b-8aa3-45a2-a615-71c24c811e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF3CDC46D0>]}
2021-10-22 15:07:18.520057 (Thread-1): 17:07:18 | 1 of 1 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 7.01s]
2021-10-22 15:07:18.521057 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-22 15:07:18.522556 (MainThread): Acquiring new snowflake connection "master".
2021-10-22 15:07:18.522556 (MainThread): Using snowflake connection "master".
2021-10-22 15:07:18.522556 (MainThread): On master: BEGIN
2021-10-22 15:07:18.522556 (MainThread): Opening a new connection, currently in state closed
2021-10-22 15:07:19.354047 (MainThread): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-22 15:07:19.354047 (MainThread): On master: COMMIT
2021-10-22 15:07:19.354047 (MainThread): Using snowflake connection "master".
2021-10-22 15:07:19.354047 (MainThread): On master: COMMIT
2021-10-22 15:07:19.614192 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-10-22 15:07:19.614192 (MainThread): 17:07:19 | 
2021-10-22 15:07:19.614192 (MainThread): 17:07:19 | Running 3 on-run-end hooks
2021-10-22 15:07:19.614192 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-22 15:07:19.615310 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-22 15:07:19.617313 (MainThread): 17:07:19 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-22 15:07:19.617313 (MainThread): Using snowflake connection "master".
2021-10-22 15:07:19.617313 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-22 15:07:19.787278 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-22 15:07:19.788279 (MainThread): 17:07:19 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.17s]
2021-10-22 15:07:19.789280 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-22 15:07:19.790283 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-22 15:07:19.792288 (MainThread): 17:07:19 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-22 15:07:19.792917 (MainThread): Using snowflake connection "master".
2021-10-22 15:07:19.792917 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-22 15:07:19.993958 (MainThread): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-22 15:07:19.994958 (MainThread): 17:07:19 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.20s]
2021-10-22 15:07:19.995955 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-22 15:07:19.995955 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-22 15:07:19.997958 (MainThread): 17:07:19 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-22 15:07:19.998957 (MainThread): Using snowflake connection "master".
2021-10-22 15:07:19.998957 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-22 15:07:20.187146 (MainThread): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-22 15:07:20.188211 (MainThread): 17:07:20 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.19s]
2021-10-22 15:07:20.189211 (MainThread): 17:07:20 | 
2021-10-22 15:07:20.189211 (MainThread): On master: Close
2021-10-22 15:07:20.487766 (MainThread): 17:07:20 | 
2021-10-22 15:07:20.488789 (MainThread): 17:07:20 | Finished running 1 table model, 4 hooks in 15.55s.
2021-10-22 15:07:20.489759 (MainThread): Connection 'master' was properly closed.
2021-10-22 15:07:20.489759 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-22 15:07:20.489759 (MainThread): Connection 'list_analytics_snapshots' was properly closed.
2021-10-22 15:07:20.489759 (MainThread): Connection 'model.lukeclarke_learn_dbt.snowflake_customer_purchases' was properly closed.
2021-10-22 15:07:20.502996 (MainThread): 
2021-10-22 15:07:20.503994 (MainThread): Completed successfully
2021-10-22 15:07:20.503994 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-22 15:07:20.505011 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF3CA56A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF3CDACFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF3CDAC940>]}
2021-10-22 15:07:20.505011 (MainThread): Flushing usage events
2021-10-22 15:17:53.103013 (MainThread): Running with dbt=0.20.2
2021-10-22 15:17:54.020338 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['example.playing_with_tests'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-22 15:17:54.020338 (MainThread): Tracking: tracking
2021-10-22 15:17:54.021337 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B2DCDD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B43193A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B4319760>]}
2021-10-22 15:17:54.032156 (MainThread): Partial parsing not enabled
2021-10-22 15:17:54.064928 (MainThread): Parsing macros\group_by.sql
2021-10-22 15:17:54.067680 (MainThread): Parsing macros\renaming_segments.sql
2021-10-22 15:17:54.068321 (MainThread): Parsing macros\adapters.sql
2021-10-22 15:17:54.106273 (MainThread): Parsing macros\catalog.sql
2021-10-22 15:17:54.109524 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-22 15:17:54.119268 (MainThread): Parsing macros\materializations\merge.sql
2021-10-22 15:17:54.121340 (MainThread): Parsing macros\materializations\table.sql
2021-10-22 15:17:54.125903 (MainThread): Parsing macros\materializations\view.sql
2021-10-22 15:17:54.127917 (MainThread): Parsing macros\core.sql
2021-10-22 15:17:54.132860 (MainThread): Parsing macros\adapters\common.sql
2021-10-22 15:17:54.198054 (MainThread): Parsing macros\etc\datetime.sql
2021-10-22 15:17:54.210374 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-22 15:17:54.211371 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-22 15:17:54.213369 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-22 15:17:54.215369 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-22 15:17:54.216368 (MainThread): Parsing macros\etc\query.sql
2021-10-22 15:17:54.217556 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-22 15:17:54.228584 (MainThread): Parsing macros\materializations\test.sql
2021-10-22 15:17:54.235581 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-22 15:17:54.252810 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-22 15:17:54.254875 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-22 15:17:54.264498 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-22 15:17:54.287725 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-22 15:17:54.316176 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-22 15:17:54.317178 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-22 15:17:54.332176 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-22 15:17:54.338176 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-22 15:17:54.344508 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-22 15:17:54.351508 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-22 15:17:54.354508 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-22 15:17:54.356128 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-22 15:17:54.357469 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-22 15:17:54.549769 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-22 15:17:54.558965 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-22 15:17:54.562076 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-22 15:17:54.565997 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:17:54.566997 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-22 15:17:54.570997 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 15:17:54.576604 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 15:17:54.586601 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-22 15:17:54.601331 (MainThread): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-22 15:17:54.619400 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-22 15:17:54.622400 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:17:54.624400 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-22 15:17:54.626400 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:17:54.671303 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-22 15:17:54.674304 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-22 15:17:54.677304 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-22 15:17:54.680304 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-22 15:17:54.708580 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:17:54.711582 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:17:54.721474 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:17:54.721474 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:17:54.723473 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:17:54.725473 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:17:54.727474 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:17:54.729473 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:17:54.740281 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:17:54.740281 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:17:54.755275 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:17:54.757275 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:17:54.783746 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c97fe85-b6c7-44a9-9ed7-853acfb9ad41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B44B60D0>]}
2021-10-22 15:17:54.805523 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-22 15:17:54.806148 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c97fe85-b6c7-44a9-9ed7-853acfb9ad41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B4340460>]}
2021-10-22 15:17:54.806148 (MainThread): Found 7 models, 12 tests, 1 snapshot, 0 analyses, 153 macros, 4 operations, 0 seed files, 2 sources, 0 exposures
2021-10-22 15:17:54.807268 (MainThread): The selection criterion 'example.playing_with_tests' does not match any nodes
2021-10-22 15:17:54.809378 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-10-22 15:17:54.830471 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B2DCD0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B4319220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B4300490>]}
2021-10-22 15:17:54.830974 (MainThread): Flushing usage events
2021-10-22 15:17:55.596346 (MainThread): Connection 'operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2' was properly closed.
2021-10-22 15:18:40.576047 (MainThread): Running with dbt=0.20.2
2021-10-22 15:18:41.415698 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['new.playing_with_tests'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-22 15:18:41.416698 (MainThread): Tracking: tracking
2021-10-22 15:18:41.416698 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002804111CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028042669460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028042669760>]}
2021-10-22 15:18:41.427891 (MainThread): Partial parsing not enabled
2021-10-22 15:18:41.452874 (MainThread): Parsing macros\group_by.sql
2021-10-22 15:18:41.454894 (MainThread): Parsing macros\renaming_segments.sql
2021-10-22 15:18:41.454894 (MainThread): Parsing macros\adapters.sql
2021-10-22 15:18:41.482726 (MainThread): Parsing macros\catalog.sql
2021-10-22 15:18:41.484731 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-22 15:18:41.493724 (MainThread): Parsing macros\materializations\merge.sql
2021-10-22 15:18:41.496539 (MainThread): Parsing macros\materializations\table.sql
2021-10-22 15:18:41.500570 (MainThread): Parsing macros\materializations\view.sql
2021-10-22 15:18:41.501659 (MainThread): Parsing macros\core.sql
2021-10-22 15:18:41.504646 (MainThread): Parsing macros\adapters\common.sql
2021-10-22 15:18:41.550667 (MainThread): Parsing macros\etc\datetime.sql
2021-10-22 15:18:41.559667 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-22 15:18:41.559858 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-22 15:18:41.561943 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-22 15:18:41.563943 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-22 15:18:41.564943 (MainThread): Parsing macros\etc\query.sql
2021-10-22 15:18:41.565943 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-22 15:18:41.575943 (MainThread): Parsing macros\materializations\test.sql
2021-10-22 15:18:41.582943 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-22 15:18:41.596240 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-22 15:18:41.598240 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-22 15:18:41.605639 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-22 15:18:41.625712 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-22 15:18:41.660887 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-22 15:18:41.661888 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-22 15:18:41.679216 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-22 15:18:41.685116 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-22 15:18:41.690116 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-22 15:18:41.696115 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-22 15:18:41.698218 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-22 15:18:41.699297 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-22 15:18:41.700297 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-22 15:18:41.867766 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-22 15:18:41.877640 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-22 15:18:41.880641 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-22 15:18:41.883646 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:18:41.884742 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-22 15:18:41.887790 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 15:18:41.892790 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 15:18:41.899945 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-22 15:18:41.913070 (MainThread): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-22 15:18:41.928692 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-22 15:18:41.931405 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:18:41.932492 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-22 15:18:41.934578 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:18:41.980195 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-22 15:18:41.983120 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-22 15:18:41.985766 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-22 15:18:41.988425 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-22 15:18:42.014483 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:18:42.016483 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:18:42.025574 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:18:42.025574 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:18:42.028562 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:18:42.030583 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:18:42.032563 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:18:42.034562 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:18:42.045749 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:18:42.045749 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:18:42.059947 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:18:42.062966 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:18:42.086258 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78ca4845-91a8-4e06-803b-442c76961d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280427DD0D0>]}
2021-10-22 15:18:42.109855 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-22 15:18:42.109855 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78ca4845-91a8-4e06-803b-442c76961d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028042690790>]}
2021-10-22 15:18:42.110855 (MainThread): Found 7 models, 12 tests, 1 snapshot, 0 analyses, 153 macros, 4 operations, 0 seed files, 2 sources, 0 exposures
2021-10-22 15:18:42.110855 (MainThread): The selection criterion 'new.playing_with_tests' does not match any nodes
2021-10-22 15:18:42.115015 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-10-22 15:18:42.135483 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002804272E580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028042741D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280426690A0>]}
2021-10-22 15:18:42.135483 (MainThread): Flushing usage events
2021-10-22 15:18:42.659908 (MainThread): Connection 'operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2' was properly closed.
2021-10-22 15:19:12.747281 (MainThread): Running with dbt=0.20.2
2021-10-22 15:19:13.539736 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['example.playing_with_tests'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-22 15:19:13.540725 (MainThread): Tracking: tracking
2021-10-22 15:19:13.540725 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBC63DDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBDB89AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBDB89730>]}
2021-10-22 15:19:13.550293 (MainThread): Partial parsing not enabled
2021-10-22 15:19:13.570477 (MainThread): Parsing macros\group_by.sql
2021-10-22 15:19:13.571476 (MainThread): Parsing macros\renaming_segments.sql
2021-10-22 15:19:13.571476 (MainThread): Parsing macros\adapters.sql
2021-10-22 15:19:13.601356 (MainThread): Parsing macros\catalog.sql
2021-10-22 15:19:13.603356 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-22 15:19:13.614600 (MainThread): Parsing macros\materializations\merge.sql
2021-10-22 15:19:13.615589 (MainThread): Parsing macros\materializations\table.sql
2021-10-22 15:19:13.619594 (MainThread): Parsing macros\materializations\view.sql
2021-10-22 15:19:13.621189 (MainThread): Parsing macros\core.sql
2021-10-22 15:19:13.624593 (MainThread): Parsing macros\adapters\common.sql
2021-10-22 15:19:13.667483 (MainThread): Parsing macros\etc\datetime.sql
2021-10-22 15:19:13.674394 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-22 15:19:13.675395 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-22 15:19:13.676394 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-22 15:19:13.677394 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-22 15:19:13.679394 (MainThread): Parsing macros\etc\query.sql
2021-10-22 15:19:13.679394 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-22 15:19:13.687737 (MainThread): Parsing macros\materializations\test.sql
2021-10-22 15:19:13.692740 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-22 15:19:13.704915 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-22 15:19:13.705917 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-22 15:19:13.712915 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-22 15:19:13.729468 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-22 15:19:13.757974 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-22 15:19:13.758976 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-22 15:19:13.778229 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-22 15:19:13.785070 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-22 15:19:13.789589 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-22 15:19:13.795821 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-22 15:19:13.798023 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-22 15:19:13.799053 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-22 15:19:13.800702 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-22 15:19:13.972921 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-22 15:19:13.981162 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-22 15:19:13.984163 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:19:13.985162 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-22 15:19:13.988162 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-22 15:19:13.993162 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-22 15:19:13.999162 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-22 15:19:14.006228 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-22 15:19:14.018293 (MainThread): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-22 15:19:14.035464 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-22 15:19:14.037957 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:19:14.038947 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-22 15:19:14.041944 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:19:14.082427 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-22 15:19:14.084658 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-22 15:19:14.086580 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-22 15:19:14.088580 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-22 15:19:14.112684 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:19:14.117032 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:19:14.126022 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:19:14.126022 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:19:14.128024 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:19:14.129481 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:19:14.131723 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:19:14.133743 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:19:14.143717 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:19:14.143717 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:19:14.156710 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:19:14.158711 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-22 15:19:14.183327 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac5fb3ef-d839-4a09-979e-8315d8b2c7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBDD290D0>]}
2021-10-22 15:19:14.200328 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-22 15:19:14.201237 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac5fb3ef-d839-4a09-979e-8315d8b2c7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBDD07700>]}
2021-10-22 15:19:14.201237 (MainThread): Found 7 models, 12 tests, 1 snapshot, 0 analyses, 153 macros, 4 operations, 0 seed files, 2 sources, 0 exposures
2021-10-22 15:19:14.202269 (MainThread): 
2021-10-22 15:19:14.203234 (MainThread): Acquiring new snowflake connection "master".
2021-10-22 15:19:14.205236 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-22 15:19:14.216617 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-22 15:19:14.217641 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-22 15:19:14.217641 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-22 15:19:16.050038 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.83 seconds
2021-10-22 15:19:16.054148 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-22 15:19:16.417682 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-22 15:19:16.423400 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-22 15:19:16.423810 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-22 15:19:16.423810 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-22 15:19:17.247954 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.82 seconds
2021-10-22 15:19:17.248954 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-22 15:19:17.548141 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_snapshots".
2021-10-22 15:19:17.550432 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_snapshots".
2021-10-22 15:19:17.550432 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */

    show terse objects in analytics.snapshots
2021-10-22 15:19:17.550432 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-22 15:19:18.609192 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 1.06 seconds
2021-10-22 15:19:18.610192 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: Close
2021-10-22 15:19:18.916514 (MainThread): Using snowflake connection "master".
2021-10-22 15:19:18.916514 (MainThread): On master: BEGIN
2021-10-22 15:19:18.916514 (MainThread): Opening a new connection, currently in state init
2021-10-22 15:19:19.751427 (MainThread): SQL status: SUCCESS 1 in 0.83 seconds
2021-10-22 15:19:19.751427 (MainThread): On master: COMMIT
2021-10-22 15:19:19.751427 (MainThread): Using snowflake connection "master".
2021-10-22 15:19:19.751427 (MainThread): On master: COMMIT
2021-10-22 15:19:20.031864 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-22 15:19:20.031864 (MainThread): 17:19:20 | 
2021-10-22 15:19:20.031864 (MainThread): 17:19:20 | Running 1 on-run-start hook
2021-10-22 15:19:20.032866 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-22 15:19:20.033864 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-22 15:19:20.036885 (MainThread): 17:19:20 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-22 15:19:20.036885 (MainThread): Using snowflake connection "master".
2021-10-22 15:19:20.036885 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-22 15:19:20.280702 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-22 15:19:20.280702 (MainThread): 17:19:20 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.24s]
2021-10-22 15:19:20.282679 (MainThread): 17:19:20 | 
2021-10-22 15:19:20.282679 (MainThread): On master: Close
2021-10-22 15:19:20.602677 (MainThread): 17:19:20 | Concurrency: 1 threads (target='dev')
2021-10-22 15:19:20.603675 (MainThread): 17:19:20 | 
2021-10-22 15:19:20.606678 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-22 15:19:20.606678 (Thread-1): 17:19:20 | 1 of 1 START table model dbt.playing_with_tests...................... [RUN]
2021-10-22 15:19:20.607674 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-22 15:19:20.607674 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-22 15:19:20.609674 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-22 15:19:20.610674 (Thread-1): finished collecting timing info
2021-10-22 15:19:20.629206 (Thread-1): Dropping relation "ANALYTICS"."DBT"."PLAYING_WITH_TESTS" because it is of type view
2021-10-22 15:19:20.637944 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-22 15:19:20.637944 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */
drop view if exists "ANALYTICS"."DBT"."PLAYING_WITH_TESTS" cascade
2021-10-22 15:19:20.637944 (Thread-1): Opening a new connection, currently in state init
2021-10-22 15:19:21.486622 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-10-22 15:19:21.495605 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-22 15:19:21.496618 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-22 15:19:21.496618 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-22 15:19:21.722555 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-22 15:19:21.723556 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-22 15:19:21.723556 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */


      create or replace transient table analytics.dbt.playing_with_tests  as
      (SELECT
  c_custkey,
  c_mktsegment,
     -- starts macro namesmacro and parameter

  CASE                 -- SQL code to be inserted everytime macro called
    WHEN c_mktsegment IN ('BUILDING', 'HOUSEHOLD', 'FURNITURE')
      THEN 'segment_1'
    ELSE 'segment_2'
  END
 mkt_segment_adjusted
FROM snowflake_sample_data.tpch_sf1.customer
      );
2021-10-22 15:19:23.454273 (Thread-1): SQL status: SUCCESS 1 in 1.73 seconds
2021-10-22 15:19:23.454273 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-22 15:19:23.455264 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-22 15:19:23.455264 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-22 15:19:23.665702 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-22 15:19:23.672837 (Thread-1): finished collecting timing info
2021-10-22 15:19:23.672837 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-22 15:19:24.009968 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac5fb3ef-d839-4a09-979e-8315d8b2c7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBE04B250>]}
2021-10-22 15:19:24.009968 (Thread-1): 17:19:24 | 1 of 1 OK created table model dbt.playing_with_tests................. [SUCCESS 1 in 3.40s]
2021-10-22 15:19:24.010965 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-22 15:19:24.011971 (MainThread): Acquiring new snowflake connection "master".
2021-10-22 15:19:24.012965 (MainThread): Using snowflake connection "master".
2021-10-22 15:19:24.012965 (MainThread): On master: BEGIN
2021-10-22 15:19:24.012965 (MainThread): Opening a new connection, currently in state closed
2021-10-22 15:19:24.820522 (MainThread): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-22 15:19:24.820522 (MainThread): On master: COMMIT
2021-10-22 15:19:24.820522 (MainThread): Using snowflake connection "master".
2021-10-22 15:19:24.821604 (MainThread): On master: COMMIT
2021-10-22 15:19:25.059222 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-22 15:19:25.059222 (MainThread): 17:19:25 | 
2021-10-22 15:19:25.060224 (MainThread): 17:19:25 | Running 3 on-run-end hooks
2021-10-22 15:19:25.062224 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-22 15:19:25.062224 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-22 15:19:25.064224 (MainThread): 17:19:25 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-22 15:19:25.065227 (MainThread): Using snowflake connection "master".
2021-10-22 15:19:25.065227 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-22 15:19:25.260251 (MainThread): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-22 15:19:25.261251 (MainThread): 17:19:25 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.20s]
2021-10-22 15:19:25.261251 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-22 15:19:25.262251 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-22 15:19:25.264251 (MainThread): 17:19:25 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-22 15:19:25.264251 (MainThread): Using snowflake connection "master".
2021-10-22 15:19:25.264251 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-22 15:19:25.476179 (MainThread): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-22 15:19:25.476179 (MainThread): 17:19:25 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.21s]
2021-10-22 15:19:25.477177 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-22 15:19:25.478179 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-22 15:19:25.483176 (MainThread): 17:19:25 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-22 15:19:25.484179 (MainThread): Using snowflake connection "master".
2021-10-22 15:19:25.484179 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-22 15:19:25.655041 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-22 15:19:25.656123 (MainThread): 17:19:25 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.17s]
2021-10-22 15:19:25.657036 (MainThread): 17:19:25 | 
2021-10-22 15:19:25.657036 (MainThread): On master: Close
2021-10-22 15:19:25.960759 (MainThread): 17:19:25 | 
2021-10-22 15:19:25.960759 (MainThread): 17:19:25 | Finished running 1 table model, 4 hooks in 11.76s.
2021-10-22 15:19:25.961758 (MainThread): Connection 'master' was properly closed.
2021-10-22 15:19:25.961758 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-22 15:19:25.961758 (MainThread): Connection 'list_analytics_snapshots' was properly closed.
2021-10-22 15:19:25.961758 (MainThread): Connection 'model.lukeclarke_learn_dbt.playing_with_tests' was properly closed.
2021-10-22 15:19:25.974838 (MainThread): 
2021-10-22 15:19:25.975757 (MainThread): Completed successfully
2021-10-22 15:19:25.975757 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-22 15:19:25.976758 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBDED0FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBDEF29D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBE04B310>]}
2021-10-22 15:19:25.976758 (MainThread): Flushing usage events
2021-10-25 07:56:18.800905 (MainThread): Running with dbt=0.20.2
2021-10-25 07:56:20.364488 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-25 07:56:20.367092 (MainThread): Tracking: tracking
2021-10-25 07:56:20.368096 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD977ECE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD98D2B5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD98D2BFD0>]}
2021-10-25 07:56:20.381278 (MainThread): Partial parsing not enabled
2021-10-25 07:56:20.585732 (MainThread): Parsing macros\group_by.sql
2021-10-25 07:56:20.587731 (MainThread): Parsing macros\renaming_segments.sql
2021-10-25 07:56:20.587731 (MainThread): Parsing macros\suspend_warehouse.sql
2021-10-25 07:56:20.589731 (MainThread): Parsing macros\adapters.sql
2021-10-25 07:56:20.617730 (MainThread): Parsing macros\catalog.sql
2021-10-25 07:56:20.619730 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-25 07:56:20.628730 (MainThread): Parsing macros\materializations\merge.sql
2021-10-25 07:56:20.630730 (MainThread): Parsing macros\materializations\table.sql
2021-10-25 07:56:20.633730 (MainThread): Parsing macros\materializations\view.sql
2021-10-25 07:56:20.635730 (MainThread): Parsing macros\core.sql
2021-10-25 07:56:20.638730 (MainThread): Parsing macros\adapters\common.sql
2021-10-25 07:56:20.693046 (MainThread): Parsing macros\etc\datetime.sql
2021-10-25 07:56:20.710267 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-25 07:56:20.710766 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-25 07:56:20.712778 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-25 07:56:20.714777 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-25 07:56:20.716777 (MainThread): Parsing macros\etc\query.sql
2021-10-25 07:56:20.716777 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-25 07:56:20.724778 (MainThread): Parsing macros\materializations\test.sql
2021-10-25 07:56:20.731776 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-25 07:56:20.745776 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-25 07:56:20.747776 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-25 07:56:20.755776 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-25 07:56:20.775794 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-25 07:56:20.800825 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-25 07:56:20.802826 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-25 07:56:20.817395 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-25 07:56:20.822000 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-25 07:56:20.825025 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-25 07:56:20.831021 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-25 07:56:20.833023 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-25 07:56:20.834027 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-25 07:56:20.835023 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-25 07:56:20.992295 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 07:56:21.001296 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 07:56:21.004296 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:56:21.005296 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 07:56:21.008296 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 07:56:21.012296 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 07:56:21.018296 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 07:56:21.025876 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 07:56:21.038521 (MainThread): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-25 07:56:21.055521 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-25 07:56:21.058522 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:56:21.059522 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-25 07:56:21.061523 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:56:21.120791 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-25 07:56:21.128479 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-25 07:56:21.131590 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-25 07:56:21.133646 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-25 07:56:21.161754 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:56:21.163751 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:56:21.173671 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:56:21.174746 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:56:21.176748 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:56:21.177763 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:56:21.180745 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:56:21.183745 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:56:21.194850 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:56:21.195431 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:56:21.208489 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:56:21.211653 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:56:21.234299 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76e0a4b6-f903-47b9-b4cb-ca0ca0851688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD98EDA0D0>]}
2021-10-25 07:56:21.255007 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-25 07:56:21.255966 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76e0a4b6-f903-47b9-b4cb-ca0ca0851688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD98EDA490>]}
2021-10-25 07:56:21.255966 (MainThread): Found 7 models, 12 tests, 1 snapshot, 0 analyses, 154 macros, 4 operations, 0 seed files, 2 sources, 0 exposures
2021-10-25 07:56:21.259283 (MainThread): 
2021-10-25 07:56:21.260282 (MainThread): Acquiring new snowflake connection "master".
2021-10-25 07:56:21.262196 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-25 07:56:21.276275 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-25 07:56:21.276774 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-25 07:56:21.276774 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-25 07:56:22.974243 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.70 seconds
2021-10-25 07:56:22.979320 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-25 07:56:23.246612 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_snapshots".
2021-10-25 07:56:23.252224 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_snapshots".
2021-10-25 07:56:23.252724 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */

    show terse objects in analytics.snapshots
2021-10-25 07:56:23.253248 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-25 07:56:24.046999 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.79 seconds
2021-10-25 07:56:24.048000 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: Close
2021-10-25 07:56:24.346205 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-25 07:56:24.347205 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-25 07:56:24.347205 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-25 07:56:24.347205 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-25 07:56:25.184588 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.84 seconds
2021-10-25 07:56:25.186607 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-25 07:56:25.460479 (MainThread): Using snowflake connection "master".
2021-10-25 07:56:25.460479 (MainThread): On master: BEGIN
2021-10-25 07:56:25.460479 (MainThread): Opening a new connection, currently in state init
2021-10-25 07:56:26.439674 (MainThread): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-25 07:56:26.439674 (MainThread): On master: COMMIT
2021-10-25 07:56:26.440688 (MainThread): Using snowflake connection "master".
2021-10-25 07:56:26.440688 (MainThread): On master: COMMIT
2021-10-25 07:56:26.677842 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-25 07:56:26.677842 (MainThread): 09:56:26 | 
2021-10-25 07:56:26.677842 (MainThread): 09:56:26 | Running 1 on-run-start hook
2021-10-25 07:56:26.679846 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-25 07:56:26.680842 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-25 07:56:26.689106 (MainThread): 09:56:26 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-25 07:56:26.690117 (MainThread): Using snowflake connection "master".
2021-10-25 07:56:26.690117 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-25 07:56:26.899686 (MainThread): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-25 07:56:26.900686 (MainThread): 09:56:26 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.21s]
2021-10-25 07:56:26.901686 (MainThread): 09:56:26 | 
2021-10-25 07:56:26.902686 (MainThread): On master: Close
2021-10-25 07:56:27.181819 (MainThread): 09:56:27 | Concurrency: 1 threads (target='dev')
2021-10-25 07:56:27.181819 (MainThread): 09:56:27 | 
2021-10-25 07:56:27.186823 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-25 07:56:27.186823 (Thread-1): 09:56:27 | 1 of 7 START table model dbt.first_model............................. [RUN]
2021-10-25 07:56:27.186823 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 07:56:27.187812 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-25 07:56:27.188774 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-25 07:56:27.206650 (Thread-1): finished collecting timing info
2021-10-25 07:56:27.232170 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-25 07:56:27.240902 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 07:56:27.240902 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-25 07:56:27.240902 (Thread-1): Opening a new connection, currently in state init
2021-10-25 07:56:28.003622 (Thread-1): SQL status: SUCCESS 1 in 0.76 seconds
2021-10-25 07:56:28.004622 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 07:56:28.004622 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below

    post_hook="grant select on analytics.dbt.first_model to role analyst" can put in config
*/




with source_data as (

    select 1 as id, 'CA' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at
    union all
    select null as id, 'TX' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at
    union all
    select 3 as id, 'VT' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-25 07:56:29.620069 (Thread-1): SQL status: SUCCESS 1 in 1.62 seconds
2021-10-25 07:56:29.621094 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-25 07:56:29.621094 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 07:56:29.621094 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-25 07:56:29.789821 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-25 07:56:29.798901 (Thread-1): finished collecting timing info
2021-10-25 07:56:29.798901 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-25 07:56:30.072822 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e0a4b6-f903-47b9-b4cb-ca0ca0851688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD991F7BB0>]}
2021-10-25 07:56:30.073723 (Thread-1): 09:56:30 | 1 of 7 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.89s]
2021-10-25 07:56:30.074232 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-25 07:56:30.074232 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-25 07:56:30.074734 (Thread-1): 09:56:30 | 2 of 7 START table model dbt.cul_order_price......................... [RUN]
2021-10-25 07:56:30.075235 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 07:56:30.075733 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-25 07:56:30.076941 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-25 07:56:30.083799 (Thread-1): finished collecting timing info
2021-10-25 07:56:30.085792 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-25 07:56:30.093084 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 07:56:30.093084 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-25 07:56:30.093084 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 07:56:30.866026 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-25 07:56:30.866026 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 07:56:30.866026 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-25 07:56:33.207678 (Thread-1): SQL status: SUCCESS 1 in 2.34 seconds
2021-10-25 07:56:33.209679 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-25 07:56:33.209679 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 07:56:33.209679 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-25 07:56:33.368772 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 07:56:33.369795 (Thread-1): finished collecting timing info
2021-10-25 07:56:33.369795 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-25 07:56:33.633262 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e0a4b6-f903-47b9-b4cb-ca0ca0851688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD99200D30>]}
2021-10-25 07:56:33.634284 (Thread-1): 09:56:33 | 2 of 7 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.56s]
2021-10-25 07:56:33.635262 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-25 07:56:33.635262 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-25 07:56:33.636262 (Thread-1): 09:56:33 | 3 of 7 START incremental model dbt.dates............................. [RUN]
2021-10-25 07:56:33.636525 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 07:56:33.636525 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-25 07:56:33.643160 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-25 07:56:33.648196 (Thread-1): finished collecting timing info
2021-10-25 07:56:33.669191 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 07:56:33.669191 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-25 07:56:33.669191 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 07:56:35.358253 (Thread-1): SQL status: SUCCESS 1 in 1.69 seconds
2021-10-25 07:56:35.365551 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 07:56:35.365551 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-25 07:56:35.534799 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-25 07:56:35.535798 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 07:56:35.535798 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-25 07:56:35.694732 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 07:56:35.695731 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 07:56:35.695731 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-25 07:56:35.844086 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-25 07:56:35.855087 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-25 07:56:35.861087 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 07:56:35.862088 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-25 07:56:36.026516 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 07:56:36.026738 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 07:56:36.026842 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-25 07:56:36.855076 (Thread-1): SQL status: SUCCESS 10 in 0.83 seconds
2021-10-25 07:56:36.856214 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-25 07:56:36.856214 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 07:56:36.857310 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-25 07:56:37.207624 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-10-25 07:56:37.207624 (Thread-1): finished collecting timing info
2021-10-25 07:56:37.208531 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-25 07:56:37.493272 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e0a4b6-f903-47b9-b4cb-ca0ca0851688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD99248B20>]}
2021-10-25 07:56:37.494314 (Thread-1): 09:56:37 | 3 of 7 OK created incremental model dbt.dates........................ [SUCCESS 10 in 3.86s]
2021-10-25 07:56:37.494912 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-25 07:56:37.494912 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-25 07:56:37.495984 (Thread-1): 09:56:37 | 4 of 7 START table model dbt.playing_with_tests...................... [RUN]
2021-10-25 07:56:37.496981 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 07:56:37.496981 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-25 07:56:37.502059 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-25 07:56:37.508099 (Thread-1): finished collecting timing info
2021-10-25 07:56:37.510616 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-25 07:56:37.518337 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 07:56:37.518337 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-25 07:56:37.518337 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 07:56:38.535736 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-25 07:56:38.535736 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 07:56:38.535736 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */


      create or replace transient table analytics.dbt.playing_with_tests  as
      (SELECT
  c_custkey,
  c_mktsegment,
     -- starts macro namesmacro and parameter

  CASE                 -- SQL code to be inserted everytime macro called
    WHEN c_mktsegment IN ('BUILDING', 'HOUSEHOLD', 'FURNITURE')
      THEN 'segment_1'
    ELSE 'segment_2'
  END
 mkt_segment_adjusted
FROM snowflake_sample_data.tpch_sf1.customer
      );
2021-10-25 07:56:39.759512 (Thread-1): SQL status: SUCCESS 1 in 1.22 seconds
2021-10-25 07:56:39.760519 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-25 07:56:39.760519 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 07:56:39.760519 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-25 07:56:39.935100 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-25 07:56:39.936153 (Thread-1): finished collecting timing info
2021-10-25 07:56:39.936153 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-25 07:56:40.225311 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e0a4b6-f903-47b9-b4cb-ca0ca0851688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD9928C850>]}
2021-10-25 07:56:40.225311 (Thread-1): 09:56:40 | 4 of 7 OK created table model dbt.playing_with_tests................. [SUCCESS 1 in 2.73s]
2021-10-25 07:56:40.225311 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-25 07:56:40.226626 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-25 07:56:40.226626 (Thread-1): 09:56:40 | 5 of 7 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-25 07:56:40.226626 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 07:56:40.226626 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-25 07:56:40.229626 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-25 07:56:40.237369 (Thread-1): finished collecting timing info
2021-10-25 07:56:40.240485 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-25 07:56:40.247482 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 07:56:40.247482 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-25 07:56:40.247482 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 07:56:41.252867 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-10-25 07:56:41.252867 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 07:56:41.252867 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM snowflake_sample_data.tpch_sf1.customer c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey

   -- starts macro namesmacro and parameter

  GROUP BY                -- SQL code to be inserted everytime macro called
      -- If n = 1 group by columns 1 - 5, not inclusive at end, thus, n+1
      1
       ,   -- Inserts a comma after each loop except the last one, endif
      -- If n = 1 group by columns 1 - 5, not inclusive at end, thus, n+1
      2
       ,   -- Inserts a comma after each loop except the last one, endif
      -- If n = 1 group by columns 1 - 5, not inclusive at end, thus, n+1
      3
        -- Inserts a comma after each loop except the last one, endif
                                -- end for loop

      );
2021-10-25 07:56:42.931033 (Thread-1): SQL status: SUCCESS 1 in 1.68 seconds
2021-10-25 07:56:42.932034 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-25 07:56:42.932034 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 07:56:42.932034 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-25 07:56:43.080140 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-25 07:56:43.080140 (Thread-1): finished collecting timing info
2021-10-25 07:56:43.081140 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-25 07:56:43.345943 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e0a4b6-f903-47b9-b4cb-ca0ca0851688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD99110B20>]}
2021-10-25 07:56:43.346940 (Thread-1): 09:56:43 | 5 of 7 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.12s]
2021-10-25 07:56:43.347940 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-25 07:56:43.347940 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-25 07:56:43.348938 (Thread-1): 09:56:43 | 6 of 7 START incremental model dbt.time.............................. [RUN]
2021-10-25 07:56:43.348938 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 07:56:43.348938 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-25 07:56:43.352618 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-25 07:56:43.358699 (Thread-1): finished collecting timing info
2021-10-25 07:56:43.362730 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 07:56:43.362730 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-25 07:56:43.362730 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 07:56:44.973414 (Thread-1): SQL status: SUCCESS 1 in 1.61 seconds
2021-10-25 07:56:44.975415 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 07:56:44.975415 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-25 07:56:45.148143 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-25 07:56:45.150225 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 07:56:45.150225 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-25 07:56:45.319204 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-25 07:56:45.322249 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 07:56:45.322249 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-25 07:56:45.465595 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-10-25 07:56:45.466597 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-25 07:56:45.473597 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 07:56:45.473597 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-25 07:56:45.652039 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-25 07:56:45.652039 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 07:56:45.652039 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-25 07:56:45.924256 (Thread-1): SQL status: SUCCESS 0 in 0.27 seconds
2021-10-25 07:56:45.924256 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-25 07:56:45.925257 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 07:56:45.925257 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-25 07:56:46.148198 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-25 07:56:46.149198 (Thread-1): finished collecting timing info
2021-10-25 07:56:46.149198 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-25 07:56:46.435445 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e0a4b6-f903-47b9-b4cb-ca0ca0851688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD9924F910>]}
2021-10-25 07:56:46.435445 (Thread-1): 09:56:46 | 6 of 7 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.09s]
2021-10-25 07:56:46.436541 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-25 07:56:46.437528 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-25 07:56:46.437528 (Thread-1): 09:56:46 | 7 of 7 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-25 07:56:46.438535 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 07:56:46.438535 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-25 07:56:46.442447 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-25 07:56:46.458810 (Thread-1): finished collecting timing info
2021-10-25 07:56:46.459810 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-25 07:56:46.465420 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 07:56:46.465420 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-25 07:56:46.465420 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 07:56:47.205850 (Thread-1): SQL status: SUCCESS 1 in 0.74 seconds
2021-10-25 07:56:47.205850 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 07:56:47.205850 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-25 07:56:48.185549 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-25 07:56:48.185549 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-25 07:56:48.185549 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 07:56:48.186647 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-25 07:56:48.343475 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 07:56:48.344475 (Thread-1): finished collecting timing info
2021-10-25 07:56:48.344475 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-25 07:56:48.612432 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e0a4b6-f903-47b9-b4cb-ca0ca0851688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD99215700>]}
2021-10-25 07:56:48.612432 (Thread-1): 09:56:48 | 7 of 7 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.17s]
2021-10-25 07:56:48.613432 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-25 07:56:48.614432 (MainThread): Acquiring new snowflake connection "master".
2021-10-25 07:56:48.615432 (MainThread): Using snowflake connection "master".
2021-10-25 07:56:48.615432 (MainThread): On master: BEGIN
2021-10-25 07:56:48.615432 (MainThread): Opening a new connection, currently in state closed
2021-10-25 07:56:49.674356 (MainThread): SQL status: SUCCESS 1 in 1.06 seconds
2021-10-25 07:56:49.674356 (MainThread): On master: COMMIT
2021-10-25 07:56:49.674356 (MainThread): Using snowflake connection "master".
2021-10-25 07:56:49.674356 (MainThread): On master: COMMIT
2021-10-25 07:56:49.880660 (MainThread): SQL status: SUCCESS 1 in 0.21 seconds
2021-10-25 07:56:49.880660 (MainThread): 09:56:49 | 
2021-10-25 07:56:49.880660 (MainThread): 09:56:49 | Running 3 on-run-end hooks
2021-10-25 07:56:49.882654 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-25 07:56:49.883641 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-25 07:56:49.889743 (MainThread): 09:56:49 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-25 07:56:49.891868 (MainThread): Using snowflake connection "master".
2021-10-25 07:56:49.891868 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-25 07:56:50.044770 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-25 07:56:50.046770 (MainThread): 09:56:50 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.15s]
2021-10-25 07:56:50.047768 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-25 07:56:50.048767 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-25 07:56:50.055768 (MainThread): 09:56:50 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-25 07:56:50.056849 (MainThread): Using snowflake connection "master".
2021-10-25 07:56:50.056849 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-25 07:56:50.302701 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-25 07:56:50.302701 (MainThread): 09:56:50 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.25s]
2021-10-25 07:56:50.303700 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-25 07:56:50.304701 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-25 07:56:50.312018 (MainThread): 09:56:50 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-25 07:56:50.312979 (MainThread): Using snowflake connection "master".
2021-10-25 07:56:50.312979 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-25 07:56:50.471645 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 07:56:50.472634 (MainThread): 09:56:50 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.16s]
2021-10-25 07:56:50.473623 (MainThread): 09:56:50 | 
2021-10-25 07:56:50.474571 (MainThread): On master: Close
2021-10-25 07:56:50.745136 (MainThread): 09:56:50 | 
2021-10-25 07:56:50.745136 (MainThread): 09:56:50 | Finished running 5 table models, 2 incremental models, 4 hooks in 29.48s.
2021-10-25 07:56:50.748048 (MainThread): Connection 'master' was properly closed.
2021-10-25 07:56:50.748048 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-25 07:56:50.748048 (MainThread): Connection 'list_analytics_dbt' was properly closed.
2021-10-25 07:56:50.748048 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-25 07:56:50.768188 (MainThread): 
2021-10-25 07:56:50.769188 (MainThread): Completed successfully
2021-10-25 07:56:50.769188 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-25 07:56:50.772300 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD98F1A670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD99296DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD99207910>]}
2021-10-25 07:56:50.772799 (MainThread): Flushing usage events
2021-10-25 07:58:48.866230 (MainThread): Running with dbt=0.20.2
2021-10-25 07:58:49.537577 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, macro='suspend', args="'{warehouse_name:transform_wh}'", defer=None, state=None, cls=<class 'dbt.task.run_operation.RunOperationTask'>, which='run-operation', rpc_method='run-operation')
2021-10-25 07:58:49.537577 (MainThread): Tracking: tracking
2021-10-25 07:58:49.537577 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028140F7CD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281424B0670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281424B0C70>]}
2021-10-25 07:58:49.545618 (MainThread): Partial parsing not enabled
2021-10-25 07:58:49.562464 (MainThread): Parsing macros\group_by.sql
2021-10-25 07:58:49.563660 (MainThread): Parsing macros\renaming_segments.sql
2021-10-25 07:58:49.563776 (MainThread): Parsing macros\suspend_warehouse.sql
2021-10-25 07:58:49.564708 (MainThread): Parsing macros\adapters.sql
2021-10-25 07:58:49.588922 (MainThread): Parsing macros\catalog.sql
2021-10-25 07:58:49.590446 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-25 07:58:49.597990 (MainThread): Parsing macros\materializations\merge.sql
2021-10-25 07:58:49.598988 (MainThread): Parsing macros\materializations\table.sql
2021-10-25 07:58:49.602007 (MainThread): Parsing macros\materializations\view.sql
2021-10-25 07:58:49.603007 (MainThread): Parsing macros\core.sql
2021-10-25 07:58:49.605007 (MainThread): Parsing macros\adapters\common.sql
2021-10-25 07:58:49.636178 (MainThread): Parsing macros\etc\datetime.sql
2021-10-25 07:58:49.641424 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-25 07:58:49.642509 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-25 07:58:49.643510 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-25 07:58:49.644512 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-25 07:58:49.645509 (MainThread): Parsing macros\etc\query.sql
2021-10-25 07:58:49.645509 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-25 07:58:49.651724 (MainThread): Parsing macros\materializations\test.sql
2021-10-25 07:58:49.656682 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-25 07:58:49.665016 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-25 07:58:49.666019 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-25 07:58:49.671035 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-25 07:58:49.686201 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-25 07:58:49.714207 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-25 07:58:49.715208 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-25 07:58:49.727833 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-25 07:58:49.731833 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-25 07:58:49.734833 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-25 07:58:49.737833 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-25 07:58:49.740028 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-25 07:58:49.740028 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-25 07:58:49.742029 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-25 07:58:49.879048 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 07:58:49.889316 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 07:58:49.892416 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:58:49.892416 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 07:58:49.896680 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 07:58:49.900693 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 07:58:49.905680 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 07:58:49.911188 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 07:58:49.920184 (MainThread): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-25 07:58:49.935389 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-25 07:58:49.937389 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:58:49.938389 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-25 07:58:49.940390 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:58:49.975390 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-25 07:58:49.977390 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-25 07:58:49.979391 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-25 07:58:49.980390 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-25 07:58:50.005188 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:58:50.008187 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:58:50.018401 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:58:50.018401 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:58:50.019922 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:58:50.021921 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:58:50.023921 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:58:50.025922 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:58:50.036258 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:58:50.036258 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:58:50.047256 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:58:50.048257 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:58:50.069211 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f08988d8-00ae-445e-8a79-9d2c86ca5bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281426570A0>]}
2021-10-25 07:58:50.085375 (MainThread): Encountered an error while running operation: Compilation Error
  The --vars argument must be a YAML dictionary, but was of type 'str'
2021-10-25 07:58:50.085375 (MainThread): 
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run_operation.py", line 54, in run
    self._run_unsafe()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run_operation.py", line 37, in _run_unsafe
    macro_kwargs = self._get_kwargs()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run_operation.py", line 27, in _get_kwargs
    return parse_cli_vars(self.args.args)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\config\utils.py", line 16, in parse_cli_vars
    raise_compiler_error(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  The --vars argument must be a YAML dictionary, but was of type 'str'
2021-10-25 07:58:50.140851 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028140F7CD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281424DCD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281424DC2E0>]}
2021-10-25 07:58:50.140851 (MainThread): Flushing usage events
2021-10-25 07:58:50.662687 (MainThread): Connection 'operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2' was properly closed.
2021-10-25 07:59:11.171722 (MainThread): Running with dbt=0.20.2
2021-10-25 07:59:11.828242 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, macro='suspend', args='{warehouse_name:transform_wh}', defer=None, state=None, cls=<class 'dbt.task.run_operation.RunOperationTask'>, which='run-operation', rpc_method='run-operation')
2021-10-25 07:59:11.828242 (MainThread): Tracking: tracking
2021-10-25 07:59:11.829244 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9D730CF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9D884B910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9D884BE80>]}
2021-10-25 07:59:11.836243 (MainThread): Partial parsing not enabled
2021-10-25 07:59:11.852572 (MainThread): Parsing macros\group_by.sql
2021-10-25 07:59:11.853572 (MainThread): Parsing macros\renaming_segments.sql
2021-10-25 07:59:11.853572 (MainThread): Parsing macros\suspend_warehouse.sql
2021-10-25 07:59:11.854572 (MainThread): Parsing macros\adapters.sql
2021-10-25 07:59:11.874700 (MainThread): Parsing macros\catalog.sql
2021-10-25 07:59:11.876700 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-25 07:59:11.885699 (MainThread): Parsing macros\materializations\merge.sql
2021-10-25 07:59:11.886701 (MainThread): Parsing macros\materializations\table.sql
2021-10-25 07:59:11.890903 (MainThread): Parsing macros\materializations\view.sql
2021-10-25 07:59:11.891904 (MainThread): Parsing macros\core.sql
2021-10-25 07:59:11.894902 (MainThread): Parsing macros\adapters\common.sql
2021-10-25 07:59:11.928073 (MainThread): Parsing macros\etc\datetime.sql
2021-10-25 07:59:11.934375 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-25 07:59:11.935396 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-25 07:59:11.936942 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-25 07:59:11.938500 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-25 07:59:11.940354 (MainThread): Parsing macros\etc\query.sql
2021-10-25 07:59:11.940855 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-25 07:59:11.950866 (MainThread): Parsing macros\materializations\test.sql
2021-10-25 07:59:11.956865 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-25 07:59:11.967056 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-25 07:59:11.969056 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-25 07:59:11.975055 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-25 07:59:11.990560 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-25 07:59:12.011922 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-25 07:59:12.012921 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-25 07:59:12.024920 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-25 07:59:12.030241 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-25 07:59:12.033241 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-25 07:59:12.038241 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-25 07:59:12.039241 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-25 07:59:12.040241 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-25 07:59:12.041332 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-25 07:59:12.176116 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 07:59:12.185726 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 07:59:12.188720 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:59:12.189720 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 07:59:12.191719 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 07:59:12.195718 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 07:59:12.200717 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 07:59:12.205717 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 07:59:12.216718 (MainThread): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-25 07:59:12.230296 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-25 07:59:12.232296 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:59:12.233295 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-25 07:59:12.234295 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:59:12.269392 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-25 07:59:12.271393 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-25 07:59:12.273392 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-25 07:59:12.274585 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-25 07:59:12.295817 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:59:12.297817 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:59:12.305240 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:59:12.305240 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:59:12.307266 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:59:12.308266 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:59:12.310266 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:59:12.311269 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:59:12.319245 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:59:12.319245 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:59:12.329886 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:59:12.330886 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 07:59:12.351356 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56d232c2-adfa-47ad-ad75-40bd3da867c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9D89F40D0>]}
2021-10-25 07:59:12.365739 (MainThread): Acquiring new snowflake connection "macro_suspend".
2021-10-25 07:59:12.365739 (MainThread): Using snowflake connection "macro_suspend".
2021-10-25 07:59:12.365739 (MainThread): On macro_suspend: BEGIN
2021-10-25 07:59:12.366804 (MainThread): Opening a new connection, currently in state init
2021-10-25 07:59:13.818839 (MainThread): SQL status: SUCCESS 1 in 1.45 seconds
2021-10-25 07:59:13.818839 (MainThread): On macro_suspend: COMMIT
2021-10-25 07:59:13.818839 (MainThread): Using snowflake connection "macro_suspend".
2021-10-25 07:59:13.818839 (MainThread): On macro_suspend: COMMIT
2021-10-25 07:59:14.063247 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-25 07:59:14.065276 (MainThread): Error running SQL: macro suspend
2021-10-25 07:59:14.065276 (MainThread): Rolling back transaction.
2021-10-25 07:59:14.066276 (MainThread): On macro_suspend: Close
2021-10-25 07:59:14.333242 (MainThread): Encountered an error while running operation: Compilation Error in macro suspend (macros\suspend_warehouse.sql)
  macro 'dbt_macro__suspend' takes no keyword argument 'warehouse_name:transform_wh'
2021-10-25 07:59:14.334243 (MainThread): 
Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 305, in exception_handler
    yield
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 663, in __call__
    raise TypeError(
TypeError: macro 'dbt_macro__suspend' takes no keyword argument 'warehouse_name:transform_wh'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run_operation.py", line 54, in run
    self._run_unsafe()
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run_operation.py", line 41, in _run_unsafe
    res = adapter.execute_macro(
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 1000, in execute_macro
    result = macro_function(**kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 262, in call_macro
    return e.value
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 307, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "C:\Users\luke.clarke\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro suspend (macros\suspend_warehouse.sql)
  macro 'dbt_macro__suspend' takes no keyword argument 'warehouse_name:transform_wh'
2021-10-25 07:59:14.373444 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9D730CF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9D8BB1A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9D8BB11C0>]}
2021-10-25 07:59:14.373947 (MainThread): Flushing usage events
2021-10-25 07:59:14.860590 (MainThread): Connection 'macro_suspend' was properly closed.
2021-10-25 09:33:16.091107 (MainThread): Running with dbt=0.20.2
2021-10-25 09:33:16.766977 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-25 09:33:16.767978 (MainThread): Tracking: tracking
2021-10-25 09:33:16.767978 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2AB2CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2C06C460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2C06C9D0>]}
2021-10-25 09:33:16.774980 (MainThread): Partial parsing not enabled
2021-10-25 09:33:16.794180 (MainThread): Parsing macros\group_by.sql
2021-10-25 09:33:16.795180 (MainThread): Parsing macros\renaming_segments.sql
2021-10-25 09:33:16.796181 (MainThread): Parsing macros\suspend_warehouse.sql
2021-10-25 09:33:16.796181 (MainThread): Parsing macros\adapters.sql
2021-10-25 09:33:16.824246 (MainThread): Parsing macros\catalog.sql
2021-10-25 09:33:16.826634 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-25 09:33:16.835003 (MainThread): Parsing macros\materializations\merge.sql
2021-10-25 09:33:16.837636 (MainThread): Parsing macros\materializations\table.sql
2021-10-25 09:33:16.840636 (MainThread): Parsing macros\materializations\view.sql
2021-10-25 09:33:16.841650 (MainThread): Parsing macros\core.sql
2021-10-25 09:33:16.844636 (MainThread): Parsing macros\adapters\common.sql
2021-10-25 09:33:16.878773 (MainThread): Parsing macros\etc\datetime.sql
2021-10-25 09:33:16.885770 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-25 09:33:16.885770 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-25 09:33:16.887770 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-25 09:33:16.888770 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-25 09:33:16.889771 (MainThread): Parsing macros\etc\query.sql
2021-10-25 09:33:16.890770 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-25 09:33:16.897774 (MainThread): Parsing macros\materializations\test.sql
2021-10-25 09:33:16.903771 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-25 09:33:16.913927 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-25 09:33:16.915926 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-25 09:33:16.921925 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-25 09:33:16.937845 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-25 09:33:16.961006 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-25 09:33:16.963053 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-25 09:33:16.976815 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-25 09:33:16.981848 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-25 09:33:16.985819 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-25 09:33:16.991055 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-25 09:33:16.992150 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-25 09:33:16.993148 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-25 09:33:16.994153 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-25 09:33:17.130087 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 09:33:17.135088 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 09:33:17.137088 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:33:17.138088 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 09:33:17.140088 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 09:33:17.143183 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 09:33:17.161673 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:33:17.166673 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '72db14e1-fb86-4c27-8be7-1c5c784b7689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2C197C70>]}
2021-10-25 09:33:17.167673 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:33:17.176470 (MainThread): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-25 09:33:17.188463 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-25 09:33:17.190687 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:33:17.191686 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-25 09:33:17.193611 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:33:17.238201 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-25 09:33:17.241513 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-25 09:33:17.244328 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-25 09:33:17.246579 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-25 09:33:17.269161 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:33:17.271160 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:33:17.278160 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:33:17.278160 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:33:17.280159 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:33:17.281159 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:33:17.282767 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:33:17.284808 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:33:17.292809 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:33:17.292809 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:33:17.304481 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:33:17.305474 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:33:17.328275 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72db14e1-fb86-4c27-8be7-1c5c784b7689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2C21A0D0>]}
2021-10-25 09:33:17.350433 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-25 09:33:17.351065 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72db14e1-fb86-4c27-8be7-1c5c784b7689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2C21A490>]}
2021-10-25 09:33:17.351065 (MainThread): Found 7 models, 12 tests, 1 snapshot, 0 analyses, 154 macros, 4 operations, 0 seed files, 2 sources, 0 exposures
2021-10-25 09:33:17.353596 (MainThread): 
2021-10-25 09:33:17.354353 (MainThread): Acquiring new snowflake connection "master".
2021-10-25 09:33:17.356971 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-25 09:33:17.369186 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-25 09:33:17.369186 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-25 09:33:17.369186 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-25 09:33:18.805928 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.44 seconds
2021-10-25 09:33:18.809225 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-25 09:33:19.100544 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-10-25 09:33:19.107620 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-10-25 09:33:19.107620 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-10-25 09:33:19.107620 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-25 09:33:20.437391 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.33 seconds
2021-10-25 09:33:20.438391 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-10-25 09:33:20.711565 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_snapshots".
2021-10-25 09:33:20.711565 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_snapshots".
2021-10-25 09:33:20.712564 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */

    show terse objects in analytics.snapshots
2021-10-25 09:33:20.712564 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-25 09:33:21.617111 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.90 seconds
2021-10-25 09:33:21.617612 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: Close
2021-10-25 09:33:21.986483 (MainThread): Using snowflake connection "master".
2021-10-25 09:33:21.986483 (MainThread): On master: BEGIN
2021-10-25 09:33:21.986483 (MainThread): Opening a new connection, currently in state init
2021-10-25 09:33:22.791842 (MainThread): SQL status: SUCCESS 1 in 0.81 seconds
2021-10-25 09:33:22.791842 (MainThread): On master: COMMIT
2021-10-25 09:33:22.791842 (MainThread): Using snowflake connection "master".
2021-10-25 09:33:22.791842 (MainThread): On master: COMMIT
2021-10-25 09:33:23.207599 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2021-10-25 09:33:23.208100 (MainThread): 11:33:23 | 
2021-10-25 09:33:23.208100 (MainThread): 11:33:23 | Running 1 on-run-start hook
2021-10-25 09:33:23.210281 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-25 09:33:23.211373 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-25 09:33:23.217945 (MainThread): 11:33:23 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-25 09:33:23.218444 (MainThread): Using snowflake connection "master".
2021-10-25 09:33:23.218687 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-25 09:33:23.385637 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-25 09:33:23.385637 (MainThread): 11:33:23 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.17s]
2021-10-25 09:33:23.386556 (MainThread): 11:33:23 | 
2021-10-25 09:33:23.387553 (MainThread): On master: Close
2021-10-25 09:33:23.683983 (MainThread): 11:33:23 | Concurrency: 1 threads (target='dev')
2021-10-25 09:33:23.684982 (MainThread): 11:33:23 | 
2021-10-25 09:33:23.691982 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-25 09:33:23.691982 (Thread-1): 11:33:23 | 1 of 7 START table model dbt.first_model............................. [RUN]
2021-10-25 09:33:23.692982 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 09:33:23.692982 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-25 09:33:23.694982 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-25 09:33:23.702256 (Thread-1): finished collecting timing info
2021-10-25 09:33:23.724339 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-25 09:33:23.735578 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 09:33:23.735578 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-25 09:33:23.735578 (Thread-1): Opening a new connection, currently in state init
2021-10-25 09:33:24.504044 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-25 09:33:24.504044 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 09:33:24.504044 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below

    post_hook="grant select on analytics.dbt.first_model to role analyst" can put in config
*/




with source_data as (

    select 1 as id, 'CA' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at
    union all
    select null as id, 'TX' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at
    union all
    select 3 as id, 'VT' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-25 09:33:27.008640 (Thread-1): SQL status: SUCCESS 1 in 2.50 seconds
2021-10-25 09:33:27.009738 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-25 09:33:27.009738 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 09:33:27.009738 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-25 09:33:27.195056 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-25 09:33:27.202311 (Thread-1): finished collecting timing info
2021-10-25 09:33:27.202311 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-25 09:33:27.490744 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72db14e1-fb86-4c27-8be7-1c5c784b7689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2C21A760>]}
2021-10-25 09:33:27.491744 (Thread-1): 11:33:27 | 1 of 7 OK created table model dbt.first_model........................ [SUCCESS 1 in 3.80s]
2021-10-25 09:33:27.492744 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-25 09:33:27.492744 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-25 09:33:27.492744 (Thread-1): 11:33:27 | 2 of 7 START table model dbt.cul_order_price......................... [RUN]
2021-10-25 09:33:27.493817 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 09:33:27.493817 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-25 09:33:27.494827 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-25 09:33:27.499841 (Thread-1): finished collecting timing info
2021-10-25 09:33:27.501841 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-25 09:33:27.506840 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 09:33:27.506840 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-25 09:33:27.506840 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 09:33:28.330809 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-25 09:33:28.330809 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 09:33:28.331888 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-25 09:33:30.288382 (Thread-1): SQL status: SUCCESS 1 in 1.96 seconds
2021-10-25 09:33:30.289428 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-25 09:33:30.289428 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 09:33:30.290429 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-25 09:33:30.494523 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-10-25 09:33:30.494523 (Thread-1): finished collecting timing info
2021-10-25 09:33:30.495522 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-25 09:33:30.801219 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72db14e1-fb86-4c27-8be7-1c5c784b7689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2C5586A0>]}
2021-10-25 09:33:30.801219 (Thread-1): 11:33:30 | 2 of 7 OK created table model dbt.cul_order_price.................... [SUCCESS 1 in 3.31s]
2021-10-25 09:33:30.802091 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-25 09:33:30.802230 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-25 09:33:30.802230 (Thread-1): 11:33:30 | 3 of 7 START incremental model dbt.dates............................. [RUN]
2021-10-25 09:33:30.802230 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:33:30.802230 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-25 09:33:30.806277 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-25 09:33:30.811416 (Thread-1): finished collecting timing info
2021-10-25 09:33:30.836372 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:33:30.836372 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt.dates)

      );
2021-10-25 09:33:30.836372 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 09:33:32.537559 (Thread-1): SQL status: SUCCESS 1 in 1.70 seconds
2021-10-25 09:33:32.548714 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:33:32.548714 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates__dbt_tmp
2021-10-25 09:33:32.741151 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-25 09:33:32.744298 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:33:32.744298 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-25 09:33:32.914875 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-25 09:33:32.917914 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:33:32.917914 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt.dates
2021-10-25 09:33:33.078018 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 09:33:33.092508 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-25 09:33:33.098411 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:33:33.098411 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-25 09:33:33.261846 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 09:33:33.262841 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:33:33.262841 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt.dates__dbt_tmp
        );
2021-10-25 09:33:33.583568 (Thread-1): SQL status: SUCCESS 0 in 0.32 seconds
2021-10-25 09:33:33.585575 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-25 09:33:33.585575 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:33:33.585575 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-25 09:33:33.816405 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-25 09:33:33.817488 (Thread-1): finished collecting timing info
2021-10-25 09:33:33.817488 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-25 09:33:34.100928 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72db14e1-fb86-4c27-8be7-1c5c784b7689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2C3E8EB0>]}
2021-10-25 09:33:34.103019 (Thread-1): 11:33:34 | 3 of 7 OK created incremental model dbt.dates........................ [SUCCESS 0 in 3.30s]
2021-10-25 09:33:34.103019 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-25 09:33:34.103019 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-25 09:33:34.103931 (Thread-1): 11:33:34 | 4 of 7 START table model dbt.playing_with_tests...................... [RUN]
2021-10-25 09:33:34.103931 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 09:33:34.103931 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-25 09:33:34.107209 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-25 09:33:34.113721 (Thread-1): finished collecting timing info
2021-10-25 09:33:34.114963 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-25 09:33:34.121565 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 09:33:34.121565 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-25 09:33:34.121565 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 09:33:35.183112 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-10-25 09:33:35.183112 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 09:33:35.183112 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */


      create or replace transient table analytics.dbt.playing_with_tests  as
      (SELECT
  c_custkey,
  c_mktsegment,
     -- starts macro namesmacro and parameter

  CASE                 -- SQL code to be inserted everytime macro called
    WHEN c_mktsegment IN ('BUILDING', 'HOUSEHOLD', 'FURNITURE')
      THEN 'segment_1'
    ELSE 'segment_2'
  END
 mkt_segment_adjusted
FROM snowflake_sample_data.tpch_sf1.customer
      );
2021-10-25 09:33:36.389509 (Thread-1): SQL status: SUCCESS 1 in 1.21 seconds
2021-10-25 09:33:36.391176 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-25 09:33:36.391176 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 09:33:36.391176 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-25 09:33:36.547441 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 09:33:36.548441 (Thread-1): finished collecting timing info
2021-10-25 09:33:36.548441 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-25 09:33:36.826440 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72db14e1-fb86-4c27-8be7-1c5c784b7689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2C06D7C0>]}
2021-10-25 09:33:36.826440 (Thread-1): 11:33:36 | 4 of 7 OK created table model dbt.playing_with_tests................. [SUCCESS 1 in 2.72s]
2021-10-25 09:33:36.828402 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-25 09:33:36.828402 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-25 09:33:36.828402 (Thread-1): 11:33:36 | 5 of 7 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-10-25 09:33:36.828402 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 09:33:36.828402 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-25 09:33:36.832490 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-25 09:33:36.838405 (Thread-1): finished collecting timing info
2021-10-25 09:33:36.840695 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-25 09:33:36.847805 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 09:33:36.847805 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-25 09:33:36.847805 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 09:33:37.810329 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-10-25 09:33:37.810469 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 09:33:37.810522 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM snowflake_sample_data.tpch_sf1.customer c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey

   -- starts macro namesmacro and parameter

  GROUP BY                -- SQL code to be inserted everytime macro called
      -- If n = 1 group by columns 1 - 5, not inclusive at end, thus, n+1
      1
       ,   -- Inserts a comma after each loop except the last one, endif
      -- If n = 1 group by columns 1 - 5, not inclusive at end, thus, n+1
      2
       ,   -- Inserts a comma after each loop except the last one, endif
      -- If n = 1 group by columns 1 - 5, not inclusive at end, thus, n+1
      3
        -- Inserts a comma after each loop except the last one, endif
                                -- end for loop

      );
2021-10-25 09:33:39.350746 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2021-10-25 09:33:39.351729 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-25 09:33:39.351729 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 09:33:39.351729 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-25 09:33:39.507396 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 09:33:39.508624 (Thread-1): finished collecting timing info
2021-10-25 09:33:39.509126 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-25 09:33:39.961396 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72db14e1-fb86-4c27-8be7-1c5c784b7689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2C4DA4C0>]}
2021-10-25 09:33:39.962394 (Thread-1): 11:33:39 | 5 of 7 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.13s]
2021-10-25 09:33:39.963399 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-25 09:33:39.964396 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-25 09:33:39.964396 (Thread-1): 11:33:39 | 6 of 7 START incremental model dbt.time.............................. [RUN]
2021-10-25 09:33:39.965395 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:33:39.965395 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-25 09:33:39.967483 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-25 09:33:39.972645 (Thread-1): finished collecting timing info
2021-10-25 09:33:39.976721 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:33:39.976721 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt.time)

      );
2021-10-25 09:33:39.976721 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 09:33:41.367729 (Thread-1): SQL status: SUCCESS 1 in 1.39 seconds
2021-10-25 09:33:41.368730 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:33:41.369729 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time__dbt_tmp
2021-10-25 09:33:41.556335 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-25 09:33:41.558336 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:33:41.558336 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-25 09:33:41.718463 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 09:33:41.721454 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:33:41.721454 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt.time
2021-10-25 09:33:42.231351 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-10-25 09:33:42.232351 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-25 09:33:42.238090 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:33:42.238090 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-25 09:33:42.414192 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-25 09:33:42.414192 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:33:42.414192 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt.time ("TIME")
        (
            select "TIME"
            from analytics.dbt.time__dbt_tmp
        );
2021-10-25 09:33:42.816618 (Thread-1): SQL status: SUCCESS 0 in 0.40 seconds
2021-10-25 09:33:42.816618 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-25 09:33:42.817780 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:33:42.817808 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-25 09:33:43.057911 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-25 09:33:43.058942 (Thread-1): finished collecting timing info
2021-10-25 09:33:43.058942 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-25 09:33:43.358891 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72db14e1-fb86-4c27-8be7-1c5c784b7689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2C5E0F40>]}
2021-10-25 09:33:43.359902 (Thread-1): 11:33:43 | 6 of 7 OK created incremental model dbt.time......................... [SUCCESS 0 in 3.39s]
2021-10-25 09:33:43.361892 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-25 09:33:43.361892 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-25 09:33:43.363000 (Thread-1): 11:33:43 | 7 of 7 START table model dbt.my_second_dbt_model..................... [RUN]
2021-10-25 09:33:43.363000 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 09:33:43.363000 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-25 09:33:43.366173 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-25 09:33:43.372216 (Thread-1): finished collecting timing info
2021-10-25 09:33:43.374174 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-25 09:33:43.383601 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 09:33:43.383601 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-25 09:33:43.383601 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 09:33:44.150259 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2021-10-25 09:33:44.151257 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 09:33:44.151257 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt.first_model
      );
2021-10-25 09:33:45.137151 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-10-25 09:33:45.137783 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-25 09:33:45.138284 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 09:33:45.138284 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-25 09:33:45.283648 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-25 09:33:45.285768 (Thread-1): finished collecting timing info
2021-10-25 09:33:45.285768 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-25 09:33:45.562212 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72db14e1-fb86-4c27-8be7-1c5c784b7689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2C539A30>]}
2021-10-25 09:33:45.562212 (Thread-1): 11:33:45 | 7 of 7 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.20s]
2021-10-25 09:33:45.563214 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-25 09:33:45.564214 (MainThread): Acquiring new snowflake connection "master".
2021-10-25 09:33:45.564214 (MainThread): Using snowflake connection "master".
2021-10-25 09:33:45.564214 (MainThread): On master: BEGIN
2021-10-25 09:33:45.564214 (MainThread): Opening a new connection, currently in state closed
2021-10-25 09:33:46.555792 (MainThread): SQL status: SUCCESS 1 in 0.99 seconds
2021-10-25 09:33:46.555792 (MainThread): On master: COMMIT
2021-10-25 09:33:46.555792 (MainThread): Using snowflake connection "master".
2021-10-25 09:33:46.555792 (MainThread): On master: COMMIT
2021-10-25 09:33:46.787754 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-25 09:33:46.788764 (MainThread): 11:33:46 | 
2021-10-25 09:33:46.788764 (MainThread): 11:33:46 | Running 3 on-run-end hooks
2021-10-25 09:33:46.792535 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-25 09:33:46.794284 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-25 09:33:46.799800 (MainThread): 11:33:46 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-25 09:33:46.800797 (MainThread): Using snowflake connection "master".
2021-10-25 09:33:46.800797 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-25 09:33:46.958416 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 09:33:46.959437 (MainThread): 11:33:46 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.16s]
2021-10-25 09:33:46.960417 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-25 09:33:46.962418 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-25 09:33:46.968651 (MainThread): 11:33:46 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-25 09:33:46.968651 (MainThread): Using snowflake connection "master".
2021-10-25 09:33:46.968651 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-25 09:33:47.197918 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-10-25 09:33:47.198905 (MainThread): 11:33:47 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.23s]
2021-10-25 09:33:47.199908 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-25 09:33:47.201905 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-25 09:33:47.207907 (MainThread): 11:33:47 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-25 09:33:47.207907 (MainThread): Using snowflake connection "master".
2021-10-25 09:33:47.207907 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-25 09:33:47.366669 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 09:33:47.367542 (MainThread): 11:33:47 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.16s]
2021-10-25 09:33:47.368041 (MainThread): 11:33:47 | 
2021-10-25 09:33:47.369000 (MainThread): On master: Close
2021-10-25 09:33:47.646004 (MainThread): 11:33:47 | 
2021-10-25 09:33:47.646004 (MainThread): 11:33:47 | Finished running 5 table models, 2 incremental models, 4 hooks in 30.29s.
2021-10-25 09:33:47.647952 (MainThread): Connection 'master' was properly closed.
2021-10-25 09:33:47.647952 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-25 09:33:47.648925 (MainThread): Connection 'list_analytics_snapshots' was properly closed.
2021-10-25 09:33:47.648925 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-25 09:33:47.666284 (MainThread): 
2021-10-25 09:33:47.666284 (MainThread): Completed successfully
2021-10-25 09:33:47.667283 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-25 09:33:47.667283 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2C55C3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2C529190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2AC6D310>]}
2021-10-25 09:33:47.667283 (MainThread): Flushing usage events
2021-10-25 09:47:06.168269 (MainThread): Running with dbt=0.20.2
2021-10-25 09:47:07.148078 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-25 09:47:07.148078 (MainThread): Tracking: tracking
2021-10-25 09:47:07.149078 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D86219CCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8636DB280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8636DBA00>]}
2021-10-25 09:47:07.158268 (MainThread): Partial parsing not enabled
2021-10-25 09:47:07.182764 (MainThread): Parsing macros\group_by.sql
2021-10-25 09:47:07.185729 (MainThread): Parsing macros\renaming_segments.sql
2021-10-25 09:47:07.185729 (MainThread): Parsing macros\suspend_warehouse.sql
2021-10-25 09:47:07.187842 (MainThread): Parsing macros\adapters.sql
2021-10-25 09:47:07.224841 (MainThread): Parsing macros\catalog.sql
2021-10-25 09:47:07.226885 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-25 09:47:07.240281 (MainThread): Parsing macros\materializations\merge.sql
2021-10-25 09:47:07.242280 (MainThread): Parsing macros\materializations\table.sql
2021-10-25 09:47:07.249976 (MainThread): Parsing macros\materializations\view.sql
2021-10-25 09:47:07.252021 (MainThread): Parsing macros\core.sql
2021-10-25 09:47:07.256003 (MainThread): Parsing macros\adapters\common.sql
2021-10-25 09:47:07.322192 (MainThread): Parsing macros\etc\datetime.sql
2021-10-25 09:47:07.334502 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-25 09:47:07.335496 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-25 09:47:07.337901 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-25 09:47:07.339984 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-25 09:47:07.341034 (MainThread): Parsing macros\etc\query.sql
2021-10-25 09:47:07.342034 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-25 09:47:07.355221 (MainThread): Parsing macros\materializations\test.sql
2021-10-25 09:47:07.367346 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-25 09:47:07.391201 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-25 09:47:07.393217 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-25 09:47:07.404971 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-25 09:47:07.475712 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-25 09:47:07.517126 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-25 09:47:07.519145 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-25 09:47:07.539173 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-25 09:47:07.547511 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-25 09:47:07.553510 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-25 09:47:07.559845 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-25 09:47:07.562758 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-25 09:47:07.563763 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-25 09:47:07.565765 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-25 09:47:07.836672 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 09:47:07.848381 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 09:47:07.851417 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:47:07.852417 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 09:47:07.857417 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 09:47:07.862416 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 09:47:07.869662 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:47:07.878665 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:47:07.893272 (MainThread): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-25 09:47:07.915093 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-25 09:47:07.919924 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:47:07.921893 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-25 09:47:07.925531 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:47:07.978004 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-25 09:47:07.982011 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-25 09:47:07.985320 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-25 09:47:07.988331 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-25 09:47:08.020521 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:47:08.023520 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:47:08.033791 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:47:08.034822 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:47:08.036826 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:47:08.038821 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:47:08.040824 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:47:08.042805 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:47:08.057987 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:47:08.057987 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:47:08.070421 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:47:08.071410 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:47:08.099308 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f261fd32-28a1-4a3a-ba16-a02421ba587c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D86388B0A0>]}
2021-10-25 09:47:08.139213 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-25 09:47:08.139713 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f261fd32-28a1-4a3a-ba16-a02421ba587c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D86388BF70>]}
2021-10-25 09:47:08.139713 (MainThread): Found 7 models, 12 tests, 1 snapshot, 0 analyses, 154 macros, 4 operations, 0 seed files, 2 sources, 0 exposures
2021-10-25 09:47:08.142080 (MainThread): 
2021-10-25 09:47:08.143077 (MainThread): Acquiring new snowflake connection "master".
2021-10-25 09:47:08.145463 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-25 09:47:08.160821 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-25 09:47:08.160821 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-25 09:47:08.160821 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-25 09:47:09.545411 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.38 seconds
2021-10-25 09:47:09.548411 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-25 09:47:09.823001 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt_luke".
2021-10-25 09:47:09.824001 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt_luke".
2021-10-25 09:47:09.824188 (ThreadPoolExecutor-0_0): Creating schema "analytics.dbt_luke"
2021-10-25 09:47:09.827278 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt_luke".
2021-10-25 09:47:09.827278 (ThreadPoolExecutor-0_0): On create_analytics_dbt_luke: BEGIN
2021-10-25 09:47:09.827278 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-25 09:47:10.810464 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-25 09:47:10.810464 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt_luke".
2021-10-25 09:47:10.810464 (ThreadPoolExecutor-0_0): On create_analytics_dbt_luke: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "create_analytics_dbt_luke"} */
create schema if not exists analytics.dbt_luke
2021-10-25 09:47:10.989643 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-25 09:47:10.990656 (ThreadPoolExecutor-0_0): On create_analytics_dbt_luke: COMMIT
2021-10-25 09:47:10.990656 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt_luke".
2021-10-25 09:47:10.990656 (ThreadPoolExecutor-0_0): On create_analytics_dbt_luke: COMMIT
2021-10-25 09:47:11.232524 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-25 09:47:11.232524 (ThreadPoolExecutor-0_0): On create_analytics_dbt_luke: Close
2021-10-25 09:47:11.517567 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_snapshots".
2021-10-25 09:47:11.523043 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_snapshots".
2021-10-25 09:47:11.523043 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */

    show terse objects in analytics.snapshots
2021-10-25 09:47:11.523043 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-25 09:47:12.264821 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.74 seconds
2021-10-25 09:47:12.265835 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: Close
2021-10-25 09:47:12.543392 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_luke".
2021-10-25 09:47:12.545392 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_luke".
2021-10-25 09:47:12.545392 (ThreadPoolExecutor-1_0): On list_analytics_dbt_luke: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt_luke"} */

    show terse objects in analytics.dbt_luke
2021-10-25 09:47:12.545392 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-25 09:47:13.260601 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.72 seconds
2021-10-25 09:47:13.260601 (ThreadPoolExecutor-1_0): On list_analytics_dbt_luke: Close
2021-10-25 09:47:13.591815 (MainThread): Using snowflake connection "master".
2021-10-25 09:47:13.591815 (MainThread): On master: BEGIN
2021-10-25 09:47:13.591815 (MainThread): Opening a new connection, currently in state init
2021-10-25 09:47:14.624457 (MainThread): SQL status: SUCCESS 1 in 1.03 seconds
2021-10-25 09:47:14.624457 (MainThread): On master: COMMIT
2021-10-25 09:47:14.624457 (MainThread): Using snowflake connection "master".
2021-10-25 09:47:14.624457 (MainThread): On master: COMMIT
2021-10-25 09:47:14.841770 (MainThread): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-25 09:47:14.841770 (MainThread): 11:47:14 | 
2021-10-25 09:47:14.841770 (MainThread): 11:47:14 | Running 1 on-run-start hook
2021-10-25 09:47:14.843846 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-25 09:47:14.844877 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-25 09:47:14.849768 (MainThread): 11:47:14 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-25 09:47:14.850663 (MainThread): Using snowflake connection "master".
2021-10-25 09:47:14.850663 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-25 09:47:15.132544 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-10-25 09:47:15.133676 (MainThread): 11:47:15 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.28s]
2021-10-25 09:47:15.134727 (MainThread): 11:47:15 | 
2021-10-25 09:47:15.134727 (MainThread): On master: Close
2021-10-25 09:47:15.415702 (MainThread): 11:47:15 | Concurrency: 1 threads (target='dev')
2021-10-25 09:47:15.415702 (MainThread): 11:47:15 | 
2021-10-25 09:47:15.420628 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-25 09:47:15.420628 (Thread-1): 11:47:15 | 1 of 7 START table model dbt_luke.first_model........................ [RUN]
2021-10-25 09:47:15.421627 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 09:47:15.421627 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-25 09:47:15.423711 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-25 09:47:15.425710 (Thread-1): finished collecting timing info
2021-10-25 09:47:15.454505 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-25 09:47:15.463521 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 09:47:15.463521 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-25 09:47:15.463521 (Thread-1): Opening a new connection, currently in state init
2021-10-25 09:47:16.225950 (Thread-1): SQL status: SUCCESS 1 in 0.76 seconds
2021-10-25 09:47:16.225950 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 09:47:16.225950 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt_luke.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below

    post_hook="grant select on analytics.dbt_luke.first_model to role analyst" can put in config
*/




with source_data as (

    select 1 as id, 'CA' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at
    union all
    select null as id, 'TX' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at
    union all
    select 3 as id, 'VT' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-25 09:47:17.619536 (Thread-1): SQL status: SUCCESS 1 in 1.39 seconds
2021-10-25 09:47:17.620910 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-25 09:47:17.620910 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 09:47:17.620910 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-25 09:47:17.778276 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 09:47:17.785400 (Thread-1): finished collecting timing info
2021-10-25 09:47:17.785400 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-25 09:47:18.054426 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f261fd32-28a1-4a3a-ba16-a02421ba587c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D86388BAF0>]}
2021-10-25 09:47:18.054989 (Thread-1): 11:47:18 | 1 of 7 OK created table model dbt_luke.first_model................... [SUCCESS 1 in 2.63s]
2021-10-25 09:47:18.055862 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-25 09:47:18.055862 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-25 09:47:18.056362 (Thread-1): 11:47:18 | 2 of 7 START table model dbt_luke.cul_order_price.................... [RUN]
2021-10-25 09:47:18.056362 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 09:47:18.056362 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-25 09:47:18.057648 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-25 09:47:18.060799 (Thread-1): finished collecting timing info
2021-10-25 09:47:18.062713 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-25 09:47:18.065717 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 09:47:18.065717 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-25 09:47:18.065717 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 09:47:18.794514 (Thread-1): SQL status: SUCCESS 1 in 0.73 seconds
2021-10-25 09:47:18.794514 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 09:47:18.794514 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt_luke.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-25 09:47:20.955966 (Thread-1): SQL status: SUCCESS 1 in 2.16 seconds
2021-10-25 09:47:20.956967 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-25 09:47:20.956967 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 09:47:20.956967 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-25 09:47:21.117738 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 09:47:21.118848 (Thread-1): finished collecting timing info
2021-10-25 09:47:21.118848 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-25 09:47:21.406049 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f261fd32-28a1-4a3a-ba16-a02421ba587c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D863BA75B0>]}
2021-10-25 09:47:21.406096 (Thread-1): 11:47:21 | 2 of 7 OK created table model dbt_luke.cul_order_price............... [SUCCESS 1 in 3.35s]
2021-10-25 09:47:21.407127 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-25 09:47:21.407340 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-25 09:47:21.407340 (Thread-1): 11:47:21 | 3 of 7 START incremental model dbt_luke.dates........................ [RUN]
2021-10-25 09:47:21.407340 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:47:21.407340 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-25 09:47:21.410214 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-25 09:47:21.413267 (Thread-1): finished collecting timing info
2021-10-25 09:47:21.440082 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-25 09:47:21.443080 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:47:21.443080 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-25 09:47:21.443080 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 09:47:22.542611 (Thread-1): SQL status: SUCCESS 1 in 1.10 seconds
2021-10-25 09:47:22.542611 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:47:22.542611 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


      create or replace transient table analytics.dbt_luke.dates  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


      );
2021-10-25 09:47:23.520312 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-10-25 09:47:23.521386 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-25 09:47:23.521386 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:47:23.521386 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-25 09:47:23.672434 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-25 09:47:23.673489 (Thread-1): finished collecting timing info
2021-10-25 09:47:23.673489 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-25 09:47:24.041697 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f261fd32-28a1-4a3a-ba16-a02421ba587c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D863BCD5E0>]}
2021-10-25 09:47:24.041697 (Thread-1): 11:47:24 | 3 of 7 OK created incremental model dbt_luke.dates................... [SUCCESS 1 in 2.63s]
2021-10-25 09:47:24.042763 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-25 09:47:24.042763 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-25 09:47:24.043668 (Thread-1): 11:47:24 | 4 of 7 START table model dbt_luke.playing_with_tests................. [RUN]
2021-10-25 09:47:24.043668 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 09:47:24.043668 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-25 09:47:24.048888 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-25 09:47:24.052394 (Thread-1): finished collecting timing info
2021-10-25 09:47:24.054394 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-25 09:47:24.056394 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 09:47:24.056394 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-25 09:47:24.057394 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 09:47:25.117260 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-10-25 09:47:25.117260 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 09:47:25.117260 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */


      create or replace transient table analytics.dbt_luke.playing_with_tests  as
      (SELECT
  c_custkey,
  c_mktsegment,
     -- starts macro namesmacro and parameter

  CASE                 -- SQL code to be inserted everytime macro called
    WHEN c_mktsegment IN ('BUILDING', 'HOUSEHOLD', 'FURNITURE')
      THEN 'segment_1'
    ELSE 'segment_2'
  END
 mkt_segment_adjusted
FROM snowflake_sample_data.tpch_sf1.customer
      );
2021-10-25 09:47:26.313106 (Thread-1): SQL status: SUCCESS 1 in 1.20 seconds
2021-10-25 09:47:26.314233 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-25 09:47:26.315317 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 09:47:26.315317 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-25 09:47:26.472034 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 09:47:26.473034 (Thread-1): finished collecting timing info
2021-10-25 09:47:26.473034 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-25 09:47:26.753027 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f261fd32-28a1-4a3a-ba16-a02421ba587c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D863A7F190>]}
2021-10-25 09:47:26.754119 (Thread-1): 11:47:26 | 4 of 7 OK created table model dbt_luke.playing_with_tests............ [SUCCESS 1 in 2.71s]
2021-10-25 09:47:26.755074 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-25 09:47:26.755074 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-25 09:47:26.755074 (Thread-1): 11:47:26 | 5 of 7 START table model dbt_luke.snowflake_customer_purchases....... [RUN]
2021-10-25 09:47:26.756030 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 09:47:26.756030 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-25 09:47:26.758116 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-25 09:47:26.761103 (Thread-1): finished collecting timing info
2021-10-25 09:47:26.763622 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-25 09:47:26.769637 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 09:47:26.769637 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-25 09:47:26.769637 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 09:47:27.553858 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-25 09:47:27.553858 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 09:47:27.553858 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt_luke.snowflake_customer_purchases  as
      (

SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM snowflake_sample_data.tpch_sf1.customer c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey

   -- starts macro namesmacro and parameter

  GROUP BY                -- SQL code to be inserted everytime macro called
      -- If n = 1 group by columns 1 - 5, not inclusive at end, thus, n+1
      1
       ,   -- Inserts a comma after each loop except the last one, endif
      -- If n = 1 group by columns 1 - 5, not inclusive at end, thus, n+1
      2
       ,   -- Inserts a comma after each loop except the last one, endif
      -- If n = 1 group by columns 1 - 5, not inclusive at end, thus, n+1
      3
        -- Inserts a comma after each loop except the last one, endif
                                -- end for loop

      );
2021-10-25 09:47:28.845015 (Thread-1): SQL status: SUCCESS 1 in 1.29 seconds
2021-10-25 09:47:28.847023 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-25 09:47:28.847931 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 09:47:28.847931 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-25 09:47:29.003235 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 09:47:29.004237 (Thread-1): finished collecting timing info
2021-10-25 09:47:29.004237 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-25 09:47:29.283293 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f261fd32-28a1-4a3a-ba16-a02421ba587c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D863BA5DC0>]}
2021-10-25 09:47:29.283293 (Thread-1): 11:47:29 | 5 of 7 OK created table model dbt_luke.snowflake_customer_purchases.. [SUCCESS 1 in 2.53s]
2021-10-25 09:47:29.284286 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-25 09:47:29.284286 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-25 09:47:29.284286 (Thread-1): 11:47:29 | 6 of 7 START incremental model dbt_luke.time......................... [RUN]
2021-10-25 09:47:29.284286 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:47:29.285272 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-25 09:47:29.287480 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-25 09:47:29.289506 (Thread-1): finished collecting timing info
2021-10-25 09:47:29.292506 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-25 09:47:29.294490 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:47:29.294490 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-25 09:47:29.294490 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 09:47:30.377413 (Thread-1): SQL status: SUCCESS 1 in 1.08 seconds
2021-10-25 09:47:30.377413 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:47:30.377413 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


      create or replace transient table analytics.dbt_luke.time  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


      );
2021-10-25 09:47:31.571475 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2021-10-25 09:47:31.573472 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-25 09:47:31.573472 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:47:31.573472 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-25 09:47:31.733067 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 09:47:31.734226 (Thread-1): finished collecting timing info
2021-10-25 09:47:31.734550 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-25 09:47:32.032839 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f261fd32-28a1-4a3a-ba16-a02421ba587c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D863B9CD90>]}
2021-10-25 09:47:32.032839 (Thread-1): 11:47:32 | 6 of 7 OK created incremental model dbt_luke.time.................... [SUCCESS 1 in 2.75s]
2021-10-25 09:47:32.034332 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-25 09:47:32.034332 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-25 09:47:32.034332 (Thread-1): 11:47:32 | 7 of 7 START table model dbt_luke.my_second_dbt_model................ [RUN]
2021-10-25 09:47:32.034332 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 09:47:32.034332 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-25 09:47:32.036760 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-25 09:47:32.039676 (Thread-1): finished collecting timing info
2021-10-25 09:47:32.042681 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-25 09:47:32.050819 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 09:47:32.050819 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-25 09:47:32.050819 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 09:47:33.036667 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-10-25 09:47:33.036667 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 09:47:33.036667 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt_luke.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt_luke.first_model
      );
2021-10-25 09:47:34.076507 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-10-25 09:47:34.077605 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-25 09:47:34.077605 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 09:47:34.077605 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-25 09:47:34.244142 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-25 09:47:34.246647 (Thread-1): finished collecting timing info
2021-10-25 09:47:34.247969 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-25 09:47:34.557651 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f261fd32-28a1-4a3a-ba16-a02421ba587c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D863BA3FD0>]}
2021-10-25 09:47:34.557651 (Thread-1): 11:47:34 | 7 of 7 OK created table model dbt_luke.my_second_dbt_model........... [SUCCESS 1 in 2.52s]
2021-10-25 09:47:34.558670 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-25 09:47:34.559651 (MainThread): Acquiring new snowflake connection "master".
2021-10-25 09:47:34.559651 (MainThread): Using snowflake connection "master".
2021-10-25 09:47:34.559651 (MainThread): On master: BEGIN
2021-10-25 09:47:34.559651 (MainThread): Opening a new connection, currently in state closed
2021-10-25 09:47:35.556190 (MainThread): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-25 09:47:35.556190 (MainThread): On master: COMMIT
2021-10-25 09:47:35.557190 (MainThread): Using snowflake connection "master".
2021-10-25 09:47:35.557190 (MainThread): On master: COMMIT
2021-10-25 09:47:35.796974 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-10-25 09:47:35.796974 (MainThread): 11:47:35 | 
2021-10-25 09:47:35.796974 (MainThread): 11:47:35 | Running 3 on-run-end hooks
2021-10-25 09:47:35.798973 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-25 09:47:35.800985 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-25 09:47:35.805009 (MainThread): 11:47:35 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-25 09:47:35.805156 (MainThread): Using snowflake connection "master".
2021-10-25 09:47:35.805156 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-25 09:47:35.966984 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 09:47:35.967956 (MainThread): 11:47:35 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.16s]
2021-10-25 09:47:35.968945 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-25 09:47:35.969945 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-25 09:47:35.975946 (MainThread): 11:47:35 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-25 09:47:35.977030 (MainThread): Using snowflake connection "master".
2021-10-25 09:47:35.977030 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-25 09:47:36.154814 (MainThread): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-25 09:47:36.155710 (MainThread): 11:47:36 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.18s]
2021-10-25 09:47:36.156711 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-25 09:47:36.157717 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-25 09:47:36.160712 (MainThread): 11:47:36 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-25 09:47:36.162081 (MainThread): Using snowflake connection "master".
2021-10-25 09:47:36.162173 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-25 09:47:36.333187 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-25 09:47:36.333445 (MainThread): 11:47:36 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.17s]
2021-10-25 09:47:36.335586 (MainThread): 11:47:36 | 
2021-10-25 09:47:36.335586 (MainThread): On master: Close
2021-10-25 09:47:36.638178 (MainThread): 11:47:36 | 
2021-10-25 09:47:36.639177 (MainThread): 11:47:36 | Finished running 5 table models, 2 incremental models, 4 hooks in 28.50s.
2021-10-25 09:47:36.640262 (MainThread): Connection 'master' was properly closed.
2021-10-25 09:47:36.641177 (MainThread): Connection 'create_analytics_dbt_luke' was properly closed.
2021-10-25 09:47:36.641177 (MainThread): Connection 'list_analytics_dbt_luke' was properly closed.
2021-10-25 09:47:36.641177 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-25 09:47:36.664363 (MainThread): 
2021-10-25 09:47:36.664867 (MainThread): Completed successfully
2021-10-25 09:47:36.665896 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-25 09:47:36.666886 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D863BC3160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D86379D970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D863A7F1C0>]}
2021-10-25 09:47:36.667979 (MainThread): Flushing usage events
2021-10-25 09:49:50.722977 (MainThread): Running with dbt=0.20.2
2021-10-25 09:49:51.827124 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\luke.clarke\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-10-25 09:49:51.828126 (MainThread): Tracking: tracking
2021-10-25 09:49:51.829243 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A816CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A96AB370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A96ABC10>]}
2021-10-25 09:49:51.846073 (MainThread): Partial parsing not enabled
2021-10-25 09:49:51.876156 (MainThread): Parsing macros\group_by.sql
2021-10-25 09:49:51.878203 (MainThread): Parsing macros\renaming_segments.sql
2021-10-25 09:49:51.879204 (MainThread): Parsing macros\suspend_warehouse.sql
2021-10-25 09:49:51.881203 (MainThread): Parsing macros\adapters.sql
2021-10-25 09:49:51.924049 (MainThread): Parsing macros\catalog.sql
2021-10-25 09:49:51.927050 (MainThread): Parsing macros\materializations\incremental.sql
2021-10-25 09:49:51.940672 (MainThread): Parsing macros\materializations\merge.sql
2021-10-25 09:49:51.944672 (MainThread): Parsing macros\materializations\table.sql
2021-10-25 09:49:51.949671 (MainThread): Parsing macros\materializations\view.sql
2021-10-25 09:49:51.952672 (MainThread): Parsing macros\core.sql
2021-10-25 09:49:51.957001 (MainThread): Parsing macros\adapters\common.sql
2021-10-25 09:49:52.024814 (MainThread): Parsing macros\etc\datetime.sql
2021-10-25 09:49:52.038110 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-10-25 09:49:52.039110 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-10-25 09:49:52.041109 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-10-25 09:49:52.043629 (MainThread): Parsing macros\etc\is_incremental.sql
2021-10-25 09:49:52.045222 (MainThread): Parsing macros\etc\query.sql
2021-10-25 09:49:52.047355 (MainThread): Parsing macros\materializations\helpers.sql
2021-10-25 09:49:52.063106 (MainThread): Parsing macros\materializations\test.sql
2021-10-25 09:49:52.072575 (MainThread): Parsing macros\materializations\common\merge.sql
2021-10-25 09:49:52.089137 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-10-25 09:49:52.092387 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-10-25 09:49:52.106547 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-10-25 09:49:52.146020 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-10-25 09:49:52.190205 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-10-25 09:49:52.192844 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-10-25 09:49:52.224209 (MainThread): Parsing macros\materializations\table\table.sql
2021-10-25 09:49:52.239491 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-10-25 09:49:52.249114 (MainThread): Parsing macros\materializations\view\view.sql
2021-10-25 09:49:52.260120 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-10-25 09:49:52.264278 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-10-25 09:49:52.266285 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-10-25 09:49:52.269285 (MainThread): Parsing macros\schema_tests\unique.sql
2021-10-25 09:49:52.586429 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 09:49:52.602062 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 09:49:52.606945 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:49:52.608947 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 09:49:52.615946 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 09:49:52.623734 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 09:49:52.632732 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:49:52.644949 (MainThread): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:49:52.665948 (MainThread): Acquiring new snowflake connection "snapshot.lukeclarke_learn_dbt.first_model_snapshot".
2021-10-25 09:49:52.695851 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.assert_under_ten_percent_not_null".
2021-10-25 09:49:52.700623 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:49:52.701124 (MainThread): Acquiring new snowflake connection "test.lukeclarke_learn_dbt.mkt_segment_test".
2021-10-25 09:49:52.705131 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:49:52.762574 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0".
2021-10-25 09:49:52.764388 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0".
2021-10-25 09:49:52.766581 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1".
2021-10-25 09:49:52.769102 (MainThread): Acquiring new snowflake connection "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2".
2021-10-25 09:49:52.804180 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:49:52.807214 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:49:52.823173 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:49:52.824174 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:49:52.827173 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:49:52.831173 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:49:52.834172 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:49:52.838172 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:49:52.857720 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:49:52.857720 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:49:52.882958 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:49:52.885958 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-25 09:49:52.914461 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3967129-e82f-4c6a-82e8-2e933d2090ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A98340A0>]}
2021-10-25 09:49:52.946393 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-25 09:49:52.947406 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3967129-e82f-4c6a-82e8-2e933d2090ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A9834F70>]}
2021-10-25 09:49:52.947406 (MainThread): Found 7 models, 12 tests, 1 snapshot, 0 analyses, 154 macros, 4 operations, 0 seed files, 2 sources, 0 exposures
2021-10-25 09:49:52.950211 (MainThread): 
2021-10-25 09:49:52.951210 (MainThread): Acquiring new snowflake connection "master".
2021-10-25 09:49:52.953226 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-10-25 09:49:52.975954 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-10-25 09:49:52.975954 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-10-25 09:49:52.975954 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-25 09:49:54.689617 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.71 seconds
2021-10-25 09:49:54.693640 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-10-25 09:49:54.965926 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_snapshots".
2021-10-25 09:49:54.977007 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_snapshots".
2021-10-25 09:49:54.977506 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_snapshots"} */

    show terse objects in analytics.snapshots
2021-10-25 09:49:54.977506 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-25 09:49:55.948213 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.97 seconds
2021-10-25 09:49:55.949214 (ThreadPoolExecutor-1_0): On list_analytics_snapshots: Close
2021-10-25 09:49:56.228218 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_luke".
2021-10-25 09:49:56.229335 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_luke".
2021-10-25 09:49:56.229938 (ThreadPoolExecutor-1_0): On list_analytics_dbt_luke: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "list_analytics_dbt_luke"} */

    show terse objects in analytics.dbt_luke
2021-10-25 09:49:56.229938 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-25 09:49:56.990893 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.76 seconds
2021-10-25 09:49:56.992229 (ThreadPoolExecutor-1_0): On list_analytics_dbt_luke: Close
2021-10-25 09:49:57.307536 (MainThread): Using snowflake connection "master".
2021-10-25 09:49:57.307536 (MainThread): On master: BEGIN
2021-10-25 09:49:57.307536 (MainThread): Opening a new connection, currently in state init
2021-10-25 09:49:58.260905 (MainThread): SQL status: SUCCESS 1 in 0.95 seconds
2021-10-25 09:49:58.260905 (MainThread): On master: COMMIT
2021-10-25 09:49:58.260905 (MainThread): Using snowflake connection "master".
2021-10-25 09:49:58.260905 (MainThread): On master: COMMIT
2021-10-25 09:49:58.695329 (MainThread): SQL status: SUCCESS 1 in 0.43 seconds
2021-10-25 09:49:58.695329 (MainThread): 11:49:58 | 
2021-10-25 09:49:58.695329 (MainThread): 11:49:58 | Running 1 on-run-start hook
2021-10-25 09:49:58.698358 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0
2021-10-25 09:49:58.699355 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-start-0"
2021-10-25 09:49:58.704356 (MainThread): 11:49:58 | 1 of 1 START hook: lukeclarke_learn_dbt.on-run-start.0............... [RUN]
2021-10-25 09:49:58.705357 (MainThread): Using snowflake connection "master".
2021-10-25 09:49:58.705357 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
create table if not exists audit (model text, state text, time timestamp_ltz)
2021-10-25 09:49:58.874014 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-25 09:49:58.875012 (MainThread): 11:49:58 | 1 of 1 OK hook: lukeclarke_learn_dbt.on-run-start.0.................. [SUCCESS 1 in 0.17s]
2021-10-25 09:49:58.875012 (MainThread): 11:49:58 | 
2021-10-25 09:49:58.877348 (MainThread): On master: Close
2021-10-25 09:49:59.149593 (MainThread): 11:49:59 | Concurrency: 1 threads (target='dev')
2021-10-25 09:49:59.149593 (MainThread): 11:49:59 | 
2021-10-25 09:49:59.156495 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-25 09:49:59.156495 (Thread-1): 11:49:59 | 1 of 7 START table model dbt_luke.first_model........................ [RUN]
2021-10-25 09:49:59.157819 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 09:49:59.158317 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-25 09:49:59.160831 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-25 09:49:59.171832 (Thread-1): finished collecting timing info
2021-10-25 09:49:59.219757 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_first_dbt_model"
2021-10-25 09:49:59.228895 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 09:49:59.229874 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: BEGIN
2021-10-25 09:49:59.229874 (Thread-1): Opening a new connection, currently in state init
2021-10-25 09:50:00.074003 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-10-25 09:50:00.074003 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 09:50:00.074003 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt_luke.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below

    post_hook="grant select on analytics.dbt_luke.first_model to role analyst" can put in config
*/




with source_data as (

    select 1 as id, 'NJ' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at
    union all
    select null as id, 'TX' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at
    union all
    select 3 as id, 'VT' as state, '2020-01-01 00:00:00.000'::timestamp as updated_at

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-10-25 09:50:00.934188 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-10-25 09:50:00.935189 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-25 09:50:00.935189 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_first_dbt_model".
2021-10-25 09:50:00.935189 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: COMMIT
2021-10-25 09:50:01.082779 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-25 09:50:01.094970 (Thread-1): finished collecting timing info
2021-10-25 09:50:01.095410 (Thread-1): On model.lukeclarke_learn_dbt.my_first_dbt_model: Close
2021-10-25 09:50:01.370608 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3967129-e82f-4c6a-82e8-2e933d2090ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A9B6D190>]}
2021-10-25 09:50:01.371686 (Thread-1): 11:50:01 | 1 of 7 OK created table model dbt_luke.first_model................... [SUCCESS 1 in 2.21s]
2021-10-25 09:50:01.372612 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_first_dbt_model
2021-10-25 09:50:01.372612 (Thread-1): Began running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-25 09:50:01.372612 (Thread-1): 11:50:01 | 2 of 7 START table model dbt_luke.cul_order_price.................... [RUN]
2021-10-25 09:50:01.373597 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 09:50:01.373597 (Thread-1): Compiling model.lukeclarke_learn_dbt.cul_order_price
2021-10-25 09:50:01.375683 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-25 09:50:01.378688 (Thread-1): finished collecting timing info
2021-10-25 09:50:01.381692 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.cul_order_price"
2021-10-25 09:50:01.386599 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 09:50:01.387678 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: BEGIN
2021-10-25 09:50:01.387678 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 09:50:02.209429 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-10-25 09:50:02.209429 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 09:50:02.209429 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.cul_order_price"} */


      create or replace transient table analytics.dbt_luke.cul_order_price  as
      (SELECT o.o_orderdate,
       sum(o.o_totalprice) OVER(partition by o.o_orderdate ORDER BY o.o_orderdate) AS "cul_daily_amount"
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" AS o
      );
2021-10-25 09:50:03.472878 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-10-25 09:50:03.474019 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-25 09:50:03.474550 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.cul_order_price".
2021-10-25 09:50:03.474550 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: COMMIT
2021-10-25 09:50:03.656015 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-25 09:50:03.656015 (Thread-1): finished collecting timing info
2021-10-25 09:50:03.656015 (Thread-1): On model.lukeclarke_learn_dbt.cul_order_price: Close
2021-10-25 09:50:03.954710 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3967129-e82f-4c6a-82e8-2e933d2090ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A9834AC0>]}
2021-10-25 09:50:03.955800 (Thread-1): 11:50:03 | 2 of 7 OK created table model dbt_luke.cul_order_price............... [SUCCESS 1 in 2.58s]
2021-10-25 09:50:03.956723 (Thread-1): Finished running node model.lukeclarke_learn_dbt.cul_order_price
2021-10-25 09:50:03.956723 (Thread-1): Began running node model.lukeclarke_learn_dbt.dates
2021-10-25 09:50:03.957622 (Thread-1): 11:50:03 | 3 of 7 START incremental model dbt_luke.dates........................ [RUN]
2021-10-25 09:50:03.957622 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:50:03.958121 (Thread-1): Compiling model.lukeclarke_learn_dbt.dates
2021-10-25 09:50:03.965643 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-25 09:50:03.972423 (Thread-1): finished collecting timing info
2021-10-25 09:50:04.004901 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:50:04.004901 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    

      create or replace temporary table analytics.dbt_luke.dates__dbt_tmp  as
      (

SELECT D_DATE
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE D_DATE <= current_date


  and d_date > (select max(d_date) from analytics.dbt_luke.dates)

      );
2021-10-25 09:50:04.004901 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 09:50:05.690834 (Thread-1): SQL status: SUCCESS 1 in 1.69 seconds
2021-10-25 09:50:05.702779 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:50:05.703955 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt_luke.dates__dbt_tmp
2021-10-25 09:50:05.880291 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-25 09:50:05.884362 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:50:05.884362 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt_luke.dates
2021-10-25 09:50:06.244062 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-10-25 09:50:06.247907 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:50:06.247907 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */

    describe table analytics.dbt_luke.dates
2021-10-25 09:50:06.566670 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-10-25 09:50:06.588797 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.dates"
2021-10-25 09:50:06.597864 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:50:06.597864 (Thread-1): On model.lukeclarke_learn_dbt.dates: BEGIN
2021-10-25 09:50:06.788334 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-25 09:50:06.788334 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:50:06.788334 (Thread-1): On model.lukeclarke_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.dates"} */


        insert into analytics.dbt_luke.dates ("D_DATE")
        (
            select "D_DATE"
            from analytics.dbt_luke.dates__dbt_tmp
        );
2021-10-25 09:50:07.138955 (Thread-1): SQL status: SUCCESS 0 in 0.35 seconds
2021-10-25 09:50:07.139955 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-25 09:50:07.140981 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.dates".
2021-10-25 09:50:07.140981 (Thread-1): On model.lukeclarke_learn_dbt.dates: COMMIT
2021-10-25 09:50:07.388311 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-10-25 09:50:07.390309 (Thread-1): finished collecting timing info
2021-10-25 09:50:07.390309 (Thread-1): On model.lukeclarke_learn_dbt.dates: Close
2021-10-25 09:50:07.690505 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3967129-e82f-4c6a-82e8-2e933d2090ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A9A54820>]}
2021-10-25 09:50:07.691000 (Thread-1): 11:50:07 | 3 of 7 OK created incremental model dbt_luke.dates................... [SUCCESS 0 in 3.73s]
2021-10-25 09:50:07.691998 (Thread-1): Finished running node model.lukeclarke_learn_dbt.dates
2021-10-25 09:50:07.691998 (Thread-1): Began running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-25 09:50:07.692721 (Thread-1): 11:50:07 | 4 of 7 START table model dbt_luke.playing_with_tests................. [RUN]
2021-10-25 09:50:07.693220 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 09:50:07.693720 (Thread-1): Compiling model.lukeclarke_learn_dbt.playing_with_tests
2021-10-25 09:50:07.697960 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-25 09:50:07.701127 (Thread-1): finished collecting timing info
2021-10-25 09:50:07.705360 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.playing_with_tests"
2021-10-25 09:50:07.722655 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 09:50:07.723155 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: BEGIN
2021-10-25 09:50:07.723155 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 09:50:08.722656 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-10-25 09:50:08.722656 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 09:50:08.722656 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.playing_with_tests"} */


      create or replace transient table analytics.dbt_luke.playing_with_tests  as
      (SELECT
  c_custkey,
  c_mktsegment,
     -- starts macro namesmacro and parameter

  CASE                 -- SQL code to be inserted everytime macro called
    WHEN c_mktsegment IN ('BUILDING', 'HOUSEHOLD', 'FURNITURE')
      THEN 'segment_1'
    ELSE 'segment_2'
  END
 mkt_segment_adjusted
FROM snowflake_sample_data.tpch_sf1.customer
      );
2021-10-25 09:50:09.905833 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-10-25 09:50:09.908028 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-25 09:50:09.908191 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.playing_with_tests".
2021-10-25 09:50:09.908596 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: COMMIT
2021-10-25 09:50:10.090304 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-25 09:50:10.092905 (Thread-1): finished collecting timing info
2021-10-25 09:50:10.092905 (Thread-1): On model.lukeclarke_learn_dbt.playing_with_tests: Close
2021-10-25 09:50:10.370486 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3967129-e82f-4c6a-82e8-2e933d2090ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A9C0A0D0>]}
2021-10-25 09:50:10.371516 (Thread-1): 11:50:10 | 4 of 7 OK created table model dbt_luke.playing_with_tests............ [SUCCESS 1 in 2.68s]
2021-10-25 09:50:10.372516 (Thread-1): Finished running node model.lukeclarke_learn_dbt.playing_with_tests
2021-10-25 09:50:10.372516 (Thread-1): Began running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-25 09:50:10.372516 (Thread-1): 11:50:10 | 5 of 7 START table model dbt_luke.snowflake_customer_purchases....... [RUN]
2021-10-25 09:50:10.373516 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 09:50:10.373516 (Thread-1): Compiling model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-25 09:50:10.377516 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-25 09:50:10.381515 (Thread-1): finished collecting timing info
2021-10-25 09:50:10.383516 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.snowflake_customer_purchases"
2021-10-25 09:50:10.389525 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 09:50:10.389525 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: BEGIN
2021-10-25 09:50:10.390516 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 09:50:11.407539 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-10-25 09:50:11.407539 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 09:50:11.407539 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt_luke.snowflake_customer_purchases  as
      (

SELECT
    c.c_custkey,
    c.c_name,
    c.c_nationkey as nation,
    sum(o.o_totalprice) as total_order_price
FROM snowflake_sample_data.tpch_sf1.customer c
LEFT JOIN snowflake_sample_data.tpch_sf1.orders o
ON c.c_custkey = o.o_custkey

   -- starts macro namesmacro and parameter

  GROUP BY                -- SQL code to be inserted everytime macro called
      -- If n = 1 group by columns 1 - 5, not inclusive at end, thus, n+1
      1
       ,   -- Inserts a comma after each loop except the last one, endif
      -- If n = 1 group by columns 1 - 5, not inclusive at end, thus, n+1
      2
       ,   -- Inserts a comma after each loop except the last one, endif
      -- If n = 1 group by columns 1 - 5, not inclusive at end, thus, n+1
      3
        -- Inserts a comma after each loop except the last one, endif
                                -- end for loop

      );
2021-10-25 09:50:12.823578 (Thread-1): SQL status: SUCCESS 1 in 1.42 seconds
2021-10-25 09:50:12.824579 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-25 09:50:12.824579 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.snowflake_customer_purchases".
2021-10-25 09:50:12.824579 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: COMMIT
2021-10-25 09:50:12.979969 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 09:50:12.980998 (Thread-1): finished collecting timing info
2021-10-25 09:50:12.980998 (Thread-1): On model.lukeclarke_learn_dbt.snowflake_customer_purchases: Close
2021-10-25 09:50:13.246370 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3967129-e82f-4c6a-82e8-2e933d2090ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A9A58B20>]}
2021-10-25 09:50:13.246370 (Thread-1): 11:50:13 | 5 of 7 OK created table model dbt_luke.snowflake_customer_purchases.. [SUCCESS 1 in 2.87s]
2021-10-25 09:50:13.248370 (Thread-1): Finished running node model.lukeclarke_learn_dbt.snowflake_customer_purchases
2021-10-25 09:50:13.248445 (Thread-1): Began running node model.lukeclarke_learn_dbt.time
2021-10-25 09:50:13.248949 (Thread-1): 11:50:13 | 6 of 7 START incremental model dbt_luke.time......................... [RUN]
2021-10-25 09:50:13.248949 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:50:13.248949 (Thread-1): Compiling model.lukeclarke_learn_dbt.time
2021-10-25 09:50:13.252960 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-25 09:50:13.259960 (Thread-1): finished collecting timing info
2021-10-25 09:50:13.263670 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:50:13.264168 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    

      create or replace temporary table analytics.dbt_luke.time__dbt_tmp  as
      (

SELECT to_time(concat(T_HOUR::varchar, ':', T_MINUTE, ':', T_SECOND)) AS TIME
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE TIME <= current_time


  and TIME > (select max(TIME) from analytics.dbt_luke.time)

      );
2021-10-25 09:50:13.264168 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 09:50:14.709941 (Thread-1): SQL status: SUCCESS 1 in 1.45 seconds
2021-10-25 09:50:14.711935 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:50:14.711935 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt_luke.time__dbt_tmp
2021-10-25 09:50:14.877458 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-10-25 09:50:14.881719 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:50:14.881719 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt_luke.time
2021-10-25 09:50:15.045226 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 09:50:15.049565 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:50:15.049565 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */

    describe table analytics.dbt_luke.time
2021-10-25 09:50:15.196669 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-25 09:50:15.197669 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.time"
2021-10-25 09:50:15.204525 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:50:15.204525 (Thread-1): On model.lukeclarke_learn_dbt.time: BEGIN
2021-10-25 09:50:15.382302 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-10-25 09:50:15.382302 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:50:15.382302 (Thread-1): On model.lukeclarke_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.time"} */


        insert into analytics.dbt_luke.time ("TIME")
        (
            select "TIME"
            from analytics.dbt_luke.time__dbt_tmp
        );
2021-10-25 09:50:16.054109 (Thread-1): SQL status: SUCCESS 163 in 0.67 seconds
2021-10-25 09:50:16.055109 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-25 09:50:16.055109 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.time".
2021-10-25 09:50:16.055109 (Thread-1): On model.lukeclarke_learn_dbt.time: COMMIT
2021-10-25 09:50:16.467716 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-10-25 09:50:16.467716 (Thread-1): finished collecting timing info
2021-10-25 09:50:16.468802 (Thread-1): On model.lukeclarke_learn_dbt.time: Close
2021-10-25 09:50:16.762055 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3967129-e82f-4c6a-82e8-2e933d2090ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A9B92430>]}
2021-10-25 09:50:16.763053 (Thread-1): 11:50:16 | 6 of 7 OK created incremental model dbt_luke.time.................... [SUCCESS 163 in 3.51s]
2021-10-25 09:50:16.764052 (Thread-1): Finished running node model.lukeclarke_learn_dbt.time
2021-10-25 09:50:16.764052 (Thread-1): Began running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-25 09:50:16.764052 (Thread-1): 11:50:16 | 7 of 7 START table model dbt_luke.my_second_dbt_model................ [RUN]
2021-10-25 09:50:16.765050 (Thread-1): Acquiring new snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 09:50:16.765050 (Thread-1): Compiling model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-25 09:50:16.767132 (Thread-1): Writing injected SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-25 09:50:16.773145 (Thread-1): finished collecting timing info
2021-10-25 09:50:16.776398 (Thread-1): Writing runtime SQL for node "model.lukeclarke_learn_dbt.my_second_dbt_model"
2021-10-25 09:50:16.783310 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 09:50:16.783310 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: BEGIN
2021-10-25 09:50:16.783310 (Thread-1): Opening a new connection, currently in state closed
2021-10-25 09:50:17.559914 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-10-25 09:50:17.560929 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 09:50:17.560929 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "node_id": "model.lukeclarke_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt_luke.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models


select *
from analytics.dbt_luke.first_model
      );
2021-10-25 09:50:18.438374 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-10-25 09:50:18.440796 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-25 09:50:18.440796 (Thread-1): Using snowflake connection "model.lukeclarke_learn_dbt.my_second_dbt_model".
2021-10-25 09:50:18.440796 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: COMMIT
2021-10-25 09:50:18.596194 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-10-25 09:50:18.597193 (Thread-1): finished collecting timing info
2021-10-25 09:50:18.597193 (Thread-1): On model.lukeclarke_learn_dbt.my_second_dbt_model: Close
2021-10-25 09:50:18.879166 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3967129-e82f-4c6a-82e8-2e933d2090ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A9BEF7C0>]}
2021-10-25 09:50:18.879166 (Thread-1): 11:50:18 | 7 of 7 OK created table model dbt_luke.my_second_dbt_model........... [SUCCESS 1 in 2.12s]
2021-10-25 09:50:18.881086 (Thread-1): Finished running node model.lukeclarke_learn_dbt.my_second_dbt_model
2021-10-25 09:50:18.882087 (MainThread): Acquiring new snowflake connection "master".
2021-10-25 09:50:18.882087 (MainThread): Using snowflake connection "master".
2021-10-25 09:50:18.882087 (MainThread): On master: BEGIN
2021-10-25 09:50:18.882087 (MainThread): Opening a new connection, currently in state closed
2021-10-25 09:50:19.875938 (MainThread): SQL status: SUCCESS 1 in 0.99 seconds
2021-10-25 09:50:19.875938 (MainThread): On master: COMMIT
2021-10-25 09:50:19.875938 (MainThread): Using snowflake connection "master".
2021-10-25 09:50:19.875938 (MainThread): On master: COMMIT
2021-10-25 09:50:20.092622 (MainThread): SQL status: SUCCESS 1 in 0.22 seconds
2021-10-25 09:50:20.092622 (MainThread): 11:50:20 | 
2021-10-25 09:50:20.093622 (MainThread): 11:50:20 | Running 3 on-run-end hooks
2021-10-25 09:50:20.095621 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0
2021-10-25 09:50:20.096621 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-0"
2021-10-25 09:50:20.099621 (MainThread): 11:50:20 | 1 of 3 START hook: lukeclarke_learn_dbt.on-run-end.0................. [RUN]
2021-10-25 09:50:20.099621 (MainThread): Using snowflake connection "master".
2021-10-25 09:50:20.099621 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant usage on schema analytics.dbt to role analyst
2021-10-25 09:50:20.252073 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-25 09:50:20.252953 (MainThread): 11:50:20 | 1 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.0.................... [SUCCESS 1 in 0.15s]
2021-10-25 09:50:20.253468 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1
2021-10-25 09:50:20.254989 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-1"
2021-10-25 09:50:20.258602 (MainThread): 11:50:20 | 2 of 3 START hook: lukeclarke_learn_dbt.on-run-end.1................. [RUN]
2021-10-25 09:50:20.259002 (MainThread): Using snowflake connection "master".
2021-10-25 09:50:20.259506 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all tables in schema analytics.dbt to role analyst
2021-10-25 09:50:20.448099 (MainThread): SQL status: SUCCESS 1 in 0.19 seconds
2021-10-25 09:50:20.449099 (MainThread): 11:50:20 | 2 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.1.................... [SUCCESS 1 in 0.19s]
2021-10-25 09:50:20.451100 (MainThread): Compiling operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2
2021-10-25 09:50:20.452099 (MainThread): Writing injected SQL for node "operation.lukeclarke_learn_dbt.lukeclarke_learn_dbt-on-run-end-2"
2021-10-25 09:50:20.455100 (MainThread): 11:50:20 | 3 of 3 START hook: lukeclarke_learn_dbt.on-run-end.2................. [RUN]
2021-10-25 09:50:20.455753 (MainThread): Using snowflake connection "master".
2021-10-25 09:50:20.455753 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.20.2", "profile_name": "lukeclarke-snowflake-dbt", "target_name": "dev", "connection_name": "master"} */
grant select on all views in schema analytics.dbt to role analyst
2021-10-25 09:50:20.603425 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2021-10-25 09:50:20.604499 (MainThread): 11:50:20 | 3 of 3 OK hook: lukeclarke_learn_dbt.on-run-end.2.................... [SUCCESS 1 in 0.15s]
2021-10-25 09:50:20.605420 (MainThread): 11:50:20 | 
2021-10-25 09:50:20.606420 (MainThread): On master: Close
2021-10-25 09:50:20.879375 (MainThread): 11:50:20 | 
2021-10-25 09:50:20.879375 (MainThread): 11:50:20 | Finished running 5 table models, 2 incremental models, 4 hooks in 27.93s.
2021-10-25 09:50:20.882292 (MainThread): Connection 'master' was properly closed.
2021-10-25 09:50:20.882292 (MainThread): Connection 'list_analytics' was properly closed.
2021-10-25 09:50:20.882292 (MainThread): Connection 'list_analytics_dbt_luke' was properly closed.
2021-10-25 09:50:20.882292 (MainThread): Connection 'model.lukeclarke_learn_dbt.my_second_dbt_model' was properly closed.
2021-10-25 09:50:20.903811 (MainThread): 
2021-10-25 09:50:20.904811 (MainThread): Completed successfully
2021-10-25 09:50:20.906050 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-10-25 09:50:20.907048 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A9A11EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A9B93940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190A9BD5FD0>]}
2021-10-25 09:50:20.907048 (MainThread): Flushing usage events
